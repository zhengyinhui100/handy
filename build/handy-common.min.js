/* Handy v1.0.0-dev | 2014-03-30 | zhengyinhui100@gmail.com */
$Define("CM.AbstractEvents",function(){var j=$H.createClass();$H.extend(j.prototype,$H.Events);$H.extend(j.prototype,{_eventCache:{},_listenTo:[],_parseListenToEvents:function(f,b,c,a){var d=this,e=$H.toArray(arguments,3);return d._parseEvents(c,function(a){a.unshift(b);d[f].apply(d,a.concat(e))})},listenTo:function(f,b,c,a,d){if(!this._parseListenToEvents("listenTo",f,b,c,a,d)){"number"==typeof a&&(d=a,a=null);a=a||this;var e=this._delegateHandler(c,a);this._listenTo.push({target:f,name:b,delegation:e,
handler:c});f.on(b,e,a,d)}},unlistenTo:function(f,b,c){if(!this._parseListenToEvents("unlistenTo",f,b,c)){var a=this._listenTo,d="all"==f;$H.each(a,function(e,r){if(d||r.name==b&&r.handler==c&&r.target==f)r.target.off(r.name,r.delegation),a.splice(e,1)})}}});return j});
$Define("CM.AbstractDao","B.LocalStorage",function(j){var f=$H.createClass();$H.extend(f.prototype,{_ajaxMethodMap:{create:"POST",update:"POST",patch:"PATCH","delete":"DELETE",read:"GET"},_localMethodMap:{create:"setItem",update:"setItem",patch:"setItem","delete":"removeItem",read:"getItem"},ajax:function(b){this.beforeSend(b);b.error=$H.intercept(this.error,b.error);b.success=$H.intercept(this.success,b.success);return $.ajax(b)},beforeSend:$H.noop,error:$H.noop,success:$H.noop,get:function(){},
set:function(){},remove:function(){},sync:function(b,c,a){a=a||{};var d=a.storeType||"remote",e={type:"POST",dataType:"json"};a.url||(e.url=c.getUrl());if(null==a.data&&c&&("create"===b||"update"===b||"patch"===b))e.data=a.attrs||c.toJSON(a);if("remote"==d)e.url+="/"+b+".do",$H.extend(e,a),this.ajax(e);else j[this._localMethodMap[b]](e);c.trigger("request",c,a)}});return f});
$Define("CM.AbstractManager",function(){var j=$H.createClass();$H.extend(j.prototype,{_types:{},_all:{},type:"manager",registerType:function(f,b){this._types[f]=b;b.prototype.xtype=f},getClass:function(f){return $H.isClass(f)?f:this._types[f]||$H.namespace(f)},register:function(f){this._all[f.getId()]=f},unregister:function(f){var b=this._all,c=f.getId();b[c]==f&&delete b[c]},eachInEl:function(f,b){var c=this;f.find(".js-"+c.type).each(function(a,d){d=$(d);var e=d.attr("id");(e=c.get(e))&&b(e)})},
generateId:function(f,b){var c=$H.expando+"_"+this.type+"_"+(f||$H.Util.getUuid());if(!0!=b&&this._all[c])$D.error("id\u91cd\u590d:"+c);else return c},get:function(f){var b=this._all;return b[f]||b[this.generateId(f,!0)]}});return j});
$Define("CM.ViewManager","CM.AbstractManager",function(j){var f=$H.createClass();$H.inherit(f,j,{type:"view",initialize:function(){var b=this;$H.on("afterRender",function(c,a){b.afterRender(a)});$H.on("removeEl",function(c,a){b.destroy(a)})},afterRender:function(b){this.eachInEl(b,function(b){b.afterRender()})},destroy:function(b){this.eachInEl(b,function(b){b.destroy(!0)})}});$V=$H.getSingleton(f);return f});
$Define("CM.View",["CM.ViewManager","CM.AbstractEvents","B.Template"],function(j,f){var b=/^(<[a-zA-Z]+)/,c=/^[^>]+class=/,a=/(class=")/,d=f.derive({xtype:"View",_placeholder:'<script id="" type="text/x-placeholder">\x3c/script>',autoRender:!0,renderBy:"append",listeners:[],items:[],children:[],_customEvents:"beforeRender render afterRender beforeShow show afterShow beforeHide hide afterHide beforeUpdate update afterUpdate beforeDestroy destroy afterDestroy add remove".split(" "),_defaultEvents:"mousedown mouseup mouseover mousemove mouseenter mouseleave dragstart drag dragenter dragleave dragover drop dragend touchstart touchmove touchend touchcancel keydown keyup keypress click dblclick focus focusin focusout contextmenu change submit".split(" "),
_applyArray:function(e,a){var d=arguments,b=d.callee.caller,c=b.$owner.prototype;0==d.length?(d=b.arguments,d=$H.toArray(d),e=b.$name,a=d.shift()):d=$H.toArray(d,2);if($H.isArray(a)){for(var b=0,g=a.length;b<g;b++)c[e].apply(this,[a[b]].concat(d));return!0}return!1},_parseListenEvents:function(e,a){var d=this;return d._parseEvents(a.name,function(b){a.name=b[0];2==b.length&&(a.handler=b[0]);d[e].call(d,a)})},initialize:function(e){this.inited||(this.manager=this.constructor.manager||$H.getSingleton(j),
this.doConfig(e),this.parseItems(),!1!=this.autoRender&&this.render(),this.manager.register(this),this.inited=!0)},doConfig:function(e){var a=this;a.initParam=e;"string"==typeof e&&(e={text:e});var d=e||{};$H.extend(a,d,{notCover:function(e,b){var c=$H.contains(a._customEvents,e);if($H.contains(a._defaultEvents,e))return a.listeners.push({name:e,handler:d[e]}),!0;if(c)return a.on(e,d[e]),!0;if("defItem"==e)return $H.extend(a[e],b),!0;if("listener"==e)return a.listeners=a.listeners.concat($H.isArray(b)?
b:[b]),!0;if("items"==e)return a.add(b),!0;if("xtype"==e)return"View"==a[e]&&(a[e]="string"==typeof b?b:b.$ns),!0}});a.renderTo=d.renderTo?$(d.renderTo):$(document.body)},getEl:function(){return this._container},getId:function(){return this._id||(this._id=this.manager.generateId(this.cid))},initHtml:function(){"string"!=typeof this.tmpl&&(this.tmpl=this.constructor.prototype.tmpl=this.tmpl.join(""));return $H.Template.tmpl({id:this.xtype,tmpl:this.tmpl},this)},getHtml:function(){var e=this.getId(),
d;d="visibility"==this.displayMode?"visibility:hidden;":"display:none;";var k=this.initHtml(),q=c.test(k),h="js-"+this.manager.type+" js-"+this.xtype+" "+this.extCls+" ";q&&(k=k.replace(a,"$1"+h));return k=k.replace(b,'$1 id="'+e+'" style="'+d+'"'+(q?"":' class="'+h+'"'))},findHtml:function(e){e=this.find(e);for(var a=[],d=0;d<e.length;d++)a.push(e[d].getHtml());return a.join("")},initStyle:function(){var e=this.getEl(),a=this.style||{};void 0!=this.width&&(a.width=this.width);void 0!=this.height&&
(a.height=this.height);e.css(a)},beforeRender:function(){return this.trigger("beforeRender")},render:function(){if(!1==this.beforeRender())return!1;this.trigger("render");var e=this.getHtml();this.renderTo[this.renderBy](e);this.afterRender()},afterRender:function(){if(this.rendered)return!1;this.callChild();this._container=$("#"+this.getId());this.rendered=!0;this.initStyle();!0!=this.notListen&&this.initListeners();this.disabled&&this.disable();this.trigger("afterRender");this.hidden||this.show()},
beforeShow:function(){return this.trigger("beforeShow")},show:function(e,a){var b=this;if(!1==b.beforeShow()||b.showed||a&&b.hidden)return!1;if(!e&&b.delayShow)setTimeout(function(){d.prototype.show.call(b,!0)},0);else{b.trigger("show");b.showed=!0;var c=b.getEl();"visibility"==b.displayMode?c.css({visibility:"visible"}):c.show();b.callChild([null,!0]);b.afterShow()}},afterShow:function(){this.trigger("afterShow")},beforeHide:function(){return this.trigger("beforeHide")},hide:function(){if(!1==this.beforeHide()||
!this.showed)return!1;this.showed=!1;var e=this.getEl();"visibility"==this.displayMode?e.css({visibility:"hidden"}):e.hide();this.trigger("hide");this.afterHide()},afterHide:function(){this.trigger("afterHide")},enable:function(){this.resume();this.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")},disable:function(){this.suspend();this.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled","disabled")},getContent:function(e,a){a?!a instanceof
d&&(a=this.find(a)[0]):a=this;return!1==e?a.children:a.getEl().html()},setContent:function(e,a){if(a)return!a instanceof d&&(a=this.find(a)[0]),a.setContent(e);var b=this.getEl();b.contents().remove();if("string"==typeof e)b.html(e);else return this.add(e)},listen:function(e){if(!this._parseListenEvents("listen",e)){var a=e.name,d=e.context,b=e.times,c=e.target,g=e.custom,f=e.handler;$H.isFunction(c)&&(c=c.call(this));if(c||g)e=$H.removeUndefined([c,a,f,d,b]),this[g?"on":"listenTo"].apply(this,e);
else{var g=this._listeners,b=e.el,c=e.method||"bind",j=e.selector,m=e.data,d=e.delegation=this._delegateHandler(f,d);$H.isFunction(b)&&(b=b.call(this));$H.mobile()&&"click"==a&&(a="touchend");b=b?"string"==typeof b?this.findEl(b):b:this.getEl();if(j)if(m)b[c](j,a,m,d);else b[c](j,a,d);else if(m)b[c](a,m,d);else b[c](a,d);g.push(e)}}},unlisten:function(e){if(!this._parseListenEvents("unlisten",e)){var a=e.name,d=e.handler;if(e.custom)this.off(a,d);else{var b=e.el,c="delegate"==e.method?"undelegate":
"unbind";e=e.selector;var g;$H.mobile()&&"click"==a&&(a="touchend");for(var b=b?"string"==typeof b?this.findEl(b):b:this.getEl(),f=this._listeners.length-1;0<=f;f--){var j=this._listeners[f];if(j.handler==d){g=j.delegation;this._listeners.splice(f,1);break}}if(e)b[c](e,a,g);else b[c](a,g)}}},initListeners:function(){if(this.listened)return!1;this.listened=!0;var e=this.listeners;this._listeners=[];for(var a=e.length-1;0<=a;a--)this.listen(e[a]);this.callChild()},clearListeners:function(){for(var e=
this._listeners,a=e.length-1;0<=a;a--)this.unlisten(e[a]);this.off("all");this.unlistenTo("all");this.callChild()},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0;this.callChild()},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1;this.callChild()},findEl:function(a){return this.getEl().find(a)},parentsEl:function(a){return this.getEl().parents(a)},each:function(a,b){for(var d=this.children,c=d.length,h,g=0;g<c;){h=d[g];h=b?a.apply(h,b):a(g,h);if(!1===h)break;c==d.length?
g++:c=d.length}},match:function(a,d){if("*"==a)return!0;var b=d||this,c,h,g;a=a.replace(/^([^\[]+)/,'[xtype="$1"]');for(var f=/\[([^=|\!]+)(=|\!=)([^=]+)\]/g;c=f.exec(a);)if(h=c[1],g=c[2],c=eval(c[3]),"="===g?b[h]!=c:b[h]==c)return!1;return!0},find:function(a,b){var d=this;b=b||[];if($H.isNumber(a))b.push(d.children[a]);else if($H.isString(a)){if(0<a.indexOf(","))return $H.each(a.split(","),function(a,e){b=b.concat(d.find(e))}),b;var c=0==a.indexOf(">"),h=a.replace(/^>?\s?/,""),f=h.search(/\s|>/),
j;0<f&&(j=h.substring(f),h=h.substring(0,f));d.each(function(d,k){k.match(h)&&(j?k.find(j,b):b.push(k));c||k.find(a,b)})}else $H.isFunction(a)&&d.each(function(d,c){a(c)&&b.push(c);c.find(a,b)});return b},parents:function(a){for(var b=this;b.parent;)if(b=b.parent,a&&this.match(a,b))return b;return a||b===this?null:b},index:function(){var a=this,b=a.parent;if(b){var d;b.each(function(b,c){if(c==a)return d=b,!1});return d}return null},callChild:function(a,b){0!=this.children.length&&(a&&"string"!=typeof a&&
(b=a,a=null),a=a||arguments.callee.caller.$name,this.each(function(d,c){b?c[a].apply(c,b):c[a].call(c)}))},add:function(a,b){if(!this._applyArray()){var c=void 0==b;if(this.startParseItems){if(a instanceof d)a.parent=this;else{this.defItem&&$H.extend(a,this.defItem,{notCover:!0});this.parseItem(a);var f=this.manager.getClass(a.xtype);f?(a.renderTo||(this.inited?a.renderTo=this.getEl():a.autoRender=!1),a.parent=this,a=new f(a)):$D.error("xtype:"+a.xtype+"\u672a\u627e\u5230")}f=this.children;c?f.push(a):
f.splice(b,0,a);this.trigger("add",a);return a}f=this.items;c?f.push(a):f.splice(b,0,a)}},remove:function(a){if(!this._applyArray()){var b=this.children,c=!1,f;if($H.isNumber(a))f=a,a=b[f];else if($H.isString(a)||$H.isFunction(a)){a=this.find(a);for(var h=0,g=a.length;h<g;h++){if(!1==this.remove(a[h]))return!1;c=!0}}else if(a instanceof d)if(a.parent==this){h=0;for(g=b.length;h<g;h++)if(b[h]==a){f=h;break}}else return a.parent.remove(a);void 0!=f&&!1!=a.destroy(!0)&&(b.splice(f,1),c=!0);this.trigger("remove",
a);return c}},parseItem:function(){},parseItems:function(){this.startParseItems=!0;var a=this.items;if(a)for(var a=$H.isArray(a)?a:[a],b=0,d=a.length;b<d;b++)this.add(a[b])},beforeUpdate:function(){return this.trigger("beforeUpdate")},update:function(a){if(!1==this.beforeUpdate())return!1;var b=this.parent,d=$("<span></span>").insertBefore(this.getEl());a=$H.extend(a||this.initParam,{xtype:this.xtype,renderBy:"replaceWith",renderTo:d});if(!a.cid||a.cid==this.cid)a._id=this._id;if(b){var c=this.index();
if(!1==b.remove(this))return d.remove(),!1;a=b.add(a,c)}else{if(!1==this.destroy())return d.remove(),!1;a=new this.constructor(a)}this.trigger("update",a);this.afterUpdate(a);return a},afterUpdate:function(a){this.trigger("afterUpdate",a)},beforeDestroy:function(){return this.trigger("beforeDestroy")},destroy:function(a){if(!1==this.beforeDestroy())return!1;if(!this.destroyed)return this.callChild(),this.trigger("destroy"),this.clearListeners(),this.getEl().remove(),this.destroyed=!0,!a&&this.parent&&
this.parent.remove(this),this.manager.unregister(this),delete this.initParam,delete this._container,delete this.renderTo,delete this._listeners,delete this.children,this.afterDestroy(),!0},afterDestroy:function(){this.trigger("afterDestroy")}},{extend:function(a){var b=this.prototype;$H.extend(b,a,{notCover:function(d){if($H.contains(["_customEvents","listeners"],d))return b[d]=(a[d]||[]).concat(b[d]||[]),!0;if("xtype"==d||"constructor"==d)return!0}})},html:function(a){return(new this($H.extend({autoRender:!1},
a))).getHtml()}});return d});
$Define("CM.Model",["CM.AbstractDao","CM.AbstractEvents"],function(j,f){return f.derive({_pending:!1,idAttribute:"id",_validate:function(b,c){if(!c.validate||!this.validate)return!0;b=$H.extend({},this.attributes,b);var a=this.validationError=this.validate(b,c)||null;if(!a)return!0;this.trigger("invalid",this,a,$H.extend(c,{validationError:a}));return!1},initialize:function(b,c){this.dao=this.dao||$H.getSingleton(j);var a=b||{};c||(c={});this.cid=$H.Util.getUuid();this.attributes={};c.collection&&
(this.collection=c.collection);c.parse&&(a=this.parse(a,c)||{});a=$H.extend(a,$H.Util.result(this,"defaults"),{notCover:!0});this.set(a,c);this.changed={}},toJSON:function(){return $H.clone(this.attributes)},sync:function(b,c,a){return this.dao.sync(b,c,a)},get:function(b){return this.attributes[b]},escape:function(b){return $H.String.escapeHTML(this.get(b))},has:function(b){b=this.get(b);return null!=b&&void 0!=b},set:function(b,c,a){var d;"object"===typeof b?(d=b,a=c):(d={})[b]=c;a||(a={});if(!this._validate(d,
a))return!1;var e=a.unset;b=a.silent;var f=[],k=this._changing;this._changing=!0;k||(this._previousAttributes=$H.Object.clone(this.attributes),this.changed={});var q=this.attributes,h=this._previousAttributes;this.idAttribute in d&&(this.id=d[this.idAttribute]);for(var g in d)c=d[g],$H.equals(q[g],c)||f.push(g),$H.equals(h[g],c)?delete this.changed[g]:this.changed[g]=c,e?delete q[g]:q[g]=c;if(!b){f.length&&(this._pending=a);c=0;for(d=f.length;c<d;c++)this.trigger("change:"+f[c],this,q[f[c]],a)}if(k)return this;
if(!b)for(;this._pending;)a=this._pending,this._pending=!1,this.trigger("change",this,a);this._changing=this._pending=!1;return this},unset:function(b,c){c=c||{};c.unset=!0;return this.set(b,void 0,c)},clear:function(b){var c={},a;for(a in this.attributes)c[a]=void 0;b=b||{};b.unset=!0;return this.set(c,b)},hasChanged:function(b){var c=this.changed;return null==b?!$H.isEmpty(c):$H.contains(c,b)},changedAttrbutes:function(b){if(!b)return this.hasChanged()?$H.clone(this.changed):!1;var c,a=!1,d=this._changing?
this._previousAttributes:this.attributes,e;for(e in b)if(!$H.equals(d[e],c=b[e]))(a||(a={}))[e]=c;return a},previous:function(b){return null==b||!this._previousAttributes?null:this._previousAttributes[b]},fetch:function(b){var c=this;b=b?$H.clone(b):{};void 0===b.parse&&(b.parse=!0);var a=b.success;b.success=function(d){if(!c.set(c.parse(d,b),b))return!1;a&&a(c,d,b);c.trigger("sync",c,d,b)};c.sync("read",c,b)},save:function(b,c,a){var d=this,e,f=d.attributes;null==b||"object"===typeof b?(e=b,a=c):
(e={})[b]=c;a=$H.extend({validate:!0},a);if(e&&a.now){if(!d.set(e,a))return!1}else if(!d._validate(e,a))return!1;e&&!a.now&&(b=$H.extend({},f),d.attributes=$H.extend(b,e));void 0===a.parse&&(a.parse=!0);var k=a.success;a.success=function(b){d.attributes=f;var c=d.parse(b,a);a.now||(c=$H.extend(e||{},c));if($H.isObject(c)&&!d.set(c,a))return!1;k&&k(d,b,a);d.trigger("sync",d,b,a)};b=d.isNew()?"create":a.update?"update":"patch";"patch"===b&&(a.attrs=e);d.sync(b,d,a);e&&!a.now&&(d.attributes=f)},destroy:function(b){var c=
this;b=b?$H.clone(b):{};var a=b.success,d=function(){c.trigger("destroy",c,c.collection,b)};b.success=function(e){(!b.now||c.isNew())&&d();a&&a(c,e,b);c.isNew()||c.trigger("sync",c,e,b)};if(c.isNew())return b.success(),!1;c.sync("delete",c,b);b.now&&d()},getUrl:function(){var b=$H.result(this,"url")||$H.result(this.collection,"url");b||$D.error(Error("\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2aurl\u5c5e\u6027\u6216\u8005\u51fd\u6570"));return this.isNew()?b:b.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},
parse:function(b){return b.code&&b.data?b.data:b},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(b){return this._validate({},$H.extend(b||{},{validate:!0}))}})});
$Define("CM.Collection",["CM.AbstractDao","CM.AbstractEvents","CM.Model"],function(j,f,b){var c=f.derive({_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(a,d){if(a instanceof b)return a;d=d?$H.clone(d):{};d.collection=this;var c=new this.model(a,d);if(!c.validationError)return c;this.trigger("invalid",this,c.validationError,d);return!1},_addReference:function(a){this._byId[a.cid]=a;null!=a.id&&(this._byId[a.id]=a);a.collection||(a.collection=this);a.on("all",this._onModelEvent,
this)},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,f){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(b,f),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))},initialize:function(a,b){this.dao=this.dao||$H.getSingleton(j);b||(b={});b.model&&(this.model=b.model);void 0!==b.comparator&&(this.comparator=
b.comparator);this._reset();a&&this.reset(a,$H.extend({silent:!0},b))},toJSON:function(a){return $H.Collection.map(this.models,function(b){return b.toJSON(a)})},sync:function(a,b,c){return this.dao.sync(a,b,c)},add:function(a,b){b=$H.extend({add:!0,remove:!1,merge:!1},b);return this.set(a,b)},remove:function(a,b){var c=!$H.isArray(a);a=c?[a]:$H.clone(a);b||(b={});var f,k,j,h;f=0;for(k=a.length;f<k;f++)if(h=a[f]=this.get(a[f]))delete this._byId[h.id],delete this._byId[h.cid],j=this.indexOf(h),this.models.splice(j,
1),this.length--,b.silent||(b.index=j,h.trigger("remove",h,this,b)),this._removeReference(h,b);return c?a[0]:a},set:function(a,d){d=$H.extend({add:!0,remove:!0,merge:!0},d);d.parse&&(a=this.parse(a,d));var c=!$H.isArray(a),f=c?a?[a]:[]:$H.clone(a),k,j,h,g,l,s,m=d.at,y=this.model,u=this.comparator&&null==m&&!1!==d.sort,z="string"==typeof this.comparator?this.comparator:null,n=[],v=[],t={},x=d.add,A=d.merge,w=d.remove,p=!u&&x&&w?[]:!1;k=0;for(j=f.length;k<j;k++){l=f[k]||{};h=l instanceof b?g=l:l[y.prototype.idAttribute||
"id"];if(h=this.get(h))w&&(t[h.cid]=!0),A&&(l=l===g?g.attributes:l,d.parse&&(l=h.parse(l,d)),h.set(l,d),u&&(!s&&h.hasChanged(z))&&(s=!0)),f[k]=h;else if(x){g=f[k]=this._prepareModel(l,d);if(!g)continue;n.push(g);this._addReference(g,d)}g=h||g;p&&(g.isNew()||!t[g.id])&&p.push(g);t[g.id]=!0}if(w){k=0;for(j=this.length;k<j;++k)t[(g=this.models[k]).cid]||v.push(g);v.length&&this.remove(v,d)}if(n.length||p&&p.length)if(u&&(s=!0),this.length+=n.length,null!=m){k=0;for(j=n.length;k<j;k++)this.models.splice(m+
k,0,n[k])}else{p&&(this.models.length=0);l=p||n;k=0;for(j=l.length;k<j;k++)this.models.push(l[k])}s&&this.sort({silent:!0});if(!d.silent){k=0;for(j=n.length;k<j;k++)(g=n[k]).trigger("add",g,this,d);(s||p&&p.length)&&this.trigger("sort",this,d)}return c?f[0]:f},reset:function(a,b){b||(b={});for(var c=0,f=this.models.length;c<f;c++)this._removeReference(this.models[c],b);b.previousModels=this.models;this._reset();a=this.add(a,$H.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return a},
push:function(a,b){return this.add(a,$H.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){return this.add(a,$H.extend({at:0},b))},shift:function(a){var b=this.at(0);this.remove(b,a);return b},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a]||this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},where:function(a,b){return $H.isEmpty(a)?
b?void 0:[]:this[b?"find":"filter"](function(b){for(var d in a)if(a[d]!==b.get(d))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){this.comparator||$D.error(Error("\u6ca1\u6709\u6bd4\u8f83\u5668"));a||(a={});"string"==typeof this.comparator||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort($H.Function.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return $H.Collection.invoke(this.models,
"get",a)},getUrl:function(){return this.url},fetch:function(a){var b=this;a=a?$H.clone(a):{};void 0===a.parse&&(a.parse=!0);var c=a.success;a.success=function(f){b[a.reset?"reset":"set"](f,a);c&&c(b,f,a);b.trigger("sync",b,f,a)};return b.sync("read",b,a)},create:function(a,b){var c=this;b=b?$H.clone(b):{};if(!(a=c._prepareModel(a,b)))return!1;b.now&&c.add(a,b);var f=b.success;b.success=function(a,j){b.now||c.add(a,b);f&&f(a,j,b)};a.save(null,b);return a},parse:function(a){return a.data},clone:function(){return new this.constructor(this.models)}});
$H.each("some every find filter invoke indexOf".split(" "),function(a,b){c.prototype[b]=function(){var a=Array.prototype.slice.call(arguments),c=$H.Array;a.unshift(this.models);return c[b].apply(c,a)}});return c});
