/* Handy v1.0.0-dev | 2014-03-19 | zhengyinhui100@gmail.com */
$Define("CM.AbstractManager",function(){var k=$H.createClass();$HO.extend(k.prototype,{_types:{},_all:{},type:"manager",registerType:function(d,a){this._types[d]=a;a.prototype.xtype=d},getClass:function(d){return this._types[d]},register:function(d){this._all[d.getId()]=d},unregister:function(d){var a=this._all,b=d.getId();a[b]==d&&delete a[b]},eachInEl:function(d,a){var b=this;d.find(".js-"+b.type).each(function(c,l){l=$(l);var g=l.attr("id");(g=b.get(g))&&a(g)})},generateId:function(d,a){var b=
$H.expando+"_"+this.type+"_"+(d||$H.Util.getUuid());if(!0!=a&&this._all[b])$D.error("id\u91cd\u590d:"+b);else return b},get:function(d){var a=this._all;return a[d]||a[this.generateId(d,!0)]}});return k});
$Define("CM.ViewManager","CM.AbstractManager",function(k){var d=$H.createClass();$H.inherit(d,k,{type:"view",initialize:function(){var a=this;$H.on("afterRender",function(b){a.afterRender(b)});$H.on("removeEl",function(b){a.destroy(b)})},afterRender:function(a){this.eachInEl(a,function(a){a.afterRender()})},destroy:function(a){this.eachInEl(a,function(a){a.destroy(!0)})}});$V=$HO.getSingleton(d);return d});
$Define("CM.AbstractView","CM.ViewManager",function(k){var d=$H.createClass(),a=/^(<[a-zA-Z]+)/,b=/^[^>]+class=/,c=/(class=")/;$HO.extend(d,{extend:function(a){var b=this.prototype;$HO.extend(b,a,{notCover:function(e){if($HO.contains(["_customEvents","listeners"],e))return b[e]=(a[e]||[]).concat(b[e]||[]),!0;if("xtype"==e||"constructor"==e)return!0}})},html:function(a){return(new this($HO.extend({autoRender:!1},a))).getHtml()}});$HO.extend(d.prototype,$H.Events);$HO.extend(d.prototype,{xtype:"AbstractView",
autoRender:!0,renderBy:"append",children:[],_customEvents:"beforeRender render afterRender beforeShow show afterShow beforeHide hide afterHide beforeUpdate update afterUpdate beforeDestroy destroy afterDestroy".split(" "),_defaultEvents:"mousedown mouseup mouseover mousemove mouseenter mouseleave dragstart drag dragenter dragleave dragover drop dragend touchstart touchmove touchend touchcancel keydown keyup keypress click dblclick focus focusin focusout contextmenu change submit".split(" "),initialize:function(a){this.manager=
this.constructor.manager||$HO.getSingleton(k);this.doConfig(a);this.parseItems();!1!=this.autoRender&&this.render();this.manager.register(this)},doConfig:function(a){var b=this;b.params=a;b.settings=$HO.clone(a);b.renderTo=a.renderTo?$(a.renderTo):$(document.body);var e=b.listeners||[];a.listeners&&(e=e.concat(a.listeners));b._listeners=e;$HO.extend(b,a,{notCover:function(e){var c=b[e],m=$HO.contains(b._customEvents,e);if($HO.contains(b._defaultEvents,e))b._listeners.push({name:e,handler:a[e]});else if(m)b.on(e,
a[e]);if(null!=c&&"object"==typeof c||$HO.isFunction(c))return!0}});a.defItem&&$HO.extend(b.defItem,a.defItem)},getEl:function(){return this._container},getId:function(){return this._id||(this._id=this.manager.generateId(this.cid))},initHtml:function(){"string"!=typeof this.tmpl&&(this.tmpl=this.constructor.prototype.tmpl=this.tmpl.join(""));return $H.Template.tmpl({id:this.xtype,tmpl:this.tmpl},this)},getHtml:function(){var l=this.getId(),g;g="visibility"==this.displayMode?"visibility:hidden;":"display:none;";
var e=this.initHtml(),h=b.test(e),f="js-"+this.manager.type+" "+this.extCls+" ";h&&(e=e.replace(c,"$1"+f));return e=e.replace(a,'$1 id="'+l+'" style="'+g+'"'+(h?"":' class="'+f+'"'))},findHtml:function(a){a=">*"==a?this.children:this.find(a);for(var b=[],e=0;e<a.length;e++)b.push(a[e].getHtml());return b.join("")},initStyle:function(){var a=this.getEl(),b=this.style||{};void 0!=this.width&&(b.width=this.width);void 0!=this.height&&(b.height=this.height);a.css(b)},beforeRender:function(){return this.trigger("beforeRender")},
render:function(){if(!1==this.beforeRender())return!1;this.trigger("render");var a=this.getHtml();this.renderTo[this.renderBy](a);this.afterRender()},afterRender:function(){if(this.rendered)return!1;this.callChild();this._container=$("#"+this.getId());this.rendered=!0;this.initStyle();!0!=this.notListen&&this.initListeners();this.disabled&&this.disable();this.trigger("afterRender");this.hidden||this.show()},beforeShow:function(){return this.trigger("beforeShow")},show:function(a,b){var e=this;if(!1==
e.beforeShow()||e.showed||b&&e.hidden)return!1;if(!a&&e.delayShow)setTimeout(function(){d.prototype.show.call(e,!0)},0);else{e.trigger("show");e.showed=!0;var c=e.getEl();"visibility"==e.displayMode?c.css({visibility:"visible"}):c.show();e.callChild([null,!0]);e.afterShow()}},afterShow:function(){this.trigger("afterShow")},beforeHide:function(){return this.trigger("beforeHide")},hide:function(){if(!1==this.beforeHide()||!this.showed)return!1;this.showed=!1;var a=this.getEl();"visibility"==this.displayMode?
a.css({visibility:"hidden"}):a.hide();this.trigger("hide");this.afterHide()},afterHide:function(){this.trigger("afterHide")},enable:function(){this.resume();this.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")},disable:function(){this.suspend();this.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled","disabled")},listen:function(a){var b=this,e=a.name,c=a.context,f=a.handler;if(a.custom)b.on(e,f,c);else{var m=b._listeners,d=a.el,k=
a.method||"bind",s=a.selector,n=a.data,r=a.delegation=function(){if(!0!=b.isSuspend)return f.apply(c||b,arguments)};$H.Browser.mobile()&&"click"==e&&(e="touchend");d=d?"string"==typeof d?b.find(d):d:b.getEl();if(s)if(n)d[k](s,e,n,r);else d[k](s,e,r);else if(n)d[k](e,n,r);else d[k](e,r);m.push(a)}},unlisten:function(a){var b=a.name,e=a.handler;if(a.custom)this.off(b,e);else{var c=a.el,f="delegate"==a.method?"undelegate":"unbind";a=a.selector;var d;$H.Browser.mobile()&&"click"==b&&(b="touchend");for(var c=
c?"string"==typeof c?this.find(c):c:this.getEl(),j=this._listeners.length-1;0<=j;j--){var k=this._listeners[j];if(k.handler==e){d=k.delegation;this._listeners.splice(j,1);break}}if(a)c[f](a,b,d);else c[f](b,d)}},initListeners:function(){if(this.listened)return!1;this.listened=!0;var a=this._listeners;this._listeners=[];for(var b=a.length-1;0<=b;b--)this.listen(a[b]);this.callChild()},clearListeners:function(){for(var a=this._listeners,b=a.length-1;0<=b;b--)this.unlisten(a[b]);this.off("all");this.callChild()},
suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0;this.callChild()},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1;this.callChild()},each:function(a,b){for(var e=this.children,c=e.length,f,d=0;d<c;){f=e[d];f=b?a.apply(f,b):a(d,f);if(!1===f)break;c==e.length?d++:c=e.length}},match:function(a,b){if("*"==a)return!0;var e=b||this,c,f,d;a=a.replace(/^([^\[]+)/,'[xtype="$1"]');for(var j=/\[([^=|\!]+)(=|\!=)([^=]+)\]/g;c=j.exec(a);)if(f=c[1],d=c[2],c=eval(c[3]),"="===d?e[f]!=
c:e[f]==c)return!1;return!0},find:function(a,b){var e=this;if(0!=a.indexOf("$"))return e.getEl().find(a);b=b||[];if(0<a.indexOf(","))return $HO.each(a.split(","),function(a,c){b=b.concat(e.find(c))}),b;var c=1==a.indexOf(">"),f=a.replace(/^\$>?\s?/,""),d=f.search(/\s|>/),j;0<d&&(j=f.substring(d),f=f.substring(0,d));e.each(function(e,d){d.match(f)&&(j?d.find("$"+j,b):b.push(d));c||d.find(a,b)});return b},parents:function(a){if(a&&0!=a.indexOf("$"))return this.getEl().parents(a);for(var b=this;b.parent;)if(b=
b.parent,a&&this.match(a,b))return b;return a||b===this?null:b},index:function(){var a=this,b=a.parent;if(b){var e;b.each(function(b,c){if(c==a)return e=b,!1});return e}return null},callChild:function(a,b){0!=this.children.length&&(a&&"string"!=typeof a&&(b=a,a=null),a=a||arguments.callee.caller.$name,this.each(function(e,c){b?c[a].apply(c,b):c[a].call(c)}))},add:function(a){this.children.push(a);a.parent=this},remove:function(a){for(var b=this.children,c=!1,d=0,f=b.length;d<f;d++)b[d]==a&&(b.splice(d,
1),a.destroy(),c=!0);return c},addItem:function(a){var b=this.settings,c=b.items;c?$HO.isArray(c)||(b.items=[c]):b.items=[];b.items.push(a)},parseItem:function(){},parseItems:function(){var a=this.settings.items;if(a)for(var a=a.length?a:[a],b=0,c=a.length;b<c;b++){var d=a[b];this.defItem&&$HO.extend(d,this.defItem,{notCover:!0});this.parseItem(d);var f=this.manager.getClass(d.xtype);f?(d.renderTo||(d.autoRender=!1),d=new f(d),this.add(d)):$D.error("xtype:"+d.xtype+"\u672a\u627e\u5230")}},beforeUpdate:function(){return this.trigger("beforeUpdate")},
update:function(a){var b=this;if(!1==b.beforeUpdate())return!1;var c=b.parent;a=$HO.extend({renderBy:"before",renderTo:b.getEl()},a);c&&(a=$HO.extend(c.defItem,a),c.parseItem(a));if(!a.cid||a.cid==b.cid)a._id=b._id;var d=new b.constructor(a);c&&(d.parent=c,c.each(function(a,l){if(l==b)return c.children.splice(a,1,d),!1}));b.destroy();b.trigger("update");b.afterUpdate(d);return d},afterUpdate:function(a){this.trigger("afterUpdate",a)},beforeDestroy:function(){return this.trigger("beforeDestroy")},
destroy:function(){if(!1==this.beforeDestroy()||this.destroyed)return!1;this.callChild();this.trigger("destroy");this.clearListeners();this.getEl().remove();this.destroyed=!0;this.parent&&this.parent.remove(this);this.manager.unregister(this);delete this.params;delete this.settings;delete this._container;delete this.renderTo;delete this._listeners;delete this.children;this.afterDestroy()},afterDestroy:function(){this.trigger("afterDestroy")}});return d});
$Define("C.Model",function(){var k=$H.createClass();$HO.extend(k.prototype,$H.Events);$HO.extend(k.prototype,{_pending:!1,idAttribute:"id",_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=$HO.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;if(!c)return!0;this.trigger("invalid",this,c,$HO.extend(b,{validationError:c}));return!1},initialize:function(a,b){var c=a||{};b||(b={});this.cid=$H.Util.getUuid();this.attributes={};b.collection&&(this.collection=
b.collection);b.parse&&(c=this.parse(c,b)||{});c=$HO.extend(c,$H.Util.result(this,"defaults"),{notCover:!0});this.set(c,b);this.changed={}},toJson:function(){return $HO.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){return $H.String.escapeHTML(this.get(a))},has:function(a){a=this.get(a);return null!=a&&void 0!=a},set:function(a,b,c){var d;"object"===typeof a?(d=a,c=b):(d={})[a]=b;c||(c={});if(!this._validate(d,c))return!1;var g=c.unset;a=c.silent;var e=[],h=
this._changing;this._changing=!0;h||(this._previousAttributes=$H.Object.clone(this.attributes),this.changed={});var f=this.attributes,m=this._previousAttributes;this.idAttribute in d&&(this.id=d[this.idAttribute]);for(var j in d)b=d[j],$HO.equals(f[j],b)||e.push(j),$HO.equals(m[j],b)?delete this.changed[j]:this.changed[j]=b,g?delete f[j]:f[j]=b;if(!a){e.length&&(this._pending=c);b=0;for(d=e.length;b<d;b++)this.trigger("change:"+e[b],this,f[e[b]],c)}if(h)return this;if(!a)for(;this._pending;)c=this._pending,
this._pending=!1,this.trigger("change",this,c);this._changing=this._pending=!1;return this},unset:function(a,b){b=b||{};b.unset=!0;return this.set(a,void 0,b)},clear:function(a){var b={},c;for(c in this.attributes)b[c]=void 0;a=a||{};a.unset=!0;return this.set(b,a)},hasChanged:function(a){var b=this.changed;return null==a?!$HO.isEmpty(b):$HO.contains(b,a)},changedAttrbutes:function(a){if(!a)return this.hasChanged()?$HO.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes,
g;for(g in a)if(!$HO.equals(d[g],b=a[g]))(c||(c={}))[g]=b;return c},previous:function(a){return null==a||!this._previousAttributes?null:this._previousAttributes[a]},fetch:function(a){var b=this;a=a?$HO.clone(a):{};void 0===a.parse&&(a.parse=!0);var c=a.success;a.success=function(d){if(!b.set(b.parse(d,a),a))return!1;c&&c(b,d,a);b.trigger("sync",b,d,a)};d(b,a);return b.sync("read",b,a)},save:function(a,b,c){var l,g=this.attributes;null==a||"object"===typeof a?(l=a,c=b):(l={})[a]=b;c=$HO.extend({validate:!0},
c);if(l&&!c.wait){if(!this.set(l,c))return!1}else if(!this._validate(l,c))return!1;l&&c.wait&&(this.attributes=$HO.extend({},g,l));void 0===c.parse&&(c.parse=!0);var e=this,h=c.success;c.success=function(a){e.attributes=g;var b=e.parse(a,c);c.wait&&(b=$HO.extend(l||{},b));if($HO.isObject(b)&&!e.set(b,c))return!1;h&&h(e,a,c);e.trigger("sync",e,a,c)};d(this,c);a=this.isNew()?"create":c.patch?"patch":"update";"patch"===a&&(c.oAttrs=l);a=this.sync(a,this,c);l&&c.wait&&(this.attributes=g);return a},destroy:function(a){a=
a?$HO.clone(a):{};var b=this,c=a.success,l=function(){b.trigger("destroy",b,b.collection,a)};a.success=function(d){(a.wait||b.isNew())&&l();c&&c(b,d,a);b.isNew()||b.trigger("sync",b,d,a)};if(this.isNew())return a.success(),!1;d(this,a);var g=this.sync("delete",this,a);a.wait||l();return g},url:function(){var a=$H.Util.result(this,"urlRoot")||$H.Util.result(this.collection,"url");a||$D.error(Error("\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2aurl\u5c5e\u6027\u6216\u8005\u51fd\u6570"));return this.isNew()?a:
a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},$HO.extend(a||{},{validate:!0}))}});var d;return k});
$Define("C.Collection","C.Model",function(k){var d=$H.createClass();$HO.extend(d.prototype,$H.Events);$HO.extend(d.prototype,{_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(a,b){if(a instanceof k)return a;b=b?$HO.clone(b):{};b.collection=this;var c=new this.model(a,b);if(!c.validationError)return c;this.trigger("invalid",this,c.validationError,b);return!1},_addReference:function(a){this._byId[a.cid]=a;null!=a.id&&(this._byId[a.id]=a);a.collection||(a.collection=
this);a.on("all",this._onModelEvent,this)},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))},initialize:function(a,b){b||(b={});b.model&&(this.model=b.model);void 0!==b.comparator&&(this.comparator=
b.comparator);this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,$HO.extend({silent:!0},b))},toJSON:function(a){return $H.Collection.map(this,function(b){return b.toJSON(a)})},add:function(a,b){$HO.extend(b,{add:!0,remove:!1,merge:!1});return this.set(a,b)},remove:function(a,b){var c=!$HO.isArray(a);a=c?[a]:$HO.clone(a);b||(b={});var d,g,e,h;d=0;for(g=a.length;d<g;d++)if(h=a[d]=this.get(a[d]))delete this._byId[h.id],delete this._byId[h.cid],e=this.indexOf(h),this.models.splice(e,
1),this.length--,b.silent||(b.index=e,h.trigger("remove",h,this,b)),this._removeReference(h,b);return c?a[0]:a},set:function(a,b){b=$H.Util.extend(b,{add:!0,remove:!0,merge:!0});b.parse&&(a=this.parse(a,b));var c=!$HO.isArray(a),d=c?a?[a]:[]:$HO.clone(a),g,e,h,f,m,j,u=b.at,s=this.model,n=this.comparator&&null==u&&!1!==b.sort,r="string"==typeof this.comparator?this.comparator:null,p=[],v=[],t={},x=b.add,y=b.merge,w=b.remove,q=!n&&x&&w?[]:!1;g=0;for(e=d.length;g<e;g++){m=d[g]||{};h=m instanceof k?f=
m:m[s.prototype.idAttribute||"id"];if(h=this.get(h))w&&(t[h.cid]=!0),y&&(m=m===f?f.attributes:m,b.parse&&(m=h.parse(m,b)),h.set(m,b),n&&(!j&&h.hasChanged(r))&&(j=!0)),d[g]=h;else if(x){f=d[g]=this._prepareModel(m,b);if(!f)continue;p.push(f);this._addReference(f,b)}f=h||f;q&&(f.isNew()||!t[f.id])&&q.push(f);t[f.id]=!0}if(w){g=0;for(e=this.length;g<e;++g)t[(f=this.models[g]).cid]||v.push(f);v.length&&this.remove(v,b)}if(p.length||q&&q.length)if(n&&(j=!0),this.length+=p.length,null!=u){g=0;for(e=p.length;g<
e;g++)this.models.splice(u+g,0,p[g])}else{q&&(this.models.length=0);m=q||p;g=0;for(e=m.length;g<e;g++)this.models.push(m[g])}j&&this.sort({silent:!0});if(!b.silent){g=0;for(e=p.length;g<e;g++)(f=p[g]).trigger("add",f,this,b);(j||q&&q.length)&&this.trigger("sort",this,b)}return c?d[0]:d},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c],b);b.previousModels=this.models;this._reset();a=this.add(a,$HO.extend({silent:!0},b));b.silent||this.trigger("reset",
this,b);return a},push:function(a,b){return this.add(a,$HO.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){return this.add(a,$HO.extend({at:0},b))},shift:function(a){var b=this.at(0);this.remove(b,a);return b},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a]||this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},where:function(a,
b){return $HO.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var d in a)if(a[d]!==b.get(d))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){this.comparator||$D.error(Error("\u6ca1\u6709\u6bd4\u8f83\u5668"));a||(a={});"string"==typeof this.comparator||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort($H.Function.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return $H.Collection.invoke(this.models,
"get",a)},parse:function(a){return a},clone:function(){return new this.constructor(this.models)}});$HO.each(["some","every","find","filter","invoke"],function(a){d.prototype[a]=function(){var b=Array.prototype.slice.call(arguments),c=$H.Collection;b.unshift(this.models);return c[a].apply(c,b)}});return d});
