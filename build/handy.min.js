/* Handy v1.0.0-dev | 2014-03-30 | zhengyinhui100@gmail.com */
(function(){var e=window.handy,d=window.$,c=window.handy=window.$=function(){};c.version="1.0.0";c.isDebug="undefined"==typeof gEnv?!1:"dev"==gEnv;c.expando="handy"+(c.version+Math.random()).replace(/\D/g,"");c.add=function(b,a,f){f||(f=a,a=null);c.base||(c.base={});var g=[];if(a)if("string"==typeof a)g.push(c.base.Object.namespace(a));else for(var d=0;d<a.length;d++)g.push(c.base.Object.namespace(a[d]));g.push(c);a=f.apply(window,g);c.base[b]=c[b]=a;if(0<="Browser,Class,Array,Cookie,Events,Function,Json,Object,String,Template,Util".indexOf(b))for(var h in a)c.isDebug&&
("undefined"!=typeof c[h]&&"console"in window&&!Function[h])&&(console.log(c[h]),console.log(b+"\u547d\u540d\u51b2\u7a81:"+h)),c[h]=a[h]};c.noConflict=function(b){window.$===c&&(window.$=d);b&&window.handy===c&&(window.handy=e);return c};c.noop=function(){}})();
handy.add("Json",function(){function e(a){g.lastIndex=0;g.test(a)&&(a=a.replace(g,function(a){var b=j[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));return'"'+a+'"'}function d(c,g){var j,h,k,m,n=a,l,s=g[c];s&&("object"===typeof s&&"function"===typeof s.toJSON)&&(s=s.toJSON(c));"function"===typeof b&&(s=b.call(g,c,s));switch(typeof s){case "string":return e(s);case "number":return isFinite(s)?String(s):"null";case "boolean":case "null":return String(s);case "object":if(!s)return"null";
a+=f;l=[];if("[object Array]"===Object.prototype.toString.apply(s)){m=s.length;for(j=0;j<m;j+=1)l[j]=d(j,s)||"null";k=0===l.length?"[]":a?"[\n"+a+l.join(",\n"+a)+"\n"+n+"]":"["+l.join(",")+"]";a=n;return k}if(b&&"object"===typeof b){m=b.length;for(j=0;j<m;j+=1)"string"===typeof b[j]&&(h=b[j],(k=d(h,s))&&l.push(e(h)+(a?": ":":")+k))}else for(h in s)Object.prototype.hasOwnProperty.call(s,h)&&(k=d(h,s))&&l.push(e(h)+(a?": ":":")+k);k=0===l.length?"{}":a?"{\n"+a+l.join(",\n"+a)+"\n"+n+"}":"{"+l.join(",")+
"}";a=n;return k}}var c="JSON"in window,b,a,f,g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k=/^[\],:{}\s]*$/,m=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,n=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,l=/(?:^|:|,)(?:\s*\[)+/g;
return{stringify:function(g,j,h,e){if(c&&!e)return JSON.stringify.apply(null,arguments);var k;f=a="";if("number"===typeof h)for(k=0;k<h;k+=1)f+=" ";else"string"===typeof h&&(f=h);if((b=j)&&"function"!==typeof j&&("object"!==typeof j||"number"!==typeof j.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return d("",{"":g})},parseJson:function(a,b,g){function f(a,c){var g,d,j=a[c];if(j&&"object"===typeof j)for(g in j)Object.prototype.hasOwnProperty.call(j,
g)&&(d=f(j,g),void 0!==d?j[g]=d:delete j[g]);return b.call(a,c,j)}if(c&&!g)return JSON.parse.apply(null,arguments);var d;a=String(a);h.lastIndex=0;h.test(a)&&(a=a.replace(h,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(k.test(a.replace(m,"@").replace(n,"]").replace(l,"")))return d=eval("("+a+")"),"function"===typeof b?f({"":d},""):d;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var e;e=(e=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(e[0])?function(c,b,a){var f=[];if(c.length){b=b||0;for(a=a||c.length;b<a;b++)f.push(c[b])}return f}:function(c,b,a){return Array.prototype.slice.call(c,b||0,a||c.length)};var d={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},namespace:function(c,b){var a=null,f,g,j,h;c=d.alias(c);g=c.split(".");a=g[0];a=(j=2==arguments.length)?eval("(function(){if (typeof "+a+' == "undefined"){'+
a+" = {};}return "+a+";})()"):eval("(function(){if (typeof "+a+' != "undefined")return '+a+";})()");f=1;for(h=g.length;f<h;++f){if(f==h-1&&j)a[g[f]]=b;else if(j||a&&a[g[f]])a[g[f]]=a[g[f]]||{};else return;a=a[g[f]]}return a},alias:function(c,b){var a=d._alias;if(b)a[c]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+c+":"+a[c]):a[c]=b;else{if(c){var f=c,g=c.length-1;do{if(a[f])return a[f]+c.substring(g);g=f.lastIndexOf(".")}while(0<g&&(f=f.substring(0,g)));return c}return a}},extend:function(c,b,
a){if(!b||d.isString(b)||d.isNumber(b))return c;var f=a?a.notCover:!1,g=a?a.cover:null;a=a?a.IsClone:!1;c=c||{};var j=c.constructor,h=j.$isClass,e,m;for(m in b)if(e=b[m],(!g||d.contains(g,m))&&b.hasOwnProperty(m)){var n=c.hasOwnProperty(m),l=!0===f?n:!1;d.isArray(f)?l=d.contains(f,m)&&n:d.isFunction(f)&&(l=f(m,e));l||(e=a?d.clone(e):e,h&&d.isFunction(e)&&(e.$name=m,e.$owner=j),c[m]=e)}return c},mix:function(c,b,a){c.superProto||(c.superProto={});for(var f in b)c.superProto[f]=d.isFunction(b[f])?c.superProto[f]?
function(a,c){return function(){c.apply(this,arguments);b[a].apply(this,arguments)}}(f,c.superProto[f]):b[f]:b[f],c[f]||(c[f]=b[f]);a&&d.extend(c,a);b.toString!=b.constructor.prototype.toString&&(c.superProto.toString=function(){b.toString.apply(c,arguments)});return c},isFunction:function(c){return"[object Function]"===window.Object.prototype.toString.call(c)},isArray:function(c){return"[object Array]"===window.Object.prototype.toString.call(c)},isObject:function(c){return"object"==typeof c&&!d.isArray(c)},
isNumber:function(c){return"number"==typeof c},isString:function(c){return"string"==typeof c},isUndefined:function(c){return"undefined"==typeof c},isClass:function(c){return d.isFunction(c)&&!0===c.$isClass},equals:function(c,b){if(typeof c==typeof b){if("object"!=typeof c)return c===b;if(c===b)return!0;if(d.isArray(c)&&d.isArray(b)){if(c.length!=b.length)return!1;for(var a=0,f=c.length;a<f;a++)if(!d.equals(c[a],b[a]))return!1;return!0}if(!d.isArray(c)&&!d.isArray(b)){if(d.count(c)!=d.count(b))return!1;
for(a in c)if(void 0==b[a]||!d.equals(c[a],b[a]))return!1;return!0}}return!1},clone:function(c){if(null==c||"object"!=typeof c)return c;var b=c.constructor;if(b!=window.Object&&b!=window.Array)return c;if(b==window.Date||b==window.RegExp||b==window.Function||b==window.String||b==window.Number||b==window.Boolean)return new b(c);try{var a=new b,f;for(f in c)a[f]=d.clone(c[f]);return a}catch(g){return c}},isEmpty:function(c){if(d.isArray(c))return 0==c.length;for(var b in c)return!1;return!0},each:function(c,
b,a){var f,g=0,j=c.length,h=void 0===j||d.isFunction(c);if(a)if(h)for(f in c){if(!1===b.apply(c[f],a))break}else for(;g<j&&!1!==b.apply(c[g],a);)f=c.length,j==f?g++:j=f;else if(h)for(f in c){if(!1===b.call(c[f],f,c[f]))break}else for(;g<j&&!1!==b.call(c[g],g,c[g]);)f=c.length,j==f?g++:j=f;return c},contains:function(c,b){var a=!1;d.each(c,function(c,g){if(d.equals(g,b))return a=!0,!1});return a},largeThan:function(c,b){if("object"==typeof c&&"object"==typeof b){var a=!0;d.each(b,function(f){if(!d.equals(b[f],
c[f]))return a=!1});return a}},count:function(c){if(d.isArray(c))return c.length;var b=0,a;for(a in c)b++;return b},removeUndefined:function(c,b){var a=d.isArray(c);if(b){if(a){var f=[];d.each(c,function(a,b){void 0!==b&&f.push(b)});return f}return d.extend({},c,{isClone:!0,notCover:function(a,b){return void 0===b}})}d.each(c,function(b,f){void 0===f&&(a?c.splice(b,1):delete c[b])});return c},toArray:e,fromArray:function(c){for(var b={},a=0,f=c.length;a<f;a++){var g=c[a];b[g.name]=g.value}return b},
generateMethod:function(c,b,a){b=d.isArray(b)?b:b.split(",");for(var f=0;f<b.length;f++){var g=b[f];c[g]=a(g)}}};return d});
handy.add("Browser","handy.base.Object",function(e){var d={},c={};e.generateMethod(c,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(a){return function(b){var c=d[a];return!b&&"string"===typeof c&&/^[\d\.]+$/.test(c)?parseInt(c):c}});e=window.navigator.userAgent;var b;(b=e.match(/MSIE ([\d.]+)/))?d.ie=b[1]:(b=e.match(/Firefox\/([\d.]+)/))?d.firefox=b[1]:(b=e.match(/Chrome\/([\d.]+)/))?
d.chrome=b[1]:(b=e.match(/Opera.([\d.]+)/))?d.opera=b[1]:(b=e.match(/Version\/([\d.]+).*Safari/))?d.safari=b[1]:0;/windows|win32/i.test(e)?d.windows=!0:/linux/i.test(e)?d.linux=!0:/macintosh/i.test(e)?d.mac=!0:0;/trident/i.test(e)?d.trident=!0:/webkit/i.test(e)?d.webkit=!0:/gecko/i.test(e)?d.gecko=!0:/presto/i.test(e)?d.presto=!0:0;/MetaSr/i.test(e)?d.sogou=!0:/Maxthon/i.test(e)?d.maxthon=!0:/TencentTraveler/i.test(e)?d.tt=!0:/TheWorld/i.test(e)?d.theWorld=!0:/360[S|E]E/i.test(e)?d.is360=!0:0;var a;
if((a=e.match(/AppleWebKit\/([\d.]*)/))&&a[1])if(/ Mobile\//.test(e)&&e.match(/iPad|iPod|iPhone/)){d.mobile="ios";if((a=e.match(/OS ([^\s]*)/))&&a[1])d.ios=a[1].replace("_",".");if((a=e.match(/iPad|iPod|iPhone/))&&a[0])d[a[0].toLowerCase()]=d.ios}else if(/ Android/i.test(e)){if(/Mobile/.test(e)&&(d.mobile="android"),(a=e.match(/Android ([^\s]*);/))&&a[1])d.android=a[1]}else if(a=e.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))d.mobile=a[0].toLowerCase();var f;try{if(d.ie){var g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
g&&(f=g.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(g=navigator.plugins["Shockwave Flash"])){var j=g.description.split(" ");b=0;for(var h=j.length;b<h;b++)if(0<parseInt(j[b])){f=j[b];break}}}catch(k){}d.flash=f?f:null;return c});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(e,d,c){var b={level:c.isDebug?0:5,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!d.mobile(),out:function(a,f,g){g=g||"log";if(f||b.showInPage){f=c.expando+"debugDiv";var d=top.document,h=d.getElementById(f);h?h.style.display="block":(h=d.createElement("DIV"),h.id=f,h.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+d.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u5168\u5c4f</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',h.style.position="fixed",h.style.width=d.body.offsetWidth-20+"px",h.style.left=0,h.style.top=0,h.style.right=0,h.style.height="150px",h.style.backgroundColor="#aaa",h.style.fontSize="12px",h.style.padding="10px",h.style.zIndex=9999999999,h.style.opacity=0.8,h.style.filter="alpha(opacity=80)",d.body.appendChild(h));f=h.getElementsByTagName("DIV")[0];d=c.Json.stringify(a,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0).replace(/\n/g,"<br/>");f.innerHTML+=
g+" : "+d+"<br/>";f.scrollTop=f.scrollHeight}try{console[g](a)}catch(e){}},log:function(a,c){b.level>b.LOG_LEVEL||b.out(a,!!c,"log")},info:function(a,c){this.level>b.INFO_LEVEL||b.out(a,!!c,"info")},warn:function(a,c){b.level>b.WARN_LEVEL||b.out(a,!!c,"warn")},error:function(a,c){if(!(b.level>b.ERROR_LEVEL)&&(b.out(a,!!c,"error"),a instanceof Error))throw a;},time:function(a,c,g){b.level>b.INFO_LEVEL||(a?("boolean"==typeof c&&(g=c,c=""),b.out((c||"")+((new Date).getTime()-(b.lastTime||0)),!!g)):b.lastTime=
(new Date).getTime())},debug:function(a){if(!(b.level>b.DEBUG_LEVEL)&&!1!==a)debugger}};return b});handy.add("Function",function(e){return{bind:function(d,c,b){var a=Array.prototype.slice.call(arguments,2);return function(){Array.prototype.push.apply(a,arguments);return d.apply(c,a)}},intercept:function(d,c,b,a){return e.Object.isFunction(d)&&e.Object.isFunction(c)?function(){var f=b||this,g={},j=arguments;g.scope=a;g.target=f;g.method=d;return!1!=c.apply(g,j)?d.apply(f,j):!1}:d}}});
handy.add("Class",["B.Object","B.Debug"],function(e,d){var c={createClass:function(b){var a=function(){var b,c;b=this.constructor==a?this:arguments.callee;if(c=b.initialize){for(var d in b)"object"==typeof b[d]&&(b[d]=e.clone(b[d]));return c.apply(b,arguments)}};a.$isClass=!0;a.derive=function(a,b,d){var h=c.createClass();c.inherit(h,this,a,b,d);return h};a.prototype.callSuper=function(a,b){a&&(!a.$isClass&&void 0!=a.length)&&(b=a,a=null);var c=arguments.callee.caller,d=c.$owner.superProto;b=b||c.arguments;
a=a?a.prototype:d||this.constructor.superProto;c=c.$name;if(a&&(c=a[c],e.isFunction(c)))return c.apply(this,b)};b&&this.namespace(b,a);return a},inherit:function(b,a,c,g,j){var h=function(){};h.prototype=a.prototype;e.extend(b,a,j);b.prototype=new h;b.prototype.constructor=b;b.superClass=a;b.superProto=a.prototype;if(a._onInherit)try{a._onInherit(b)}catch(k){d.error(k)}g&&e.extend(b,g);c&&e.extend(b.prototype,c)},getSingleton:function(b){return(b="string"==typeof b?e.namespace(b):b)&&(b.$singleton||
(b.$singleton=new b))}};return c});
handy.add("Loader",["B.Debug","B.Object","B.Function"],function(e,d,c,b){function a(a){var b={},c=[];"string"==typeof a&&(a=[a]);for(var g=0,f=a.length;g<f;g++){var j;j=a[g];j=/\.(css|js)$/.test(j)?y[j]&&"loaded"==y[j].status:q.urlMap&&q.urlMap[j]?q.urlMap[j].chkExist():d.namespace(j);if(j)c.push(j);else return b.notExist=a[g],b}b.exist=c;return b}function f(a,b){function c(){c.isCalled||(c.isCalled=!0,clearTimeout(h),b())}if("SCRIPT"===a.nodeName){var d=a,f=c;d.onload=d.onerror=d.onreadystatechange=
function(){/loaded|complete|undefined/.test(d.readyState)&&(d.onload=d.onerror=d.onreadystatechange=null,n.removeChild(d),d=null,setTimeout(f,0))}}else{var j=c;window.hasOwnProperty("attachEvent")?a.attachEvent("onload",j):setTimeout(function(){g(a,j)},0)}var h=setTimeout(function(){e.error("Time is out:"+a.src);c()},q.timeout)}function g(a,b){if(!b.isCalled){var c;if(l)a.sheet&&(c=!0);else if(a.sheet)try{a.sheet.cssRules&&(c=!0)}catch(d){if("SecurityError"===d.name||"NS_ERROR_DOM_SECURITY_ERR"===
d.name)c=!0}setTimeout(function(){c?b():g(a,b)},1)}}function j(a){q.showLoading(!1);v--;y[a].status="loaded";q.traceLog&&e.info(k+"Response: "+a);h()}function h(){for(var b=r.length-1;0<=b;b--){var c=r[b],g=a(c.deps);if(g.notExist)0==b&&0==v&&$D.error(m+g.notExist);else{r.splice(b,1);c.callback.apply(null,g.exist);h();break}}}var k="Loader ",m=k+"not found: ",n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,l=navigator.userAgent.indexOf("AppleWebKit"),r=[],v=0,y=
{},q={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(a,c,g){a=b.Object.alias(a);2==arguments.length&&(g=c,c=[]);q.require(c,function(){var b;if("function"==typeof g)try{b=g.apply(null,arguments),q.traceLog&&e.info(k+"define: "+a)}catch(c){c.message=k+a+":factory define error:"+c.message;e.error(c);return}else b=g;if(b){d.namespace(a,b);var f=typeof b;if("object"==f||"function"==f)b.$ns=a}else $D.error(k+"factory no return: "+a)})},require:function(g,d){for(var h=
"string"==typeof g?[g]:g,l=[],s=[],u=!0,t=0,w=h.length;t<w;t++){var p=h[t],p=b.Object.alias(p),x=a(p);x.notExist?(l.push(p),u&&(u=!1,r.push({deps:h,callback:d})),q.traceLog&&e.info(m+p)):s.push(x.exist[0])}if(0==l.length)return d&&d.apply(null,s),0==s.length?s[0]:s;u=!1;h=0;for(s=l.length;h<s;h++)if(t=l[h],!y[t]){u=t;p=q.urlMap&&q.urlMap[u]&&q.urlMap[u].url;if(!p){w="";p=q.rootPath;if("string"==typeof p)w=p;else if("object"==typeof p)for(x in x=void 0,p)0==u.indexOf(x)&&(w=p[x],u=u.replace(x,""));
else w="";p=/.css$/.test(u)?0==u.indexOf("/")?u:"/css/"+u:/.js$/.test(u)?u:u.replace(/\./g,"/")+".js";0!=p.indexOf("/")&&(p="/"+p);p=w+p}u=!0;y[t]={id:t,status:"loading"};w=c.bind(j,null,t);if(/.css$/.test(p))a:{t=p;p=n.getElementsByTagName("link");for(x=0;x<p.length;x++){var C=p[x].href;!q.skinNode&&0<=C.indexOf(q.skinName)&&(q.skinNode=p[x]);if(0<=C.indexOf(t)||0<=t.indexOf(C))break a}p=document.createElement("link");p.rel="stylesheet";p.href=t;f(p,w);n.insertBefore(p,q.skinNode);q.traceLog&&e.info(k+
"request:"+t)}else t=p,p=document.createElement("script"),p.async="async",p.src=t,p.type="text/javascript",f(p,w),n.appendChild(p),q.traceLog&&e.info(k+"request:"+t);v++}u&&q.showLoading(!0)}};return q});
handy.add("Events",function(e){return{_eventCache:{},_execEvtCache:[],_parseEvents:function(d,c){var b=/\s+/;if("object"==typeof d){for(var a in d)c([a,d[a]]);return!0}if("string"==typeof d&&b.test(d)){b=d.split(b);a=0;for(var f=b.length;a<f;a++)c([b[a]]);return!0}return!1},_parseCustomEvents:function(d,c,b){var a=this,f=e.toArray(arguments,2);return a._parseEvents(c,function(b){a[d].apply(a,b.concat(f))})},_delegateHandler:function(d,c){var b=this;return function(){if(!0!=b.isSuspend)return d.apply(c||
b,arguments)}},_pushEvent:function(d){this._execEvtCache.push(d)},_execEvents:function(){var d=this,c;e.each(d._execEvtCache,function(b,a){var f=a.delegation;"number"==typeof a.times&&(1<a.times?a.times--:d.off(a.name,a.handler));c=f.apply(d,a.args)});d._execEvtCache=[];return c},on:function(d,c,b,a){if(!this._parseCustomEvents("on",d,c,b,a)){"number"==typeof b&&(a=b,b=null);var f=this._eventCache,g=f[d];g||(g=f[d]=[]);d=this._delegateHandler(c,b);g.push({times:a,handler:c,context:b,delegation:d})}},
once:function(d,c,b){var a=e.toArray(arguments);this.on.apply(this,a.push(1))},off:function(d,c){if("all"==d)return this._eventCache={},!0;if(!this._parseCustomEvents("off",d,c)){var b=this._eventCache,a=d.indexOf(".");if(!c&&0>=a){for(var f in b)(f.split(".")[0]==d||0==a&&0<=f.indexOf(d))&&delete b[f];return!0}a=b[d];if(!a)return!1;if(c){b=0;for(f=a.length;b<f;b++)if(a[b].handler==c)return a.splice(b,1),!0}else return delete b[d],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=
!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(d,c){function b(b){if(b)for(var c=0,f=b.length;c<f;c++){var j=b[c];j.args=g;j.name=d;a._pushEvent(j)}}var a=this,f=e.toArray(arguments);f.unshift("trigger");if(!a._parseCustomEvents.apply(a,f)){var f=a._eventCache,g=e.toArray(arguments),j;if(0<d.indexOf("."))j=f[d],b(j);else for(var h in f)if(j=d.indexOf("."),h.split(".")[0]==d||0==j&&0<=h.indexOf(d))j=f[h],b(j);b(f.all);return a._execEvents()}}}});
handy.add("Date",function(){var e=window.Date,d={getWeek:function(c,b){var a=c.getDay();b&&(a=(a+(b%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[a]},isWeeken:function(c){return 0==c.getDay()||6==c.getDay()},getDaysInMonth:function(c){c=new e(c.getFullYear(),c.getMonth()+1,0);return c.getDate()},getDaysInYear:function(c){var b=new e(c.getFullYear(),0,0);c=new e(c.getFullYear()+1,0,0);return Math.floor((c.getTime()-b.getTime())/864E5)},getDayIndexOfYear:function(c){var b=new e("1/1/"+
c.getFullYear());return Math.ceil((c.getTime()-b.getTime())/864E5)},format:function(c,b){b=b||"yyyy-MM-dd HH:mm:ss";c=c||new e;var a=c.getHours(),f=Math.floor((c.getMonth()+3)/3),a={"y+":c.getFullYear(),"M+":c.getMonth()+1,"d+":c.getDate(),"h+":0==a%12?12:a%12,"H+":a,"m+":c.getMinutes(),"s+":c.getSeconds(),"w+":d.getWeek(c),"q+":f,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][f-1],"S+":c.getMilliseconds()},g;for(g in a)RegExp("("+g+")").test(b)&&(f=RegExp.$1.length,b=b.replace(RegExp.$1,1==f?a[g]:("00"+
a[g]).slice(-f)));return b},parse:function(c,b){for(var a=(b||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),d=c.match(/\d+/g),g=new e,j=0;j<d.length;j++){var h=a[j],k=parseInt(d[j]);switch(h){case "yyyy":g.setFullYear(k);break;case "MM":g.setMonth(k-1);break;case "dd":g.setDate(k);break;case "HH":g.setHours(k);break;case "mm":g.setMinutes(k);break;case "ss":g.setSeconds(k);break;case "SS":g.setMilliseconds(k)}}return g},parseObject:function(c){return new e(c.year+1900,c.month,c.date,c.hours,c.minutes,
c.seconds)}};return d});
handy.add("String",function(){var e={stripTags:function(d){return d.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(d){var c=document.createElement("div");d=document.createTextNode(d);c.appendChild(d);return c.innerHTML},unescapeHTML:function(d){var c=document.createElement("div");c.innerHTML=e.stripTags(d);return c.childNodes[0].nodeValue},decodeHTML:function(d){d=d.replace(/&lt;/gi,"<");d=d.replace(/&gt;/gi,">");d=d.replace(/&quot;/gi,'"');d=d.replace(/&apos;/gi,"'");d=d.replace(/<\/?br>/gi,"\n");
d=d.replace(/&amp;/gi,"&");return d=d.replace(/&nbsp;/gi," ")},encodeHTML:function(d){d=d.replace(/&/gi,"&amp;");d=d.replace(/</gi,"&lt;");d=d.replace(/>/gi,"&gt;");d=d.replace(/\"/gi,"&quot;");d=d.replace(/\'/gi,"&apos;");d=d.replace(/\n/gi,"</br>");return d=d.replace(/ /gi,"&nbsp;")},trim:function(d){return d=d.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(d,c){c||(c=/[,%\'\"\/\\;|\<\>\^]/);return-1<d.search(c)},len:function(d){return d.replace(/[^\x00-\xff]/g,"**").length},left:function(d,
c,b){if(e.len(d)>c){!0===b?b=2:0<b||(b=0);var a=0,f=0;for(c-=b;f<c;)255<d.charCodeAt(a)?f+=2:f++,a++;d=d.substring(0,a);for(a=0;a<b;a++)d+="."}return d},isNumberStr:function(d){return 0==d.search(/^\d+$/g)},hasChn:function(d){return/[\u4E00-\u9FA5]+/.test(d)},isChn:function(d){return/^[\u4E00-\u9FA5]+$/.test(d)},addParam:function(d,c){c&&(d+=(-1<d.indexOf("?")?"&":"?")+c);return d}};return e});
handy.add("Cookie",function(){return{getCookie:function(e,d){var c=e+"=",b="",a=document.cookie;if(0<a.length){var f=a.indexOf(c);-1!=f&&(f+=c.length,c=a.indexOf(";",f),-1==c&&(c=a.length),b=a.substring(f,c),d||(b=unescape(b)))}return b},setCookie:function(e,d,c){var b=[];void 0!=e&&void 0!=d&&b.push(e+"="+escape(d));c&&(void 0!=c.path&&b.push("path="+c.path),void 0!=c.domain&&b.push("domain="+c.domain),void 0!=c.expires&&b.push("expires="+c.expires),c.secure&&b.push("secure"));document.cookie=b.join(";")},
delCookie:function(e){var d=new Date;d.setTime(d.getTime()-1);document.cookie=e+"=;expires="+d.toGMTString()}}});
handy.add("Util","B.Object",function(e){var d=0;return{isWindow:function(c){return null!=c&&c==c.window},getUuid:function(){return d++},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(c){var b=top.location.hash;0<=b.indexOf("#")&&(c=b.replace(/#[^\?]*/,c));top.location.hash=c},distance:function(c,b,a){var d,g;e.isArray(c)?(d=c[0],c=c[1]):(d=c.latitude,c=c.longitude);e.isArray(b)?(g=b[0],b=b[1]):(g=b.latitude,b=b.longitude);d=d*Math.PI/180;g=g*Math.PI/180;c=c*Math.PI/
180-b*Math.PI/180;c=2*Math.asin(Math.sqrt(Math.pow(Math.sin((d-g)/2),2)+Math.cos(d)*Math.cos(g)*Math.pow(Math.sin(c/2),2)));c=Math.round(63781370*c);if(a){if(isNaN(c))return"\u672a\u77e5";c=1E3<c?(c/1E3).toFixed(1)+"km":c+"m"}return c},result:function(c,b){var a=c[b];return e.isFunction(a)?a():a}}});
handy.add("Array","B.Object",function(e,d){function c(a){return a}function b(a){return function(b){return b[a]}}function a(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}}var f={map:function(a,b,c){var d=[];if(null==a)return d;var f=Array.prototype.map;if(f&&a.map===f)return a.map(b,c);e.each(a,function(a,g){d.push(b.call(c,g,a))});return d},pluck:function(a,c){return this.map(a,b(c))},some:function(a,b,c){var f=!1;if(null==a||!b)return f;var e=Array.prototype.some;
if(e&&a.some===e)return a.some(b,c);d.each(a,function(a,g,d){if(f||(f=b.call(c,g,a,d)))return!1});return!!f},every:function(a,b,c){var f=!0;if(null==a||!b)return f;var e=Array.prototype.every;if(e&&a.every===e)return a.every(b,c);d.each(a,function(a,g,d){if(!(f=b.call(c,g,a,d)))return!1});return!!f},indexOf:function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c)if("number"==typeof c)d=0>c?Math.max(0,e+c):c;else return d=f.sortedIndex(a,b),a[d]===b?d:-1;var n=Array.prototype.indexOf;if(n&&a.indexOf===
n)return a.indexOf(b,c);for(;d<e;d++)if(a[d]===b)return d;return-1},find:function(a,b,c){var d;this.some(a,function(a,g,f){if(b.call(c,a,g,f))return d=a,!0});return d},filter:function(a,b,c){var f=[];if(null==a)return f;var e=Array.prototype.filter;if(e&&a.filter===e)return a.filter(b,c);d.each(a,function(a,d,g){b.call(c,d,a,g)&&f.push(d)});return f},where:function(b,c){return this.filter(b,a(c))},findWhere:function(b,c){return this.find(b,a(c))},invoke:function(a,b){var c=Array.prototype.slice.call(arguments,
2),d=e.isFunction(b);return this.map(a,function(a){return(d?b:a[b]).apply(a,c)})},sortedIndex:function(a,f,e,k){e=null==e?c:d.isFunction(e)?e:b(e);f=e.call(k,f);for(var m=0,n=a.length;m<n;){var l=m+n>>>1;e.call(k,a[l])<f?m=l+1:n=l}return m},sortBy:function(a,f,e){f=null==f?c:d.isFunction(f)?f:b(f);return this.pluck(this.map(a,function(a,b,c){return{value:a,index:b,criteria:f.call(e,a,b,c)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-
b.index}),"value")}};return f});
handy.add("Template","B.String",function(e,d){function c(a){return j?"$r+="+a+";\n":"$r.push("+a+");\n"}function b(a){a=a.replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n");return c('"'+a+'"')}var a={openTag:"<%",closeTag:"%>",isEscape:!0,registerHelper:function(a,b){h[a]||(k+=a+"=oHelpers."+a+",");h[a]=b},tmpl:function(e,n){var l,r,v;if("string"==typeof e)l=e;else if(l=e.tmpl,v=e.id)if(f[v])r=f[v];else if(!l){var y=document.getElementById(v);y&&(l=(y.value||y.innerHTML).replace(/\s/g,
""))}if(!r){if(!l){d.Debug.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}var q=k+"$r="+(j?'""':"[]")+";\n";d.Object.each(l.split(a.openTag),function(d,f){var j=f.split(a.closeTag);if(1==j.length)q+=b(j[0]);else{var e=q,h=j[0],h=h.replace(/this/g,"$data");0==h.indexOf("=")&&(h=c(h.replace(g,"")+'||""'));q=e+(h+"\n");j[1]&&(q+=b(j[1]))}});q+="return "+(j?"$r;":'$r.join("");');l=new Function("$data",q);l.$helpers=h;r=l;v&&(f[v]=r)}return n?r(n):r}},f={},g=/^=/,j="".trim,h={escape:e.escapeHTML,trim:e.trim},
k="var oHelpers=arguments.callee.$helpers,escape=oHelpers.escape,trim=oHelpers.trim,";return a});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(e,d,c){function b(a){if(a==m)return!1;var b=k.contentWindow.document;b.open();b.write("<!doctype html><html><body>"+a+"</body></html>");b.close();m=a;e.log("set:"+k.contentWindow.document.body.innerText)}function a(){var a=d.getHash(),c=k.contentWindow.document.body.innerText;a!=m?(b(a),f(a)):c!=m&&(e.log("update:"+k.contentWindow.document.body.innerText),d.setHash(c))}function f(a){var b=r.listeners,c;for(c in b)b[c](a)}var g,
j=0,h=document,k,m,n=h.documentMode,l="onhashchange"in window&&(void 0===n||7<n),r={delay:50,listen:function(e,m){if(!g&&!g)if(g=!0,r.listeners={},l)$(window).on("hashchange",function(){f(d.getHash())});else k=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(h.body)[0],$(k).one("load",function(){b(d.getHash());setInterval(a,r.delay)});if(m in r.listeners)$D.error(Error("Duplicate name"));else return m=m||c.expando+ ++j,r.listeners[m]=e,m},unListen:function(a){for(var b in r.listeners)(!a||
a==b)&&delete r.listeners[b]}};return r});handy.add("Support","B.Browser",function(e){var d={mediaQuery:function(){var b;if(e.mobile())b="hui-mobile";else{b="hui-pc";var a=e.ie();a&&(b+=" ie"+a)}document.documentElement.className+=" "+b}};d.mediaQuery();if(6==e.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(c){}return d});
handy.add("Validator",["B.String","B.Object"],function(e,d){var c={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(b,a){var d=a.rules,g;for(g in d){var j=d[g],e=("function"==typeof j?j:c[g])(b,j);if(!e)return d=a.error||c.error,g=a.messages&&
a.messages[g]||c.messages[g],g=g.replace(/\{([^\}]+)\}/g,function(b,c){return j[c]||0==c&&j||a[c]||j||""}),d&&d(g),e}return!0},required:function(b){return 0<e.trim(""+b).length},email:function(b){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(b)},
url:function(b){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(b)},
date:function(b){return!/Invalid|NaN/.test((new Date(b)).toString())},dateISO:function(b){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(b)},number:function(b){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(b)},digits:function(b){return/^\d+$/.test(b)},creditcard:function(b){if(/[^0-9 \-]+/.test(b))return!1;var a=0,c=0,d=!1;b=b.replace(/\D/g,"");for(var j=b.length-1;0<=j;j--){c=b.charAt(j);c=parseInt(c,10);if(d&&9<(c*=2))c-=9;a+=c;d=!d}return 0===a%10},min:function(b,a){return b>=a},max:function(b,
a){return b<=a},range:function(b,a){return b>=a[0]&&b<=a[1]},minlength:function(b,a){return(d.isArray(b)?b.length:e.trim(""+b).length)>=a},maxlength:function(b,a){return(d.isArray(b)?b.length:e.trim(""+b).length)<=a},rangelength:function(b,a){var c=d.isArray(b)?b.length:e.trim(""+b).length;return c>=a[0]&&c<=a[1]},equalTo:function(b,a){return b===a}};return c});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(e,d,c){d={_init:function(){!b&&e.ie()&&(f=document.getElementById("LocalStorageUserDataDiv"),f||(f=document.createElement("DIV"),f.style.display="none",f.id="LocalStorageUserDataDiv",f.addBehavior("#default#userData"),document.body.appendChild(f),f.load(g)))},getItem:function(d){d=b?a.getItem(d):f.getAttribute(d);return d=c.parseJson(d)},setItem:function(d,e){e=c.stringify(e);try{b?a.setItem(d,e):(f.setAttribute(d,e),f.save(g))}catch(k){return $D.error(k),
!1}return!0},removeItem:function(c){b?a.removeItem(c):(f.removeAttribute(c),f.save(g))},clear:function(){b?a.clear():f.unload()}};var b=window.localStorage&&window.localStorage.getItem,a=window.localStorage,f,g=document.domain;d._init();return d});(function(e){Hui=H=$H=e.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};e=window.$;e.fn.remove=$H.intercept(e.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
$Define("CM.AbstractEvents",function(){var e=$H.createClass();$H.extend(e.prototype,$H.Events);$H.extend(e.prototype,{_eventCache:{},_listenTo:[],_parseListenToEvents:function(d,c,b,a){var f=this,g=$H.toArray(arguments,3);return f._parseEvents(b,function(a){a.unshift(c);f[d].apply(f,a.concat(g))})},listenTo:function(d,c,b,a,f){if(!this._parseListenToEvents("listenTo",d,c,b,a,f)){"number"==typeof a&&(f=a,a=null);a=a||this;var g=this._delegateHandler(b,a);this._listenTo.push({target:d,name:c,delegation:g,
handler:b});d.on(c,g,a,f)}},unlistenTo:function(d,c,b){if(!this._parseListenToEvents("unlistenTo",d,c,b)){var a=this._listenTo,f="all"==d;$H.each(a,function(g,j){if(f||j.name==c&&j.handler==b&&j.target==d)j.target.off(j.name,j.delegation),a.splice(g,1)})}}});return e});
$Define("CM.AbstractDao","B.LocalStorage",function(e){var d=$H.createClass();$H.extend(d.prototype,{_ajaxMethodMap:{create:"POST",update:"POST",patch:"PATCH","delete":"DELETE",read:"GET"},_localMethodMap:{create:"setItem",update:"setItem",patch:"setItem","delete":"removeItem",read:"getItem"},ajax:function(c){this.beforeSend(c);c.error=$H.intercept(this.error,c.error);c.success=$H.intercept(this.success,c.success);return $.ajax(c)},beforeSend:$H.noop,error:$H.noop,success:$H.noop,get:function(){},
set:function(){},remove:function(){},sync:function(c,b,a){a=a||{};var d=a.storeType||"remote",g={type:"POST",dataType:"json"};a.url||(g.url=b.getUrl());if(null==a.data&&b&&("create"===c||"update"===c||"patch"===c))g.data=a.attrs||b.toJSON(a);if("remote"==d)g.url+="/"+c+".do",$H.extend(g,a),this.ajax(g);else e[this._localMethodMap[c]](g);b.trigger("request",b,a)}});return d});
$Define("CM.AbstractManager",function(){var e=$H.createClass();$H.extend(e.prototype,{_types:{},_all:{},type:"manager",registerType:function(d,c){this._types[d]=c;c.prototype.xtype=d},getClass:function(d){return $H.isClass(d)?d:this._types[d]||$H.namespace(d)},register:function(d){this._all[d.getId()]=d},unregister:function(d){var c=this._all,b=d.getId();c[b]==d&&delete c[b]},eachInEl:function(d,c){var b=this;d.find(".js-"+b.type).each(function(a,d){d=$(d);var g=d.attr("id");(g=b.get(g))&&c(g)})},
generateId:function(d,c){var b=$H.expando+"_"+this.type+"_"+(d||$H.Util.getUuid());if(!0!=c&&this._all[b])$D.error("id\u91cd\u590d:"+b);else return b},get:function(d){var c=this._all;return c[d]||c[this.generateId(d,!0)]}});return e});
$Define("CM.ViewManager","CM.AbstractManager",function(e){var d=$H.createClass();$H.inherit(d,e,{type:"view",initialize:function(){var c=this;$H.on("afterRender",function(b,a){c.afterRender(a)});$H.on("removeEl",function(b,a){c.destroy(a)})},afterRender:function(c){this.eachInEl(c,function(b){b.afterRender()})},destroy:function(c){this.eachInEl(c,function(b){b.destroy(!0)})}});$V=$H.getSingleton(d);return d});
$Define("CM.View",["CM.ViewManager","CM.AbstractEvents","B.Template"],function(e,d){var c=/^(<[a-zA-Z]+)/,b=/^[^>]+class=/,a=/(class=")/,f=d.derive({xtype:"View",_placeholder:'<script id="" type="text/x-placeholder">\x3c/script>',autoRender:!0,renderBy:"append",listeners:[],items:[],children:[],_customEvents:"beforeRender render afterRender beforeShow show afterShow beforeHide hide afterHide beforeUpdate update afterUpdate beforeDestroy destroy afterDestroy add remove".split(" "),_defaultEvents:"mousedown mouseup mouseover mousemove mouseenter mouseleave dragstart drag dragenter dragleave dragover drop dragend touchstart touchmove touchend touchcancel keydown keyup keypress click dblclick focus focusin focusout contextmenu change submit".split(" "),
_applyArray:function(a,b){var c=arguments,d=c.callee.caller,f=d.$owner.prototype;0==c.length?(c=d.arguments,c=$H.toArray(c),a=d.$name,b=c.shift()):c=$H.toArray(c,2);if($H.isArray(b)){for(var d=0,e=b.length;d<e;d++)f[a].apply(this,[b[d]].concat(c));return!0}return!1},_parseListenEvents:function(a,b){var c=this;return c._parseEvents(b.name,function(d){b.name=d[0];2==d.length&&(b.handler=d[0]);c[a].call(c,b)})},initialize:function(a){this.inited||(this.manager=this.constructor.manager||$H.getSingleton(e),
this.doConfig(a),this.parseItems(),!1!=this.autoRender&&this.render(),this.manager.register(this),this.inited=!0)},doConfig:function(a){var b=this;b.initParam=a;"string"==typeof a&&(a={text:a});var c=a||{};$H.extend(b,c,{notCover:function(a,d){var g=$H.contains(b._customEvents,a);if($H.contains(b._defaultEvents,a))return b.listeners.push({name:a,handler:c[a]}),!0;if(g)return b.on(a,c[a]),!0;if("defItem"==a)return $H.extend(b[a],d),!0;if("listener"==a)return b.listeners=b.listeners.concat($H.isArray(d)?
d:[d]),!0;if("items"==a)return b.add(d),!0;if("xtype"==a)return"View"==b[a]&&(b[a]="string"==typeof d?d:d.$ns),!0}});b.renderTo=c.renderTo?$(c.renderTo):$(document.body)},getEl:function(){return this._container},getId:function(){return this._id||(this._id=this.manager.generateId(this.cid))},initHtml:function(){"string"!=typeof this.tmpl&&(this.tmpl=this.constructor.prototype.tmpl=this.tmpl.join(""));return $H.Template.tmpl({id:this.xtype,tmpl:this.tmpl},this)},getHtml:function(){var d=this.getId(),
f;f="visibility"==this.displayMode?"visibility:hidden;":"display:none;";var e=this.initHtml(),k=b.test(e),m="js-"+this.manager.type+" js-"+this.xtype+" "+this.extCls+" ";k&&(e=e.replace(a,"$1"+m));return e=e.replace(c,'$1 id="'+d+'" style="'+f+'"'+(k?"":' class="'+m+'"'))},findHtml:function(a){a=this.find(a);for(var b=[],c=0;c<a.length;c++)b.push(a[c].getHtml());return b.join("")},initStyle:function(){var a=this.getEl(),b=this.style||{};void 0!=this.width&&(b.width=this.width);void 0!=this.height&&
(b.height=this.height);a.css(b)},beforeRender:function(){return this.trigger("beforeRender")},render:function(){if(!1==this.beforeRender())return!1;this.trigger("render");var a=this.getHtml();this.renderTo[this.renderBy](a);this.afterRender()},afterRender:function(){if(this.rendered)return!1;this.callChild();this._container=$("#"+this.getId());this.rendered=!0;this.initStyle();!0!=this.notListen&&this.initListeners();this.disabled&&this.disable();this.trigger("afterRender");this.hidden||this.show()},
beforeShow:function(){return this.trigger("beforeShow")},show:function(a,b){var c=this;if(!1==c.beforeShow()||c.showed||b&&c.hidden)return!1;if(!a&&c.delayShow)setTimeout(function(){f.prototype.show.call(c,!0)},0);else{c.trigger("show");c.showed=!0;var d=c.getEl();"visibility"==c.displayMode?d.css({visibility:"visible"}):d.show();c.callChild([null,!0]);c.afterShow()}},afterShow:function(){this.trigger("afterShow")},beforeHide:function(){return this.trigger("beforeHide")},hide:function(){if(!1==this.beforeHide()||
!this.showed)return!1;this.showed=!1;var a=this.getEl();"visibility"==this.displayMode?a.css({visibility:"hidden"}):a.hide();this.trigger("hide");this.afterHide()},afterHide:function(){this.trigger("afterHide")},enable:function(){this.resume();this.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")},disable:function(){this.suspend();this.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled","disabled")},getContent:function(a,b){b?!b instanceof
f&&(b=this.find(b)[0]):b=this;return!1==a?b.children:b.getEl().html()},setContent:function(a,b){if(b)return!b instanceof f&&(b=this.find(b)[0]),b.setContent(a);var c=this.getEl();c.contents().remove();if("string"==typeof a)c.html(a);else return this.add(a)},listen:function(a){if(!this._parseListenEvents("listen",a)){var b=a.name,c=a.context,d=a.times,f=a.target,e=a.custom,l=a.handler;$H.isFunction(f)&&(f=f.call(this));if(f||e)a=$H.removeUndefined([f,b,l,c,d]),this[e?"on":"listenTo"].apply(this,a);
else{var e=this._listeners,d=a.el,f=a.method||"bind",r=a.selector,v=a.data,c=a.delegation=this._delegateHandler(l,c);$H.isFunction(d)&&(d=d.call(this));$H.mobile()&&"click"==b&&(b="touchend");d=d?"string"==typeof d?this.findEl(d):d:this.getEl();if(r)if(v)d[f](r,b,v,c);else d[f](r,b,c);else if(v)d[f](b,v,c);else d[f](b,c);e.push(a)}}},unlisten:function(a){if(!this._parseListenEvents("unlisten",a)){var b=a.name,c=a.handler;if(a.custom)this.off(b,c);else{var d=a.el,f="delegate"==a.method?"undelegate":
"unbind";a=a.selector;var e;$H.mobile()&&"click"==b&&(b="touchend");for(var d=d?"string"==typeof d?this.findEl(d):d:this.getEl(),l=this._listeners.length-1;0<=l;l--){var r=this._listeners[l];if(r.handler==c){e=r.delegation;this._listeners.splice(l,1);break}}if(a)d[f](a,b,e);else d[f](b,e)}}},initListeners:function(){if(this.listened)return!1;this.listened=!0;var a=this.listeners;this._listeners=[];for(var b=a.length-1;0<=b;b--)this.listen(a[b]);this.callChild()},clearListeners:function(){for(var a=
this._listeners,b=a.length-1;0<=b;b--)this.unlisten(a[b]);this.off("all");this.unlistenTo("all");this.callChild()},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0;this.callChild()},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1;this.callChild()},findEl:function(a){return this.getEl().find(a)},parentsEl:function(a){return this.getEl().parents(a)},each:function(a,b){for(var c=this.children,d=c.length,f,e=0;e<d;){f=c[e];f=b?a.apply(f,b):a(e,f);if(!1===f)break;d==c.length?
e++:d=c.length}},match:function(a,b){if("*"==a)return!0;var c=b||this,d,f,e;a=a.replace(/^([^\[]+)/,'[xtype="$1"]');for(var l=/\[([^=|\!]+)(=|\!=)([^=]+)\]/g;d=l.exec(a);)if(f=d[1],e=d[2],d=eval(d[3]),"="===e?c[f]!=d:c[f]==d)return!1;return!0},find:function(a,b){var c=this;b=b||[];if($H.isNumber(a))b.push(c.children[a]);else if($H.isString(a)){if(0<a.indexOf(","))return $H.each(a.split(","),function(a,d){b=b.concat(c.find(d))}),b;var d=0==a.indexOf(">"),f=a.replace(/^>?\s?/,""),e=f.search(/\s|>/),
l;0<e&&(l=f.substring(e),f=f.substring(0,e));c.each(function(c,e){e.match(f)&&(l?e.find(l,b):b.push(e));d||e.find(a,b)})}else $H.isFunction(a)&&c.each(function(c,d){a(d)&&b.push(d);d.find(a,b)});return b},parents:function(a){for(var b=this;b.parent;)if(b=b.parent,a&&this.match(a,b))return b;return a||b===this?null:b},index:function(){var a=this,b=a.parent;if(b){var c;b.each(function(b,d){if(d==a)return c=b,!1});return c}return null},callChild:function(a,b){0!=this.children.length&&(a&&"string"!=typeof a&&
(b=a,a=null),a=a||arguments.callee.caller.$name,this.each(function(c,d){b?d[a].apply(d,b):d[a].call(d)}))},add:function(a,b){if(!this._applyArray()){var c=void 0==b;if(this.startParseItems){if(a instanceof f)a.parent=this;else{this.defItem&&$H.extend(a,this.defItem,{notCover:!0});this.parseItem(a);var d=this.manager.getClass(a.xtype);d?(a.renderTo||(this.inited?a.renderTo=this.getEl():a.autoRender=!1),a.parent=this,a=new d(a)):$D.error("xtype:"+a.xtype+"\u672a\u627e\u5230")}d=this.children;c?d.push(a):
d.splice(b,0,a);this.trigger("add",a);return a}d=this.items;c?d.push(a):d.splice(b,0,a)}},remove:function(a){if(!this._applyArray()){var b=this.children,c=!1,d;if($H.isNumber(a))d=a,a=b[d];else if($H.isString(a)||$H.isFunction(a)){a=this.find(a);for(var e=0,n=a.length;e<n;e++){if(!1==this.remove(a[e]))return!1;c=!0}}else if(a instanceof f)if(a.parent==this){e=0;for(n=b.length;e<n;e++)if(b[e]==a){d=e;break}}else return a.parent.remove(a);void 0!=d&&!1!=a.destroy(!0)&&(b.splice(d,1),c=!0);this.trigger("remove",
a);return c}},parseItem:function(){},parseItems:function(){this.startParseItems=!0;var a=this.items;if(a)for(var a=$H.isArray(a)?a:[a],b=0,c=a.length;b<c;b++)this.add(a[b])},beforeUpdate:function(){return this.trigger("beforeUpdate")},update:function(a){if(!1==this.beforeUpdate())return!1;var b=this.parent,c=$("<span></span>").insertBefore(this.getEl());a=$H.extend(a||this.initParam,{xtype:this.xtype,renderBy:"replaceWith",renderTo:c});if(!a.cid||a.cid==this.cid)a._id=this._id;if(b){var d=this.index();
if(!1==b.remove(this))return c.remove(),!1;a=b.add(a,d)}else{if(!1==this.destroy())return c.remove(),!1;a=new this.constructor(a)}this.trigger("update",a);this.afterUpdate(a);return a},afterUpdate:function(a){this.trigger("afterUpdate",a)},beforeDestroy:function(){return this.trigger("beforeDestroy")},destroy:function(a){if(!1==this.beforeDestroy())return!1;if(!this.destroyed)return this.callChild(),this.trigger("destroy"),this.clearListeners(),this.getEl().remove(),this.destroyed=!0,!a&&this.parent&&
this.parent.remove(this),this.manager.unregister(this),delete this.initParam,delete this._container,delete this.renderTo,delete this._listeners,delete this.children,this.afterDestroy(),!0},afterDestroy:function(){this.trigger("afterDestroy")}},{extend:function(a){var b=this.prototype;$H.extend(b,a,{notCover:function(c){if($H.contains(["_customEvents","listeners"],c))return b[c]=(a[c]||[]).concat(b[c]||[]),!0;if("xtype"==c||"constructor"==c)return!0}})},html:function(a){return(new this($H.extend({autoRender:!1},
a))).getHtml()}});return f});
$Define("CM.Model",["CM.AbstractDao","CM.AbstractEvents"],function(e,d){return d.derive({_pending:!1,idAttribute:"id",_validate:function(c,b){if(!b.validate||!this.validate)return!0;c=$H.extend({},this.attributes,c);var a=this.validationError=this.validate(c,b)||null;if(!a)return!0;this.trigger("invalid",this,a,$H.extend(b,{validationError:a}));return!1},initialize:function(c,b){this.dao=this.dao||$H.getSingleton(e);var a=c||{};b||(b={});this.cid=$H.Util.getUuid();this.attributes={};b.collection&&
(this.collection=b.collection);b.parse&&(a=this.parse(a,b)||{});a=$H.extend(a,$H.Util.result(this,"defaults"),{notCover:!0});this.set(a,b);this.changed={}},toJSON:function(){return $H.clone(this.attributes)},sync:function(c,b,a){return this.dao.sync(c,b,a)},get:function(c){return this.attributes[c]},escape:function(c){return $H.String.escapeHTML(this.get(c))},has:function(c){c=this.get(c);return null!=c&&void 0!=c},set:function(c,b,a){var d;"object"===typeof c?(d=c,a=b):(d={})[c]=b;a||(a={});if(!this._validate(d,
a))return!1;var e=a.unset;c=a.silent;var j=[],h=this._changing;this._changing=!0;h||(this._previousAttributes=$H.Object.clone(this.attributes),this.changed={});var k=this.attributes,m=this._previousAttributes;this.idAttribute in d&&(this.id=d[this.idAttribute]);for(var n in d)b=d[n],$H.equals(k[n],b)||j.push(n),$H.equals(m[n],b)?delete this.changed[n]:this.changed[n]=b,e?delete k[n]:k[n]=b;if(!c){j.length&&(this._pending=a);b=0;for(d=j.length;b<d;b++)this.trigger("change:"+j[b],this,k[j[b]],a)}if(h)return this;
if(!c)for(;this._pending;)a=this._pending,this._pending=!1,this.trigger("change",this,a);this._changing=this._pending=!1;return this},unset:function(c,b){b=b||{};b.unset=!0;return this.set(c,void 0,b)},clear:function(c){var b={},a;for(a in this.attributes)b[a]=void 0;c=c||{};c.unset=!0;return this.set(b,c)},hasChanged:function(c){var b=this.changed;return null==c?!$H.isEmpty(b):$H.contains(b,c)},changedAttrbutes:function(c){if(!c)return this.hasChanged()?$H.clone(this.changed):!1;var b,a=!1,d=this._changing?
this._previousAttributes:this.attributes,e;for(e in c)if(!$H.equals(d[e],b=c[e]))(a||(a={}))[e]=b;return a},previous:function(c){return null==c||!this._previousAttributes?null:this._previousAttributes[c]},fetch:function(c){var b=this;c=c?$H.clone(c):{};void 0===c.parse&&(c.parse=!0);var a=c.success;c.success=function(d){if(!b.set(b.parse(d,c),c))return!1;a&&a(b,d,c);b.trigger("sync",b,d,c)};b.sync("read",b,c)},save:function(c,b,a){var d=this,e,j=d.attributes;null==c||"object"===typeof c?(e=c,a=b):
(e={})[c]=b;a=$H.extend({validate:!0},a);if(e&&a.now){if(!d.set(e,a))return!1}else if(!d._validate(e,a))return!1;e&&!a.now&&(c=$H.extend({},j),d.attributes=$H.extend(c,e));void 0===a.parse&&(a.parse=!0);var h=a.success;a.success=function(b){d.attributes=j;var c=d.parse(b,a);a.now||(c=$H.extend(e||{},c));if($H.isObject(c)&&!d.set(c,a))return!1;h&&h(d,b,a);d.trigger("sync",d,b,a)};c=d.isNew()?"create":a.update?"update":"patch";"patch"===c&&(a.attrs=e);d.sync(c,d,a);e&&!a.now&&(d.attributes=j)},destroy:function(c){var b=
this;c=c?$H.clone(c):{};var a=c.success,d=function(){b.trigger("destroy",b,b.collection,c)};c.success=function(e){(!c.now||b.isNew())&&d();a&&a(b,e,c);b.isNew()||b.trigger("sync",b,e,c)};if(b.isNew())return c.success(),!1;b.sync("delete",b,c);c.now&&d()},getUrl:function(){var c=$H.result(this,"url")||$H.result(this.collection,"url");c||$D.error(Error("\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2aurl\u5c5e\u6027\u6216\u8005\u51fd\u6570"));return this.isNew()?c:c.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},
parse:function(c){return c.code&&c.data?c.data:c},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(c){return this._validate({},$H.extend(c||{},{validate:!0}))}})});
$Define("CM.Collection",["CM.AbstractDao","CM.AbstractEvents","CM.Model"],function(e,d,c){var b=d.derive({_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(a,b){if(a instanceof c)return a;b=b?$H.clone(b):{};b.collection=this;var d=new this.model(a,b);if(!d.validationError)return d;this.trigger("invalid",this,d.validationError,b);return!1},_addReference:function(a){this._byId[a.cid]=a;null!=a.id&&(this._byId[a.id]=a);a.collection||(a.collection=this);a.on("all",this._onModelEvent,
this)},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))},initialize:function(a,b){this.dao=this.dao||$H.getSingleton(e);b||(b={});b.model&&(this.model=b.model);void 0!==b.comparator&&(this.comparator=
b.comparator);this._reset();a&&this.reset(a,$H.extend({silent:!0},b))},toJSON:function(a){return $H.Collection.map(this.models,function(b){return b.toJSON(a)})},sync:function(a,b,c){return this.dao.sync(a,b,c)},add:function(a,b){b=$H.extend({add:!0,remove:!1,merge:!1},b);return this.set(a,b)},remove:function(a,b){var c=!$H.isArray(a);a=c?[a]:$H.clone(a);b||(b={});var d,e,k,m;d=0;for(e=a.length;d<e;d++)if(m=a[d]=this.get(a[d]))delete this._byId[m.id],delete this._byId[m.cid],k=this.indexOf(m),this.models.splice(k,
1),this.length--,b.silent||(b.index=k,m.trigger("remove",m,this,b)),this._removeReference(m,b);return c?a[0]:a},set:function(a,b){b=$H.extend({add:!0,remove:!0,merge:!0},b);b.parse&&(a=this.parse(a,b));var d=!$H.isArray(a),e=d?a?[a]:[]:$H.clone(a),h,k,m,n,l,r,v=b.at,y=this.model,q=this.comparator&&null==v&&!1!==b.sort,D="string"==typeof this.comparator?this.comparator:null,z=[],B=[],A={},s=b.add,u=b.merge,t=b.remove,w=!q&&s&&t?[]:!1;h=0;for(k=e.length;h<k;h++){l=e[h]||{};m=l instanceof c?n=l:l[y.prototype.idAttribute||
"id"];if(m=this.get(m))t&&(A[m.cid]=!0),u&&(l=l===n?n.attributes:l,b.parse&&(l=m.parse(l,b)),m.set(l,b),q&&(!r&&m.hasChanged(D))&&(r=!0)),e[h]=m;else if(s){n=e[h]=this._prepareModel(l,b);if(!n)continue;z.push(n);this._addReference(n,b)}n=m||n;w&&(n.isNew()||!A[n.id])&&w.push(n);A[n.id]=!0}if(t){h=0;for(k=this.length;h<k;++h)A[(n=this.models[h]).cid]||B.push(n);B.length&&this.remove(B,b)}if(z.length||w&&w.length)if(q&&(r=!0),this.length+=z.length,null!=v){h=0;for(k=z.length;h<k;h++)this.models.splice(v+
h,0,z[h])}else{w&&(this.models.length=0);l=w||z;h=0;for(k=l.length;h<k;h++)this.models.push(l[h])}r&&this.sort({silent:!0});if(!b.silent){h=0;for(k=z.length;h<k;h++)(n=z[h]).trigger("add",n,this,b);(r||w&&w.length)&&this.trigger("sort",this,b)}return d?e[0]:e},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c],b);b.previousModels=this.models;this._reset();a=this.add(a,$H.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return a},
push:function(a,b){return this.add(a,$H.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){return this.add(a,$H.extend({at:0},b))},shift:function(a){var b=this.at(0);this.remove(b,a);return b},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a]||this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},where:function(a,b){return $H.isEmpty(a)?
b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){this.comparator||$D.error(Error("\u6ca1\u6709\u6bd4\u8f83\u5668"));a||(a={});"string"==typeof this.comparator||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort($H.Function.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return $H.Collection.invoke(this.models,
"get",a)},getUrl:function(){return this.url},fetch:function(a){var b=this;a=a?$H.clone(a):{};void 0===a.parse&&(a.parse=!0);var c=a.success;a.success=function(d){b[a.reset?"reset":"set"](d,a);c&&c(b,d,a);b.trigger("sync",b,d,a)};return b.sync("read",b,a)},create:function(a,b){var c=this;b=b?$H.clone(b):{};if(!(a=c._prepareModel(a,b)))return!1;b.now&&c.add(a,b);var d=b.success;b.success=function(a,e){b.now||c.add(a,b);d&&d(a,e,b)};a.save(null,b);return a},parse:function(a){return a.data},clone:function(){return new this.constructor(this.models)}});
$H.each("some every find filter invoke indexOf".split(" "),function(a,c){b.prototype[c]=function(){var a=Array.prototype.slice.call(arguments),b=$H.Array;a.unshift(this.models);return b[c].apply(b,a)}});return b});$Define("C.ComponentManager",["CM.AbstractManager","CM.ViewManager"],function(e,d){var c=e.derive({type:"component",initialize:function(){var b=$H.getSingleton(d);this._types=b._types;this._all=b._all}});$CM=new c;return c});
$Define("C.AbstractComponent",["CM.ViewManager","CM.View"],function(e,d){$C=$H.namespace("C",{});var c=$H.createClass();$H.inherit(c,d,{xtype:"AbstractComponent",activeCls:"hui-active",hasConfig:function(b,a){if(!a)return!1;if($H.isArray(a))for(var c=0,d=a.length;c<d;c++){if(this.match(b,a[c]))return!0}else if(this.match(b,a))return!0;return!1},doConfig:function(){this.callSuper();this.cls||(this.cls=this.xtype.toLowerCase());this.extCls=this.getExtCls();this.icon&&this.add({xtype:"Icon",name:this.icon});
this.isMini&&(this.defItem=$H.extend({isMini:!0},this.defItem))},getExtCls:function(){var b=["js-component"];this.extCls&&b.push(this.extCls);this.theme&&b.push("hui-"+this.cls+"-"+this.theme);this.radius&&b.push("hui-radius-"+this.radius);this.isMini&&b.push("hui-mini");this.shadow&&b.push("hui-shadow");this.shadowSurround&&b.push("hui-shadow-surround");this.shadowOverlay&&b.push("hui-shadow-overlay");this.shadowInset&&b.push("hui-shadow-inset");this.isActive&&b.push(this.activeCls);this.isFocus&&
b.push("hui-focus");this.isInline&&b.push("hui-inline");return 0<b.length?b.join(" "):""},active:function(){this.getEl().addClass(this.activeCls)},unactive:function(){this.getEl().removeClass(this.activeCls)},txt:function(b){var a=this.findEl(".js-"+this.cls+"-txt");0==a.length&&(a=this.findEl(".hui-"+this.cls+"-txt"));if(void 0!=b)a.text(b);else return a.text()},valid:function(){var b=this.validator;if(b){var a=this.val();b.error||(b.error=function(a){new $C.Tips({text:a,theme:"error"})});return b=
$H.Validator.valid(a,b)}for(var a=this.children,c=0,d=a.length;c<d;c++)if(b=a[c].valid(),!b)return b;return!0}},{define:function(b,a){var d=$H.createClass();$H.inherit(d,a||c,null,null,{notCover:function(a){return"define"==a}});$H.getSingleton(e).registerType(b,d);return $C[b]=d}});return c});$Define("C.Panel","C.AbstractComponent",function(e){e=e.define("Panel");e.extend({tmpl:['<div><%=this.content||this.findHtml(">*")%></div>']});return e});
$Define("C.Popup","C.AbstractComponent",function(e){e=e.define("Popup");var d=0,c;e.extend({delayShow:!0,clickHide:!0,showPos:"center",shadowOverlay:!0,tmpl:['<div class="hui-popup"><%=this.findHtml(">*")%></div>'],doConfig:function(){this.callSuper();this.clickHide&&this.listeners.push({name:"click",el:$(document),handler:function(){this.hide()}});$H.android()&&(this.listeners.push({name:"show",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.show")&&$("input,textarea,select").attr("disabled",
"disabled")}}),this.listeners.push({name:"hide",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.hide")&&setTimeout(function(){$("input,textarea,select").removeAttr("disabled")},500)}}))},afterShow:function(){var b=this,a=b.getEl();a.css("z-index",1E3*d+1E3);if(!b.width&&b.parent){var c=b.width=b.parent.getEl().outerWidth();a.css("width",c)}a=b.showPos;if("string"==typeof a)b[a]();else"function"==typeof a&&a.call(b);b.noMask||b.mask();b.timeout&&setTimeout(function(){b.destroyed||
b.hide()},b.timeout)},hide:function(){!1!=this.callSuper()&&(this.noMask||this.unmask(),this.notDestroy||this.destroy())},center:function(){var b=this.getEl(),a=this.width||b.width(),c=this.height||b.height(),d=document,a=((d.documentElement.offsetWidth||d.body.offsetWidth)-a)/2,c=((d.documentElement.clientHeight||d.body.clientHeight)-c)/2+(d.documentElement.scrollTop||d.body.scrollTop),c=10>c?window.screen.height/2-200:c;b.css({left:a+"px",top:c-(this.offsetTop||0)+"px"})},followEl:function(b){b=
(b||this.parent.getEl()).position();this.getEl().css(b)},mask:function(){c||(c=$('<div class="hui-mask" style="display:none;"></div>').appendTo(document.body));c.css("z-index",1E3*d+998);0==d&&c.show();d++},unmask:function(){d--;0==d?c.hide():c.css("z-index",1E3*(d-1)+998)}});return e});
$Define("C.ControlGroup","C.AbstractComponent",function(e){e=e.define("ControlGroup");e.extend({multi:!1,defItem:{xtype:"Button",extCls:"js-item",radius:null,shadow:!1,isInline:!1},tmpl:['<div class="hui-ctrlgp<%if(this.direction=="h"){%> hui-ctrlgp-h<%}else{%> hui-ctrlgp-v<%}%>">','<%=this.findHtml(">*")%>',"</div>"],listeners:[{name:"click",selector:".js-item",method:"delegate",handler:function(d){var c=$(d.currentTarget),c=this.find('>[_id="'+c.attr("id")+'"]');0<c.length&&(c=c[0].index(),this.onItemClick(d,
c))}}],select:function(d){if(!this.notSelect&&(d="number"==typeof d?this.children[d]:"string"==typeof d?this.find(d)[0]:d))if(!this.multi&&!d.multi){var c=this.getSelected();c&&this.selectItem(c,!1);this.selectItem(d)}else this.selectItem(d,!d.selected)},getSelected:function(d){var c=[];this.each(function(b,a){a.selected&&c.push(d?b:a)});return 0<c.length?this.multi?c:c[0]:null},selectItem:function(d,c){(c=!1!=c)?(d.selected=c,d.select?d.select():d.active()):(d.selected=c,d.select?d.select(c):d.unactive())},
val:function(d){if(d){var c=d.split(",");this.each(function(b,a){a.select($H.contains(c,a.value))})}else return d=this.find(">[selected=true]"),c=[],$H.each(d,function(b,a){c.push(a.value)}),c.join(",")},onItemClick:function(d,c){this.select(c);this.itemClick&&this.itemClick(this.children[c],c)}});return e});
$Define("C.Icon","C.AbstractComponent",function(e){e=e.define("Icon");e.extend({tmpl:'<span class="hui-icon;<%if(this.isAlt){%>; hui-alt-icon;<%}%>; hui-icon-<%=this.name%>;<%if(!this.noBg){%>; hui-icon-bg;<%}%>"></span>'.split(";")});return e});
$Define("C.Button","C.AbstractComponent",function(e){e=e.define("Button");e.extend({iconPos:"left",theme:"gray",activeCls:"hui-btn-active",cls:"btn",defItem:{xtype:"Icon"},radius:"normal",shadow:!0,isInline:!0,tmpl:'<a href="javascript:;" hidefocus="true" class="hui-btn,<%if(!this.text){%> hui-btn-icon-notxt<%},if(this.isBack){%> hui-btn-back<%},if(this.hasIcon&&this.text){%> hui-btn-icon-<%=this.iconPos%><%}%>">,<span class="hui-btn-txt"><%=this.text%></span>,<%=this.findHtml(">*")%>,</a>'.split(","),parseItem:function(d){"Icon"==
d.xtype&&(this.hasIcon=!0)}});return e});
$Define("C.Radio","C.AbstractComponent",function(e){e=e.define("Radio");e.extend({tmpl:'<div class="hui-radio hui-btn hui-btn-gray<%if(this.selected){%> hui-radio-on<%}%>">;<span class="hui-icon hui-icon-radio"></span>;<input type="radio"<%if(this.selected){%> checked=true<%}%>;<%if(this.name){%> name="<%=this.name%>"<%}%>;<%if(this.value){%> value="<%=this.value%>"<%}%>/>;<span class="hui-radio-txt"><%=this.text%></span>;</div>'.split(";"),select:function(d){this.selected=d=!1!=d;var c=this.findEl("input"),
b=this.getEl();d?(c.attr("checked",!0),b.addClass("hui-radio-on")):(c.removeAttr("checked"),b.removeClass("hui-radio-on"))},val:function(d){if(d)this.value=d,this.findEl("input").val(d);else return this.value}});return e});
$Define("C.Checkbox","C.AbstractComponent",function(e){e=e.define("Checkbox");e.extend({text:"",value:"",selected:!1,multi:!0,cls:"chkbox",tmpl:'<div class="hui-chkbox hui-btn hui-btn-gray<%if(this.selected){%> hui-chkbox-on<%}%>">;<span class="hui-icon hui-icon-chkbox"></span>;<input type="checkbox"<%if(this.selected){%> checked=true<%}%>;<%if(this.name){%> name="<%=this.name%>"<%}%>;<%if(this.value){%> value="<%=this.value%>"<%}%>/>;<span class="hui-chkbox-txt"><%=this.text%></span>;</div>'.split(";"),select:function(d){this.selected=
d=!1!=d;var c=this.findEl("input"),b=this.getEl();d?(c.attr("checked",!0),b.addClass("hui-chkbox-on")):(c.removeAttr("checked"),b.removeClass("hui-chkbox-on"))},val:function(d){if(d)this.value=d,this.findEl("input").val(d);else return this.value}});return e});
$Define("C.Select","C.AbstractComponent",function(e){e=e.define("Select");e.extend({text:"\u8bf7\u9009\u62e9...",value:"",radius:"little",optionClick:function(){},defItem:{xtype:"Menu",hidden:!0,markType:"dot",renderTo:"body"},_customEvents:["change"],tmpl:['<div class="hui-select hui-btn hui-btn-gray hui-btn-icon-right">','<span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span>','<input value="<%=this.value%>" name="<%=this.name%>"/>','<span class="hui-btn-txt js-select-txt"><%=this.text%></span>',
"</div>"],listeners:[{name:"click",handler:function(){this.showOptions()}}],doConfig:function(d){var c=this;c.callSuper();for(var b=d.options,a=0,e=b.length;a<e;a++){var g=b[a];if(g.value==d.value){c.text=g.text;g.selected=!0;break}}c.add({itemClick:function(a){c.val(a.value)},width:c.width,items:b})},showOptions:function(){this.children[0].show()},val:function(d){if(d){if(this.value!=d){var c=this.children[0],b=c.find('>[value="'+d+'"]');0<b.length&&(this.trigger("change"),b=b[0],this.value=d,this.findEl("input").attr("value",
d),this.txt(b.text),c.select(b))}}else return this.value}});return e});
$Define("C.Input","C.AbstractComponent",function(e){e=e.define("Input");e.extend({radius:"little",iconPos:"left",btnPos:"right",tmpl:'<div class="hui-input;<%if(this.hasIcon){%>; hui-input-icon-<%=this.iconPos%>;<%}%>;<%if(this.hasBtn){%>; hui-input-btn-<%=this.btnPos%>;<%}%>">;<%=this.findHtml(">*")%>;<%if(this.type=="textarea"){%>;<textarea class="js-input";<%}else{%>;<input type="text" class="js-input hui-input-txt";<%}%> ; name="<%=this.name%>";<%if(this.placeholder){%>; placeholder="<%=this.placeholder%>";<%}%>;<%if(this.type=="textarea"){%>;><%=this.value%></textarea>;<%}else{%>; value="<%=this.value%>"/>;<%}%> ;</div>'.split(";"),listeners:[{name:"focus",
el:".js-input",handler:function(){this.getEl().addClass("hui-focus")}},{name:"blur",el:".js-input",handler:function(){this.getEl().removeClass("hui-focus")}}],doConfig:function(){var d=this;d.callSuper();"search"==d.type?d.icon="search":"textarea"==d.type&&d.listeners.push({name:"input propertychange",el:".js-input",handler:function(){var c=d.findEl(".js-input");c.css("height",c[0].scrollHeight)}});d.withClear&&d.add({xtype:"Button",radius:"big",icon:"delete",click:function(){this.parent.findEl("input").val("").focus()}})},
parseItem:function(d){"Icon"==d.xtype?this.hasIcon=!0:"Button"==d.xtype&&(this.hasBtn=!0)},val:function(d){var c=this.findEl("input,textarea");if(d)c.val(d);else return c.val()},focus:function(){this.findEl("input").focus()}});return e});$Define("C.Set","C.AbstractComponent",function(e){e=e.define("Set");e.extend({tmpl:'<div class="hui-set">;<h1 class="hui-set-title"><%=this.title%></h1>;<div class="hui-set-content">;<%=this.findHtml(">*")%>;</div>;</div>'.split(";")});return e});
$Define("C.Field","C.AbstractComponent",function(e){e=e.define("Field");e.extend({tmpl:'<div class="hui-form-field">;<label class="hui-form-left" for="<%=this.forName%>"><%=this.label%></label>;<div class="hui-form-right">;<%=this.text%>;<%=this.findHtml(">*")%>;</div>;</div>'.split(";")});return e});
$Define("C.Form","C.AbstractComponent",function(e){e=e.define("Form");e.extend({tmpl:'<div class="hui-form">;<form action="">;<div class="hui-form-tips c-error"></div>;<%=this.findHtml(">*")%>;</form>;</div>'.split(";")});return e});
$Define("C.TabItem",["C.AbstractComponent","C.Panel"],function(e){e=e.define("TabItem");e.extend({defItem:{xtype:"Button",xrole:"title",radius:null,isInline:!1,iconPos:"top",shadow:!1},extCls:"js-item",tmpl:["<div><%=this.findHtml(\">[xrole='title']\")%></div>"],initialize:function(){this.callSuper();this.titleCmp=this.find('>[xrole="title"]')[0];this.contentCmp=this.find('>[xrole="content"]')[0]},doConfig:function(d){this.callSuper();var c=d.title;"string"==typeof c&&(c={text:c});"object"==typeof c&&
this.add(c);d=d.content;"string"==typeof d&&(d={xtype:"Panel",content:d});"object"==typeof d&&($H.extend(d,{xrole:"content",hidden:!this.selected,extCls:"js-content"}),this.add(d));this.activeType&&(this.defItem.activeCls="hui-btn-active-"+this.activeType)},parseItem:function(d){this.selected&&"title"==d.xrole&&(d.isActive=!0)},select:function(d){var c=this.titleCmp,b=this.contentCmp;!1==d?(c.unactive(),b&&b.hide()):(c.active(),b&&b.show())},getContent:function(d,c){c||(c=this.contentCmp);return this.callSuper([d,
c])},setContent:function(d,c){c||(c=this.contentCmp);return this.callSuper([d,c])}});return e});
$Define("C.Tab",["C.AbstractComponent","C.TabItem","C.ControlGroup"],function(e,d,c){e=e.define("Tab",c);e.extend({defItem:{xtype:"TabItem"},listeners:[{name:"afterRender add remove",custom:!0,handler:function(){this.layout()}}],tmpl:['<div class="hui-tab">','<ul class="js-tab-btns c-clear">','<%var aBtns=this.find(">TabItem");',"for(var i=0,len=aBtns.length;i<len;i++){%>",'<li class="hui-tab-item">',"<%=aBtns[i].getHtml()%>","</li>","<%}%>","</ul>","<%=this.findHtml(\">TabItem>[xrole='content']\")%>",
"</div>"],doConfig:function(){this.callSuper();this.activeType&&(this.defItem.activeType=this.activeType)},layout:function(){var b=this.children.length,a=Math.floor(100/b);this.findEl(".js-tab-btns>li").each(function(c,d){d.style.width=c<b-1?a+"%":100-a*(b-1)+"%"})},setTabContent:function(b,a){a=a||this.getSelected(!0);this.findEl(".js-tab-content").index(a).html(b)}});return e});
$Define("C.Toolbar","C.AbstractComponent",function(e){e=e.define("Toolbar");e.extend({cls:"tbar",defItem:{xtype:"Button",theme:"black",pos:"right",isMini:!0},tmpl:['<div class="hui-tbar<%if(this.type=="header"){%> hui-header<%}else if(this.type=="footer"){%> hui-footer<%}%>">','<%=this.findHtml(">*")%>','<%if(this.title){%><h1 class="hui-tbar-title js-tbar-txt"><%=this.title%></h1><%}%>',"</div>"],parseItem:function(d){"Button"==d.xtype&&(d.shadowSurround=!0,"left"==d.pos?d.extCls=(d.extCls||"")+
" hui-tbar-btn-left":"right"==d.pos&&(d.extCls=(d.extCls||"")+" hui-tbar-btn-right"))}});return e});$Define("C.Tips",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(e,d){var c=e.define("Tips",d);c.extend({theme:"black",timeout:1E3,radius:"normal",tmpl:['<div class="hui-tips<%if(!this.text){%> hui-tips-notxt<%}%>">','<%=this.findHtml(">*")%>','<%if(this.text){%><span class="hui-tips-txt"><%=this.text%></span><%}%>',"</div>"]});return c});
$Define("C.Dialog",["C.AbstractComponent","C.Popup"],function(e,d){var c=e.define("Dialog",d);$H.extend(c,{alert:function(b){return new c({contentMsg:b,noClose:!0,noCancel:!0})},confirm:function(b,a){return new c({contentMsg:b,noClose:!0,okCall:function(){return a&&a(!0)},cancelCall:function(){return a&&a(!1)}})},prompt:function(b,a,d){d||(d=a,a="");return new c({contentMsg:b,noClose:!0,items:{xtype:"Input",xrole:"dialog-content",value:a},okCall:function(){var a=this.find("Input")[0].val();return d&&
d(a)}})}});c.extend({okTxt:"\u786e\u5b9a",cancelTxt:"\u53d6\u6d88",clickHide:!1,radius:"little",tmpl:'<div class="hui-dialog">;<%=this.findHtml(">[xrole=\'dialog-header\']")%>;<div class="hui-dialog-body">;<%if(this.content){%><%=this.content%><%}else{%>;<div class="hui-body-content">;<h1 class="hui-content-title"><%=this.contentTitle%></h1>;<div class="hui-content-msg"><%=this.contentMsg%></div>;<%=this.findHtml(">[xrole=\'dialog-content\']")%>;</div>;<%}%>;<%if(!this.noAction){%>;<div class="hui-body-action">;<%=this.findHtml(">[xrole=\'dialog-action\']")%>;</div>;<%}%>;</div>;</div>'.split(";"),
doConfig:function(b){var a=this;a.callSuper();b=b.items;a.title&&!a.hasConfig('[xrole="dialog-header"]',b)&&a.add({xtype:"Toolbar",title:a.title,theme:"gray",xrole:"dialog-header",extCls:"hui-dialog-header",items:!a.noClose&&{xtype:"Button",radius:"big",icon:"delete",isMini:!1,theme:"gray",pos:"left",click:function(){a.hide()}}});!a.noAction&&!a.hasConfig('[xrole="dialog-action"]',b)&&(b=[],a.noCancel||b.push({title:{isActive:1==a.activeBtn,text:a.cancelTxt,click:function(){!1!=(a.cancelCall&&a.cancelCall())&&
a.hide()}}}),a.noOk||b.push({title:{text:a.okTxt,isActive:2==a.activeBtn,click:function(){!1!=(a.okCall&&a.okCall())&&a.hide()}}}),a.add({xtype:"Tab",xrole:"dialog-action",theme:"border-top",notSelect:!0,items:b}))}});return c});
$Define("C.Menu",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(e,d,c){e=e.define("Menu",d);e.extend(c.prototype);e.extend({notDestroy:!0,tmpl:['<div class="hui-menu<%if(this.markType=="dot"){%> hui-menu-mark<%}%>">',"<ul>","<%for(var i=0,len=this.children.length;i<len;i++){%>",'<li class="hui-menu-item<%if(this.children[i].selected){%> hui-item-mark<%}%>">',"<%=this.children[i].getHtml()%>",'<%if(this.markType=="dot"){%><span class="hui-icon-mark"></span><%}%>',"</li>","<%}%>","</ul>",
"</div>"],selectItem:function(b,a){a=!1!=a;"dot"==this.markType?(b.selected=a,b.getEl().parent()[!1==a?"removeClass":"addClass"]("hui-item-mark")):"active"==this.markType?c.prototype.selectItem.call(this,b,a):b.selected=a}});return e});$Define("C.List",["C.AbstractComponent","C.ControlGroup"],function(e,d){var c=e.define("List",d);c.extend({tmpl:['<div class="hui-list">','<div class="hui-list-item c-clear">',"</div>","</div>"]});return c});
$Define("M.AbstractModule","CM.View",function(e){var d=$H.createClass();$H.inherit(d,e,{useCache:$H.noop,cache:$H.noop,init:$H.noop,reset:$H.noop,exit:function(){return!0},cleanCache:function(){this.clearCache=!0}});return d});$Define("M.AbstractNavigator","handy.base.Object",function(e){var d=$H.createClass();e.extend(d.prototype,{navigate:function(){}});return d});
$Define("M.History","handy.base.HashChange",function(e){var d=$H.createClass(),c=0;$H.extend(d.prototype,{initialize:function(b,a){"function"==typeof b&&(a=b,b=null);this.error=a||$H.noop;this.key=b||"handy";this.states=[];e.listen($H.Function.bind(this.stateChange,this))},stateChange:function(){var b=this.getHashParam(),a=b.hKey,c=this.currentKey,d=this.states,e=d[c];if(a==c)return!1;(d=d[a])?b=d.onStateChange(d.param,!0):($D.warn("hisory state not found"),b=this.error("stateNotFound",b));!0!=b?
(b={hKey:c,param:e.param},this.saveHash(b)):this.currentKey=a},saveState:function(b){var a=this.currentKey=this.key+ ++c;this.states.push(a);this.states[a]=b;this.saveHash({hKey:a,param:b.param})},saveHash:function(b){$H.setHash("#"+$H.Json.stringify(b))},getHashParam:function(){try{var b=$H.getHash().replace("#","");return $H.parseJson(b)}catch(a){$H.Debug.warn("History.getCurrentState:parse hash error:"+a.message)}},getCurrentState:function(){try{var b=this.getHashParam();return this.states[b.hKey]}catch(a){$H.Debug.warn("History.getCurrentState:parse hash error:"+
a.message)}},getPreState:function(){try{for(var b=this.getHashParam().hKey,a=this.states,c=a.length,d=0;d++;d<c)if(a[d]==b)return 0<d?a[a[--d]]:null}catch(e){$H.Debug.error("History.getPreState error:"+e.message,e)}},back:function(){var b=this.getPreState();if(b)b.onStateChange(b.param)}});return d});
$Define("M.ModuleManager",["M.History","CM.AbstractManager"],function(e,d){var c=$H.createClass();$H.inherit(c,d,{type:"module",_createMod:function(b){var a=this,c=b.modName;a.modules[c]={waiting:!0};$Require(a.defModPackage+c,function(d){var e={renderTo:a.container,name:c,xtype:c,_id:a.generateId(),extCls:"js-module m-module",hidden:!0};$H.extend(e,b);d=new d(e);a.modules[c]=d;$H.trigger("afterRender",d.getEl());a.requestMod==c&&a._showMod(d)})},_showMod:function(b){var a=this.modules[this.currentMod];
if(!this.navigator||!this.navigator.navigate(b,a,this))a&&a.hide(),b.show();a&&(a.isActive=!1);b.isActive=!0;this.currentMod=b.name},_destroy:function(b){b.destroy();delete this.modules[b.name]},initialize:function(b){var a=this;b&&(a.conf=b,$H.extend(a,b),a.container=b.container?$(b.container):$(document.body));a.defModPackage+=".";a.history=new e(function(b,c){a.go(c.param)});a.modules={}},go:function(b,a){"string"==typeof b&&(b={modName:b});var c=b.modName,d=this.currentMod,e=this.modules,h=e[d];
if(d==c)h.waiting||h.reset();else{if(h&&!h.waiting)if(h._forceExit)h._forceExit=!1;else if(!1==h.exit())return!1;this.requestMod=c;(c=e[c])?!0!=c.notCache&&!0!=c.clearCache&&!1!=c.useCache(b)?(!1==c.clearCache,this._showMod(c),c.cache(b)):c.waiting||(this._destroy(c),this._createMod(b)):this._createMod(b);!0!=a&&this.history.saveState({onStateChange:$H.Function.bind(this.go,this),param:b});return!0}},update:function(b,a){var c=b.update(a);c&&(this.modules[b.name]=c,$H.trigger("afterRender",c.getEl()))},
clearCache:function(b){b.notCache=!0},back:function(b){b&&(this.modules[this.currentMod]._forceExit=!0);history.back()}});return c});
