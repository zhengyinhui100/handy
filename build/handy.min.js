/* Handy v1.0.0-dev | 2014-05-24 | zhengyinhui100@gmail.com */
(function(){var f=window.handy,b=window.$,c=window.handy=window.$=function(){};c.version="1.0.0";c.isDebug="undefined"==typeof gEnv?!1:"dev"==gEnv;c.expando=("handy-"+c.version).replace(/\./g,"_");c.add=function(a,e,g){g||(g=e,e=null);c.base||(c.base={});var d=[];if(e)if("string"==typeof e)d.push(c.base.Object.ns(e));else for(var b=0;b<e.length;b++)d.push(c.base.Object.ns(e[b]));d.push(c);e=g.apply(window,d);c.base[a]=c[a]=e;if(0<="Browser,Class,Array,Geo,Cookie,Date,Events,Function,Json,Object,String,Template,Util".indexOf(a))for(var j in e)c.isDebug&&
("undefined"!=typeof c[j]&&"console"in window&&!Function[j])&&(console.log(c[j]),console.log(a+"\u547d\u540d\u51b2\u7a81:"+j)),c[j]=e[j]};c.noConflict=function(a){window.$===c&&(window.$=b);a&&window.handy===c&&(window.handy=f);return c};c.noop=function(){}})();
handy.add("Json",function(){function f(a){d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){var d=h[a];return"string"===typeof d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));return'"'+a+'"'}function b(d,c){var h,j,m,l,n=e,x,k=c[d];k&&("object"===typeof k&&"function"===typeof k.toJSON)&&(k=k.toJSON(d));"function"===typeof a&&(k=a.call(c,d,k));switch(typeof k){case "undefined":return"undefined";case "string":return f(k);case "number":return isFinite(k)?String(k):"null";case "boolean":case "null":return String(k);
case "object":if(!k)return"null";e+=g;x=[];if("[object Array]"===Object.prototype.toString.apply(k)){l=k.length;for(h=0;h<l;h+=1)x[h]=b(h,k)||"null";m=0===x.length?"[]":e?"[\n"+e+x.join(",\n"+e)+"\n"+n+"]":"["+x.join(",")+"]";e=n;return m}if(a&&"object"===typeof a){l=a.length;for(h=0;h<l;h+=1)"string"===typeof a[h]&&(j=a[h],(m=b(j,k))&&x.push(f(j)+(e?": ":":")+m))}else for(j in k)Object.prototype.hasOwnProperty.call(k,j)&&(m=b(j,k))&&x.push(f(j)+(e?": ":":")+m);m=0===x.length?"{}":e?"{\n"+e+x.join(",\n"+
e)+"\n"+n+"}":"{"+x.join(",")+"}";e=n;return m}}var c="JSON"in window,a,e,g,d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,m=/^[\],:{}\s]*$/,l=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,n=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
k=/(?:^|:|,)(?:\s*\[)+/g;return{stringify:function(d,h,j,f){if(c&&!f)return JSON.stringify.apply(null,arguments);var m;g=e="";if("number"===typeof j)for(m=0;m<j;m+=1)g+=" ";else"string"===typeof j&&(g=j);if((a=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return b("",{"":d})},parseJson:function(a,d,e){function g(a,e){var b,c,h=a[e];if(h&&"object"===typeof h)for(b in h)Object.prototype.hasOwnProperty.call(h,
b)&&(c=g(h,b),void 0!==c?h[b]=c:delete h[b]);return d.call(a,e,h)}if(c&&!e)return JSON.parse.apply(null,arguments);var b;a=String(a);j.lastIndex=0;j.test(a)&&(a=a.replace(j,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(m.test(a.replace(l,"@").replace(n,"]").replace(k,"")))return b=eval("("+a+")"),"function"===typeof d?g({"":b},""):b;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var f;f=(f=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(f[0])?function(a,e,g){var d=[];if(a.length){e=e||0;for(g=g||a.length;e<g;e++)d.push(a[e])}return d}:function(a,e,g){return Array.prototype.slice.call(a,e||0,g||a.length)};var b={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},ns:function(a,e){var g=null,d,c,j,f;a=b.alias(a);c=a.split(".");g=c[0];g=(j=2==arguments.length)?eval("(function(){if (typeof "+g+' == "undefined"){'+
g+" = {};}return "+g+";})()"):eval("(function(){if (typeof "+g+' != "undefined")return '+g+";})()");d=1;for(f=c.length;d<f;++d){if(d==f-1&&j)g[c[d]]=e;else if(j||g&&g[c[d]])g[c[d]]=g[c[d]]||{};else return;g=g[c[d]]}return g},alias:function(a,e){var g=b._alias;if(e)g[a]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+a+":"+g[a]):g[a]=e;else{if(a){var d=a,c=a.length-1;do{if(g[d])return g[d]+a.substring(c);c=d.lastIndexOf(".")}while(0<c&&(d=d.substring(0,c)));return a}return g}},extend:function(a,e,
g){if(!e||b.isStr(e)||b.isNum(e))return a;var d=g?g.notCover:!1,c=g?g.cover:null;g=g?g.IsClone:!1;a=a||{};var j=a.constructor,f=j.$isClass,l,n;for(n in e)if(l=e[n],(!c||b.contains(c,n))&&e.hasOwnProperty(n)){var k=a.hasOwnProperty(n),q=!0===d?k:!1;b.isArr(d)?q=b.contains(d,n)&&k:b.isFunc(d)&&(q=d(n,l));q||(l=g?b.clone(l):l,f&&b.isFunc(l)&&(l.$name=n,l.$owner=j),a[n]=l)}return a},extendIf:function(a,e){return b.extend(a,e,{notCover:!0})},mix:function(a,e,g){a.superProto||(a.superProto={});for(var d in e)a.superProto[d]=
b.isFunc(e[d])?a.superProto[d]?function(a,d){return function(){d.apply(this,arguments);e[a].apply(this,arguments)}}(d,a.superProto[d]):e[d]:e[d],a[d]||(a[d]=e[d]);g&&b.extend(a,g);e.toString!=e.constructor.prototype.toString&&(a.superProto.toString=function(){e.toString.apply(a,arguments)});return a},isNum:function(a){return"number"==typeof a},isStr:function(a){return"string"==typeof a},isBool:function(a){return"boolean"==typeof a},isSimple:function(a){return b.isStr(a)||b.isNum(a)||b.isBool(a)},
isUndef:function(a){return"undefined"==typeof a},isFunc:function(a){return"[object Function]"===c.prototype.toString.call(a)},isArr:function(a){return"[object Array]"===c.prototype.toString.call(a)},isObj:function(a){return"object"==typeof a&&!b.isArr(a)},isClass:function(a){return b.isFunc(a)&&!0===a.$isClass},equals:function(a,e){if(typeof a==typeof e){if("object"!=typeof a)return a===e;if(a===e)return!0;if(b.isArr(a)&&b.isArr(e)){if(a.length!=e.length)return!1;for(var g=0,d=a.length;g<d;g++)if(!b.equals(a[g],
e[g]))return!1;return!0}if(!b.isArr(a)&&!b.isArr(e)){if(b.count(a)!=b.count(e))return!1;for(g in a)if(void 0===e[g]||!b.equals(a[g],e[g]))return!1;return!0}}return!1},clone:function(a){if(null==a||"object"!=typeof a)return a;var e=a.constructor;if(e!=c&&e!=window.Array)return a;if(e==window.Date||e==window.RegExp||e==window.Function||e==window.String||e==window.Number||e==window.Boolean)return new e(a);try{var g=new e,d;for(d in a)g[d]=b.clone(a[d]);return g}catch(h){return a}},isEmpty:function(a){if(b.isArr(a))return 0==
a.length;for(var e in a)return!1;return!0},each:function(a,e,g){if(a){var d,c=0,j=a.length,f=void 0===j||b.isFunc(a);if(g)if(f)for(d in a){if(!1===e.apply(a[d],g))break}else for(;c<j&&!1!==e.apply(a[c],g);)d=a.length,j==d?c++:j=d;else if(f)for(d in a){if(!1===e.call(a[d],d,a[d]))break}else for(;c<j&&!1!==e.call(a[c],c,a[c]);)d=a.length,j==d?c++:j=d;return a}},contains:function(a,e){if(!a)return!1;var g=!1;b.each(a,function(a,c){if(b.equals(c,e))return g=!0,!1});return g},largeThan:function(a,e){if("object"==
typeof a&&"object"==typeof e){var g=!0;b.each(e,function(d){if(!b.equals(e[d],a[d]))return g=!1});return g}},count:function(a){if(b.isArr(a))return a.length;var e=0,g;for(g in a)e++;return e},removeUndefined:function(a,e){var g=b.isArr(a);if(e){if(g){var d=[];b.each(a,function(a,e){void 0!==e&&d.push(e)});return d}return b.extend({},a,{isClone:!0,notCover:function(a,d){return void 0===d}})}b.each(a,function(d,e){void 0===e&&(g?a.splice(d,1):delete a[d])});return a},toArray:f,fromArray:function(a){for(var e=
{},g=0,d=a.length;g<d;g++){var c=a[g];e[c.name]=c.value}return e},generateMethod:function(a,e,g){e=b.isArr(e)?e:e.split(",");for(var d=0;d<e.length;d++){var c=e[d];a[c]=g(c)}}},c=window.Object;return b});
handy.add("Browser","handy.base.Object",function(f){var b={},c={};f.generateMethod(c,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(a){return function(d){var e=b[a];return!d&&"string"===typeof e&&/^[\d\.]+$/.test(e)?parseInt(e):e}});f=window.navigator.userAgent;var a;(a=f.match(/MSIE ([\d.]+)/))?b.ie=a[1]:(a=f.match(/Firefox\/([\d.]+)/))?b.firefox=a[1]:(a=f.match(/Chrome\/([\d.]+)/))?
b.chrome=a[1]:(a=f.match(/Opera.([\d.]+)/))?b.opera=a[1]:(a=f.match(/Version\/([\d.]+).*Safari/))?b.safari=a[1]:0;/windows|win32/i.test(f)?b.windows=!0:/linux/i.test(f)?b.linux=!0:/macintosh/i.test(f)?b.mac=!0:0;/trident/i.test(f)?b.trident=!0:/webkit/i.test(f)?b.webkit=!0:/gecko/i.test(f)?b.gecko=!0:/presto/i.test(f)?b.presto=!0:0;/MetaSr/i.test(f)?b.sogou=!0:/Maxthon/i.test(f)?b.maxthon=!0:/TencentTraveler/i.test(f)?b.tt=!0:/TheWorld/i.test(f)?b.theWorld=!0:/360[S|E]E/i.test(f)?b.is360=!0:0;var e;
if((e=f.match(/AppleWebKit\/([\d.]*)/))&&e[1])if(/ Mobile\//.test(f)&&f.match(/iPad|iPod|iPhone/)){b.mobile="ios";if((e=f.match(/OS ([^\s]*)/))&&e[1])b.ios=e[1].replace("_",".");if((e=f.match(/iPad|iPod|iPhone/))&&e[0])b[e[0].toLowerCase()]=b.ios}else if(/ Android/i.test(f)){if(/Mobile/.test(f)&&(b.mobile="android"),(e=f.match(/Android ([^\s]*);/))&&e[1])b.android=e[1]}else if(e=f.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))b.mobile=e[0].toLowerCase();var g;try{if(b.ie){var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
d&&(g=d.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(d=navigator.plugins["Shockwave Flash"])){var h=d.description.split(" ");a=0;for(var j=h.length;a<j;a++)if(0<parseInt(h[a])){g=h[a];break}}}catch(m){}b.flash=g?g:null;return c});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(f,b,c){var a={level:c.isDebug?0:5,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!b.mobile(),out:function(e,g,d){d=d||"log";if(g||a.showInPage){var b=c.expando+"debugDiv",j=top.document,f=j.getElementById(b);f?f.style.display="block":(f=j.createElement("DIV"),f.id=b,f.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+j.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u6536\u8d77</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',f.style.position="fixed",f.style.width="100%",f.style.left=0,f.style.top=0,f.style.right=0,f.style.height="100%",f.style.backgroundColor="#aaa",f.style.fontSize="12px",f.style.padding="10px",f.style.zIndex=9999999999,f.style.opacity=0.95,f.style.filter="alpha(opacity=95)",j.body.appendChild(f));b=f.getElementsByTagName("DIV")[0];j="string"==typeof e?e:c.Json.stringify(e,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0);j=j.replace(/\n|\\n/g,"<br/>");
b.innerHTML+="<div"+("log"==d?"":' style="color:'+("error"==d?"red":"info"==d?"green":"yellow"))+'">'+d+":<br/>"+j+"</div><br/><br/>";b.scrollTop=b.scrollHeight}b=arguments.callee.caller;b.$owner||(b=b.caller);try{if(b.$owner)console[d]("["+b.$owner.$ns+"->"+b.$name+"]");console[d](e)}catch(l){}},log:function(e,g){a.level>a.LOG_LEVEL||a.out(e,!!g,"log")},info:function(e,g){this.level>a.INFO_LEVEL||a.out(e,!!g,"info")},warn:function(e,g){a.level>a.WARN_LEVEL||a.out(e,!!g,"warn")},error:function(e,
g){if(!(a.level>a.ERROR_LEVEL)&&(a.out(e,!!g,"error"),e instanceof Error))throw e;},time:function(e,g,d){a.level>a.INFO_LEVEL||(e?("boolean"==typeof g&&(d=g,g=""),a.out((g||"")+((new Date).getTime()-(a.lastTime||0)),!!d)):a.lastTime=(new Date).getTime())},debug:function(e){if(!(a.level>a.DEBUG_LEVEL)&&!1!==e)debugger}};return a});
handy.add("Function",function(f){return{bind:function(b,c,a){var e=Array.prototype.slice.call(arguments,2);return function(){var a=e.slice();Array.prototype.push.apply(a,arguments);return b.apply(c,a)}},intercept:function(b,c,a,e){return f.Object.isFunc(b)&&f.Object.isFunc(c)?function(){var g=a||this,d={},h=arguments;d.scope=e;d.target=g;d.method=b;return!1!=c.apply(d,h)?b.apply(g,h):!1}:b}}});
handy.add("Class",["B.Object","B.Debug"],function(f,b){var c={createClass:function(a){var e=function(){var a,d,c=arguments;if(this.constructor==e)a=this;else return a=c.callee,d=function(){},d.prototype=a.prototype,d=new d,a.apply(d,c),d;if(d=a.initialize)return d.apply(a,c)};e.$isClass=!0;e.derive=function(a,d,e){var b=c.createClass();c.inherit(b,this,a,d,e);return b};e.prototype.callSuper=function(a,d){a&&(!a.$isClass&&void 0!==a.length)&&(d=a,a=null);var e=arguments.callee.caller,c=e.$owner.superProto;
d=d||e.arguments;a=a?a.prototype:c||this.constructor.superProto;e=e.$name;if(a&&(e=a[e],f.isFunc(e)))return e.apply(this,d)};a&&this.ns(a,e);return e},inherit:function(a,e,c,d,h){var j=function(){};j.prototype=e.prototype;f.extend(a,e,h);a.prototype=new j;a.prototype.constructor=a;a.superClass=e;a.superProto=e.prototype;if(e._onInherit)try{e._onInherit(a)}catch(m){b.error(m)}d&&f.extend(a,d);c&&f.extend(a.prototype,c)},getSingleton:function(a){return(a="string"==typeof a?f.ns(a):a)&&(a.$singleton||
(a.$singleton=new a))}};return c});
handy.add("Loader",["B.Debug","B.Object","B.Function"],function(f,b,c,a){function e(a){var d={},e=[];"string"==typeof a&&(a=[a]);for(var c=0,g=a.length;c<g;c++){var h;h=a[c];h=/\.(css|js)$/.test(h)?s[h]&&"loaded"==s[h].status:p.urlMap&&p.urlMap[h]?p.urlMap[h].chkExist():b.ns(h);if(h)e.push(h);else return d.notExist=a[c],d}d.exist=e;return d}function g(a,e){function c(){c.isCalled||(c.isCalled=!0,clearTimeout(l),e())}if("SCRIPT"===a.nodeName){var b=a,g=c,h=function(){/loaded|complete|undefined/.test(b.readyState)&&(b.onload=
b.onerror=b.onreadystatechange=null,n.removeChild(b),b=null,setTimeout(g,0))};b.onload=b.onreadystatechange=h;b.onerror=function(){f.error(m+"load script error:\n"+b.src);h()}}else{var j=c;window.hasOwnProperty("attachEvent")?a.attachEvent("onload",j):setTimeout(function(){d(a,j)},0)}var l=setTimeout(function(){f.error("Time is out:"+a.src);c()},p.timeout)}function d(a,e){if(!e.isCalled){var c;if(k)a.sheet&&(c=!0);else if(a.sheet)try{a.sheet.cssRules&&(c=!0)}catch(b){if("SecurityError"===b.name||
"NS_ERROR_DOM_SECURITY_ERR"===b.name)c=!0}setTimeout(function(){c?e():d(a,e)},1)}}function h(a){p.showLoading(!1);v--;s[a].status="loaded";p.traceLog&&f.log(m+"Response:\n"+a);j()}function j(){for(var a=q.length-1;0<=a;a--){var d=q[a],c=e(d.deps);if(c.notExist)0==a&&0==v&&f.error(l+c.notExist);else{q.splice(a,1);d.callback.apply(null,c.exist);j();break}}}var m="[Handy Loader] ",l=m+"not found: ",n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,k=navigator.userAgent.indexOf("AppleWebKit"),
q=[],v=0,s={},p={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(d,e,c){d=a.Object.alias(d);2==arguments.length&&(c=e,e=[]);p.require(e,function(){var a;if("function"==typeof c)try{p.traceLog&&f.log(m+"define:\n"+d),a=c.apply(null,arguments)}catch(e){e.message=m+d+":\nfactory define error:\n"+e.message;f.error(e);return}else a=c;if(a){b.ns(d,a);var g=typeof a;if("object"==g||"function"==g)a.$ns=d}else f.error(m+"factory no return:\n"+d)})},require:function(d,b){for(var j=
"string"==typeof d?[d]:d,k=[],A=[],t=!0,y=0,z=j.length;y<z;y++){var r=j[y],r=a.Object.alias(r),u=e(r);u.notExist?(k.push(r),t&&(t=!1,q.push({deps:j,callback:b})),p.traceLog&&f.log(l+r)):A.push(u.exist[0])}if(0==k.length)return b&&b.apply(null,A),1==A.length?A[0]:A;t=!1;j=0;for(A=k.length;j<A;j++)if(y=k[j],!s[y]){t=y;r=p.urlMap&&p.urlMap[t]&&p.urlMap[t].url;if(!r){z="";r=p.rootPath;if("string"==typeof r)z=r;else if("object"==typeof r)for(u in u=void 0,r)0==t.indexOf(u)&&(z=r[u],t=t.replace(u,""));
else z="";r=/.css$/.test(t)?0==t.indexOf("/")?t:"/css/"+t:/.js$/.test(t)?t:t.replace(/\./g,"/")+".js";r=z.replace(/\/$/,"")+"/"+r.replace(/^\//,"")}t=!0;s[y]={id:y,status:"loading"};z=c.bind(h,null,y);p.traceLog&&f.log(m+"request:\n"+r);if(/.css$/.test(r))a:{y=r;r=n.getElementsByTagName("link");for(u=0;u<r.length;u++){var w=r[u].href;!p.skinNode&&0<=w.indexOf(p.skinName)&&(p.skinNode=r[u]);if(0<=w.indexOf(y)||0<=y.indexOf(w))break a}r=document.createElement("link");r.rel="stylesheet";r.href=y;g(r,
z);p.skinNode?n.insertBefore(r,p.skinNode):n.appendChild(r)}else y=r,r=document.createElement("script"),r.async="async",r.src=y,r.type="text/javascript",g(r,z),n.appendChild(r);v++}t&&p.showLoading(!0)}};return p});
handy.add("Events",function(f){return{_eventCache:{},_execEvtCache:[],_parseEvents:function(b,c){var a=/\s+/;if("object"==typeof b){for(var e in b)c([e,b[e]]);return!0}if("string"==typeof b&&a.test(b)){a=b.split(a);e=0;for(var g=a.length;e<g;e++)c([a[e]]);return!0}return!1},_parseCustomEvents:function(b,c,a){var e=this,g=f.toArray(arguments,2);return e._parseEvents(c,function(a){e[b].apply(e,a.concat(g))})},_delegateHandler:function(b,c){var a=this;return function(){if(!0!=a.isSuspend)return b.apply(c||
a,arguments)}},_pushEvent:function(b){this._execEvtCache.push(b)},_execEvents:function(){var b=this,c,a=b._execEvtCache;f.each(a,function(e,g){a.splice(e,1);var d=g.delegation;"number"==typeof g.times&&(1<g.times?g.times--:b.off(g.name,g.handler));c=d.apply(b,g.args)});return c},on:function(b,c,a,e){if(!this._parseCustomEvents("on",b,c,a,e)){"number"==typeof a&&(e=a,a=null);var g=this._eventCache,d=g[b];d||(d=g[b]=[]);b=this._delegateHandler(c,a);d.push({times:e,handler:c,context:a,delegation:b})}},
once:function(b,c,a){var e=f.toArray(arguments);e.push(1);this.on.apply(this,e)},off:function(b,c){if("all"==b)return this._eventCache={},!0;if(!this._parseCustomEvents("off",b,c)){var a=this._eventCache,e=b.indexOf(".");if(!c&&0>=e){for(var g in a)(g.split(".")[0]==b||0==e&&0<=g.indexOf(b))&&delete a[g];return!0}e=a[b];if(!e)return!1;if(c){a=0;for(g=e.length;a<g;a++)if(e[a].handler==c)return e.splice(a,1),!0}else return delete a[b],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=
!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(b,c){function a(a){if(a)for(var c=0,g=a.length;c<g;c++){var h=a[c];h.args=d;h.name=b;e._pushEvent(h)}}var e=this,g=f.toArray(arguments);g.unshift("trigger");if(!e._parseCustomEvents.apply(e,g)){var g=e._eventCache,d=f.toArray(arguments),h;if(0<b.indexOf("."))h=g[b],a(h);else for(var j in g)if(h=b.indexOf("."),j.split(".")[0]==b||0==h&&0<=j.indexOf(b))h=g[j],a(h);a(g.all);return e._execEvents()}}}});
handy.add("Date",function(){var f=window.Date,b={getWeek:function(a,e){var c=a.getDay();e&&(c=(c+(e%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[c]},isWeeken:function(a){return 0==a.getDay()||6==a.getDay()},getDaysInMonth:function(a){a=new f(a.getFullYear(),a.getMonth()+1,0);return a.getDate()},getDaysInYear:function(a){var e=new f(a.getFullYear(),0,0);a=new f(a.getFullYear()+1,0,0);return Math.floor((a.getTime()-e.getTime())/864E5)},getDayIndexOfYear:function(a){var e=new f("1/1/"+
a.getFullYear());return Math.ceil((a.getTime()-e.getTime())/864E5)},formatDate:function(a,e){e=e||"yyyy-MM-dd HH:mm:ss";var c=a.getHours(),d=Math.floor((a.getMonth()+3)/3),c={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":0==c%12?12:c%12,"H+":c,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":b.getWeek(a),"q+":d,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][d-1],"S+":a.getMilliseconds()},h;for(h in c)RegExp("("+h+")").test(e)&&(d=RegExp.$1.length,e=e.replace(RegExp.$1,1==d?c[h]:("00"+c[h]).slice(-d)));
return e},parseDate:function(a,e){var c=typeof a,d=new f;if("number"==c)return d.setTime(a),d;if("string"!=c)return a;var c=(e||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),b=a.match(/\d+/g);if(b){for(var j=0;j<b.length;j++){var m=c[j],l=parseInt(b[j]);switch(m){case "yyyy":d.setFullYear(l);break;case "MM":d.setMonth(l-1);break;case "dd":d.setDate(l);break;case "HH":d.setHours(l);break;case "mm":d.setMinutes(l);break;case "ss":d.setSeconds(l);break;case "SS":d.setMilliseconds(l)}}return d}},now:function(a){var e=
new f;if(a)"number"!=typeof a&&(a=b.parseDate(a).getTime()),c=a-e.getTime();else return e.setTime(e.getTime()+c),e},howLong:function(a,e){if(a){var c=b.now().getTime()-a.getTime();if(!1!=e){var d;if(60>(c/=6E4))d="\u5206\u949f",c=c||1;else if(24>(c/=60))d="\u5c0f\u65f6";else if(30>(c/=24))d="\u5929";else return"30\u5929\u524d";c=(Math.floor(c)||1)+d+"\u524d"}return c}}},c=0;return b});
handy.add("String",function(){var f={stripTags:function(b){return b.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(b){if(!b)return b;var c=document.createElement("div");b=document.createTextNode(b);c.appendChild(b);return c.innerHTML},unescapeHTML:function(b){var c=document.createElement("div");c.innerHTML=f.stripTags(b);return c.childNodes[0].nodeValue},decodeHTML:function(b){b=b.replace(/&lt;/gi,"<");b=b.replace(/&gt;/gi,">");b=b.replace(/&quot;/gi,'"');b=b.replace(/&apos;/gi,"'");b=b.replace(/<\/?br>/gi,
"\n");b=b.replace(/&amp;/gi,"&");return b=b.replace(/&nbsp;/gi," ")},encodeHTML:function(b){b=b.replace(/&/gi,"&amp;");b=b.replace(/</gi,"&lt;");b=b.replace(/>/gi,"&gt;");b=b.replace(/\"/gi,"&quot;");b=b.replace(/\'/gi,"&apos;");b=b.replace(/\n/gi,"</br>");return b=b.replace(/ /gi,"&nbsp;")},trim:function(b){return b=b.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(b,c){c||(c=/[,%\'\"\/\\;|\<\>\^]/);return-1<b.search(c)},len:function(b){return b.replace(/[^\x00-\xff]/g,"**").length},
left:function(b,c,a){if(f.len(b)>c){!0===a?a=2:0<a||(a=0);var e=0,g=0;for(c-=a;g<c;)255<b.charCodeAt(e)?g+=2:g++,e++;b=b.substring(0,e);for(e=0;e<a;e++)b+="."}return b},isNumStr:function(b){return 0==b.search(/^\d+$/g)},hasChn:function(b){return/[\u4E00-\u9FA5]+/.test(b)},isChn:function(b){return/^[\u4E00-\u9FA5]+$/.test(b)},addParam:function(b,c){c&&(b+=(-1<b.indexOf("?")?"&":"?")+c);return b}};return f});
handy.add("Cookie",function(){return{getCookie:function(f,b){var c=f+"=",a="",e=document.cookie;if(0<e.length){var g=e.indexOf(c);-1!=g&&(g+=c.length,c=e.indexOf(";",g),-1==c&&(c=e.length),a=e.substring(g,c),b||(a=unescape(a)))}return a},setCookie:function(f,b,c){var a=[];void 0!==f&&void 0!==b&&a.push(f+"="+escape(b));c&&(void 0!==c.path&&a.push("path="+c.path),void 0!==c.domain&&a.push("domain="+c.domain),void 0!==c.expires&&a.push("expires="+c.expires),c.secure&&a.push("secure"));document.cookie=
a.join(";")},delCookie:function(f){var b=new Date;b.setTime(b.getTime()-1);document.cookie=f+"=;expires="+b.toGMTString()}}});
handy.add("Util","B.Object",function(f){var b=0;return{isWindow:function(c){return null!=c&&c==c.window},uuid:function(){return++b},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(c){var a=top.location.hash;0<=a.indexOf("#")&&(c=a.replace(/#[^\?]*/,c));top.location.hash=c},position:function(c){for(var a=0,e=0;c;)a+=c.offsetLeft,e+=c.offsetTop,c=c.offsetParent;return{top:e,left:a}},result:function(c,a){var e=c[a];return f.isFunc(e)?e():e}}});
handy.add("Array","B.Object",function(f,b){function c(a){return a}function a(a){return function(d){return d[a]}}function e(d){return null==d?c:b.isFunc(d)?d:a(d)}function g(a){return function(d){if(d===a)return!0;for(var e in a)if(a[e]!==d[e])return!1;return!0}}function d(a){return function(d,c,b){var g={};c=e(c);f.each(d,function(e,h){var f=c.call(b,h,e,d);a(g,f,h)});return g}}var h={map:function(a,d,e){var c=[];if(null==a)return c;var b=Array.prototype.map;if(b&&a.map===b)return a.map(d,e);f.each(a,
function(a,b){c.push(d.call(e,b,a))});return c},pluck:function(d,e){return this.map(d,a(e))},some:function(a,d,e){var c=!1;if(null==a||!d)return c;var g=Array.prototype.some;if(g&&a.some===g)return a.some(d,e);b.each(a,function(a,b,g){if(c||(c=d.call(e,b,a,g)))return!1});return!!c},every:function(a,d,e){var c=!0;if(null==a||!d)return c;var g=Array.prototype.every;if(g&&a.every===g)return a.every(d,e);b.each(a,function(a,b,g){if(!(c=d.call(e,b,a,g)))return!1});return!!c},indexOf:function(a,d,e){if(null==
a)return-1;var c=0,b=a.length;if(e)if("number"==typeof e)c=0>e?Math.max(0,b+e):e;else return c=h.sortedIndex(a,d),a[c]===d?c:-1;var g=Array.prototype.indexOf;if(g&&a.indexOf===g)return a.indexOf(d,e);for(;c<b;c++)if(a[c]===d)return c;return-1},find:function(a,d,e){var c;this.some(a,function(a,b,g){if(d.call(e,a,b,g))return c=a,!0});return c},filter:function(a,d,e){var c=[];if(null==a)return c;var g=Array.prototype.filter;if(g&&a.filter===g)return a.filter(d,e);b.each(a,function(a,b,g){d.call(e,b,
a,g)&&c.push(b)});return c},where:function(a,d){return this.filter(a,g(d))},findWhere:function(a,d){return this.find(a,g(d))},invoke:function(a,d){var e=Array.prototype.slice.call(arguments,2),c=f.isFunc(d);return this.map(a,function(a){return(c?d:a[d]).apply(a,e)})},sortedIndex:function(a,d,c,b){c=e(c);d=c.call(b,d);for(var g=0,h=a.length;g<h;){var f=g+h>>>1;c.call(b,a[f])<d?g=f+1:h=f}return g},sortBy:function(a,d,c){d=e(d);return this.pluck(this.map(a,function(a,e,b){return{value:a,index:e,criteria:d.call(c,
a,e,b)}}).sort(function(a,d){var c=a.criteria,e=d.criteria;if(c!==e){if(c>e||void 0===c)return 1;if(c<e||void 0===e)return-1}return a.index-d.index}),"value")},groupBy:d(function(a,d,c){a[d]?a[d].push(c):a[d]=[c]}),countBy:d(function(a,d){a[d]?a[d]++:a[d]=1})};return h});
handy.add("Geo",function(f){return{distance:function(b,c,a){function e(a){a.get?a=[a.get("latitude"),a.get("longitude")]:f.isObj(a)&&(a=[a.latitude,a.longitude]);return a}var g,d;b=e(b);g=b[0];b=b[1];c=e(c);d=c[0];c=c[1];g=g*Math.PI/180;d=d*Math.PI/180;b=6371*Math.acos(Math.cos(d)*Math.cos(g)*Math.cos(b*Math.PI/180-c*Math.PI/180)+Math.sin(d)*Math.sin(g));b=b.toFixed(2);if(!1!=a){if(isNaN(b))return"\u672a\u77e5";b+="km"}return b}}});
handy.add("Template",["B.Object","B.String","B.Debug","B.Function"],function(f,b,c){function a(a){var d=typeof a;"string"!==d&&(a="number"===d?a+"":"");return a}function e(a,d){var c=d.fn,e="";if(a){if(void 0!==a.length)for(var b=0,g=a.length;b<g;b++)e+=c(a[b]);else for(b in a)e+=c(a[b]);return e}}function g(a,d){var c=d.fn,e=[];if(a){if(void 0!==a.length)for(var b=0,g=a.length;b<g;b++)e.push(c(a[b]));else for(b in a)e.push(c(a[b]));return e.join("")}}function d(a){a=a.replace(/("|\\)/g,"\\$1").replace(/\r/g,
"\\r").replace(/\n/g,"\\n");return q?"$r+="+('"'+a+'"')+";":"$r.push("+('"'+a+'"')+");"}function h(a,d){d=d||{};var c=a.exp.replace(/"/g,"'"),c=b.trim(c).replace(/\s{2,}/g," "),e=d.helpers,g=e&&e.parseValue,h=a.blockName,f=a.children,j=a.num,p,n="\nif($tmp||$tmp===0){"+(q?"$r+=$tmp;":"$r.push($tmp);")+"}";p=(a.inverse?"inverse:true,":"")+"num:"+j+',context:$me,exp:"'+c+'",helpers:$helpers,data:$data}';e=e&&e.getValue?'$helpers.getValue.call($me,"'+c+'",$data,{'+p+")":"($data&&$data."+c+")";h?(c="$program"+
j,p='$tmp = $helpers["'+h+'"].call($me,'+e+", {fn:"+c+","+p+");"+n,f&&(n=m(f,d),n=s[0]+"\n"+n.join("\n")+"\n"+s[1],k.splice(2,0,"\nfunction "+c+"($data){\n"+n+"\n}\n"))):((f=c.match(/([^\s]+)\s([^\n]+)/))?(c=f[1],p="if (helper = $helpers."+c+') {\n$tmp = helper.call($me,"'+f[2]+'",{'+p+'); \n}else{$tmp="";}'):p="if (helper = $helpers."+c+') {\n$tmp = helper.call($me,"",{'+p+"); \n}else{\nhelper = "+e+"; $tmp = typeof helper === functionType ? helper.call($me,{"+p+") : helper;\n}"+(g?"\n$tmp=$helpers.parseValue.call($me,$tmp,{"+
p+");":l.isEscape?"\n$tmp=escape($tmp);":""),p+=n);return p}function j(a,d){if(a){var e=d||{},b=l.openTag,g=l.closeTag,h,f;e.children?f=e.children:e.children=f=[];if(0<=(h=a.indexOf(b))){var m=a.substring(0,h);m&&f.push({html:m});a=a.substring(h+b.length);if(0==a.indexOf("#"))if(a=a.substring(1),m=a.match(/^[a-z]+/)){var p=m[0];h=a.indexOf(g);m=a.substring(p.length+1,h);a=a.substring(h+g.length);m={num:++v,blockName:p,exp:m};f.push(m);var k=b+"/"+p+g;a:{h=a;for(var g=RegExp(b+"[#/]"+p+"((?!"+g+").)*"+
g,"ig"),n=0;b=g.exec(h);)if(b[0]==k)if(0==n){h=b.index;break a}else n--;else n++;h=-1}if(-1==h){c.error("\u672a\u627e\u5230\u5757\u7ed3\u675f\u4f4d\u7f6e:"+k);return}b=a.substring(0,h);a=a.substring(h+k.length);j(b,m);if("if"==p){p=m.children;k=0;for(b=p.length;k<b;k++)g=p[k],"else"==g.exp&&(g.exp=m.exp,g.blockName="if",g.num=++v,g.inverse=!0,g.children=p.slice(k+1),f.push(g),m.children=p.slice(0,k))}}else{c.error("\u627e\u4e0d\u5230\u8f85\u52a9\u51fd\u6570:"+a);return}else h=a.indexOf(g),f.push({num:++v,
exp:a.substring(0,h)}),a=a.substring(h+g.length);j(a,e)}else a&&f.push({html:a});return e}}function m(a,e){var c=[];if(a)for(var b=0,g=a.length;b<g;b++){var f=a[b];f.html?c.push(d(f.html)):f.exp&&c.push(h(f,e))}return c}var l={openTag:"{{",closeTag:"}}",isTrim:!0,isEscape:!1,getIfPlusJoin:function(){return q},registerHelper:function(a,d,c){f.isObj(d)?(p[a]||(p[a]={}),f.extend(p[a],d)):p[a][d]=c},tmpl:function(a,d,e){var b,g,h;if("string"==typeof a)b=a;else if(void 0!==a.length)b=a.join("");else if(b=
a.tmpl,h=a.id)if(n[h])g=n[h];else if(!b){var q=document.getElementById(h);q&&(b=(q.value||q.innerHTML).replace(/\s/g,""))}if(!g){if(!b){c.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}a:{var q=l.openTag,z=l.closeTag;b=b.replace(RegExp(q+"!((?!"+z+").)*"+z,"ig"),"");l.isTrim&&(b=b.replace(/^[\s\n]+/,"").replace(/[\s\n]+$/,"").replace(RegExp("("+z+"|\\>)(\\s|\\n)+(?=("+q+"|<))","ig"),"$1").replace(RegExp(z+"[\\s\\n]+([^\\n]+)[\\s\\n]+(?=("+q+"|<))","ig"),z+"$1"));k=[s[0]];k.push('var escape=$helpers.escape,functionType="function",$me=this;');
var q=a&&a.ns,r;q?(r=f.extend({},p["default"]),r=f.extend(r,p[q])):r=p["default"];a.helpers=r;b=j(b);v=0;a=m(b.children,a);k=k.concat(a);k.push(s[1]);a=k.join("\n");try{var u=window.Function.apply(null,["$T","$helpers","$data",a]);g=function(a,d){return u.call(d||a,l,r,a)};break a}catch(w){c.log(a),c.error(w)}g=void 0}h&&(n[h]=g)}if(d)try{return g(d,e)}catch(I){c.log(g.toString()),c.error(I)}else return g}},n={},k,q="".trim,v=0,s=["var $r="+(q?'""':"[]")+",$tmp,helper;","return "+(q?"$r;":'$r.join("");')],
p={"default":{"if":function(a,d){var c=d.data;f.isFunc(a)&&(a=a.call(c));if(a&&!d.inverse||!a&&d.inverse)return d.fn(c)},unless:function(a,d){d.inverse=!0;return d.helpers["if"].call(this,a,d)},each:q?e:g,escape:function(d){return b.encodeHTML(a(d))},trim:b.trim}};return l});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(f,b,c){function a(a){if(a==l)return!1;var d=m.contentWindow.document;d.open();d.write("<!doctype html><html><body>"+a+"</body></html>");d.close();l=a;f.log("set:"+m.contentWindow.document.body.innerText)}function e(){var d=b.getHash(),c=m.contentWindow.document.body.innerText;d!=l?(a(d),g(d)):c!=l&&(f.log("update:"+m.contentWindow.document.body.innerText),b.setHash(c))}function g(a){var d=q.listeners,c;for(c in d)d[c](a)}var d,
h=0,j=document,m,l,n=j.documentMode,k="onhashchange"in window&&(void 0===n||7<n),q={delay:50,listen:function(f,l){if(!d&&!d)if(d=!0,q.listeners={},k)$(window).on("hashchange",function(){g(b.getHash())});else m=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(j.body)[0],$(m).one("load",function(){a(b.getHash());setInterval(e,q.delay)});if(l in q.listeners)$D.error(Error("Duplicate name"));else return l=l||c.expando+ ++h,q.listeners[l]=f,l},unListen:function(a){for(var d in q.listeners)(!a||
a==d)&&delete q.listeners[d]}};return q});handy.add("Support","B.Browser",function(f){var b={mediaQuery:function(){var a;if(f.mobile())a="hui-mobile";else{a="hui-pc";var c=f.ie();c&&(a+=" ie"+c)}document.documentElement.className+=" "+a}};b.mediaQuery();if(6==f.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(c){}return b});
handy.add("Validator",["B.String","B.Object"],function(f,b){var c={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(a,e){var b=e.rules,d;for(d in b){var h=b[d],f=("function"==typeof h?h:c[d])(a,h);if(!f)return b=e.error||c.error,d=e.messages&&
e.messages[d]||c.messages[d],d=d.replace(/\{([^\}]+)\}/g,function(a,d){return h[d]||0==d&&h||e[d]||h||""}),b&&b(d),f}return!0},required:function(a){return 0<f.trim(""+a).length},email:function(a){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a){return!/Invalid|NaN/.test((new Date(a)).toString())},dateISO:function(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a){return/^\d+$/.test(a)},creditcard:function(a){if(/[^0-9 \-]+/.test(a))return!1;var c=0,b=0,d=!1;a=a.replace(/\D/g,"");for(var h=a.length-1;0<=h;h--){b=a.charAt(h);b=parseInt(b,10);if(d&&9<(b*=2))b-=9;c+=b;d=!d}return 0===c%10},min:function(a,c){return a>=c},max:function(a,
c){return a<=c},range:function(a,c){return a>=c[0]&&a<=c[1]},minlength:function(a,c){return(b.isArr(a)?a.length:f.trim(""+a).length)>=c},maxlength:function(a,c){return(b.isArr(a)?a.length:f.trim(""+a).length)<=c},rangelength:function(a,c){var g=b.isArr(a)?a.length:f.trim(""+a).length;return g>=c[0]&&g<=c[1]},equalTo:function(a,c){return a===c}};return c});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(f,b,c){b={_init:function(){!a&&f.ie()&&(g=document.getElementById("LocalStorageUserDataDiv"),g||(g=document.createElement("DIV"),g.style.display="none",g.id="LocalStorageUserDataDiv",g.addBehavior("#default#userData"),document.body.appendChild(g),g.load(d)))},getItem:function(d){d=a?e.getItem(d):g.getAttribute(d);return d=c.parseJson(d)},setItem:function(b,f){f=c.stringify(f);try{a?e.setItem(b,f):(g.setAttribute(b,f),g.save(d))}catch(m){return $D.error(m),
!1}return!0},removeItem:function(c){a?e.removeItem(c):(g.removeAttribute(c),g.save(d))},clear:function(){a?e.clear():g.unload()}};var a=window.localStorage&&window.localStorage.getItem,e=window.localStorage,g,d=document.domain;b._init();return b});(function(f){Hui=H=$H=f.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};f=window.$;f.fn.remove=$H.intercept(f.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
$Define("CM.AbstractEvents",function(){var f=$H.createClass();$H.extend(f.prototype,$H.Events);$H.extend(f.prototype,{initialize:function(){this._eventCache={};this._listenTo=[]},_parseListenToEvents:function(b,c,a,e){var g=this,d=$H.toArray(arguments,3);return g._parseEvents(a,function(a){a.unshift(c);g[b].apply(g,a.concat(d))})},listenTo:function(b,c,a,e,g){if(!this._parseListenToEvents("listenTo",b,c,a,e,g)){"number"==typeof e&&(g=e,e=null);e=e||this;var d=this._delegateHandler(a,e);this._listenTo.push({target:b,
name:c,delegation:d,handler:a});b.on(c,d,e,g)}},unlistenTo:function(b,c,a){if(!this._parseListenToEvents("unlistenTo",b,c,a)){var e=this._listenTo,g="all"==b;$H.each(e,function(d,h){if(g||h.name==c&&h.handler==a&&h.target==b)h.target.off(h.name,h.delegation),e.splice(d,1)})}}});return f});
$Define("CM.DataStore",function(){var f=$H.createClass();$H.extend(f.prototype,{get:function(c,a){var e;if(e=b[c])return a?$H.where(e,a):e},push:function(c,a){"string"!=typeof c&&(a=c,c=null);var e=a.constructor.$ns;(b[e]||(b[e]=[])).push(a);c&&(b[c]||(b[c]=a))}});var b={};$S=$H.getSingleton(f);return f});
$Define("CM.AbstractDao","B.LocalStorage",function(f){var b=$H.createClass();$H.extend(b.prototype,{_ajaxMethodMap:{create:"POST",update:"POST",patch:"PATCH","delete":"DELETE",read:"GET"},_localMethodMap:{create:"setItem",update:"setItem",patch:"setItem","delete":"removeItem",read:"getItem"},ajax:function(c){c=this.parseParam(c);var a=$H.intercept(c.error,this.error);c.error=$H.intercept(a,c.beforeErr);a=$H.intercept(c.success,this.success);c.success=$H.intercept(a,c.beforeSucc);c.beforeSend=$H.intercept($H.bind(this.beforeSend,
this),c.beforeSend);c.complete=$H.intercept($H.bind(this.complete,this),c.complete);return $.ajax(c)},parseParam:$H.noop,beforeSend:function(){this.showLoading(!0)},complete:function(){this.showLoading(!1)},error:$H.noop,success:$H.noop,showLoading:$H.noop,get:function(){},set:function(){},remove:function(){},sync:function(c,a,e){e=e||{};var b=e.storeType||"remote",d={type:"POST",dataType:"json"};e.url||(d.url=a.getUrl());if(null==e.data&&a&&("create"===c||"update"===c||"patch"===c))d.data=e.attrs||
a.toJSON(e);if("remote"==b)d.url+="/"+c+".do",$H.extend(d,e),this.ajax(d);else f[this._localMethodMap[c]](d);a.trigger("request",a,e)}});return b});
$Define("CM.Model",["CM.AbstractDao","CM.AbstractEvents","CM.DataStore"],function(f,b){return b.derive({idAttribute:"id",_pending:!1,_validate:function(c,a){if(!a.validate||!this.validate)return!0;c=$H.extend({},this._attributes,c);var e=this.validationError=this.validate(c,a)||null;if(!e)return!0;this.trigger("invalid",this,e,$H.extend(a,{validationError:e}));return!1},_doDepends:function(c,a){var e=this.fields,b,d,h={},f;for(f in e)if((b=e[f])&&(d=b.depends))for(b=0;b<d.length;b++)if(c.hasOwnProperty(d[b])){h[f]=
0;break}this.set(h,null,{silent:a})},_parseFields:function(c){var a;if(!(a=this.fields))return c;var e,b,d,h={},f;for(f in c){b=c[f];if(e=a[f]){d=e.type;if(e=e.parse)b=e.apply(this,[b,c]);$H.isStr(d)&&("Date"==d?b=$H.parseDate(b):0<d.indexOf(".")&&(d=$H.ns(d)));$H.isClass(d)&&!(b instanceof d)&&(b=new d(b),b.on("all",$H.bind(this._onAttrEvent,this,f)))}h[f]=b}return h},_onAttrEvent:function(c,a){if(!("invalid"==a||"sync"==a)){var b=this.get(c);0!=a.indexOf("change:")&&(this.trigger("change:"+c,this,
b),this.trigger("change",this))}},initialize:function(c,a){this.callSuper();this.uuid=$H.uuid();this.dao=this.dao||$H.getSingleton(f);var b=c||{};a||(a={});this.cid=$H.Util.uuid();this._attributes={};a.collection&&(this.collection=a.collection);a.parse&&(b=this.parse(b,a)||{});b=$H.extendIf(b,this.getDefaults());this.set(b,a);this._changed={};$S.push(this)},getDefaults:function(){var c={},a;if(a=this.fields)for(var b in a){var g=a[b];c[b]=g&&$H.isObj(g)?g.def:g}return c},toJSON:function(){return $H.clone(this._attributes)},
sync:function(c,a,b){return this.dao.sync(c,a,b)},get:function(c){return this._attributes[c]},escape:function(c){return $H.String.escapeHTML(this.get(c))},has:function(c){c=this.get(c);return null!==c&&void 0!==c},set:function(c,a,b){var g;"object"===typeof c?(g=c,b=a):(g={})[c]=a;b||(b={});g=this._parseFields(g);if(!this._validate(g,b))return!1;var d=b.unset;c=b.silent;var h={},f=this._changing;this._changing=!0;f||(this._previousAttributes=$H.Object.clone(this._attributes),this._changed={});var m=
this._attributes,l=this._previousAttributes;this.idAttribute in g&&(this.id=g[this.idAttribute]);for(var n in g)a=g[n],$H.equals(m[n],a)||(h[n]=a),$H.equals(l[n],a)?delete this._changed[n]:this._changed[n]=a,d?delete m[n]:m[n]=a;a=!$H.isEmpty(h);if(!c){a&&(this._pending=b);for(var k in h)this.trigger("change:"+k,this,m[k],b)}if(f)return this;if(!c)for(;this._pending;)b=this._pending,this._pending=!1,this.trigger("change",this,b);this._changing=this._pending=!1;a&&this._doDepends(h,c);return this},
unset:function(c,a){a=a||{};a.unset=!0;return this.set(c,void 0,a)},clear:function(c){var a={},b;for(b in this._attributes)a[b]=void 0;c=c||{};c.unset=!0;return this.set(a,c)},each:function(c){$H.each(this._attributes,c)},hasChanged:function(c){var a=this._changed;return null==c?!$H.isEmpty(a):$H.contains(a,c)},changedAttrbutes:function(c){if(!c)return this.hasChanged()?$H.clone(this._changed):!1;var a,b=!1,g=this._changing?this._previousAttributes:this._attributes,d;for(d in c)if(!$H.equals(g[d],
a=c[d]))(b||(b={}))[d]=a;return b},previous:function(c){return null==c||!this._previousAttributes?null:this._previousAttributes[c]},fetch:function(c){var a=this;c=c?$H.clone(c):{};void 0===c.parse&&(c.parse=!0);var b=c.success,g=c.beforeSet;c.success=function(d){if(!(g&&!1==g(a,d,c))){if(!a.set(a.parse(d,c),c))return!1;b&&b(a,d,c);a.trigger("sync",a,d,c)}};a.sync("read",a,c)},save:function(c,a,b){var g=this,d;null==c||"object"===typeof c?(d=c,b=a):(d={})[c]=a;$H.isFunc(b)&&(b={success:b});b=$H.extend({validate:!0},
b);if(d&&b.now){if(!g.set(d,b))return!1}else if(!g._validate(d,b))return!1;void 0===b.parse&&(b.parse=!0);var h=b.success;b.success=function(a){var c=g.parse(a,b);b.now||(c=$H.extend(d||{},c));if($H.isObj(c)&&!g.set(c,b))return!1;h&&h(g,a,b);g.trigger("sync",g,a,b)};c=g.isNew()?"create":b.update?"update":"patch";if("patch"===c){a=g.changedAttrbutes(d);if(!a){h&&h(g,b);return}b.attrs=a}else a=$H.extend({},g._attributes),b.attrs=$H.extend(a,d);g.sync(c,g,b)},destroy:function(b){var a=this;b=b?$H.clone(b):
{};var e=b.success,g=function(){a.trigger("destroy",a,a.collection,b);a.off("all")};b.success=function(d){(!b.now||a.isNew())&&g();e&&e(a,d,b);a.isNew()||a.trigger("sync",a,d,b)};if(a.isNew())return b.success(),!1;a.sync("delete",a,b);b.now&&g()},getUrl:function(){var b=$H.result(this,"url")||$H.result(this.collection,"url");b||$D.error(Error("\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2aurl\u5c5e\u6027\u6216\u8005\u51fd\u6570"));return this.isNew()?b:b.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},
parse:function(b){return b.code&&b.data?b.data:b},clone:function(){return new this.constructor(this._attributes)},isNew:function(){return void 0===this.id},isValid:function(b){return this._validate({},$H.extend(b||{},{validate:!0}))}})});
$Define("CM.Collection",["CM.AbstractDao","CM.AbstractEvents","CM.Model","CM.DataStore"],function(f,b,c){var a=b.derive({model:c,_reset:function(){this.length=0;this._models=[];this._byId={}},_prepareModel:function(a,d){if(a instanceof c)return a;d=d?$H.clone(d):{};d.collection=this;var b;if(d.id&&(b=(b=$S.get(this.model.$ns,{id:d.id}))&&b[0]))return b.set(a,d),b;b=new this.model(a,d);if(!b.validationError)return b;this.trigger("invalid",this,b.validationError,d);return!1},_addReference:function(a){this._byId[a.cid]=
a;null!=a.id&&(this._byId[a.id]=a);a.collection||(a.collection=this);a.on("all",this._onModelEvent,this)},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,d,b,c){("add"===a||"remove"===a)&&b!==this||("destroy"===a&&this.remove(d,c),d&&a==="change:"+d.idAttribute&&(delete this._byId[d.previous(d.idAttribute)],null!=d.id&&(this._byId[d.id]=d)),this.trigger.apply(this,arguments))},initialize:function(a,d){this.callSuper();
this.dao=this.dao||$H.getSingleton(f);d||(d={});d.model&&(this.model=d.model);d.url&&(this.url=d.url);void 0!==d.comparator&&(this.comparator=d.comparator);this._reset();a&&this.reset(a,$H.extend({silent:!0},d))},toJSON:function(a){return $H.map(this._models,function(d){return d.toJSON(a)})},sync:function(a,d,b){return this.dao.sync(a,d,b)},add:function(a,d){d=$H.extend({add:!0,remove:!1,merge:!1},d);return this.set(a,d)},remove:function(a,d){var b=!$H.isArr(a);a=b?[a]:$H.clone(a);d||(d={});var c,
e,f,n;c=0;for(e=a.length;c<e;c++)if(n=a[c]=this.get(a[c]))delete this._byId[n.id],delete this._byId[n.cid],f=this.indexOf(n),this._models.splice(f,1),this.length--,d.silent||(d.index=f,n.trigger("remove",n,this,d)),this._removeReference(n,d);return b?a[0]:a},set:function(a,d){if(a){d=$H.extend({add:!0,remove:!0,merge:!0},d);d.parse&&(a=this.parse(a,d));var b=!$H.isArr(a),e=b?a?[a]:[]:$H.clone(a),f,l,n,k,q,v,s,p=d.at,F=this.model,B=this.comparator&&null==p&&!1!==d.sort,G="string"==typeof this.comparator?
this.comparator:null,x=[],A=[],t={},y=d.add,z=d.merge,r=d.remove,u=!B&&y&&r?[]:!1;f=0;for(l=e.length;f<l;f++){q=e[f]||{};n=q instanceof c?k=q:q[F.prototype.idAttribute||"id"];if(v=this.get(n))r&&(t[v.cid]=!0),z&&(q=q===k?k.attributes:q,d.parse&&(q=v.parse(q,d)),v.set(q,d),B&&(!s&&v.hasChanged(G))&&(s=!0)),e[f]=v;else if(y){d.id=n;k=e[f]=this._prepareModel(q,d);if(!k)continue;x.push(k);this._addReference(k,d)}k=v||k;u&&(k.isNew()||!t[k.id])&&u.push(k);t[k.id]=!0}if(r){f=0;for(l=this.length;f<l;++f)t[(k=
this._models[f]).cid]||A.push(k);A.length&&this.remove(A,d)}if(x.length||u&&u.length)if(B&&(s=!0),this.length+=x.length,null!=p){f=0;for(l=x.length;f<l;f++)this._models.splice(p+f,0,x[f])}else{u&&(this._models.length=0);n=u||x;f=0;for(l=n.length;f<l;f++)this._models.push(n[f])}s&&this.sort({silent:!0});if(!d.silent){f=0;for(l=x.length;f<l;f++)(k=x[f]).trigger("add",k,this,d);(s||u&&u.length)&&this.trigger("sort",this,d)}return b?e[0]:e}},each:function(a){$H.each(this._models,a)},reset:function(a,
d){d||(d={});for(var b=0,c=this._models.length;b<c;b++)this._removeReference(this._models[b],d);d.previousModels=this._models;this._reset();a&&(a=this.add(a,$H.extend({silent:!0},d)));d.silent||this.trigger("reset",this,d);return a},push:function(a,d){return this.add(a,$H.extend({at:this.length},d))},pop:function(a){var d=this.at(this.length-1);this.remove(d,a);return d},unshift:function(a,d){return this.add(a,$H.extend({at:0},d))},shift:function(a){var d=this.at(0);this.remove(d,a);return d},slice:function(){return Array.prototype.slice.apply(this._models,
arguments)},get:function(a){return null==a?void 0:this._byId[a]||this._byId[a.id]||this._byId[a.cid]},size:function(){return this.length},at:function(a){return this._models[a]},where:function(a,d){return $H.isEmpty(a)?d?void 0:[]:this[d?"find":"filter"](function(d){for(var b in a)if(a[b]!==d.get(b))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){this.comparator||$D.error(Error("\u6ca1\u6709\u6bd4\u8f83\u5668"));a||(a={});"string"==typeof this.comparator||1===this.comparator.length?
this._models=this.sortBy(this.comparator,this):this._models.sort($H.Function.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return $H.invoke(this._models,"get",a)},getUrl:function(){return this.url},fetch:function(a){var d=this;a=a?$H.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=a.success,c=a.beforeSet;a.success=function(e){c&&!1==c(d,e,a)||(d[a.reset?"reset":a.add?"add":"set"](e,a),b&&b(d,e,a),d.trigger("sync",d,e,a))};return d.sync("read",d,
a)},create:function(a,d){var b=this;d=d?$H.clone(d):{};if(!(a=b._prepareModel(a,d)))return!1;d.now&&b.add(a,d);var c=d.success;d.success=function(a,e){d.now||b.add(a,d);c&&c(a,e,d)};a.save(null,d);return a},parse:function(a){return a.data},clone:function(){return new this.constructor(this._models)}}),e=$H.Array;$H.each("map some every find filter invoke indexOf".split(" "),function(b,d){a.prototype[d]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(this._models);return e[d].apply(e,
a)}});$H.each(["sortBy","groupBy","countBy"],function(b){a.prototype[b]=function(a,c){var f=$H.isFunc(a)?a:function(b){return b.get(a)};return e[b](this._models,f,c)}});return a});
$Define("CM.AbstractManager",function(){var f=$H.createClass();$H.extend(f.prototype,{initialize:function(){this._types={};this._all={}},type:"manager",registerType:function(b,c){this._types[b]=c;c.prototype.xtype=b},getClass:function(b){return $H.isClass(b)?b:this._types[b]||$H.ns(b)},register:function(b,c){var a=b.cid=c.cid||$H.uuid(),e=b._id=this.generateId(a,b.xtype);this._all[e]=b;this._all[a]=b},unregister:function(b){var c=this._all,a=b.getId(),e=b.getCid();c[a]==b&&delete c[a];c[e]==b&&delete c[e]},
eachInEl:function(b,c){var a=this;b.find(".js-"+a.type).each(function(b,g){g=$(g);var d=g.attr("id");(d=a.get(d))&&c(d)})},generateId:function(b,c){var a=$H.expando+"-"+this.type+"-"+c+"-"+(b||$H.uuid());if(this._all[a])$D.error("id\u91cd\u590d:"+a);else return a},get:function(b){return this._all[b]}});return f});
$Define("CM.ViewManager","CM.AbstractManager",function(f){var b=$H.createClass();$H.inherit(b,f,{type:"view",initialize:function(){var b=this;b.callSuper();$H.on("afterRender",function(a,e){b.afterRender(e)});$H.on("removeEl",function(a,e){b.destroy(e)})},afterRender:function(b){this.eachInEl(b,function(a){a.afterRender()})},destroy:function(b){this.eachInEl(b,function(a){a.destroy(!0)})}});$V=$H.getSingleton(b);return b});
$Define("CM.AbstractView",["CM.ViewManager","CM.AbstractEvents"],function(f,b){return b.derive({xtype:"View",renderBy:"append",autoRender:!0,listeners:[],_parseListenEvents:function(b,a){var e=this;return e._parseEvents(a.name,function(g){var d=$H.extend({},a);d.name=g[0];2==g.length&&(d.handler=g[1]);e[b].call(e,d)})},initialize:function(b){this.callSuper();this._listeners=[];this.listeners=$H.clone(this.listeners);this.manager=this.constructor.manager||$H.getSingleton(f);this.manager.register(this,
b);this.doConfig(b);this.init(b);this.parseItems();!1!=this.autoRender&&this.render();this.inited=!0},init:$H.noop,doConfig:function(b){b=(this.initParam=b)||{};$H.extend(this,b);var a;this.renderTo=(a=b.renderTo)?$(a):$(document.body)},getId:function(){return this._id},getCid:function(){return this.cid},getEl:function(){return this._container},getHtml:function(){return this.html},render:function(){var b=this.getHtml();this.renderTo[this.renderBy](b);this._container=$("#"+this.getId());this.initListeners()},
findEl:function(b){return this.getEl().find(b)},parseItems:$H.noop,callChild:$H.noop,listen:function(b){if(!this._parseListenEvents("listen",b)){var a=b.name,e=b.context,g=b.times,d=b.target,f=b.custom||d||$H.contains(this._customEvents,a),j=b.handler;$H.isFunc(d)&&(d=d.call(this));if(f)b=$H.removeUndefined([d,a,j,e,g]),this[d?"listenTo":"on"].apply(this,b);else if(this.listened){var d=this._listeners,g=b.el,f=b.method||"bind",m=b.selector,l=b.data,e=b.delegation=this._delegateHandler(j,e);$H.isFunc(g)&&
(g=g.call(this));g=g?"string"==typeof g?this.findEl(g):g:this.getEl();if(m)if(l)g[f](m,a,l,e);else g[f](m,a,e);else if(l)g[f](a,l,e);else g[f](a,e);d.push(b)}else this.listeners.push(b)}},unlisten:function(b){if(!this._parseListenEvents("unlisten",b)){var a=b.name,e=b.handler;if(b.custom)this.off(a,e);else{var g=b.el,d="delegate"==b.method?"undelegate":"unbind";b=b.selector;for(var f,g=g?"string"==typeof g?this.findEl(g):g:this.getEl(),j=this._listeners.length-1;0<=j;j--){var m=this._listeners[j];
if(m.handler==e){f=m.delegation;this._listeners.splice(j,1);break}}if(b)g[d](b,a,f);else g[d](a,f)}}},initListeners:function(){if(this.listened)return!1;this.listened=!0;for(var b=this.listeners,a=b.length-1;0<=a;a--)this.listen(b[a]);this.callChild()},clearListeners:function(){for(var b=this._listeners,a=b.length-1;0<=a;a--)this.unlisten(b[a]);this.off("all");this.unlistenTo("all");this.callChild()},destroy:function(){if(!this.destroyed)return this.clearListeners(),this.unlistenTo("all"),this.getEl().remove(),
this.destroyed=!0,this.manager.unregister(this),delete this._container,delete this.renderTo,delete this.html,!0}})});
$Define("CM.ModelView",["B.Template","CM.AbstractView","CM.Model","CM.Collection"],function(f,b,c,a){function e(a,b){return b.get?b.get(a):b[a]}function g(a,b){for(var c=b.context,e=b.data,g=b.num,f=b.type,j="bindAttr-"+(c.getCid()+"-"+g),l=[],k=[],n=c.ifBind(g,e),q=f&&c.ifBind(g,e,!0);g=m.exec(a);)"id"==g[2]?j=0==g[3].indexOf("this.")?c[g[3].substring(5)]:d(g[3],e):k.push(g);l.push('id="'+j+'"');for(var w,s,v,C,D=0,J=k.length;D<J;D++){g=k[D];s=g[2];w=g[3];w=w.split(" ");v=[];for(var E=0;E<w.length;E++)((C=
h(c,j,s,w[E],n,q,e))||0===C)&&v.push(C);w=v.join(" ");s?(f&&"value"==s&&(b.value=w),w=(g[1]||"")+w+g[4]):w&&(w=w+'="'+w+'"');w&&l.push(w)}return" "+l.join(" ")+" "}function d(a,b){return!a?a:0==a.indexOf("#")?a.substring(1):e(a,b)}function h(a,b,c,e,g,f,h){var j;b="#"+b;var l=e.indexOf("?"),m=e.indexOf(":");if(0==e.indexOf("this."))return a[e.substring(5)];if(0<l||0<m){f=e.substring(0,0<l?l:m);var k=0>l?"":e.substring(l+1,0<m?m:e.length),n=0>m?"":e.substring(m+1,e.length);j=d(f,h);g&&0!=f.indexOf("#")&&
a.listenTo(h,"change:"+f,function(a,d,e){a=$(b);c?"class"==c?e?(n&&a.removeClass(n),k&&a.addClass(k)):(k&&a.removeClass(k),n&&a.addClass(n)):a.attr(c,e?k:n):e?a.prop(k,!0):a.prop(k,!1)});return j?k:n}j=d(e,h);0!=e.indexOf("#")&&(g&&a.listenTo(h,"change:"+e,function(a,d,e){a=$(b);"class"==c?(a.removeClass(j),a.addClass(e),j=e):a.attr(c,e||"")}),"value"==c&&f&&a.listen({name:"input propertychange",el:b,handler:function(a){h.set(e,a.target.value)}}));return j}b=b.derive({bindType:"both",initialize:function(){this._bindModelNums=
{};this._bindElNums={};this.callSuper()},doConfig:function(){this.callSuper();var a=this.modelClass||c;this.model||(this.model=new a(this.data));this.xmodel=this.model},preTmpl:function(){var a=this.tmpl;$H.isArr(a)&&(a=a.join(""));var b=n.test(a),d="#js-"+this.manager.type+" #js-"+this.xtype;if(b){if(b=a.match(k)[1])v.test(a)||(b=b.replace(/([^\s]+)/g,"#$1")),d+=" "+b;a=a.replace(k,"")}d=' id=this._id class="'+d+'"';this.tmpl=a=q.test(a)?a.replace(s,"$1"+d):a.replace(l,"$1 {{bindAttr"+d+"}}")},getTmplFn:function(){var a=
this.tmpl,b=this.constructor;if(!$H.isFunc(a)&&!$H.isFunc(a=b.tmpl))this.preTmpl(),a=b.tmpl=$H.tmpl({tmpl:this.tmpl,ns:"ModelView"});return this.tmpl=a},getHtml:function(){return this.html?this.html:this.html=this.getTmplFn()(this.xmodel,this)},ifBind:function(b,d,e){if(!e&&"el"==this.bindType||e&&"model"==this.bindType)return!1;e=e?this._bindElNums:this._bindModelNums;d=!e[b]&&(d&&(d instanceof c||d instanceof a)||!d);e[b]=1;return d},updateMetaMorph:function(a,b,d){if("append"==d)$("#metamorph-"+
a+"-end").before(b);else{var c=$("#metamorph-"+a+"-start");if(0!=c.length){a="metamorph-"+a+"-end";for(var e=c[0].nextSibling,g;e&&e.id!=a;)g=$(e),e=e.nextSibling,g.remove();b&&c.after(b);"remove"==d&&(c.remove(),$(e).remove())}}},wrapMetaMorph:function(a,b){return'<script id="metamorph-'+a+'-start" type="text/x-placeholder">\x3c/script>'+(b||"")+'<script id="metamorph-'+a+'-end" type="text/x-placeholder">\x3c/script>'},get:function(a){return this.xmodel.get(a)},set:function(a,b){this.xmodel.set(a,
b)},update:function(a){this.xmodel.set(a)},getXmodel:function(){return this.xmodel}});f.registerHelper("ModelView",{"if":function(a,b){var d=b.context,c=b.data,e=b.exp;$H.isFunc(a)&&(a=a.call(c));var g;if(a&&!b.inverse||!a&&b.inverse)g=b.fn(c);var f=b.num,h=d.getCid()+"-"+f;d.ifBind(f,c)&&d.listenTo(c,"change:"+e,function(a,c,g){var f;if(g&&!b.inverse||!g&&b.inverse)a={},a[e]=g,f=b.fn(a);d.updateMetaMorph(h,f)});return d.wrapMetaMorph(h,g)},unless:function(a,b){b.inverse=!0;return b.helpers["if"].call(this,
a,b)},each:function(b,d){var c=d.context,e=d.fn,g=j?"":[],f=d.num,h=c.getCid()+"-"+f;if(b){var l;if(b instanceof a)b.each(function(a,b){l=c.wrapMetaMorph(h+"-"+b.uuid,e(b));j?g+=l:g.push(l)}),c.ifBind(f,b)&&(c.listenTo(b,"add",function(a,b,d,g){a=c.wrapMetaMorph(h+"-"+b.uuid,e(b));(g=g.at)?(d=d.at(g-1),$("#metamorph-"+(h+"-"+d.uuid)+"-end").after(a)):$("#metamorph-"+h+"-end").before(a)}),c.listenTo(b,"remove",function(a,b){c.updateMetaMorph(h+"-"+b.uuid,"","remove")}));else if(void 0!==b.length)for(var m=
0,f=b.length;m<f;m++)l=c.wrapMetaMorph(h+"-"+m,e(b[m])),j?g+=l:g.push(l);else for(m in b)l=c.wrapMetaMorph(h+"-"+m,e(b[m])),j?g+=l:g.push(l);return c.wrapMetaMorph(h,j?g:g.join(""))}},getValue:e,parseValue:function(a,b){var d=b.context,c=b.data,e=b.exp,g=f.isEscape,h=b.helpers,j=b.num,l=d.getCid()+"-"+j;d.ifBind(j,c)&&d.listenTo(c,"change:"+e,function(a,b,c){g&&(c=h.escape(c));d.updateMetaMorph(l,c)});g&&(a=h.escape(a));return d.wrapMetaMorph(l,a)},bindAttr:g,input:function(a,b){b.type="input";return"<input "+
g(a,b)+"/>"},textarea:function(a,b){b.type="textarea";return"<textarea "+g(a,b)+">"+b.value+"</textarea>"}});var j=f.getIfPlusJoin(),m=/((\w+)=['"]?)?([#\w][\s\w\.\?:#-]*)(['"]?)(?!\w*=)/g,l=/[^<]*(<[a-zA-Z]+)/,n=/^[^>]+class=/,k=/class=['"]?([#\w][\s\w\.\?:#-]*)(['"]?)(?!\w*=)/,q=/^[^>]+{{bindAttr/,v=/^[^>]+{{bindAttr((?!}}).)class=/,s=/({{bindAttr)/;return b});
$Define("CM.View",["CM.ViewManager","CM.ModelView","CM.Model","B.Template"],function(f,b,c,a){var e=/^(<[a-zA-Z]+)/,g=b.derive({xtype:"View",xConfig:{},tmpl:"<div>{{placeItem}}</div>",bindRefType:"bindRef",_customEvents:"beforeRender render afterRender beforeShow show afterShow beforeHide hide afterHide beforeUpdate update afterUpdate beforeDestroy destroy afterDestroy add remove".split(" "),_defaultEvents:"mousedown mouseup mouseover mousemove mouseenter mouseleave dragstart drag dragenter dragleave dragover drop dragend touchstart touchmove touchend touchcancel keydown keyup keypress click dblclick focus focusin focusout contextmenu change submit".split(" "),
_applyArray:function(a,b){var c=this,e=arguments,g=e.callee.caller,f=g.$owner.prototype;0==e.length?(e=g.arguments,e=$H.toArray(e),a=g.$name,b=e.shift()):e=$H.toArray(e,2);return $H.isArr(b)?($H.each(b,function(b,g){f[a].apply(c,[g].concat(e))}),!0):!1},initialize:function(){this.items=[];this.children=[];this.callSuper()},doConfig:function(a){var b=this;b.initParam=a;"string"==typeof a&&(a={text:a});var e=a||{};$H.extend(b,e,{notCover:function(a,d){var c;if(c=/^{{(((?!}}).)+)}}$/.exec(d))c=c[1],
(b.refModelAttrs||(b.refModelAttrs={}))[c]=a;c=$H.contains(b._customEvents,a);if($H.contains(b._defaultEvents,a))return b.listeners.push({name:a,handler:e[a]}),!0;if(c)return b.on(a,e[a]),!0;if("defItem"==a)return b[a]=$H.extend(b[a],d),!0;if("listener"==a)return b.listeners=b.listeners.concat($H.isArr(d)?d:[d]),!0;if("items"==a)return b.add(d),!0;if("extCls"==a&&b[a])return b[a]+=" "+d,!0;if("xtype"==a)return"View"==b[a]&&(b[a]="string"==typeof d?d:d.$ns),!0}});if(a=e.renderTo){if($H.isFunc(a))a=
a.call(b);else if($H.isStr(a)&&0==a.indexOf(">")){var g=b.parent;a=g.inited&&g.findEl(a.substring(1))}else a=$(a);b.renderTo=a}else b.renderTo=$(document.body);if(a=b.getRefModel()){var g=b.refModelAttrs,f;for(f in g)b[g[f]]=a.get(f)}f=b.xConfig;a=b.modelClass;if(!a&&!(a=b.constructor.modelClass))a=f?c.derive({fields:f}):c,a=b.constructor.modelClass=a;var n={};$H.each(f,function(a){var d=b[a];void 0!==d&&(n[a]=d)});b.xmodel=new a(n);b.bindRefModel()},getHtml:function(){this.getId();var a,b=this.extCls||
"";"visibility"==this.displayMode?a="visibility:hidden;":b+=" hui-hidden";var c=this.callSuper();a&&(c=c.replace(e,'$1 style="'+a+'"'));b&&(c=c.replace(/(class=['"])/,"$1"+b+" "));if(a=this.wrapHtml)c=a[0]+c+a[1];return this.html=c},findHtml:function(a){a=this.find(a);for(var b=[],c=0;c<a.length;c++)b.push(a[c].getHtml());return b.join("")},initStyle:function(){var a=this.getEl(),b=this.style||{};void 0!==this.width&&(b.width=this.width);void 0!==this.height&&(b.height=this.height);a.css(b)},beforeRender:function(){return this.trigger("beforeRender")},
render:function(){if(!1==this.beforeRender())return!1;var a=this.getHtml();this.renderTo[this.renderBy](a);this.afterRender()},afterRender:function(){if(this.rendered)return!1;this.trigger("render");this.callChild();this._container=$("#"+this.getId());this.rendered=!0;this.initStyle();!0!=this.notListen&&this.initListeners();this.disabled&&this.disable();this.trigger("afterRender");this.hidden||this.show()},beforeShow:function(){return this.trigger("beforeShow")},show:function(a,b){var c=this;if(!1==
c.beforeShow()||c.showed||b&&c.hidden)return!1;if(!a&&c.delayShow)setTimeout(function(){g.prototype.show.call(c,!0)},0);else{c.trigger("show");c.showed=!0;var e=c.getEl();"visibility"==c.displayMode?e.css({visibility:"visible"}):e.removeClass("hui-hidden");c.callChild([null,!0]);c.afterShow()}},afterShow:function(){var a=this;setTimeout(function(){a.trigger("afterShow")},0)},beforeHide:function(){return this.trigger("beforeHide")},hide:function(){if(!1==this.beforeHide()||!this.showed)return!1;this.showed=
!1;var a=this.getEl();"visibility"==this.displayMode?a.css({visibility:"hidden"}):a.addClass("hui-hidden");this.trigger("hide");this.afterHide()},afterHide:function(){this.trigger("afterHide")},enable:function(){this.resume();this.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")},disable:function(){this.suspend();this.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled","disabled")},getContent:function(a,b){b?!b instanceof g&&(b=this.find(b)[0]):
b=this;return!1==a?b.children:b.getEl().html()},setContent:function(a,b){if(b)return!b instanceof g&&(b=this.find(b)[0]),b.setContent(a);if("string"==typeof a)this.set("content",a),this.remove();else return this.set("content",""),this.add(a)},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0;this.callChild()},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1;this.callChild()},parentsEl:function(a){return this.getEl().parents(a)},get:function(a){return void 0===this.xConfig[a]?
this[a]:this.xmodel.get(a)},set:function(a,b){void 0===this.xConfig[a]?this[a]=b:this.xmodel.set(a,b)},getRefModel:function(){var a;if(a=this.refModel||this.model)return a;for(var b=this.parent;b;){if(a=b.refModel||b.model)return this.refModel=a;if(b.parent)b=b.parent;else return b.model}},bindRefModel:function(){function a(d,e){("both"==c||"bindRef"==c)&&b.listenTo(g,"change:"+d,function(a,d,c){b.set(e,c)});("both"==c||"bindXmodel"==c)&&b.listenTo(f,"change:"+e,function(a,b,c){g.set(d,c)})}var b=
this,c=b.bindRefType,e=b.refModelAttrs;if(c&&e){var g=b.getRefModel(),f=b.xmodel,k;for(k in e)a(k,e[k])}},each:function(a,b){for(var c=this.children,e=c.length,g,f=0;f<e;){g=c[f];g=b?a.apply(g,b):a(f,g);if(!1===g)break;e==c.length?f++:e=c.length}},match:function(a,b){if("*"==a)return!0;b=b||this;var c,e,g;a=a.replace(/^#([^\s,\[]+)/,"[cid=$1]");a=a.replace(/^\.([^\s,\[]+)/,"[cClass=$1]");a=a.replace(/^([^\[]+)/,"[xtype=$1]");for(var f=/\[([^=|\!]+)(=|\!=)([^=]+)\]/g;c=f.exec(a);){e=c[1];g=c[2];c=
c[3];if("false"==c||"true"==c)c=eval(c);e=b.get?b.get(e):b[e];if("="===g?e!=c:e==c)return!1}return!0},find:function(a,b){var c=this;b=b||[];if(a)if($H.isNum(a))b.push(c.children[a]);else if($H.isStr(a)){if(0<a.indexOf(","))return $H.each(a.split(","),function(a,d){b=b.concat(c.find(d))}),b;var e=0==a.indexOf(">"),g=a.replace(/^>?\s?/,""),f=g.search(/\s|>/),k;0<f&&(k=g.substring(f),g=g.substring(0,f));c.each(function(c,f){f.match(g)&&(k?f.find(k,b):b.push(f));e||f.find(a,b)})}else{if($H.isFunc(a)){var q=
$H.isClass(a);c.each(function(c,e){(q&&e instanceof a||!q&&a(e))&&b.push(e);e.find(a,b)})}}else b=b.concat(c.children);return b},parents:function(a){for(var b=this;b.parent;)if(b=b.parent,a&&this.match(a,b))return b;return a||b===this?null:b},index:function(){var a=this,b=a.parent;if(b){var c;b.each(function(b,e){if(e==a)return c=b,!1});return c}return null},callChild:function(a,b){0!=this.children.length&&(a&&"string"!=typeof a&&(b=a,a=null),a=a||arguments.callee.caller.$name,this.each(function(c,
e){b?e[a].apply(e,b):e[a].call(e)}))},add:function(a,b){if(!this._applyArray()){var c=void 0===b;if(this.startParseItems){if(a instanceof g)a.parent=this;else{this.defItem&&$H.extend(a,this.defItem,{notCover:!0});this.parseItem(a);var e=this.manager.getClass(a.xtype);if(e){var f=a.renderTo;!this.inited&&($H.isStr(f)&&0==f.indexOf(">"))&&(f=null);f||(a.autoRender=!1);a.parent=this;a=new e(a)}else $D.error("xtype:"+a.xtype+"\u672a\u627e\u5230")}e=this.children;c?e.push(a):e.splice(b,0,a);this.trigger("add",
a);return a}e=this.items;c?e.push(a):e.splice(b,0,a)}},remove:function(a){if(!this._applyArray()){var b=this.children,c=!1,e;if($H.isNum(a))e=a,a=b[e];else if($H.isStr(a)||$H.isFunc(a)){a=this.find(a);for(var f=0,n=a.length;f<n;f++){if(!1==this.remove(a[f]))return!1;c=!0}}else if(a instanceof g)if(a.parent==this){f=0;for(n=b.length;f<n;f++)if(b[f]==a){e=f;break}}else return a.parent.remove(a);void 0!==e&&!1!=a.destroy(!0)&&(b.splice(e,1),c=!0);this.trigger("remove",a);return c}},parseItem:function(){},
parseItems:function(){this.startParseItems=!0;var a=this.items;if(a)for(var a=$H.isArr(a)?a:[a],b=0,c=a.length;b<c;b++)this.add(a[b])},beforeUpdate:function(){return this.trigger("beforeUpdate")},update:function(a,b){if(!a||!1==this.beforeUpdate())return!1;var c=this.xConfig,e=!0;$H.each(a,function(a){if("undefined"==typeof c[a])return e=!1});var g;if(e)this.xmodel.set(a),g=this;else{g=this.parent;var f=$("<span></span>").insertBefore(this.getEl());b||(void 0===a.autoRender&&(a.autoRender=!0),a=$H.extend(a,
this.initParam,{notCover:!0}));a=$H.extend(a,{xtype:this.xtype,renderBy:"replaceWith",renderTo:f},{notCover:["xtype"]});if(!a.cid||a.cid==this.cid)a._id=this._id;if(g){var k=this.index();if(!1==g.remove(this))return f.remove(),!1;g=g.add(a,k)}else{if(!1==this.destroy())return f.remove(),!1;g=new this.constructor(a)}}this.trigger("update",g);this.afterUpdate(g);return g},replace:function(a){return this.update(a,!0)},afterUpdate:function(a){this.trigger("afterUpdate",a)},beforeDestroy:function(){return this.trigger("beforeDestroy")},
destroy:function(a){if(!1==this.beforeDestroy())return!1;if(!this.destroyed)return this.callChild(),this.trigger("destroy"),this.clearListeners(),this.getEl().remove(),this.destroyed=!0,!a&&this.parent&&this.parent.remove(this),this.manager.unregister(this),delete this.initParam,delete this._container,delete this.renderTo,delete this._listeners,delete this.html,delete this.xmodel,delete this.children,this.afterDestroy(),!0},afterDestroy:function(){this.trigger("afterDestroy")}},{extend:function(a){var b=
this.prototype;$H.extend(b,a,{notCover:function(c){if("_customEvents"==c||"listeners"==c)return b[c]=(a[c]||[]).concat(b[c]||[]),!0;if("xtype"==c||"constructor"==c)return!0;if("xConfig"==c)return b[c]=$H.extendIf(a[c],b[c]),!0}})},html:function(a){return(new this($H.extend({autoRender:!1},a))).getHtml()}});a.registerHelper("ModelView",{placeItem:function(a,b){var c=b.context,e=b.num,g=c.getCid()+"-"+e,f=c.findHtml(a);if(c.ifBind(e))c.on("add",function(b,e){e.match(a)&&(c.updateMetaMorph(g,e.getHtml(),
"append"),e.afterRender())});return c.wrapMetaMorph(g,f)}});e=/[^<]*(<[a-zA-Z]+)/;return g});$Define("C.ComponentManager",["CM.AbstractManager","CM.ViewManager"],function(f,b){var c=f.derive({type:"component",initialize:function(){var a=$H.getSingleton(b);this._types=a._types;this._all=a._all}});$CM=new c;return c});
$Define("C.AbstractComponent",["CM.ViewManager","CM.View"],function(f,b){$C=$H.ns("C",{});var c=$H.createClass();$H.inherit(c,b,{xtype:"AbstractComponent",xConfig:{extCls:"",tType:"",theme:"",cls:"",radius:null,shadow:!1,shadowInset:!1,shadowSurround:!1,shadowOverlay:!1,isMini:!1,isActive:!1,isFocus:!1,isInline:!1,activeCls:"hui-active",cmpCls:{depends:["cls"],parse:function(){return"hui-"+this.get("cls")}},tTypeCls:{depends:["tType"],parse:function(){var a=this.get("tType");return a?"hui-"+this.get("cls")+
"-"+a:""}},themeCls:{depends:["theme"],parse:function(){return this.get("theme")?"hui-"+this.get("cls")+"-"+this.get("theme"):""}},activeClass:{depends:["isActive","activeCls"],parse:function(){return this.get("isActive")?this.get("activeCls"):""}},radiusCls:{depends:["radius"],parse:function(){var a=this.get("radius");return a?"hui-radius-"+a:""}}},hasConfig:function(a,b){if(!b)return!1;if($H.isArr(b))for(var c=0,d=b.length;c<d;c++){if(this.match(a,b[c]))return!0}else if(this.match(a,b))return!0;
return!1},doConfig:function(){this.callSuper();this.icon&&this.add({xtype:"Icon",name:this.icon});this.isMini&&(this.defItem=$H.extend({isMini:!0},this.defItem))},preTmpl:function(){this.callSuper();this.tmpl=this.tmpl.replace(/(class=['"])/,"$1#js-component cmpCls tTypeCls themeCls radiusCls isMini?hui-mini shadow?hui-shadow shadowSurround?hui-shadow-surround shadowOverlay?hui-shadow-overlay shadowInset?hui-shadow-inset activeClass isFocus?hui-focus isInline?hui-inline ")},active:function(){this.update({isActive:!0})},
unactive:function(){this.update({isActive:!1})},txt:function(a){return void 0!==a?this.set("text",a):this.get("text")},valid:function(){var a=this.validator;if(a){var b=this.val();a.error||(a.error=function(a){new $C.Tips({text:a,theme:"error"})});return a=$H.Validator.valid(b,a)}for(var b=this.children,c=0,d=b.length;c<d;c++)if(a=b[c].valid(),!a)return a;return!0}},{define:function(a,b){var g=$H.createClass();$H.inherit(g,b||c,null,null,{notCover:function(a){return"define"==a}});$H.getSingleton(f).registerType(a,
g);return $C[a]=g}});return c});$Define("C.Icon","C.AbstractComponent",function(f){f=f.define("Icon");f.extend({xConfig:{cls:"icon",hasBg:!0,isAlt:!1,name:"",iconName:{depends:["name"],parse:function(){return"hui-icon-"+this.get("name")}}},tmpl:'<span {{bindAttr class="isAlt?hui-alt-icon iconName hasBg?hui-icon-bg"}}></span>',doConfig:function(b){$H.isStr(b)&&(b={name:b});this.callSuper([b])}});return f});
$Define("C.Button","C.AbstractComponent",function(f){f=f.define("Button");f.extend({xConfig:{cls:"btn",text:"",theme:"gray",iconPos:"",activeCls:"hui-btn-active",isBack:!1,radius:"little",shadow:!0,isInline:!0,iconPosCls:{depends:["iconPos"],parse:function(){var b=this.get("iconPos");return b?"hui-btn-icon-"+b:""}}},cls:"btn",defItem:{xtype:"Icon"},tmpl:'<a href="javascript:;" hidefocus="true" {{bindAttr class="text:hui-btn-icon-notxt isBack?hui-btn-back iconPosCls"}}><span class="hui-btn-txt">{{text}}</span>{{placeItem}}</a>'});
return f});$Define("C.Desc",["C.AbstractComponent","CM.Model","CM.Collection"],function(f){f=f.define("Desc");f.extend({xConfig:{cls:"desc",icon:"",text:"",iconCls:{depends:["icon"],parse:function(){var b=this.get("icon");return b?"hui-icon-"+b:""}}},tmpl:'<div class="hui-content-desc">{{#if icon}}<span {{bindAttr class="#hui-icon #hui-mini #hui-alt-icon iconCls #hui-light"}}></span>{{/if}}{{text}}</div>'});return f});
$Define("C.Panel","C.AbstractComponent",function(f){f=f.define("Panel");f.extend({xConfig:{cls:"panel",content:"",isLoading:!1,loadingTxt:"\u6b63\u5728\u52a0\u8f7d\u4e2d..."},tmpl:'<div>{{#if isLoading}}<div class="hui-panel-loading"><div class="hui-mask"></div><div class="hui-loading-container"><div class="hui-tips hui-tips-big hui-tips-black hui-radius-little"><span class="hui-icon hui-icon-loading"></span><span class="hui-tips-txt">{{loadingTxt}}</span></div></div></div>{{/if}}{{#if content}}{{content}}{{else}}{{placeItem}}{{/if}}</div>'});
return f});
$Define("C.Popup","C.AbstractComponent",function(f){f=f.define("Popup");var b=0,c;f.extend({delayShow:!0,clickHide:!0,showPos:"center",destroyWhenHide:!0,shadowOverlay:!0,tmpl:"<div>{{placeItem}}</div>",doConfig:function(){this.callSuper();this.clickHide&&this.listeners.push({name:"click",el:$(document),handler:function(){this.hide()}});$H.android()&&(this.listeners.push({name:"show",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.show")&&$("input,textarea,select").attr("disabled","disabled")}}),
this.listeners.push({name:"hide",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.hide")&&setTimeout(function(){$("input,textarea,select").removeAttr("disabled")},500)}}))},afterShow:function(){var a=this,c=a.getEl();c.css("z-index",1E3*b+1E3);if(!a.width&&a.parent){var g=a.width=a.parent.getEl().outerWidth();c.css("width",g)}c=a.showPos;if("string"==typeof c)a[c]();else"function"==typeof c&&c.call(a);a.noMask||a.mask();a.timeout&&setTimeout(function(){a.destroyed||a.hide()},a.timeout)},
hide:function(){!1!=this.callSuper()&&(this.noMask||this.unmask(),this.destroyWhenHide&&this.destroy())},top:function(){this.getEl().css({left:"80px",top:"8px",position:"fixed"})},center:function(){var a=this.getEl(),b=this.width||a.outerWidth(),c=this.height||a.outerHeight(),d=document,b=((d.documentElement.offsetWidth||d.body.offsetWidth)-b)/2,c=((d.documentElement.clientHeight||d.body.clientHeight)-c)/2+(d.documentElement.scrollTop||d.body.scrollTop),c=10>c?window.screen.height/2-200:c;a.css({left:b+
"px",top:c-(this.offsetTop||0)+"px"})},followEl:function(a){a=a||this.parent.getEl();a=$H.position(a[0]);this.getEl().css(a)},mask:function(){c||(c=$('<div class="hui-mask" style="display:none;"></div>').appendTo(document.body));c.css("z-index",1E3*b+998);0==b&&c.show();b++},unmask:function(){b--;0==b?c.hide():c.css("z-index",1E3*(b-1)+998)}});return f});
$Define("C.ControlGroup","C.AbstractComponent",function(f){f=f.define("ControlGroup");f.extend({xConfig:{cls:"ctrlgp",direction:"v",directionCls:{depends:["direction"],parse:function(){return"hui-ctrlgp-"+this.get("direction")}}},multi:!1,defItem:{xtype:"Button",radius:null,shadow:!1,isInline:!1},tmpl:'<div {{bindAttr class="directionCls"}}>{{placeItem}}</div>',listeners:[{name:"click",selector:".js-item",method:"delegate",handler:function(b){var c=$(b.currentTarget),c=this.find(">[_id="+c.attr("id")+
"]");0<c.length&&(c=c[0].index(),this.onItemClick(b,c))}}],parseItem:function(b){b.extCls=(b.extCls||"")+"js-item"},select:function(b){if(!this.notSelect&&(b="number"==typeof b?this.children[b]:"string"==typeof b?this.find(b)[0]:b))if(!this.multi&&!b.multi){var c=this.getSelected();c&&this.selectItem(c,!1);this.selectItem(b)}else this.selectItem(b,!b.get("selected"))},getSelected:function(b){var c=[];this.each(function(a,e){if(e.get(e.select?"selected":"isActive"))c.push(b?a:e)});return 0<c.length?
this.multi?c:c[0]:null},selectItem:function(b,c){(c=!1!=c)?b.select?b.select():b.active():b.select?b.select(c):b.unactive()},val:function(b){if(b){var c=b.split(",");this.each(function(a,b){b.select($H.contains(c,b.value))})}else return c=[],this.each(function(a,b){b.get("selected")&&c.push(b.value)}),c.join(",")},onItemClick:function(b,c){this.select(c);this.itemClick&&this.itemClick(this.children[c],c)}});return f});
$Define("C.Radio","C.AbstractComponent",function(f){f=f.define("Radio");f.extend({xConfig:{cls:"radio",name:"",text:"",value:"",selected:!1},tmpl:'<div {{bindAttr class="#hui-btn #hui-btn-gray selected?hui-radio-on"}}><span class="hui-icon hui-icon-radio"></span><input type="radio" {{bindAttr selected?checked name="name" value="value"}}/><span class="hui-radio-txt">{{text}}</span></div>',select:function(b){this.update({selected:!1!=b})},val:function(b){if(b)this.set("value",b);else return this.get("value")}});
return f});
$Define("C.Checkbox","C.AbstractComponent",function(f){f=f.define("Checkbox");f.extend({xConfig:{cls:"chkbox",name:"",text:"",value:"",selected:!1},multi:!0,tmpl:'<div {{bindAttr class="#hui-btn #hui-btn-gray selected?hui-chkbox-on"}}><span class="hui-icon hui-icon-chkbox"></span><input type="checkbox" {{bindAttr selected?checked name="name" value="value"}}/><span class="hui-chkbox-txt">{{text}}</span></div>',select:function(b){this.update({selected:!1!=b})},val:function(b){if(b)this.set("value",b);
else return this.get("value")}});return f});
$Define("C.Select","C.AbstractComponent",function(f){f=f.define("Select");f.extend({xConfig:{cls:"select",name:"",text:"\u8bf7\u9009\u62e9...",value:"",radius:"little"},optionClick:function(){},defItem:{xtype:"Menu",hidden:!0,markType:"hook",showPos:"followEl",renderTo:"body"},_customEvents:["change"],tmpl:'<div class="hui-btn hui-btn-gray hui-btn-icon-right"><span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span><input {{bindAttr value="value" name="name"}}/><span class="hui-btn-txt js-select-txt">{{text}}</span></div>',listeners:[{name:"click",
handler:function(){this.showOptions()}}],doConfig:function(b){var c=this;c.callSuper();for(var a=b.options,e=!1,g=0,d=a.length;g<d;g++){var f=a[g];if(f.value==b.value){c.set("text",f.text);e=f.selected=!0;break}}e||delete c.value;c.add({itemClick:function(a){a=a.get("value");c.val(a)},width:c.width,items:a})},showOptions:function(){this.children[0].show()},val:function(b){if(b){if(this.get("value")!=b){var c=this.children[0],a=c.find(">[value="+b+"]");0<a.length&&(this.trigger("change"),a=a[0],this.set("value",
b),this.txt(a.get("text")),c.select(a))}}else return this.get("value")}});return f});
$Define("C.Input","C.AbstractComponent",function(f){f=f.define("Input");f.extend({xConfig:{cls:"input",isTextarea:!1,name:"",value:"",placeholder:"",radius:"little",iconPos:"",btnPos:"",iconPosCls:{depends:["iconPos"],parse:function(){var b=this.get("iconPos");return b?"hui-input-icon-"+b:""}},btnPosCls:{depends:["btnPos"],parse:function(){var b=this.get("btnPos");return b?"hui-input-btn-"+b:""}}},type:"",withClear:!1,tmpl:'<div {{bindAttr class="iconPosCls btnPosCls"}}>{{placeItem}}{{#if isTextarea}}{{textarea class="#js-input" name="name" placeholder="placeholder" value=value}}{{else}}{{input type="#text" class="#js-input #hui-input-txt" name="name" placeholder="placeholder" value="value"}}{{/if}}</div>',
listeners:[{name:"focus",el:".js-input",handler:function(){this.getEl().addClass("hui-focus")}},{name:"blur",el:".js-input",handler:function(){this.getEl().removeClass("hui-focus")}}],doConfig:function(b){var c=this;"search"==b.type&&(c.icon="search");c.callSuper();b.isTextarea&&c.listeners.push({name:"input propertychange",el:".js-input",handler:function(){var a=c.findEl(".js-input"),b=a[0].scrollHeight;50<=b&&a.css("height",b)}});c.withClear&&c.add({xtype:"Button",radius:"big",icon:"delete",click:function(){this.parent.findEl("input").val("").focus()}})},
parseItem:function(b){"Icon"==b.xtype?this.get("iconPos")||this.set("iconPos","left"):"Button"==b.xtype&&(this.get("btnPos")||this.set("btnPos","right"))},val:function(b){var c=this.findEl("input,textarea");if(b)c.val(b);else return c.val()},focus:function(){this.findEl("input").focus()}});return f});
$Define("C.Label","C.AbstractComponent",function(f){f=f.define("Label");f.extend({xConfig:{cls:"label",text:"",color:"",textAlign:"",forName:"",colorCls:{depends:["color"],parse:function(){var b=this.get("color");return b?"hui-label-"+b:""}},textAlignCls:{depends:["textAlign"],parse:function(){var b=this.get("textAlign");return b?"c-txt-"+b:""}}},tmpl:'<label {{bindAttr class="colorCls textAlignCls" for="forName"}}>{{text}}</label>'});return f});
$Define("C.RowItem","C.AbstractComponent",function(f){f=f.define("RowItem");f.extend({xConfig:{cls:"rowitem",text:"",underline:!1,hasArrow:!1},tmpl:'<div {{bindAttr class="text?hui-rowitem-txt underline?hui-rowitem-underline"}}>{{text}}{{placeItem}}{{#if hasArrow}}<a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="\u8be6\u60c5"><span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span></a>{{/if}}</div>',doConfig:function(b){this.callSuper();this.get("text")||this.set("text",
"&nbsp;");this.text&&void 0===this.underline&&this.set("underline",!0);b.click&&void 0===this.hasArrow&&this.set("hasArrow",!0)}});return f});$Define("C.Set","C.AbstractComponent",function(f){f=f.define("Set");f.extend({xConfig:{cls:"set",title:""},tmpl:'<div><h1 class="hui-set-title">{{title}}</h1><div class="hui-set-content">{{placeItem}}</div></div>'});return f});
$Define("C.Field","C.AbstractComponent",function(f){f=f.define("Field");f.extend({xConfig:{cls:"field",noPadding:!1},defItem:{xtype:"RowItem",xrole:"content"},tmpl:'<div {{bindAttr class="noPadding?hui-field-nopadding"}}><div class="hui-field-left">{{placeItem >[xrole=title]}}</div><div class="hui-field-right">{{placeItem >[xrole=content]}}</div></div>',doConfig:function(b){var c=b.title;$H.isSimple(c)&&(c={text:c});c=$H.extend({xtype:"Label",xrole:"title"},c);this.add(c);c=b.content;void 0===c&&
!b.items&&(c="");$H.isSimple(c)&&(c={text:c,underline:!0});c&&(this.noPadding=!0,this.add(c));b=$.extend({},b);delete b.title;delete b.content;this.callSuper([b])}});return f});$Define("C.Form","C.AbstractComponent",function(f){f=f.define("Form");f.extend({xConfig:{cls:"form"},tmpl:'<div><form action=""><div class="hui-form-tips c-txt-error"></div>{{placeItem}}</form></div>'});return f});
$Define("C.TabItem",["C.AbstractComponent","C.Panel"],function(f){f=f.define("TabItem");f.extend({xConfig:{cls:"tabitem",extCls:"js-item"},wrapHtml:['<li class="hui-tab-item">',"</li>"],defItem:{xtype:"Button",xrole:"title",radius:null,isInline:!1,shadow:!1},tmpl:"<div>{{placeItem >[xrole=title]}}</div>",initialize:function(){this.callSuper();this.titleCmp=this.find(">[xrole=title]")[0];this.contentCmp=this.find(">[xrole=content]")[0]},doConfig:function(b){this.callSuper();var c=b.title;"string"==
typeof c&&(c={text:c});"object"==typeof c&&this.add(c);b=b.content;"string"==typeof b&&(b={xtype:"Panel",content:b});"object"==typeof b&&($H.extend(b,{xrole:"content",hidden:!this.selected,extCls:"js-content"}),this.add(b))},parseItem:function(b){this.selected&&"title"==b.xrole&&(b.isActive=!0);b.icon&&void 0===b.iconPos&&(b.iconPos="top");this.activeType&&(b.activeCls="hui-btn-active-"+this.activeType)},select:function(b){var c=this.titleCmp,a=this.contentCmp;!1==b?(c.unactive(),a&&a.hide(),this.set("selected",
!1)):(c.active(),a&&a.show(),this.set("selected",!0))},getContent:function(b,c){c||(c=this.contentCmp);return this.callSuper([b,c])},setContent:function(b,c){c||(c=this.contentCmp);return this.callSuper([b,c])}});return f});
$Define("C.Tab",["C.AbstractComponent","C.TabItem","C.ControlGroup"],function(f,b,c){f=f.define("Tab",c);f.extend({xConfig:{cls:"tab"},defItem:{xtype:"TabItem"},listeners:[{name:"afterRender add remove",custom:!0,handler:function(){this.layout()}}],tmpl:'<div><ul class="js-tab-btns c-clear">{{placeItem >TabItem}}</ul>{{placeItem >TabItem>[xrole=content]}}</div>',parseItem:function(a){this.activeType&&(a.activeType=this.activeType);this.callSuper()},layout:function(){var a=this.children.length,b=Math.floor(100/
a);this.findEl(".js-tab-btns>li").each(function(c,d){d.style.width=c<a-1?b+"%":100-b*(a-1)+"%"})},setTabContent:function(a,b){b=b||this.getSelected(!0);this.findEl(".js-tab-content").index(b).html(a)}});return f});
$Define("C.Toolbar","C.AbstractComponent",function(f){f=f.define("Toolbar");f.extend({xConfig:{cls:"tbar",title:"",isHeader:!1,isFooter:!1},defItem:{xtype:"Button",theme:"black"},tmpl:'<div {{bindAttr class="isHeader?hui-header isFooter?hui-footer"}}>{{placeItem}}{{#if title}}<h1 class="hui-tbar-title js-tbar-txt">{{title}}</h1>{{/if}}</div>',parseItem:function(b){"Button"==b.xtype&&(b.shadowSurround=!0,"left"==b.pos?b.extCls=(b.extCls||"")+" hui-tbar-btn-left":"right"==b.pos&&(b.extCls=(b.extCls||
"")+" hui-tbar-btn-right"))}});return f});
$Define("C.Tips",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(f,b){var c=f.define("Tips",b);c.extend({xConfig:{cls:"tips",text:"",radius:"normal",tType:"big",theme:"black"},timeout:1E3,tmpl:'<div {{bindAttr class="text:hui-tips-notxt"}}>{{placeItem}}{{#if text}}<span class="hui-tips-txt">{{text}}</span>{{/if}}</div>',doConfig:function(a){"loading"==a.type?$H.extend(this,{text:"\u6b63\u5728\u52a0\u8f7d\u4e2d...",timeout:null,noMask:!0,icon:"loading"}):"miniLoading"==a.type?$H.extend(this,
{showPos:"top",clickHide:!1,destroyWhenHide:!1,timeout:null,delayShow:!1,shadowOverlay:null,theme:null,noMask:!0,tType:"mini",items:{xtype:"Icon",name:"loading-mini",hasBg:!1}}):"topTips"==a.type&&$H.extend(this,{showPos:"top",noMask:!0,tType:"mini"});this.callSuper()}});return c});
$Define("C.Dialog",["C.AbstractComponent","C.Popup"],function(f,b){var c=f.define("Dialog",b);$H.extend(c,{alert:function(a){return new c({contentMsg:a,noClose:!0,noCancel:!0})},confirm:function(a,b){return new c({contentMsg:a,noClose:!0,okCall:function(){return b&&b(!0)},cancelCall:function(){return b&&b(!1)}})},prompt:function(a,b,g){g||(g=b,b="");return new c({contentMsg:a,noClose:!0,items:{xtype:"Input",xrole:"dialog-content",value:b},okCall:function(){var a=this.find("Input")[0].val();return g&&
g(a)}})}});c.extend({xConfig:{cls:"dialog",radius:"little",content:"",contentTitle:"",contentMsg:""},okTxt:"\u786e\u5b9a",cancelTxt:"\u53d6\u6d88",clickHide:!1,tmpl:'<div>{{placeItem >[xrole=dialog-header]}}<div class="hui-dialog-body">{{#if content}}{{content}}{{else}}<div class="hui-body-content"><h1 class="hui-content-title">{{contentTitle}}</h1><div class="hui-content-msg">{{contentMsg}}</div>{{placeItem >[xrole=dialog-content]}}</div>{{/if}}{{#unless noAction}}<div class="hui-body-action">{{placeItem >[xrole=dialog-action]}}</div>{{/unless}}</div></div>',
doConfig:function(a){var b=this;b.callSuper();a=a.items;b.title&&!b.hasConfig("[xrole=dialog-header]",a)&&b.add({xtype:"Toolbar",title:b.title,theme:"gray",xrole:"dialog-header",extCls:"hui-dialog-header",items:!b.noClose&&{xtype:"Button",radius:"big",icon:"delete",isMini:!1,theme:"gray",pos:"left",click:function(){b.hide()}}});!b.noAction&&!b.hasConfig("[xrole=dialog-action]",a)&&(a=[],b.noCancel||a.push({title:{isActive:1==b.activeBtn,text:b.cancelTxt,click:function(){!1!=(b.cancelCall&&b.cancelCall())&&
b.hide()}}}),b.noOk||a.push({title:{text:b.okTxt,isActive:2==b.activeBtn,click:function(){!1!=(b.okCall&&b.okCall())&&b.hide()}}}),b.add({xtype:"Tab",xrole:"dialog-action",theme:"border-top",notSelect:!0,items:a}))}});return c});
$Define("C.Menu",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(f,b,c){f=f.define("Menu",b);f.extend(c.prototype);f.extend({xConfig:{cls:"menu"},markType:null,destroyWhenHide:!1,defItem:{xtype:"Button",radius:null,shadow:!1,isInline:!1},tmpl:'<div {{bindAttr class="directionCls"}}>{{placeItem}}</div>',parseItem:function(a){c.prototype.parseItem.call(this,a);var b=this.markType;b?"hook"==b&&(a.items={name:"check",isAlt:!0,hasBg:!1},a.iconPos="left",a.activeCls="hui-item-select"):this.notSelect=
!0;a.isActive=a.selected}});return f});
$Define("C.Hcard","C.AbstractComponent",function(f){f=f.define("Hcard");f.extend({xConfig:{cls:"hcard",image:"",title:"",hasArrow:!1},defItem:{xtype:"Desc",xrole:"desc"},tmpl:'<div {{bindAttr class="image?hui-hcard-hasimg"}}>{{#if image}}<div class="hui-hcard-img"><img {{bindAttr src="image"}}></div>{{/if}}<div class="hui-hcard-content"><div class="hui-content-title">{{title}}</div>{{placeItem >[xrole=desc]}}</div>{{placeItem >[xrole!=desc]}}{{#if hasArrow}}<a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="\u8be6\u60c5"><span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span></a>{{/if}}</div>',doConfig:function(b){this.callSuper();
b.click&&void 0===this.hasArrow&&this.set("hasArrow",!0);(b=this.desc)&&this.add(b)}});return f});
$Define("C.Vcard","C.AbstractComponent",function(f){f=f.define("Vcard");f.extend({xConfig:{cls:"vcard",image:"",title:"",extraTitle:""},tmpl:'<div><div class="hui-vcard-title hui-title-hasimg c-clear"><div class="hui-title-img"><img {{bindAttr src="image"}}></div><div class="hui-title-txt">{{title}}</div><div class="hui-title-extra">{{extraTitle}}</div></div>{{placeItem >[xrole!=action]}}<div class="hui-vcard-action">{{placeItem >[xrole=action]}}</div></div>',doConfig:function(b){this.callSuper();
if(b=b.action)b=$H.extend({xtype:"Button",radius:null,isInline:!1,xrole:"action"},b),this.add(b)}});return f});
$Define("C.ModelList","C.AbstractComponent",function(f){f=f.define("ModelList");f.extend({xConfig:{cls:"mlist",isEmpty:!1,emptyTips:"\u6682\u65e0",pdText:"\u4e0b\u62c9\u53ef\u5237\u65b0",pdComment:"\u4e0a\u6b21\u5237\u65b0\u65f6\u95f4\uff1a",pdTime:"",hasPullRefresh:!1},tmpl:'<div class="hui-list"><div class="hui-list-inner">{{#if hasPullRefresh}}<div class="hui-list-pulldown hui-pd-pull c-h-middle-container"><div class="c-h-middle"><span class="hui-icon hui-alt-icon hui-icon-arrow-d hui-light"></span><span class="hui-icon hui-alt-icon hui-icon-loading-mini"></span><div class="hui-pd-txt">{{#if pdText}}<div class="js-txt">{{pdText}}</div>{{/if}}{{#if pdComment}}<div class="js-comment hui-pd-comment"><span class="js-pdComment">{{pdComment}}</span><span class="js-pdTime">{{pdTime}}</span></div>{{/if}}</div></div></div>{{/if}}{{#if isEmpty}}<div class="hui-list-empty js-empty">{{emptyTips}}</div>{{/if}}<div class="js-item-container">{{placeItem}}</div>{{#if hasPullRefresh}}<div {{bindAttr class="hui-list-more isEmpty?hui-hidden"}}><a href="javascript:;" hidefocus="true" class="hui-btn hui-btn-gray hui-shadow hui-inline hui-radius-normal"><span class="hui-btn-txt">\u67e5\u770b\u66f4\u591a</span></a></div>{{/if}}</div></div>',init:function(){var b=
this;b.itemXtype&&((b.defItem||(b.defItem={})).xtype=b.itemXtype);var c=b.model,a=!1;c.each(function(c,g){b.addListItem(g);a=!0});a||b.set("isEmpty",!0);b.listenTo(c,{add:function(a,c){b.addListItem(c)},remove:function(a,c){b.removeListItem(c)},reset:function(){b.removeListItem("emptyAll")}});b.hasPullRefresh=b.hasPullRefresh&&window.iScroll;b.hasPullRefresh&&(b.listen({name:"afterRender",handler:function(){var a=this,b=a.getEl(),c=b.find(".hui-list-pulldown");a.scroller=new window.iScroll(b[0],{useTransition:!0,
topOffset:50,onRefresh:function(){c.hasClass("hui-pd-refresh")&&(c.removeClass("hui-pd-refresh hui-pd-release"),a.set("pdText","\u4e0b\u62c9\u53ef\u5237\u65b0"))},onScrollMove:function(){5<this.y&&!c.hasClass("hui-pd-release")?(c.addClass("hui-pd-release"),a.set("pdText","\u677e\u5f00\u53ef\u5237\u65b0"),this.minScrollY=0):5>this.y&&c.hasClass("hui-pd-release")&&(c.removeClass("hui-pd-release"),a.set("pdText","\u4e0b\u62c9\u53ef\u5237\u65b0"),this.minScrollY=-50)},onScrollEnd:function(){c.hasClass("hui-pd-release")&&
(c.addClass("hui-pd-refresh"),a.set("pdText","\u6b63\u5728\u5237\u65b0"),a.refresh())}})}}),b.listenTo(b.model,"sync",function(){b.set("pdTime",$H.formatDate($H.now(),"HH:mm"));setTimeout(function(){b.refreshScroller()},0)}),b.listen({name:"afterShow",handler:function(){b.refreshScroller()}}),b.listen({name:"click",method:"delegate",selector:".hui-list-more",handler:function(){b.getMore()}}))},addListItem:function(b){this.set("isEmpty",!1);this.add({model:b})},removeListItem:function(b){"emptyAll"==
b?this.remove(this.children):this.remove(function(c){return c.model&&c.model.id==b.id});0==this.children.length&&this.set("isEmpty",!0)},refreshScroller:function(){this.scroller&&this.getEl()[0].clientHeight&&this.scroller.refresh()},destroy:function(){this.scroller&&(this.scroller.destroy(),this.scroller=null);this.callSuper()}});return f});
$Define("M.AbstractModule","CM.View",function(f){var b=$H.createClass();$H.inherit(b,f,{useCache:$H.noop,cache:$H.noop,init:$H.noop,reset:$H.noop,exit:function(){return!0},cleanCache:function(){this.clearCache=!0}});return b});$Define("M.AbstractNavigator","handy.base.Object",function(f){var b=$H.createClass();f.extend(b.prototype,{navigate:function(){}});return b});
$Define("M.History","handy.base.HashChange",function(f){var b=$H.createClass(),c=0;$H.extend(b.prototype,{initialize:function(a,b){"function"==typeof a&&(b=a,a=null);this.error=b||$H.noop;this.key=a||"handy";this.states=[];f.listen($H.Function.bind(this.stateChange,this))},stateChange:function(){var a=this.getHashParam(),b=a.hKey,c=this.currentKey,d=this.states,f=d[c];if(b==c)return!1;(d=d[b])?a=d.onStateChange(d.param,!0):($D.warn("hisory state not found"),a=this.error("stateNotFound",a));!0!=a?
(a={hKey:c,param:f.param},this.saveHash(a)):this.currentKey=b},saveState:function(a){var b=this.currentKey=this.key+ ++c;this.states.push(b);this.states[b]=a;this.saveHash({hKey:b,param:a.param})},saveHash:function(a){$H.setHash("#"+$H.Json.stringify(a))},getHashParam:function(){try{var a=$H.getHash().replace("#","");return $H.parseJson(a)}catch(b){$H.Debug.warn("History.getCurrentState:parse hash error:"+b.message)}},getCurrentState:function(){try{var a=this.getHashParam();return this.states[a.hKey]}catch(b){$H.Debug.warn("History.getCurrentState:parse hash error:"+
b.message)}},getPreState:function(){try{for(var a=this.getHashParam().hKey,b=this.states,c=b.length,d=0;d++;d<c)if(b[d]==a)return 0<d?b[b[--d]]:null}catch(f){$H.Debug.error("History.getPreState error:"+f.message,f)}},back:function(){var a=this.getPreState();if(a)a.onStateChange(a.param)}});return b});
$Define("M.ModuleManager",["M.History","CM.AbstractManager"],function(f,b){var c=$H.createClass();$H.inherit(c,b,{type:"module",_createMod:function(a){var b=this,c=a.modName;b.modules[c]={waiting:!0};$Require(b.defModPackage+c,function(d){var f={renderTo:b.container,name:c,xtype:c,extCls:"js-module m-module m-"+c.replace(/\./g,"-"),hidden:!0};$H.extend(f,a);d=new d(f);b.modules[c]=d;$H.trigger("afterRender",d.getEl());b.requestMod==c&&b._showMod(d)})},_showMod:function(a){var b=this.modules[this.currentMod];
if(!this.navigator||!this.navigator.navigate(a,b,this))b&&b.hide(),a.show();b&&(b.isActive=!1);a.isActive=!0;this.currentMod=a.name},_destroy:function(a){a.destroy();delete this.modules[a.name]},initialize:function(a){var b=this;b.callSuper();a&&(b.conf=a,$H.extend(b,a),b.container=a.container?$(a.container):$(document.body));b.defModPackage+=".";b.history=new f(function(a,c){b.go(c.param)});b.modules={}},go:function(a,b){"string"==typeof a&&(a={modName:a});var c=a.modName,d=this.currentMod,f=this.modules,
j=f[d];if(d==c)j.waiting||j.reset();else{if(j&&!j.waiting)if(j._forceExit)j._forceExit=!1;else if(!1==j.exit())return!1;this.requestMod=c;(c=f[c])?!0!=c.notCache&&!0!=c.clearCache&&!1!=c.useCache(a)?(!1==c.clearCache,this._showMod(c),c.cache(a)):c.waiting||(this._destroy(c),this._createMod(a)):this._createMod(a);!0!=b&&this.history.saveState({onStateChange:$H.Function.bind(this.go,this),param:a});return!0}},update:function(a,b){var c=a.update(b);c&&(this.modules[a.name]=c,$H.trigger("afterRender",
c.getEl()));return c},clearCache:function(a){a.notCache=!0},back:function(a){a&&(this.modules[this.currentMod]._forceExit=!0);history.back()}});return c});
