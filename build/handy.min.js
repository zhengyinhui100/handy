/* Handy v1.0.0-dev | 2014-03-26 | zhengyinhui100@gmail.com */
(function(){var e=window.handy,d=window.$,a=window.handy=window.$=function(){};a.version="1.0.0";a.expando="handy"+(a.version+Math.random()).replace(/\D/g,"");a.add=function(c,b,f){f||(f=b,b=null);a.base||(a.base={});var h=[];if(b)if("string"==typeof b)h.push(a.base.Object.namespace(b));else for(var d=0;d<b.length;d++)h.push(a.base.Object.namespace(b[d]));h.push(a);b=f.apply(window,h);a.base[c]=a[c]=b;if(0<="Browser,Class,Collection,Cookie,Events,Function,Json,Object,String,Template,Util".indexOf(c))for(var g in b)"undefined"!=
typeof a[g]&&("console"in window&&!Function[g])&&(console.log(a[g]),console.log(c+"\u547d\u540d\u51b2\u7a81:"+g)),a[g]=b[g]};a.noConflict=function(c){window.$===a&&(window.$=d);c&&window.handy===a&&(window.handy=e);return a};a.noop=function(){}})();
handy.add("Json",function(){function e(b){h.lastIndex=0;h.test(b)&&(b=b.replace(h,function(b){var c=j[b];return"string"===typeof c?c:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));return'"'+b+'"'}function d(a,h){var j,g,k,m,n=b,l,s=h[a];s&&("object"===typeof s&&"function"===typeof s.toJSON)&&(s=s.toJSON(a));"function"===typeof c&&(s=c.call(h,a,s));switch(typeof s){case "string":return e(s);case "number":return isFinite(s)?String(s):"null";case "boolean":case "null":return String(s);case "object":if(!s)return"null";
b+=f;l=[];if("[object Array]"===Object.prototype.toString.apply(s)){m=s.length;for(j=0;j<m;j+=1)l[j]=d(j,s)||"null";k=0===l.length?"[]":b?"[\n"+b+l.join(",\n"+b)+"\n"+n+"]":"["+l.join(",")+"]";b=n;return k}if(c&&"object"===typeof c){m=c.length;for(j=0;j<m;j+=1)"string"===typeof c[j]&&(g=c[j],(k=d(g,s))&&l.push(e(g)+(b?": ":":")+k))}else for(g in s)Object.prototype.hasOwnProperty.call(s,g)&&(k=d(g,s))&&l.push(e(g)+(b?": ":":")+k);k=0===l.length?"{}":b?"{\n"+b+l.join(",\n"+b)+"\n"+n+"}":"{"+l.join(",")+
"}";b=n;return k}}var a="JSON"in window,c,b,f,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k=/^[\],:{}\s]*$/,m=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,n=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,l=/(?:^|:|,)(?:\s*\[)+/g;
return{stringify:function(h,j,g,e){if(a&&!e)return JSON.stringify.apply(null,arguments);var k;f=b="";if("number"===typeof g)for(k=0;k<g;k+=1)f+=" ";else"string"===typeof g&&(f=g);if((c=j)&&"function"!==typeof j&&("object"!==typeof j||"number"!==typeof j.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return d("",{"":h})},parseJson:function(b,c,f){function h(b,a){var f,d,j=b[a];if(j&&"object"===typeof j)for(f in j)Object.prototype.hasOwnProperty.call(j,
f)&&(d=h(j,f),void 0!==d?j[f]=d:delete j[f]);return c.call(b,a,j)}if(a&&!f)return JSON.parse.apply(null,arguments);var d;b=String(b);g.lastIndex=0;g.test(b)&&(b=b.replace(g,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(k.test(b.replace(m,"@").replace(n,"]").replace(l,"")))return d=eval("("+b+")"),"function"===typeof c?h({"":d},""):d;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var e;e=(e=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(e[0])?function(a,c,b){var f=[];if(a.length){c=c||0;for(b=b||a.length;c<b;c++)f.push(a[c])}return f}:function(a,c,b){return Array.prototype.slice.call(a,c||0,b||a.length)};var d={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},namespace:function(a,c){var b=null,f,h,j,g;a=d.alias(a);h=a.split(".");b=h[0];b=(j=2==arguments.length)?eval("(function(){if (typeof "+b+' == "undefined"){'+
b+" = {};}return "+b+";})()"):eval("(function(){if (typeof "+b+' != "undefined")return '+b+";})()");f=1;for(g=h.length;f<g;++f){if(f==g-1&&j)b[h[f]]=c;else if(j||b&&b[h[f]])b[h[f]]=b[h[f]]||{};else return;b=b[h[f]]}return b},alias:function(a,c){var b=d._alias;if(c)b[a]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+a+":"+b[a]):b[a]=c;else{if(a){var f=a,h=a.length-1;do{if(b[f])return b[f]+a.substring(h);h=f.lastIndexOf(".")}while(0<h&&(f=f.substring(0,h)));return a}return b}},extend:function(a,c,
b){var f=b?b.notCover:!1,h=b?b.cover:null;b=b?b.IsClone:!1;a=a||{};var j=a.constructor,g=j.$isClass,e,m;for(m in c)if(e=c[m],(!h||d.contains(h,m))&&c.hasOwnProperty(m)){var n=a.hasOwnProperty(m),l=!0===f?n:!1;d.isArray(f)?l=d.contains(f,m)&&n:d.isFunction(f)&&(l=f(m,e));l||(e=b?d.clone(e):e,g&&d.isFunction(e)&&(e.$name=m,e.$owner=j),a[m]=e)}return a},mix:function(a,c,b){a.superProto||(a.superProto={});for(var f in c)a.superProto[f]=d.isFunction(c[f])?a.superProto[f]?function(b,a){return function(){a.apply(this,
arguments);c[b].apply(this,arguments)}}(f,a.superProto[f]):c[f]:c[f],a[f]||(a[f]=c[f]);b&&d.extend(a,b);c.toString!=c.constructor.prototype.toString&&(a.superProto.toString=function(){c.toString.apply(a,arguments)});return a},isFunction:function(a){return"[object Function]"===window.Object.prototype.toString.call(a)},isArray:function(a){return"[object Array]"===window.Object.prototype.toString.call(a)},isClass:function(a){return d.isFunction(a)&&!0===a.$isClass},equals:function(a,c){if(typeof a==
typeof c){if("object"!=typeof a)return a===c;if(a===c)return!0;if(d.isArray(a)&&d.isArray(c)){if(a.length!=c.length)return!1;for(var b=0,f=a.length;b<f;b++)if(!d.equals(a[b],c[b]))return!1;return!0}if(!d.isArray(a)&&!d.isArray(c)){if(d.count(a)!=d.count(c))return!1;for(b in a)if(void 0==c[b]||!d.equals(a[b],c[b]))return!1;return!0}}return!1},clone:function(a){if(null==a||"object"!=typeof a)return a;var c=a.constructor;if(c!=window.Object&&c!=window.Array)return a;if(c==window.Date||c==window.RegExp||
c==window.Function||c==window.String||c==window.Number||c==window.Boolean)return new c(a);try{var b=new c,f;for(f in a)b[f]=d.clone(a[f]);return b}catch(h){return a}},isEmpty:function(a){if(d.isArray(a))return 0==a.length;for(var c in a)return!1;return!0},each:function(a,c,b){var f,h=0,j=a.length,g=void 0===j||d.isFunction(a);if(b)if(g)for(f in a){if(!1===c.apply(a[f],b))break}else for(;h<j&&!1!==c.apply(a[h],b);)f=a.length,j==f?h++:j=f;else if(g)for(f in a){if(!1===c.call(a[f],f,a[f]))break}else for(;h<
j&&!1!==c.call(a[h],h,a[h]);)f=a.length,j==f?h++:j=f;return a},contains:function(a,c){var b=!1;d.each(a,function(a,h){if(d.equals(h,c))return b=!0,!1});return b},largeThan:function(a,c){if("object"==typeof a&&"object"==typeof c){var b=!0;d.each(c,function(f){if(!d.equals(c[f],a[f]))return b=!1});return b}},count:function(a){if(d.isArray(a))return a.length;var c=0,b;for(b in a)c++;return c},removeUndefined:function(a,c){var b=d.isArray(a);if(c){if(b){var f=[];d.each(a,function(b,c){void 0!==c&&f.push(c)});
return f}return d.extend({},a,{isClone:!0,notCover:function(b,c){return void 0===c}})}d.each(a,function(c,f){void 0===f&&(b?a.splice(c,1):delete a[c])});return a},toArray:e,getSingleton:function(a){a="string"==typeof a?d.namespace(a):a;return a._singleton||(a._singleton=new a)},generateMethod:function(a,c,b){c=d.isArray(c)?c:c.split(",");for(var f=0;f<c.length;f++){var h=c[f];a[h]=b(h)}}};return d});
handy.add("Browser","handy.base.Object",function(e){var d={},a={};e.generateMethod(a,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(b){return function(c){var a=d[b];return!c&&"string"===typeof a&&/^[\d\.]+$/.test(a)?parseInt(a):a}});e=window.navigator.userAgent;var c;(c=e.match(/MSIE ([\d.]+)/))?d.ie=c[1]:(c=e.match(/Firefox\/([\d.]+)/))?d.firefox=c[1]:(c=e.match(/Chrome\/([\d.]+)/))?
d.chrome=c[1]:(c=e.match(/Opera.([\d.]+)/))?d.opera=c[1]:(c=e.match(/Version\/([\d.]+).*Safari/))?d.safari=c[1]:0;/windows|win32/i.test(e)?d.windows=!0:/linux/i.test(e)?d.linux=!0:/macintosh/i.test(e)?d.mac=!0:0;/trident/i.test(e)?d.trident=!0:/webkit/i.test(e)?d.webkit=!0:/gecko/i.test(e)?d.gecko=!0:/presto/i.test(e)?d.presto=!0:0;/MetaSr/i.test(e)?d.sogou=!0:/Maxthon/i.test(e)?d.maxthon=!0:/TencentTraveler/i.test(e)?d.tt=!0:/TheWorld/i.test(e)?d.theWorld=!0:/360[S|E]E/i.test(e)?d.is360=!0:0;var b;
if((b=e.match(/AppleWebKit\/([\d.]*)/))&&b[1])if(/ Mobile\//.test(e)&&e.match(/iPad|iPod|iPhone/)){d.mobile="ios";if((b=e.match(/OS ([^\s]*)/))&&b[1])d.ios=b[1].replace("_",".");if((b=e.match(/iPad|iPod|iPhone/))&&b[0])d[b[0].toLowerCase()]=d.ios}else if(/ Android/i.test(e)){if(/Mobile/.test(e)&&(d.mobile="android"),(b=e.match(/Android ([^\s]*);/))&&b[1])d.android=b[1]}else if(b=e.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))d.mobile=b[0].toLowerCase();var f;try{if(d.ie){var h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
h&&(f=h.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(h=navigator.plugins["Shockwave Flash"])){var j=h.description.split(" ");c=0;for(var g=j.length;c<g;c++)if(0<parseInt(j[c])){f=j[c];break}}}catch(k){}d.flash=f?f:null;return a});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(e,d,a){var c={level:0,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!d.mobile(),out:function(b,f,h){h=h||"log";if(f||c.showInPage){f=a.expando+"debugDiv";var d=top.document,g=d.getElementById(f);g?g.style.display="block":(g=d.createElement("DIV"),g.id=f,g.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+d.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u5168\u5c4f</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',g.style.position="fixed",g.style.width=d.body.offsetWidth-20+"px",g.style.left=0,g.style.top=0,g.style.right=0,g.style.height="150px",g.style.backgroundColor="#aaa",g.style.fontSize="12px",g.style.padding="10px",g.style.zIndex=9999999999,g.style.opacity=0.8,g.style.filter="alpha(opacity=80)",d.body.appendChild(g));f=g.getElementsByTagName("DIV")[0];d=a.Json.stringify(b,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0).replace(/\n/g,"<br/>");f.innerHTML+=
h+" : "+d+"<br/>";f.scrollTop=f.scrollHeight}try{console[h](b)}catch(e){}},log:function(b,a){c.level>c.LOG_LEVEL||c.out(b,!!a,"log")},info:function(b,a){this.level>c.INFO_LEVEL||c.out(b,!!a,"info")},warn:function(b,a){c.level>c.WARN_LEVEL||c.out(b,!!a,"warn")},error:function(b,a){if(!(c.level>c.ERROR_LEVEL)&&(c.out(b,!!a,"error"),b instanceof Error))throw b;},time:function(b,a,h){c.level>c.INFO_LEVEL||(b?("boolean"==typeof a&&(h=a,a=""),c.out((a||"")+((new Date).getTime()-(c.lastTime||0)),!!h)):c.lastTime=
(new Date).getTime())},debug:function(b){if(!(c.level>c.DEBUG_LEVEL)&&!1!==b)debugger}};return c});handy.add("Function",function(e){return{bind:function(d,a,c){var b=Array.prototype.slice.call(arguments,2);return function(){Array.prototype.push.apply(b,arguments);return d.apply(a,b)}},intercept:function(d,a,c,b){return e.Object.isFunction(d)&&e.Object.isFunction(a)?function(){var f=c||this,h={},j=arguments;h.scope=b;h.target=f;h.method=d;return!1!=a.apply(h,j)?d.apply(f,j):!1}:d}}});
handy.add("Class",["B.Object","B.Debug"],function(e,d){var a={createClass:function(c){var b=function(){var c,a;c=this.constructor==b?this:arguments.callee;if(a=c.initialize){for(var d in c)"object"==typeof c[d]&&(c[d]=e.clone(c[d]));return a.apply(c,arguments)}};b.$isClass=!0;b.derive=function(b,c,d){var g=a.createClass();a.inherit(g,this,b,c,d);return g};b.prototype.callSuper=function(b,c){b&&(!b.$isClass&&void 0!=b.length)&&(c=b,b=null);var a=arguments.callee.caller,d=a.$owner.superProto;c=c||a.arguments;
b=b?b.prototype:d||this.constructor.superProto;a=a.$name;if(b&&(a=b[a],e.isFunction(a)))return a.apply(this,c)};c&&this.namespace(c,b);return b},inherit:function(c,b,a,h,j){var g=function(){};g.prototype=b.prototype;e.extend(c,b,j);c.prototype=new g;c.prototype.constructor=c;c.superClass=b;c.superProto=b.prototype;if(b._onInherit)try{b._onInherit(c)}catch(k){d.error(k)}h&&e.extend(c,h);a&&e.extend(c.prototype,a)}};return a});
handy.add("Loader",["B.Debug","B.Object","B.Function"],function(e,d,a,c){function b(b){var c={},a=[];"string"==typeof b&&(b=[b]);for(var h=0,f=b.length;h<f;h++){var j;j=b[h];j=/\.(css|js)$/.test(j)?y[j]&&"loaded"==y[j].status:q.urlMap&&q.urlMap[j]?q.urlMap[j].chkExist():d.namespace(j);if(j)a.push(j);else return c.notExist=b[h],c}c.exist=a;return c}function f(b,c){function a(){a.isCalled||(a.isCalled=!0,clearTimeout(g),c())}if("SCRIPT"===b.nodeName){var f=b,d=a;f.onload=f.onerror=f.onreadystatechange=
function(){/loaded|complete|undefined/.test(f.readyState)&&(f.onload=f.onerror=f.onreadystatechange=null,n.removeChild(f),f=null,setTimeout(d,0))}}else{var j=a;window.hasOwnProperty("attachEvent")?b.attachEvent("onload",j):setTimeout(function(){h(b,j)},0)}var g=setTimeout(function(){e.error("Time is out:"+b.src);a()},q.timeout)}function h(b,c){if(!c.isCalled){var a;if(l)b.sheet&&(a=!0);else if(b.sheet)try{b.sheet.cssRules&&(a=!0)}catch(f){if("SecurityError"===f.name||"NS_ERROR_DOM_SECURITY_ERR"===
f.name)a=!0}setTimeout(function(){a?c():h(b,c)},1)}}function j(b){q.showLoading(!1);v--;y[b].status="loaded";q.traceLog&&e.info(k+"Response: "+b);g()}function g(){for(var c=r.length-1;0<=c;c--){var a=r[c],f=b(a.deps);if(f.notExist)0==c&&0==v&&$D.error(m+f.notExist);else{r.splice(c,1);a.callback.apply(null,f.exist);g();break}}}var k="Loader ",m=k+"not found: ",n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,l=navigator.userAgent.indexOf("AppleWebKit"),r=[],v=0,y=
{},q={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(b,a,f){b=c.Object.alias(b);2==arguments.length&&(f=a,a=[]);q.require(a,function(){var c;if("function"==typeof f)try{c=f.apply(null,arguments),q.traceLog&&e.info(k+"define: "+b)}catch(a){a.message=k+b+":factory define error:"+a.message;e.error(a);return}else c=f;if(c){d.namespace(b,c);var h=typeof c;if("object"==h||"function"==h)c.$ns=b}else $D.error(k+"factory no return: "+b)})},require:function(h,d){for(var g=
"string"==typeof h?[h]:h,l=[],s=[],u=!0,t=0,w=g.length;t<w;t++){var p=g[t],p=c.Object.alias(p),x=b(p);x.notExist?(l.push(p),u&&(u=!1,r.push({deps:g,callback:d})),q.traceLog&&e.info(m+p)):s.push(x.exist[0])}if(0==l.length)return d&&d.apply(null,s),0==s.length?s[0]:s;u=!1;g=0;for(s=l.length;g<s;g++)if(t=l[g],!y[t]){u=t;p=q.urlMap&&q.urlMap[u]&&q.urlMap[u].url;if(!p){w="";p=q.rootPath;if("string"==typeof p)w=p;else if("object"==typeof p)for(x in x=void 0,p)0==u.indexOf(x)&&(w=p[x],u=u.replace(x,""));
else w="";p=/.css$/.test(u)?0==u.indexOf("/")?u:"/css/"+u:/.js$/.test(u)?u:u.replace(/\./g,"/")+".js";0!=p.indexOf("/")&&(p="/"+p);p=w+p}u=!0;y[t]={id:t,status:"loading"};w=a.bind(j,null,t);if(/.css$/.test(p))a:{t=p;p=n.getElementsByTagName("link");for(x=0;x<p.length;x++){var C=p[x].href;!q.skinNode&&0<=C.indexOf(q.skinName)&&(q.skinNode=p[x]);if(0<=C.indexOf(t)||0<=t.indexOf(C))break a}p=document.createElement("link");p.rel="stylesheet";p.href=t;f(p,w);n.insertBefore(p,q.skinNode);q.traceLog&&e.info(k+
"request:"+t)}else t=p,p=document.createElement("script"),p.async="async",p.src=t,p.type="text/javascript",f(p,w),n.appendChild(p),q.traceLog&&e.info(k+"request:"+t);v++}u&&q.showLoading(!0)}};return q});
handy.add("Events",function(e){return{_eventCache:{},_parseEvents:function(d,a){var c=/\s+/;if("object"==typeof d){for(var b in d)a([b,d[b]]);return!0}if("string"==typeof d&&c.test(d)){c=d.split(c);b=0;for(var f=c.length;b<f;b++)a([c[b]]);return!0}return!1},_parseCustomEvents:function(d,a,c){var b=this,f=e.toArray(arguments,2);return b._parseEvents(a,function(c){b[d].apply(b,c.concat(f))})},_delegateHandler:function(d,a){var c=this;return function(){if(!0!=c.isSuspend)return d.apply(a||c,arguments)}},
on:function(d,a,c,b){if(!this._parseCustomEvents("on",d,a,c,b)){"number"==typeof c&&(b=c,c=null);var f=this._eventCache,h=f[d];h||(h=f[d]=[]);d=this._delegateHandler(a,c);h.push({times:b,handler:a,context:c,delegation:d})}},once:function(d,a,c){var b=e.toArray(arguments);this.on.apply(this,b.push(1))},off:function(d,a){if("all"==d)return this._eventCache={},!0;if(!this._parseCustomEvents("off",d,a)){var c=this._eventCache,b=d.indexOf(".");if(!a&&0>=b){for(var f in c)(f.split(".")[0]==d||0==b&&0<=
f.indexOf(d))&&delete c[f];return!0}b=c[d];if(!b)return!1;if(a){c=0;for(f=b.length;c<f;c++)if(b[c].handler==a)return b.splice(c,1),!0}else return delete c[d],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(d,a){function c(c){if(c)for(var a=0,f=c.length;a<f;a++){var d=c[a],g=d.delegation;"number"==typeof d.times&&(1<d.times?d.times--:b.off(k,d.handler));j=g.apply(null,h)}}var b=this,f=e.toArray(arguments);
f.unshift("trigger");if(!b._parseCustomEvents.apply(b,f)){var f=b._eventCache,h=e.toArray(arguments),j,g;if(0<d.indexOf("."))g=f[d],c(g);else for(var k in f)if(g=d.indexOf("."),k.split(".")[0]==d||0==g&&0<=k.indexOf(d))g=f[k],c(g);c(f.all);return j}}}});
handy.add("Date",function(){var e=window.Date,d={getWeek:function(a,c){var b=a.getDay();c&&(b=(b+(c%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[b]},isWeeken:function(a){return 0==a.getDay()||6==a.getDay()},getDaysInMonth:function(a){a=new e(a.getFullYear(),a.getMonth()+1,0);return a.getDate()},getDaysInYear:function(a){var c=new e(a.getFullYear(),0,0);a=new e(a.getFullYear()+1,0,0);return Math.floor((a.getTime()-c.getTime())/864E5)},getDayIndexOfYear:function(a){var c=new e("1/1/"+
a.getFullYear());return Math.ceil((a.getTime()-c.getTime())/864E5)},format:function(a,c){c=c||"yyyy-MM-dd HH:mm:ss";a=a||new e;var b=a.getHours(),f=Math.floor((a.getMonth()+3)/3),b={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":0==b%12?12:b%12,"H+":b,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":d.getWeek(a),"q+":f,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][f-1],"S+":a.getMilliseconds()},h;for(h in b)RegExp("("+h+")").test(c)&&(f=RegExp.$1.length,c=c.replace(RegExp.$1,1==f?b[h]:("00"+
b[h]).slice(-f)));return c},parse:function(a,c){for(var b=(c||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),f=a.match(/\d+/g),h=new e,d=0;d<f.length;d++){var g=b[d],k=parseInt(f[d]);switch(g){case "yyyy":h.setFullYear(k);break;case "MM":h.setMonth(k-1);break;case "dd":h.setDate(k);break;case "HH":h.setHours(k);break;case "mm":h.setMinutes(k);break;case "ss":h.setSeconds(k);break;case "SS":h.setMilliseconds(k)}}return h},parseObject:function(a){return new e(a.year+1900,a.month,a.date,a.hours,a.minutes,
a.seconds)}};return d});
handy.add("String",function(){var e={stripTags:function(d){return d.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(d){var a=document.createElement("div");d=document.createTextNode(d);a.appendChild(d);return a.innerHTML},unescapeHTML:function(d){var a=document.createElement("div");a.innerHTML=e.stripTags(d);return a.childNodes[0].nodeValue},decodeHTML:function(d){d=d.replace(/&lt;/gi,"<");d=d.replace(/&gt;/gi,">");d=d.replace(/&quot;/gi,'"');d=d.replace(/&apos;/gi,"'");d=d.replace(/<\/?br>/gi,"\n");
d=d.replace(/&amp;/gi,"&");return d=d.replace(/&nbsp;/gi," ")},encodeHTML:function(d){d=d.replace(/&/gi,"&amp;");d=d.replace(/</gi,"&lt;");d=d.replace(/>/gi,"&gt;");d=d.replace(/\"/gi,"&quot;");d=d.replace(/\'/gi,"&apos;");d=d.replace(/\n/gi,"</br>");return d=d.replace(/ /gi,"&nbsp;")},trim:function(d){return d=d.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(d,a){a||(a=/[,%\'\"\/\\;|\<\>\^]/);return-1<d.search(a)},len:function(d){return d.replace(/[^\x00-\xff]/g,"**").length},left:function(d,
a,c){if(e.len(d)>a){!0===c?c=2:0<c||(c=0);var b=0,f=0;for(a-=c;f<a;)255<d.charCodeAt(b)?f+=2:f++,b++;d=d.substring(0,b);for(b=0;b<c;b++)d+="."}return d},isNumber:function(d){return 0==d.search(/^\d+$/g)},hasChn:function(d){return/[\u4E00-\u9FA5]+/.test(d)},isChn:function(d){return/^[\u4E00-\u9FA5]+$/.test(d)},addParam:function(d,a){a&&(d+=(-1<d.indexOf("?")?"&":"?")+a);return d}};return e});
handy.add("Cookie",function(){return{getCookie:function(e,d){var a=e+"=",c="",b=document.cookie;if(0<b.length){var f=b.indexOf(a);-1!=f&&(f+=a.length,a=b.indexOf(";",f),-1==a&&(a=b.length),c=b.substring(f,a),d||(c=unescape(c)))}return c},setCookie:function(e,d,a){var c=[];void 0!=e&&void 0!=d&&c.push(e+"="+escape(d));a&&(void 0!=a.path&&c.push("path="+a.path),void 0!=a.domain&&c.push("domain="+a.domain),void 0!=a.expires&&c.push("expires="+a.expires),a.secure&&c.push("secure"));document.cookie=c.join(";")},
delCookie:function(e){var d=new Date;d.setTime(d.getTime()-1);document.cookie=e+"=;expires="+d.toGMTString()}}});
handy.add("Util","B.Object",function(e){var d=0;return{isWindow:function(a){return null!=a&&a==a.window},getUuid:function(){return d++},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(a){var c=top.location.hash;0<=c.indexOf("#")&&(a=c.replace(/#[^\?]*/,a));top.location.hash=a},distance:function(a,c,b){var f,h;e.isArray(a)?(f=a[0],a=a[1],h=c[0],c=c[1]):(f=a.latitude,a=a.longtitude,h=c.latitude,c=c.longtitude);f=f*Math.PI/180;h=h*Math.PI/180;a=a*Math.PI/180-c*Math.PI/
180;a=2*Math.asin(Math.sqrt(Math.pow(Math.sin((f-h)/2),2)+Math.cos(f)*Math.cos(h)*Math.pow(Math.sin(a/2),2)));a=Math.round(63781370*a);b&&(a=1E3<a?(a/1E3).toFixed(1)+"km":a+"m");return a},result:function(a,c){var b=a[c];return e.isFunction(b)?b():b}}});
handy.add("Collection","B.Object",function(e,d){function a(b){return b}function c(b){return function(c){return c[b]}}function b(b){return function(c){if(c===b)return!0;for(var a in b)if(b[a]!==c[a])return!1;return!0}}return{map:function(b,c,a){var d=[];if(null==b)return d;var k=Array.prototype.map;if(k&&b.map===k)return b.map(c,a);e.each(b,function(b,f){d.push(c.call(a,f,b))});return d},pluck:function(b,a){return this.map(b,c(a))},some:function(b,c,a){var g=!1;if(null==b||!c)return g;var e=Array.prototype.some;
if(e&&b.some===e)return b.some(c,a);d.each(b,function(b,f,d){if(g||(g=c.call(a,f,b,d)))return!1});return!!g},every:function(b,c,a){var g=!0;if(null==b||!c)return g;var e=Array.prototype.every;if(e&&b.every===e)return b.every(c,a);d.each(b,function(b,d,f){if(!(g=c.call(a,d,b,f)))return!1});return!!g},find:function(b,c,a){var d;this.some(b,function(b,f,e){if(c.call(a,b,f,e))return d=b,!0});return d},filter:function(b,c,a){var g=[];if(null==b)return g;var e=Array.prototype.filter;if(e&&b.filter===e)return b.filter(c,
a);d.each(b,function(b,d,f){c.call(a,d,b,f)&&g.push(d)});return g},where:function(c,a){return this.filter(c,b(a))},findWhere:function(c,a){return this.find(c,b(a))},invoke:function(b,c){var a=Array.prototype.slice.call(arguments,2),d=e.isFunction(c);return this.map(b,function(b){return(d?c:b[c]).apply(b,a)})},sortBy:function(b,h,j){var g=h;h=null==g?a:d.isFunction(g)?g:c(g);return this.pluck(this.map(b,function(b,c,a){return{value:b,index:c,criteria:h.call(j,b,c,a)}}).sort(function(b,c){var a=b.criteria,
d=c.criteria;if(a!==d){if(a>d||void 0===a)return 1;if(a<d||void 0===d)return-1}return b.index-c.index}),"value")}}});
handy.add("Template","B.String",function(e,d){function a(b){return j?"$r+="+b+";\n":"$r.push("+b+");\n"}function c(b){b=b.replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n");return a('"'+b+'"')}var b={openTag:"<%",closeTag:"%>",isEscape:!0,registerHelper:function(b,c){g[b]||(k+=b+"=oHelpers."+b+",");g[b]=c},tmpl:function(e,n){var l,r,v;if("string"==typeof e)l=e;else if(l=e.tmpl,v=e.id)if(f[v])r=f[v];else if(!l){var y=document.getElementById(v);y&&(l=(y.value||y.innerHTML).replace(/\s/g,
""))}if(!r){if(!l){d.Debug.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}var q=k+"$r="+(j?'""':"[]")+";\n";d.Object.each(l.split(b.openTag),function(d,f){var j=f.split(b.closeTag);if(1==j.length)q+=c(j[0]);else{var g=q,e=j[0],e=e.replace(/this/g,"$data");0==e.indexOf("=")&&(e=a(e.replace(h,"")+'||""'));q=g+(e+"\n");j[1]&&(q+=c(j[1]))}});q+="return "+(j?"$r;":'$r.join("");');l=new Function("$data",q);l.$helpers=g;r=l;v&&(f[v]=r)}return n?r(n):r}},f={},h=/^=/,j="".trim,g={escape:e.escapeHTML,trim:e.trim},
k="var oHelpers=arguments.callee.$helpers,escape=oHelpers.escape,trim=oHelpers.trim,";return b});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(e,d,a){function c(b){if(b==m)return!1;var c=k.contentWindow.document;c.open();c.write("<!doctype html><html><body>"+b+"</body></html>");c.close();m=b;e.log("set:"+k.contentWindow.document.body.innerText)}function b(){var b=d.getHash(),a=k.contentWindow.document.body.innerText;b!=m?(c(b),f(b)):a!=m&&(e.log("update:"+k.contentWindow.document.body.innerText),d.setHash(a))}function f(b){var c=r.listeners,a;for(a in c)c[a](b)}var h,
j=0,g=document,k,m,n=g.documentMode,l="onhashchange"in window&&(void 0===n||7<n),r={delay:50,listen:function(e,m){if(!h&&!h)if(h=!0,r.listeners={},l)$(window).on("hashchange",function(){f(d.getHash())});else k=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(g.body)[0],$(k).one("load",function(){c(d.getHash());setInterval(b,r.delay)});if(m in r.listeners)$D.error(Error("Duplicate name"));else return m=m||a.expando+ ++j,r.listeners[m]=e,m},unListen:function(b){for(var c in r.listeners)(!b||
b==c)&&delete r.listeners[c]}};return r});handy.add("Support","B.Browser",function(e){var d={mediaQuery:function(){var c;if(e.mobile())c="hui-mobile";else{c="hui-pc";var b=e.ie();b&&(c+=" ie"+b)}document.documentElement.className+=" "+c}};d.mediaQuery();if(6==e.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}return d});
handy.add("Validator",["B.String","B.Object"],function(e,d){var a={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(c,b){var d=b.rules,h;for(h in d){var j=d[h],g=("function"==typeof j?j:a[h])(c,j);if(!g)return d=b.error||a.error,h=b.messages&&
b.messages[h]||a.messages[h],h=h.replace(/\{([^\}]+)\}/g,function(c,a){return j[a]||0==a&&j||b[a]||j||""}),d&&d(h),g}return!0},required:function(c){return 0<e.trim(""+c).length},email:function(c){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(c)},
url:function(c){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(c)},
date:function(c){return!/Invalid|NaN/.test((new Date(c)).toString())},dateISO:function(c){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(c)},number:function(c){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(c)},digits:function(c){return/^\d+$/.test(c)},creditcard:function(c){if(/[^0-9 \-]+/.test(c))return!1;var b=0,a=0,d=!1;c=c.replace(/\D/g,"");for(var j=c.length-1;0<=j;j--){a=c.charAt(j);a=parseInt(a,10);if(d&&9<(a*=2))a-=9;b+=a;d=!d}return 0===b%10},min:function(c,b){return c>=b},max:function(c,
b){return c<=b},range:function(c,b){return c>=b[0]&&c<=b[1]},minlength:function(c,b){return(d.isArray(c)?c.length:e.trim(""+c).length)>=b},maxlength:function(c,b){return(d.isArray(c)?c.length:e.trim(""+c).length)<=b},rangelength:function(c,b){var a=d.isArray(c)?c.length:e.trim(""+c).length;return a>=b[0]&&a<=b[1]},equalTo:function(a,b){return a===b}};return a});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(e,d,a){d={_init:function(){!c&&e.ie()&&(f=document.getElementById("LocalStorageUserDataDiv"),f||(f=document.createElement("DIV"),f.style.display="none",f.id="LocalStorageUserDataDiv",f.addBehavior("#default#userData"),document.body.appendChild(f),f.load(h)))},getItem:function(d){d=c?b.getItem(d):f.getAttribute(d);return d=a.parseJson(d)},setItem:function(d,g){g=a.stringify(g);try{c?b.setItem(d,g):(f.setAttribute(d,g),f.save(h))}catch(e){return $D.error(e),
!1}return!0},removeItem:function(a){c?b.removeItem(a):(f.removeAttribute(a),f.save(h))},clear:function(){c?b.clear():f.unload()}};var c=window.localStorage&&window.localStorage.getItem,b=window.localStorage,f,h=document.domain;d._init();return d});(function(e){Hui=H=$H=e.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};e=window.$;e.fn.remove=$H.intercept(e.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
$Define("CM.AbstractEvents",function(){var e=$H.createClass();$H.extend(e.prototype,$H.Events);$H.extend(e.prototype,{_eventCache:{},_listenTo:[],_parseListenToEvents:function(d,a,c,b){var f=this,h=$H.toArray(arguments,3);return f._parseEvents(c,function(b){b.unshift(a);f[d].apply(f,b.concat(h))})},listenTo:function(d,a,c,b,f){if(!this._parseListenToEvents("listenTo",d,a,c,b,f)){"number"==typeof b&&(f=b,b=null);var h=this._delegateHandler(c,b);this._listenTo.push({target:d,name:a,delegation:h,handler:c});
d.on(a,h,b||this,f)}},unlistenTo:function(d,a,c){if(!this._parseListenToEvents("unlistenTo",d,a,c))for(var b=this._listenTo,f="all"==d,h,j=0,g=b.length;j<g;j++)if(h=b[j],f||h.name==a&&h.handler==c&&h.target==d)d.off(a,h.delegation),b.splice(j,1)}});return e});
$Define("CM.AbstractDao","B.LocalStorage",function(e){var d=$H.createClass();$H.extend(d.prototype,{ajax:function(a){this.beforeSend(a);a.error=$H.intercept(this.error,a.error);a.success=$H.intercept(this.success,a.success);return $.ajax(a)},beforeSend:$H.noop,error:$H.noop,success:$H.noop,get:function(){},set:function(){},remove:function(){},sync:function(a){a=a||{};var c=a.type||"remote";a=a.param;if("remote"==c)this.ajax(a);else e[c+"Item"](a)}});return d});
$Define("CM.AbstractManager",function(){var e=$H.createClass();$H.extend(e.prototype,{_types:{},_all:{},type:"manager",registerType:function(d,a){this._types[d]=a;a.prototype.xtype=d},getClass:function(d){return $H.isClass(d)?d:this._types[d]||$H.namespace(d)},register:function(d){this._all[d.getId()]=d},unregister:function(d){var a=this._all,c=d.getId();a[c]==d&&delete a[c]},eachInEl:function(d,a){var c=this;d.find(".js-"+c.type).each(function(b,d){d=$(d);var h=d.attr("id");(h=c.get(h))&&a(h)})},
generateId:function(d,a){var c=$H.expando+"_"+this.type+"_"+(d||$H.Util.getUuid());if(!0!=a&&this._all[c])$D.error("id\u91cd\u590d:"+c);else return c},get:function(d){var a=this._all;return a[d]||a[this.generateId(d,!0)]}});return e});
$Define("CM.ViewManager","CM.AbstractManager",function(e){var d=$H.createClass();$H.inherit(d,e,{type:"view",initialize:function(){var a=this;$H.on("afterRender",function(c,b){a.afterRender(b)});$H.on("removeEl",function(c,b){a.destroy(b)})},afterRender:function(a){this.eachInEl(a,function(a){a.afterRender()})},destroy:function(a){this.eachInEl(a,function(a){a.destroy(!0)})}});$V=$H.getSingleton(d);return d});
$Define("CM.View",["CM.ViewManager","CM.AbstractEvents","B.Template"],function(e,d){var a=/^(<[a-zA-Z]+)/,c=/^[^>]+class=/,b=/(class=")/,f=d.derive({xtype:"View",_placeholder:'<script id="" type="text/x-placeholder">\x3c/script>',autoRender:!0,renderBy:"append",listeners:[],items:[],children:[],_customEvents:"beforeRender render afterRender beforeShow show afterShow beforeHide hide afterHide beforeUpdate update afterUpdate beforeDestroy destroy afterDestroy add remove".split(" "),_defaultEvents:"mousedown mouseup mouseover mousemove mouseenter mouseleave dragstart drag dragenter dragleave dragover drop dragend touchstart touchmove touchend touchcancel keydown keyup keypress click dblclick focus focusin focusout contextmenu change submit".split(" "),
_applyArray:function(b,a){var c=arguments,d=c.callee.caller,f=d.$owner.prototype;0==c.length?(c=d.arguments,c=$H.toArray(c),b=d.$name,a=c.shift()):c=$H.toArray(c,2);if($H.isArray(a)){for(var d=0,e=a.length;d<e;d++)f[b].apply(this,[a[d]].concat(c));return!0}return!1},_parseListenEvents:function(b,a){var c=this;return c._parseEvents(a.name,function(d){a.name=d[0];2==d.length&&(a.handler=d[0]);c[b].call(c,a)})},initialize:function(b){this.inited||(this.manager=this.constructor.manager||$H.getSingleton(e),
this.doConfig(b),this.parseItems(),!1!=this.autoRender&&this.render(),this.manager.register(this),this.inited=!0)},doConfig:function(b){var a=this;b=a.initParam=$H.clone(b||{});$H.extend(a,b,{notCover:function(c,d){var f=$H.contains(a._customEvents,c);if($H.contains(a._defaultEvents,c))return a.listeners.push({name:c,handler:b[c]}),!0;if(f)return a.on(c,b[c]),!0;if("defItem"==c)return $H.extend(a[c],d),!0;if("listener"==c)return a.listeners=a.listeners.concat($H.isArray(d)?d:[d]),!0;if("items"==c)return a.add(d),
!0;if("xtype"==c)return"View"==a[c]&&(a[c]="string"==typeof d?d:d.$ns.replace(/\./g,"_")),!0}});a.renderTo=b.renderTo?$(b.renderTo):$(document.body)},getEl:function(){return this._container},getId:function(){return this._id||(this._id=this.manager.generateId(this.cid))},initHtml:function(){"string"!=typeof this.tmpl&&(this.tmpl=this.constructor.prototype.tmpl=this.tmpl.join(""));return $H.Template.tmpl({id:this.xtype,tmpl:this.tmpl},this)},getHtml:function(){var d=this.getId(),f;f="visibility"==this.displayMode?
"visibility:hidden;":"display:none;";var e=this.initHtml(),k=c.test(e),m="js-"+this.manager.type+" js-"+this.xtype+" "+this.extCls+" ";k&&(e=e.replace(b,"$1"+m));return e=e.replace(a,'$1 id="'+d+'" style="'+f+'"'+(k?"":' class="'+m+'"'))},findHtml:function(b){0!=b.indexOf("$")&&(b="$"+b);b="$>*"==b?this.children:this.find(b);for(var a=[],c=0;c<b.length;c++)a.push(b[c].getHtml());return a.join("")},initStyle:function(){var b=this.getEl(),a=this.style||{};void 0!=this.width&&(a.width=this.width);void 0!=
this.height&&(a.height=this.height);b.css(a)},beforeRender:function(){return this.trigger("beforeRender")},render:function(){if(!1==this.beforeRender())return!1;this.trigger("render");var b=this.getHtml();this.renderTo[this.renderBy](b);this.afterRender()},afterRender:function(){if(this.rendered)return!1;this.callChild();this._container=$("#"+this.getId());this.rendered=!0;this.initStyle();!0!=this.notListen&&this.initListeners();this.disabled&&this.disable();this.trigger("afterRender");this.hidden||
this.show()},beforeShow:function(){return this.trigger("beforeShow")},show:function(b,a){var c=this;if(!1==c.beforeShow()||c.showed||a&&c.hidden)return!1;if(!b&&c.delayShow)setTimeout(function(){f.prototype.show.call(c,!0)},0);else{c.trigger("show");c.showed=!0;var d=c.getEl();"visibility"==c.displayMode?d.css({visibility:"visible"}):d.show();c.callChild([null,!0]);c.afterShow()}},afterShow:function(){this.trigger("afterShow")},beforeHide:function(){return this.trigger("beforeHide")},hide:function(){if(!1==
this.beforeHide()||!this.showed)return!1;this.showed=!1;var b=this.getEl();"visibility"==this.displayMode?b.css({visibility:"hidden"}):b.hide();this.trigger("hide");this.afterHide()},afterHide:function(){this.trigger("afterHide")},enable:function(){this.resume();this.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")},disable:function(){this.suspend();this.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled","disabled")},getContent:function(b,
a){a?!a instanceof f&&(a=this.find(a),$H.isArray(a)&&(a=a[0])):a=this;return!1==b?a.children:a.getEl().html()},setContent:function(b,a){if(a)return!a instanceof f&&(a=this.find(a),$H.isArray(a)&&(a=a[0])),a.setContent(b);var c=this.getEl();c.contents().remove();if("string"==typeof b)c.html(b);else return this.add(b)},listen:function(b){if(!this._parseListenEvents("listen",b)){var a=b.name,c=b.context,d=b.times,f=b.target,e=b.custom,l=b.handler;if(f||e)b=$H.removeUndefined([f,a,l,c,d]),this[e?"on":
"listenTo"].apply(this,b);else if(b.custom)this.on.apply(this,a,l,c,d);else{var e=this._listeners,d=b.el,f=b.method||"bind",r=b.selector,v=b.data,c=b.delegation=this._delegateHandler(l,c);$H.mobile()&&"click"==a&&(a="touchend");d=d?"string"==typeof d?this.find(d):d:this.getEl();if(r)if(v)d[f](r,a,v,c);else d[f](r,a,c);else if(v)d[f](a,v,c);else d[f](a,c);e.push(b)}}},unlisten:function(b){if(!this._parseListenEvents("unlisten",b)){var a=b.name,c=b.handler;if(b.custom)this.off(a,c);else{var d=b.el,
f="delegate"==b.method?"undelegate":"unbind";b=b.selector;var e;$H.mobile()&&"click"==a&&(a="touchend");for(var d=d?"string"==typeof d?this.find(d):d:this.getEl(),l=this._listeners.length-1;0<=l;l--){var r=this._listeners[l];if(r.handler==c){e=r.delegation;this._listeners.splice(l,1);break}}if(b)d[f](b,a,e);else d[f](a,e)}}},initListeners:function(){if(this.listened)return!1;this.listened=!0;var b=this.listeners;this._listeners=[];for(var a=b.length-1;0<=a;a--)this.listen(b[a]);this.callChild()},
clearListeners:function(){for(var b=this._listeners,a=b.length-1;0<=a;a--)this.unlisten(b[a]);this.off("all");this.unlistenTo("all");this.callChild()},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0;this.callChild()},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1;this.callChild()},each:function(b,a){for(var c=this.children,d=c.length,f,e=0;e<d;){f=c[e];f=a?b.apply(f,a):b(e,f);if(!1===f)break;d==c.length?e++:d=c.length}},match:function(b,a){if("*"==b)return!0;var c=
a||this,d,f,e;b=b.replace(/^([^\[]+)/,'[xtype="$1"]');for(var l=/\[([^=|\!]+)(=|\!=)([^=]+)\]/g;d=l.exec(b);)if(f=d[1],e=d[2],d=eval(d[3]),"="===e?c[f]!=d:c[f]==d)return!1;return!0},find:function(b,a){var c=this;if("number"==typeof b)return c.children[b];if(0!=b.indexOf("$"))return c.getEl().find(b);a=a||[];if(0<b.indexOf(","))return $H.each(b.split(","),function(b,d){a=a.concat(c.find(d))}),a;var d=1==b.indexOf(">"),f=b.replace(/^\$>?\s?/,""),e=f.search(/\s|>/),l;0<e&&(l=f.substring(e),f=f.substring(0,
e));c.each(function(c,e){e.match(f)&&(l?e.find("$"+l,a):a.push(e));d||e.find(b,a)});return a},parents:function(b){if(b&&0!=b.indexOf("$"))return this.getEl().parents(b);for(var a=this;a.parent;)if(a=a.parent,b&&this.match(b,a))return a;return b||a===this?null:a},index:function(){var b=this,a=b.parent;if(a){var c;a.each(function(a,d){if(d==b)return c=a,!1});return c}return null},callChild:function(b,a){0!=this.children.length&&(b&&"string"!=typeof b&&(a=b,b=null),b=b||arguments.callee.caller.$name,
this.each(function(c,d){a?d[b].apply(d,a):d[b].call(d)}))},add:function(b,a){if(!this._applyArray()){var c=void 0==a;if(this.startParseItems){if(b instanceof f)b.parent=this;else{this.defItem&&$H.extend(b,this.defItem,{notCover:!0});this.parseItem(b);var d=this.manager.getClass(b.xtype);d?(b.renderTo||(this.inited?b.renderTo=this.getEl():b.autoRender=!1),b.parent=this,b=new d(b)):$D.error("xtype:"+b.xtype+"\u672a\u627e\u5230")}d=this.children;c?d.push(b):d.splice(a,0,b);this.trigger("add",b);return b}d=
this.items;c?d.push(b):d.splice(a,0,b)}},remove:function(b){var a=this.children,c=!1,d;if("number"==typeof b)d=b,b=a[d];else if("string"==typeof b){b=this.find(b);for(var e=0,n=b.length;e<n;e++){if(!1==this.remove(b))return!1;c=!0}}else if(b instanceof f)if(b.parent==this){e=0;for(n=a.length;e<n;e++)if(a[e]==b){d=e;break}}else return b.parent.remove(b);void 0!=d&&!1!=b.destroy(!0)&&(a.splice(d,1),c=!0);this.trigger("remove",b);return c},parseItem:function(){},parseItems:function(){this.startParseItems=
!0;var b=this.items;if(b)for(var b=$H.isArray(b)?b:[b],a=0,c=b.length;a<c;a++)this.add(b[a])},beforeUpdate:function(){return this.trigger("beforeUpdate")},update:function(b){if(!1==this.beforeUpdate())return!1;var a=this.parent,c=$("<span></span>").insertBefore(this.getEl());b=$H.extend({xtype:this.xtype,renderBy:"replaceWith",renderTo:c},b);if(!b.cid||b.cid==this.cid)b._id=this._id;if(a){var d=this.index();if(!1==a.remove(this))return c.remove(),!1;b=a.add(b,d)}else{if(!1==this.destroy())return c.remove(),
!1;b=new this.constructor(b)}this.trigger("update",b);this.afterUpdate(b);return b},afterUpdate:function(b){this.trigger("afterUpdate",b)},beforeDestroy:function(){return this.trigger("beforeDestroy")},destroy:function(b){if(!1==this.beforeDestroy())return!1;if(!this.destroyed)return this.callChild(),this.trigger("destroy"),this.clearListeners(),this.getEl().remove(),this.destroyed=!0,!b&&this.parent&&this.parent.remove(this),this.manager.unregister(this),delete this.initParam,delete this._container,
delete this.renderTo,delete this._listeners,delete this.children,this.afterDestroy(),!0},afterDestroy:function(){this.trigger("afterDestroy")}},{extend:function(b){var a=this.prototype;$H.extend(a,b,{notCover:function(c){if($H.contains(["_customEvents","listeners"],c))return a[c]=(b[c]||[]).concat(a[c]||[]),!0;if("xtype"==c||"constructor"==c)return!0}})},html:function(b){return(new this($H.extend({autoRender:!1},b))).getHtml()}});return f});
$Define("CM.Model",["CM.AbstractDao","CM.AbstractEvents"],function(e,d){return d.derive({_pending:!1,idAttribute:"id",_validate:function(a,c){if(!c.validate||!this.validate)return!0;a=$H.extend({},this.attributes,a);var b=this.validationError=this.validate(a,c)||null;if(!b)return!0;this.trigger("invalid",this,b,$H.extend(c,{validationError:b}));return!1},initialize:function(a,c){this.dao=this.dao||$H.getSingleton(e);var b=a||{};c||(c={});this.cid=$H.Util.getUuid();this.attributes={};c.collection&&
(this.collection=c.collection);c.parse&&(b=this.parse(b,c)||{});b=$H.extend(b,$H.Util.result(this,"defaults"),{notCover:!0});this.set(b,c);this.changed={}},toJSON:function(){return $H.clone(this.attributes)},sync:function(a,c,b){return this.dao.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return $H.String.escapeHTML(this.get(a))},has:function(a){a=this.get(a);return null!=a&&void 0!=a},set:function(a,c,b){var d;"object"===typeof a?(d=a,b=c):(d={})[a]=c;
b||(b={});if(!this._validate(d,b))return!1;var e=b.unset;a=b.silent;var j=[],g=this._changing;this._changing=!0;g||(this._previousAttributes=$H.Object.clone(this.attributes),this.changed={});var k=this.attributes,m=this._previousAttributes;this.idAttribute in d&&(this.id=d[this.idAttribute]);for(var n in d)c=d[n],$H.equals(k[n],c)||j.push(n),$H.equals(m[n],c)?delete this.changed[n]:this.changed[n]=c,e?delete k[n]:k[n]=c;if(!a){j.length&&(this._pending=b);c=0;for(d=j.length;c<d;c++)this.trigger("change:"+
j[c],this,k[j[c]],b)}if(g)return this;if(!a)for(;this._pending;)b=this._pending,this._pending=!1,this.trigger("change",this,b);this._changing=this._pending=!1;return this},unset:function(a,c){c=c||{};c.unset=!0;return this.set(a,void 0,c)},clear:function(a){var c={},b;for(b in this.attributes)c[b]=void 0;a=a||{};a.unset=!0;return this.set(c,a)},hasChanged:function(a){var c=this.changed;return null==a?!$H.isEmpty(c):$H.contains(c,a)},changedAttrbutes:function(a){if(!a)return this.hasChanged()?$H.clone(this.changed):
!1;var c,b=!1,d=this._changing?this._previousAttributes:this.attributes,e;for(e in a)if(!$H.equals(d[e],c=a[e]))(b||(b={}))[e]=c;return b},previous:function(a){return null==a||!this._previousAttributes?null:this._previousAttributes[a]},fetch:function(a){var c=this;a=a?$H.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=a.success;a.success=function(d){if(!c.set(c.parse(d,a),a))return!1;b&&b(c,d,a);c.trigger("sync",c,d,a)};(void 0)(c,a);return c.sync("read",c,a)},save:function(a,c,b){var d,e=this.attributes;
null==a||"object"===typeof a?(d=a,b=c):(d={})[a]=c;b=$H.extend({validate:!0},b);if(d&&!b.wait){if(!this.set(d,b))return!1}else if(!this._validate(d,b))return!1;d&&b.wait&&(this.attributes=$H.extend({},e,d));void 0===b.parse&&(b.parse=!0);var j=this,g=b.success;b.success=function(a){j.attributes=e;var c=j.parse(a,b);b.wait&&(c=$H.extend(d||{},c));if($H.isObject(c)&&!j.set(c,b))return!1;g&&g(j,a,b);j.trigger("sync",j,a,b)};(void 0)(this,b);a=this.isNew()?"create":b.patch?"patch":"update";"patch"===
a&&(b.oAttrs=d);a=this.sync(a,this,b);d&&b.wait&&(this.attributes=e);return a},destroy:function(a){a=a?$H.clone(a):{};var c=this,b=a.success,d=function(){c.trigger("destroy",c,c.collection,a)};a.success=function(e){(a.wait||c.isNew())&&d();b&&b(c,e,a);c.isNew()||c.trigger("sync",c,e,a)};if(this.isNew())return a.success(),!1;(void 0)(this,a);var e=this.sync("delete",this,a);a.wait||d();return e},url:function(){var a=$H.Util.result(this,"urlRoot")||$H.Util.result(this.collection,"url");a||$D.error(Error("\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2aurl\u5c5e\u6027\u6216\u8005\u51fd\u6570"));
return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},$H.extend(a||{},{validate:!0}))}})});
$Define("CM.Collection",["CM.AbstractDao","CM.AbstractEvents","CM.Model"],function(e,d,a){var c=d.derive({_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(b,c){if(b instanceof a)return b;c=c?$H.clone(c):{};c.collection=this;var d=new this.model(b,c);if(!d.validationError)return d;this.trigger("invalid",this,d.validationError,c);return!1},_addReference:function(b){this._byId[b.cid]=b;null!=b.id&&(this._byId[b.id]=b);b.collection||(b.collection=this);b.on("all",this._onModelEvent,
this)},_removeReference:function(b){this===b.collection&&delete b.collection;b.off("all",this._onModelEvent,this)},_onModelEvent:function(b,a,c,d){("add"===b||"remove"===b)&&c!==this||("destroy"===b&&this.remove(a,d),a&&b==="change:"+a.idAttribute&&(delete this._byId[a.previous(a.idAttribute)],null!=a.id&&(this._byId[a.id]=a)),this.trigger.apply(this,arguments))},initialize:function(b,a){this.dao=this.dao||$H.getSingleton(e);a||(a={});a.model&&(this.model=a.model);void 0!==a.comparator&&(this.comparator=
a.comparator);this._reset();b&&this.reset(b,$H.extend({silent:!0},a))},toJSON:function(b){return $H.Collection.map(this.models,function(a){return a.toJSON(b)})},sync:function(b,a,c){return this.dao.sync({method:b,param:c})},add:function(b,a){$H.extend(a,{add:!0,remove:!1,merge:!1});return this.set(b,a)},remove:function(b,a){var c=!$H.isArray(b);b=c?[b]:$H.clone(b);a||(a={});var d,e,k,m;d=0;for(e=b.length;d<e;d++)if(m=b[d]=this.get(b[d]))delete this._byId[m.id],delete this._byId[m.cid],k=this.indexOf(m),
this.models.splice(k,1),this.length--,a.silent||(a.index=k,m.trigger("remove",m,this,a)),this._removeReference(m,a);return c?b[0]:b},set:function(b,c){c=$H.extend(c,{add:!0,remove:!0,merge:!0});c.parse&&(b=this.parse(b,c));var d=!$H.isArray(b),e=d?b?[b]:[]:$H.clone(b),g,k,m,n,l,r,v=c.at,y=this.model,q=this.comparator&&null==v&&!1!==c.sort,D="string"==typeof this.comparator?this.comparator:null,z=[],B=[],A={},s=c.add,u=c.merge,t=c.remove,w=!q&&s&&t?[]:!1;g=0;for(k=e.length;g<k;g++){l=e[g]||{};m=l instanceof
a?n=l:l[y.prototype.idAttribute||"id"];if(m=this.get(m))t&&(A[m.cid]=!0),u&&(l=l===n?n.attributes:l,c.parse&&(l=m.parse(l,c)),m.set(l,c),q&&(!r&&m.hasChanged(D))&&(r=!0)),e[g]=m;else if(s){n=e[g]=this._prepareModel(l,c);if(!n)continue;z.push(n);this._addReference(n,c)}n=m||n;w&&(n.isNew()||!A[n.id])&&w.push(n);A[n.id]=!0}if(t){g=0;for(k=this.length;g<k;++g)A[(n=this.models[g]).cid]||B.push(n);B.length&&this.remove(B,c)}if(z.length||w&&w.length)if(q&&(r=!0),this.length+=z.length,null!=v){g=0;for(k=
z.length;g<k;g++)this.models.splice(v+g,0,z[g])}else{w&&(this.models.length=0);l=w||z;g=0;for(k=l.length;g<k;g++)this.models.push(l[g])}r&&this.sort({silent:!0});if(!c.silent){g=0;for(k=z.length;g<k;g++)(n=z[g]).trigger("add",n,this,c);(r||w&&w.length)&&this.trigger("sort",this,c)}return d?e[0]:e},reset:function(b,a){a||(a={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c],a);a.previousModels=this.models;this._reset();b=this.add(b,$H.extend({silent:!0},a));a.silent||
this.trigger("reset",this,a);return b},push:function(b,a){return this.add(b,$H.extend({at:this.length},a))},pop:function(b){var a=this.at(this.length-1);this.remove(a,b);return a},unshift:function(b,a){return this.add(b,$H.extend({at:0},a))},shift:function(b){var a=this.at(0);this.remove(a,b);return a},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(b){return null==b?void 0:this._byId[b]||this._byId[b.id]||this._byId[b.cid]},at:function(b){return this.models[b]},
where:function(b,a){return $H.isEmpty(b)?a?void 0:[]:this[a?"find":"filter"](function(a){for(var c in b)if(b[c]!==a.get(c))return!1;return!0})},findWhere:function(b){return this.where(b,!0)},sort:function(b){this.comparator||$D.error(Error("\u6ca1\u6709\u6bd4\u8f83\u5668"));b||(b={});"string"==typeof this.comparator||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort($H.Function.bind(this.comparator,this));b.silent||this.trigger("sort",this,b);return this},pluck:function(b){return $H.Collection.invoke(this.models,
"get",b)},fetch:function(b){var a=this;b=b?$H.clone(b):{};b.url||(b.url=a.url);void 0===b.parse&&(b.parse=!0);var c=b.success;b.success=function(d){a[b.reset?"reset":"set"](d,b);c&&c(a,d,b);a.trigger("sync",a,d,b)};return a.sync("get",a,b)},create:function(b,a){var c=this;a=a?$H.clone(a):{};if(!(b=c._prepareModel(b,a)))return!1;a.wait||c.add(b,a);var d=a.success;a.success=function(b,e){a.wait&&c.add(b,a);d&&d(b,e,a)};b.save(null,a);return b},parse:function(b){return b.data},clone:function(){return new this.constructor(this.models)}});
$H.each(["some","every","find","filter","invoke"],function(b){c.prototype[b]=function(){var a=Array.prototype.slice.call(arguments),c=$H.Collection;a.unshift(this.models);return c[b].apply(c,a)}});return c});$Define("C.ComponentManager",["CM.AbstractManager","CM.ViewManager"],function(e,d){var a=e.derive({type:"component",initialize:function(){var a=$H.getSingleton(d);this._types=a._types;this._all=a._all}});$CM=new a;return a});
$Define("C.AbstractComponent",["CM.ViewManager","CM.View"],function(e,d){$C=$H.namespace("C",{});var a=$H.createClass();$H.inherit(a,d,{xtype:"AbstractComponent",activeCls:"hui-active",hasConfig:function(a,b){if(!b)return!1;if($H.isArray(b))for(var d=0,e=b.length;d<e;d++){if(this.match(a,b[d]))return!0}else if(this.match(a,b))return!0;return!1},doConfig:function(){this.callSuper();this.cls||(this.cls=this.xtype.toLowerCase());this.extCls=this.getExtCls();this.icon&&this.add({xtype:"Icon",name:this.icon});
this.isMini&&(this.defItem=$H.extend({isMini:!0},this.defItem))},getExtCls:function(){var a=["js-component"];this.extCls&&a.push(this.extCls);this.theme&&a.push("hui-"+this.cls+"-"+this.theme);this.radius&&a.push("hui-radius-"+this.radius);this.isMini&&a.push("hui-mini");this.shadow&&a.push("hui-shadow");this.shadowSurround&&a.push("hui-shadow-surround");this.shadowOverlay&&a.push("hui-shadow-overlay");this.shadowInset&&a.push("hui-shadow-inset");this.isActive&&a.push(this.activeCls);this.isFocus&&
a.push("hui-focus");this.isInline&&a.push("hui-inline");return 0<a.length?a.join(" "):""},active:function(){this.getEl().addClass(this.activeCls)},unactive:function(){this.getEl().removeClass(this.activeCls)},txt:function(a){var b=this.find(".js-"+this.cls+"-txt");0==b.length&&(b=this.find(".hui-"+this.cls+"-txt"));if(void 0!=a)b.text(a);else return b.text()},valid:function(){var a=this.settings.validator;if(a){var b=this.val();a.error||(a.error=function(a){new $C.Tips({text:a,theme:"error"})});return a=
$H.Validator.valid(b,a)}for(var b=this.children,d=0,e=b.length;d<e;d++)if(a=b[d].valid(),!a)return a;return!0}},{define:function(c,b){var d=$H.createClass();$H.inherit(d,b||a,null,null,{notCover:function(a){return"define"==a}});$H.getSingleton(e).registerType(c,d);return $C[c]=d}});return a});$Define("C.Panel","C.AbstractComponent",function(e){e=e.define("Panel");e.extend({tmpl:['<div><%=this.content||this.findHtml(">*")%></div>']});return e});
$Define("C.Popup","C.AbstractComponent",function(e){e=e.define("Popup");var d=0,a;e.extend({delayShow:!0,clickHide:!0,showPos:"center",shadowOverlay:!0,tmpl:['<div class="hui-popup"><%=this.findHtml("$>*")%></div>'],doConfig:function(){this.callSuper();this.clickHide&&this.listeners.push({name:"click",el:$(document),handler:function(){this.hide()}});$H.android()&&(this.listeners.push({name:"show",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.show")&&$("input,textarea,select").attr("disabled",
"disabled")}}),this.listeners.push({name:"hide",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.hide")&&setTimeout(function(){$("input,textarea,select").removeAttr("disabled")},500)}}))},afterShow:function(){var a=this,b=a.getEl();b.css("z-index",1E3*d+1E3);if(!a.width&&a.parent){var e=a.width=a.parent.getEl().outerWidth();b.css("width",e)}b=a.showPos;if("string"==typeof b)a[b]();else"function"==typeof b&&b.call(a);a.noMask||a.mask();a.timeout&&setTimeout(function(){a.destroyed||
a.hide()},a.timeout)},hide:function(){!1!=this.callSuper()&&(this.noMask||this.unmask(),this.notDestroy||this.destroy())},center:function(){var a=this.getEl(),b=this.width||a.width(),d=this.height||a.height(),e=document,b=((e.documentElement.offsetWidth||e.body.offsetWidth)-b)/2,d=((e.documentElement.clientHeight||e.body.clientHeight)-d)/2+(e.documentElement.scrollTop||e.body.scrollTop),d=10>d?window.screen.height/2-200:d;a.css({left:b+"px",top:d-(this.offsetTop||0)+"px"})},followEl:function(a){a=
(a||this.parent.getEl()).position();this.getEl().css(a)},mask:function(){a||(a=$('<div class="hui-mask" style="display:none;"></div>').appendTo(document.body));a.css("z-index",1E3*d+998);0==d&&a.show();d++},unmask:function(){d--;0==d?a.hide():a.css("z-index",1E3*(d-1)+998)}});return e});
$Define("C.ControlGroup","C.AbstractComponent",function(e){e=e.define("ControlGroup");e.extend({multi:!1,defItem:{xtype:"Button",extCls:"js-item",radius:null,shadow:!1,isInline:!1},tmpl:['<div class="hui-ctrlgp<%if(this.direction=="h"){%> hui-ctrlgp-h<%}else{%> hui-ctrlgp-v<%}%>">','<%=this.findHtml("$>*")%>',"</div>"],listeners:[{name:"click",selector:".js-item",method:"delegate",handler:function(d){var a=$(d.currentTarget),a=this.find('$>[_id="'+a.attr("id")+'"]');0<a.length&&(a=a[0].index(),this.onItemClick(d,
a))}}],select:function(d){if(!this.notSelect&&(d="number"==typeof d?this.children[d]:"string"==typeof d?this.find(d)[0]:d))if(!this.multi&&!d.multi){var a=this.getSelected();a&&this.selectItem(a,!1);this.selectItem(d)}else this.selectItem(d,!d.selected)},getSelected:function(d){var a=[];this.each(function(c,b){b.selected&&a.push(d?c:b)});return 0<a.length?this.multi?a:a[0]:null},selectItem:function(d,a){(a=!1!=a)?(d.selected=a,d.select?d.select():d.active()):(d.selected=a,d.select?d.select(a):d.unactive())},
val:function(d){if(d){var a=d.split(",");this.each(function(c,b){b.select($H.contains(a,b.value))})}else return d=this.find("$>[selected=true]"),a=[],$H.each(d,function(c,b){a.push(b.value)}),a.join(",")},onItemClick:function(d,a){this.select(a);this.itemClick&&this.itemClick(this.children[a],a)}});return e});
$Define("C.Icon","C.AbstractComponent",function(e){e=e.define("Icon");e.extend({tmpl:'<span class="hui-icon;<%if(this.isAlt){%>; hui-alt-icon;<%}%>; hui-icon-<%=this.name%>;<%if(!this.noBg){%>; hui-icon-bg;<%}%>"></span>'.split(";")});return e});
$Define("C.Button","C.AbstractComponent",function(e){e=e.define("Button");e.extend({iconPos:"left",theme:"gray",activeCls:"hui-btn-active",cls:"btn",defItem:{xtype:"Icon"},radius:"normal",shadow:!0,isInline:!0,tmpl:'<a href="javascript:;" hidefocus="true" class="hui-btn,<%if(!this.text){%> hui-btn-icon-notxt<%},if(this.isBack){%> hui-btn-back<%},if(this.hasIcon&&this.text){%> hui-btn-icon-<%=this.iconPos%><%}%>">,<span class="hui-btn-txt"><%=this.text%></span>,<%=this.findHtml("$>*")%>,</a>'.split(","),parseItem:function(d){"Icon"==
d.xtype&&(this.hasIcon=!0)}});return e});
$Define("C.Radio","C.AbstractComponent",function(e){e=e.define("Radio");e.extend({tmpl:'<div class="hui-radio hui-btn hui-btn-gray<%if(this.selected){%> hui-radio-on<%}%>">;<span class="hui-icon hui-icon-radio"></span>;<input type="radio"<%if(this.selected){%> checked=true<%}%>;<%if(this.name){%> name="<%=this.name%>"<%}%>;<%if(this.value){%> value="<%=this.value%>"<%}%>/>;<span class="hui-radio-txt"><%=this.text%></span>;</div>'.split(";"),select:function(d){this.selected=d=!1!=d;var a=this.find("input"),
c=this.getEl();d?(a.attr("checked",!0),c.addClass("hui-radio-on")):(a.removeAttr("checked"),c.removeClass("hui-radio-on"))},val:function(d){if(d)this.value=d,this.find("input").val(d);else return this.value}});return e});
$Define("C.Checkbox","C.AbstractComponent",function(e){e=e.define("Checkbox");e.extend({text:"",value:"",selected:!1,multi:!0,cls:"chkbox",tmpl:'<div class="hui-chkbox hui-btn hui-btn-gray<%if(this.selected){%> hui-chkbox-on<%}%>">;<span class="hui-icon hui-icon-chkbox"></span>;<input type="checkbox"<%if(this.selected){%> checked=true<%}%>;<%if(this.name){%> name="<%=this.name%>"<%}%>;<%if(this.value){%> value="<%=this.value%>"<%}%>/>;<span class="hui-chkbox-txt"><%=this.text%></span>;</div>'.split(";"),select:function(d){this.selected=
d=!1!=d;var a=this.find("input"),c=this.getEl();d?(a.attr("checked",!0),c.addClass("hui-chkbox-on")):(a.removeAttr("checked"),c.removeClass("hui-chkbox-on"))},val:function(d){if(d)this.value=d,this.find("input").val(d);else return this.value}});return e});
$Define("C.Select","C.AbstractComponent",function(e){e=e.define("Select");e.extend({text:"\u8bf7\u9009\u62e9...",value:"",radius:"little",optionClick:function(){},defItem:{xtype:"Menu",hidden:!0,markType:"dot",renderTo:"body"},_customEvents:["change"],tmpl:['<div class="hui-select hui-btn hui-btn-gray hui-btn-icon-right">','<span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span>','<input value="<%=this.value%>" name="<%=this.name%>"/>','<span class="hui-btn-txt js-select-txt"><%=this.text%></span>',
"</div>"],listeners:[{name:"click",handler:function(){this.showOptions()}}],doConfig:function(d){var a=this;a.callSuper();for(var c=d.options,b=0,e=c.length;b<e;b++){var h=c[b];if(h.value==d.value){a.text=h.text;h.selected=!0;break}}a.add({itemClick:function(b){a.val(b.value)},width:a.width,items:c})},showOptions:function(){this.children[0].show()},val:function(d){if(d){if(this.value!=d){var a=this.children[0],c=a.find('$>[value="'+d+'"]');0<c.length&&(this.trigger("change"),c=c[0],this.value=d,this.find("input").attr("value",
d),this.txt(c.text),a.select(c))}}else return this.value}});return e});
$Define("C.Input","C.AbstractComponent",function(e){e=e.define("Input");e.extend({radius:"little",iconPos:"left",btnPos:"right",tmpl:'<div class="hui-input;<%if(this.hasIcon){%>; hui-input-icon-<%=this.iconPos%>;<%}%>;<%if(this.hasBtn){%>; hui-input-btn-<%=this.btnPos%>;<%}%>">;<%=this.findHtml("$>*")%>;<%if(this.type=="textarea"){%>;<textarea class="js-input";<%}else{%>;<input type="text" class="js-input hui-input-txt";<%}%> ; name="<%=this.name%>";<%if(this.placeholder){%>; placeholder="<%=this.placeholder%>";<%}%>;<%if(this.type=="textarea"){%>;><%=this.value%></textarea>;<%}else{%>; value="<%=this.value%>"/>;<%}%> ;</div>'.split(";"),listeners:[{name:"focus",
el:".js-input",handler:function(){this.getEl().addClass("hui-focus")}},{name:"blur",el:".js-input",handler:function(){this.getEl().removeClass("hui-focus")}}],doConfig:function(){var d=this;d.callSuper();"search"==d.type?d.icon="search":"textarea"==d.type&&d.listeners.push({name:"input propertychange",el:".js-input",handler:function(){var a=d.find(".js-input");a.css("height",a[0].scrollHeight)}});d.withClear&&d.add({xtype:"Button",radius:"big",icon:"delete",click:function(){this.parent.find("input").val("").focus()}})},
parseItem:function(d){"Icon"==d.xtype?this.hasIcon=!0:"Button"==d.xtype&&(this.hasBtn=!0)},val:function(d){var a=this.find("input,textarea");if(d)a.val(d);else return a.val()},focus:function(){this.find("input").focus()}});return e});$Define("C.Set","C.AbstractComponent",function(e){e=e.define("Set");e.extend({tmpl:'<div class="hui-set">;<h1 class="hui-set-title"><%=this.title%></h1>;<div class="hui-set-content">;<%=this.findHtml("$>*")%>;</div>;</div>'.split(";")});return e});
$Define("C.Field","C.AbstractComponent",function(e){e=e.define("Field");e.extend({tmpl:'<div class="hui-form-field">;<label class="hui-form-left" for="<%=this.forName%>"><%=this.label%></label>;<div class="hui-form-right">;<%=this.text%>;<%=this.findHtml("$>*")%>;</div>;</div>'.split(";")});return e});
$Define("C.Form","C.AbstractComponent",function(e){e=e.define("Form");e.extend({tmpl:'<div class="hui-form">;<form action="">;<div class="hui-form-tips c-error"></div>;<%=this.findHtml("$>*")%>;</form>;</div>'.split(";")});return e});
$Define("C.TabItem",["C.AbstractComponent","C.Panel"],function(e){e=e.define("TabItem");e.extend({defItem:{xtype:"Button",xrole:"title",radius:null,isInline:!1,iconPos:"top",shadow:!1},extCls:"js-item",tmpl:["<div><%=this.findHtml(\"$>[xrole='title']\")%></div>"],initialize:function(){this.callSuper();this.titleCmp=this.find('$>[xrole="title"]')[0];this.contentCmp=this.find('$>[xrole="content"]')[0]},doConfig:function(d){this.callSuper();var a=d.title;"string"==typeof a&&(a={text:a});"object"==typeof a&&
this.add(a);d=d.content;"string"==typeof d&&(d={xtype:"Panel",content:d});"object"==typeof d&&($H.extend(d,{xrole:"content",hidden:!this.selected,extCls:"js-content"}),this.add(d));this.activeType&&(this.defItem.activeCls="hui-btn-active-"+this.activeType)},parseItem:function(d){this.selected&&"title"==d.xrole&&(d.isActive=!0)},select:function(d){var a=this.titleCmp,c=this.contentCmp;!1==d?(a.unactive(),c&&c.hide()):(a.active(),c&&c.show())},getContent:function(d,a){a||(a=this.contentCmp);return this.callSuper([d,
a])},setContent:function(d,a){a||(a=this.contentCmp);return this.callSuper([d,a])}});return e});
$Define("C.Tab",["C.AbstractComponent","C.TabItem","C.ControlGroup"],function(e,d,a){e=e.define("Tab",a);e.extend({defItem:{xtype:"TabItem"},listeners:[{name:"afterRender add remove",custom:!0,handler:function(){this.layout()}}],tmpl:['<div class="hui-tab">','<ul class="js-tab-btns c-clear">','<%var aBtns=this.find("$>TabItem");',"for(var i=0,len=aBtns.length;i<len;i++){%>",'<li class="hui-tab-item">',"<%=aBtns[i].getHtml()%>","</li>","<%}%>","</ul>","<%=this.findHtml(\"$>TabItem>[xrole='content']\")%>",
"</div>"],doConfig:function(){this.callSuper();this.activeType&&(this.defItem.activeType=this.activeType)},layout:function(){var a=this.children.length,b=Math.floor(100/a);this.find(".js-tab-btns>li").each(function(d,e){e.style.width=d<a-1?b+"%":100-b*(a-1)+"%"})},setTabContent:function(a,b){b=b||this.getSelected(!0);this.find("js-tab-content").index(b).html(a)}});return e});
$Define("C.Toolbar","C.AbstractComponent",function(e){e=e.define("Toolbar");e.extend({cls:"tbar",defItem:{xtype:"Button",theme:"black",pos:"right",isMini:!0},tmpl:['<div class="hui-tbar<%if(this.type=="header"){%> hui-header<%}else if(this.type=="footer"){%> hui-footer<%}%>">','<%=this.findHtml(">*")%>','<%if(this.title){%><h1 class="hui-tbar-title js-tbar-txt"><%=this.title%></h1><%}%>',"</div>"],parseItem:function(d){"Button"==d.xtype&&(d.shadowSurround=!0,"left"==d.pos?d.extCls=(d.extCls||"")+
" hui-tbar-btn-left":"right"==d.pos&&(d.extCls=(d.extCls||"")+" hui-tbar-btn-right"))}});return e});$Define("C.Tips",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(e,d){var a=e.define("Tips",d);a.extend({theme:"black",timeout:2E3,radius:"normal",tmpl:['<div class="hui-tips<%if(!this.text){%> hui-tips-notxt<%}%>">','<%=this.findHtml("$>*")%>','<%if(this.text){%><span class="hui-tips-txt"><%=this.text%></span><%}%>',"</div>"]});return a});
$Define("C.Dialog",["C.AbstractComponent","C.Popup"],function(e,d){var a=e.define("Dialog",d);$H.extend(a,{alert:function(c){return new a({contentMsg:c,noClose:!0,noCancel:!0})},confirm:function(c,b){return new a({contentMsg:c,noClose:!0,okCall:function(){return b&&b(!0)},cancelCall:function(){return b&&b(!1)}})},prompt:function(c,b,d){d||(d=b,b="");return new a({contentMsg:c,noClose:!0,items:{xtype:"Input",xrole:"dialog-content",value:b},okCall:function(){var a=this.find("$Input")[0].val();return d&&
d(a)}})}});a.extend({okTxt:"\u786e\u5b9a",cancelTxt:"\u53d6\u6d88",clickHide:!1,radius:"little",tmpl:'<div class="hui-dialog">;<%=this.findHtml("$>[xrole=\'dialog-header\']")%>;<div class="hui-dialog-body">;<%if(this.content){%><%=this.content%><%}else{%>;<div class="hui-body-content">;<h1 class="hui-content-title"><%=this.contentTitle%></h1>;<div class="hui-content-msg"><%=this.contentMsg%></div>;<%=this.findHtml("$>[xrole=\'dialog-content\']")%>;</div>;<%}%>;<%if(!this.noAction){%>;<div class="hui-body-action">;<%=this.findHtml("$>[xrole=\'dialog-action\']")%>;</div>;<%}%>;</div>;</div>'.split(";"),
doConfig:function(a){var b=this;b.callSuper();a=a.items;b.title&&!b.hasConfig('[xrole="dialog-header"]',a)&&b.add({xtype:"Toolbar",title:b.title,theme:"gray",xrole:"dialog-header",extCls:"hui-dialog-header",items:!b.noClose&&{xtype:"Button",radius:"big",icon:"delete",isMini:!1,theme:"gray",pos:"left",click:function(){b.hide()}}});!b.noAction&&!b.hasConfig('[xrole="dialog-action"]',a)&&(a=[],b.noCancel||a.push({title:{isActive:1==b.activeBtn,text:b.cancelTxt,click:function(){!1!=(b.cancelCall&&b.cancelCall())&&
b.hide()}}}),b.noOk||a.push({title:{text:b.okTxt,isActive:2==b.activeBtn,click:function(){!1!=(b.okCall&&b.okCall())&&b.hide()}}}),b.add({xtype:"Tab",xrole:"dialog-action",theme:"border-top",notSelect:!0,items:a}))}});return a});
$Define("C.Menu",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(e,d,a){e=e.define("Menu",d);e.extend(a.prototype);e.extend({notDestroy:!0,tmpl:['<div class="hui-menu<%if(this.markType=="dot"){%> hui-menu-mark<%}%>">',"<ul>","<%for(var i=0,len=this.children.length;i<len;i++){%>",'<li class="hui-menu-item<%if(this.children[i].selected){%> hui-item-mark<%}%>">',"<%=this.children[i].getHtml()%>",'<%if(this.markType=="dot"){%><span class="hui-icon-mark"></span><%}%>',"</li>","<%}%>","</ul>",
"</div>"],selectItem:function(c,b){b=!1!=b;"dot"==this.markType?(c.selected=b,c.getEl().parent()[!1==b?"removeClass":"addClass"]("hui-item-mark")):"active"==this.markType?a.prototype.selectItem.call(this,c,b):c.selected=b}});return e});$Define("C.List",["C.AbstractComponent","C.ControlGroup"],function(e,d){var a=e.define("List",d);a.extend({tmpl:['<div class="hui-list">','<div class="hui-list-item c-clear">',"</div>","</div>"]});return a});
$Define("M.AbstractModule","CM.View",function(e){var d=$H.createClass();$H.inherit(d,e,{useCache:!0,cache:function(){},init:function(){},reset:function(){},exit:function(){return!0}});return d});$Define("M.AbstractNavigator","handy.base.Object",function(e){var d=$H.createClass();e.extend(d.prototype,{navigate:function(){}});return d});
$Define("M.History","handy.base.HashChange",function(e){var d=$H.createClass(),a=0;$H.extend(d.prototype,{initialize:function(a,b){"function"==typeof a&&(b=a,a=null);this.error=b||$H.noop;this.key=a||"handy";this.states=[];e.listen($H.Function.bind(this.stateChange,this))},stateChange:function(){var a=this.getHashParam(),b=a.hKey,d=this.currentKey,e=this.states,j=e[d];if(b==d&&$H.equals(a.param,j.param))return!1;(e=e[b])?a=e.onStateChange(e.param,!0):($D.warn("hisory state not found"),a=this.error("stateNotFound",
a));!0!=a?(a={hKey:d,param:j.param},this.saveHash(a)):this.currentKey=b},saveState:function(c){var b=this.currentKey=this.key+ ++a;this.states.push(b);this.states[b]=c;this.saveHash({hKey:b,param:c.param})},saveHash:function(a){$H.setHash("#"+$H.Json.stringify(a))},getHashParam:function(){try{var a=$H.getHash().replace("#","");return $H.parseJson(a)}catch(b){$H.Debug.warn("History.getCurrentState:parse hash error:"+b.message)}},getCurrentState:function(){try{var a=this.getHashParam();return this.states[a.hKey]}catch(b){$H.Debug.warn("History.getCurrentState:parse hash error:"+
b.message)}},getPreState:function(){try{for(var a=this.getHashParam().hKey,b=this.states,d=b.length,e=0;e++;e<d)if(b[e]==a)return 0<e?b[b[--e]]:null}catch(j){$H.Debug.error("History.getPreState error:"+j.message,j)}},back:function(){var a=this.getPreState();if(a)a.onStateChange(a.param)}});return d});
$Define("M.ModuleManager",["M.History","CM.AbstractManager"],function(e,d){var a=$H.createClass();$H.inherit(a,d,{type:"module",_createMod:function(a){var b=this,d=a.modName;b.modules[d]={waiting:!0};$Require(b.defModPackage+d,function(e){var j={renderTo:b.container,name:d,xtype:d,_id:b.generateId(),extCls:"js-module m-module",hidden:!0};$H.extend(j,a);e=new e(j);b.modules[d]=e;$H.trigger("afterRender",e.getEl());b.requestMod==d&&b._showMod(e)})},_showMod:function(a){var b=this.modules[this.currentMod];
if(!this.navigator||!this.navigator.navigate(a,b,this))b&&b.hide(),a.show();b&&(b.isActive=!1);a.isActive=!0;this.currentMod=a.name},_destroy:function(a){a.destroy();delete this.modules[a.name]},initialize:function(a){var b=this;a&&(b.conf=a,$H.extend(b,a),b.container=a.container?$(a.container):$(document.body));b.defModPackage+=".";b.history=new e(function(a,c){b.go(c.param)});b.modules={}},go:function(a,b){"string"==typeof a&&(a={modName:a});var d=a.modName,e=this.currentMod,j=this.modules,g=j[e];
if(e==d)g.waiting||g.reset();else{if(g&&!g.waiting)if(g._forceExit)g._forceExit=!1;else if(!1==g.exit())return!1;this.requestMod=d;(d=j[d])?d.useCache?(this._showMod(d),d.cache(a)):d.waiting||(this._destroy(d),this._createMod(a)):this._createMod(a);!0!=b&&this.history.saveState({onStateChange:$H.Function.bind(this.go,this),param:a});return!0}},back:function(a){a&&(this.modules[this.currentMod]._forceExit=!0);history.back()}});return a});
