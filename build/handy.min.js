/* Handy v1.0.0-dev | 2014-01-16 | zhengyinhui100@gmail.com */
(function(){var e=window.handy,b=window.$,a=window.handy=window.$=function(){};a.version="1.0.0";a.expando="handy"+(a.version+Math.random()).replace(/\D/g,"");a.add=function(d,c,f){f||(f=c,c=null);if(!c||!a.Loader){a.base||(a.base={});var b=[];if(c)if("string"==typeof c)b.push(a.base.Object.namespace(c));else for(var e=0;e<c.length;e++)b.push(a.base.Object.namespace(c[e]));b.push(a);a.base[d]=a[d]=f.apply(window,b)}else a.Loader.require(c,function(){Array.prototype.push.call(arguments,a);a.base[d]=
a[d]=f.apply(window,arguments)})};a.noConflict=function(d){window.$===a&&(window.$=b);d&&window.handy===a&&(window.handy=e);return a}})();
handy.add("Json",function(){var e;e||(e={});(function(){function b(c){return 10>c?"0"+c:c}function a(c){f.lastIndex=0;return f.test(c)?'"'+c.replace(f,function(c){var a=h[c];return"string"===typeof a?a:"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+c+'"'}function d(c,f){var b,e,h,t,r=g,p,l=f[c];l&&("object"===typeof l&&"function"===typeof l.toJSON)&&(l=l.toJSON(c));"function"===typeof j&&(l=j.call(f,c,l));switch(typeof l){case "string":return a(l);case "number":return isFinite(l)?
String(l):"null";case "boolean":case "null":return String(l);case "object":if(!l)return"null";g+=k;p=[];if("[object Array]"===Object.prototype.toString.apply(l)){t=l.length;for(b=0;b<t;b+=1)p[b]=d(b,l)||"null";h=0===p.length?"[]":g?"[\n"+g+p.join(",\n"+g)+"\n"+r+"]":"["+p.join(",")+"]";g=r;return h}if(j&&"object"===typeof j){t=j.length;for(b=0;b<t;b+=1)"string"===typeof j[b]&&(e=j[b],(h=d(e,l))&&p.push(a(e)+(g?": ":":")+h))}else for(e in l)Object.prototype.hasOwnProperty.call(l,e)&&(h=d(e,l))&&p.push(a(e)+
(g?": ":":")+h);h=0===p.length?"{}":g?"{\n"+g+p.join(",\n"+g)+"\n"+r+"}":"{"+p.join(",")+"}";g=r;return h}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,k,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;"function"!==typeof e.stringify&&(e.stringify=function(c,a,f){var b;k=g="";if("number"===typeof f)for(b=0;b<f;b+=1)k+=" ";else"string"===typeof f&&(k=f);if((j=a)&&"function"!==typeof a&&("object"!==typeof a||"number"!==typeof a.length))throw Error("JSON.stringify");return d("",{"":c})});"function"!==
typeof e.parse&&(e.parse=function(a,f){function b(c,a){var d,g,e=c[a];if(e&&"object"===typeof e)for(d in e)Object.prototype.hasOwnProperty.call(e,d)&&(g=b(e,d),void 0!==g?e[d]=g:delete e[d]);return f.call(c,a,e)}var d;a=String(a);c.lastIndex=0;c.test(a)&&(a=a.replace(c,function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return d=eval("("+a+")"),"function"===typeof f?b({"":d},""):d;throw new SyntaxError("JSON.parse");})})();return e});
handy.add("Object",function(){function e(){var a=window.navigator.userAgent.match(/MSIE ([\d.]+)/);return a&&9>parseInt(a[0])?function(a,c,f){var b=[];if(a.length){c=c||0;for(f=f||a.length;c<f;c++)b.push(a[c])}return b}:function(a,c,b){return Array.prototype.slice.call(a,c||0,b||a.length)}}var b={namespace:function(a,b){var c=null,f,g,e,h;g=a.split(".");c=g[0];c=(e=2==arguments.length)?eval("(function(){if (typeof "+c+' == "undefined"){'+c+" = {};}return "+c+";})()"):eval("(function(){if (typeof "+
c+' != "undefined")return '+c+";})()");f=1;for(h=g.length;f<h;++f){if(f==h-1&&e)c[g[f]]=b;else if(e||c&&c[g[f]])c[g[f]]=c[g[f]]||{};else return;c=c[g[f]]}return c},createClass:function(a){var b=function(){var c,a;c=this.constructor==b?this:arguments.callee;if(a=c.initialize)return a.apply(c,arguments)};a&&this.namespace(a,b);return b},extend:function(a,d,c){var f=c?c.notCover:!1;c=c?c.notClone:!1;for(var g in d){var e=a.hasOwnProperty(g),h=!0===f?e:!1;b.isArray(f)?h=b.contain(f,g)&&e:b.isFunction(f)&&
(h=f(g));h||(a[g]=c?d[g]:b.clone(d[g]))}return a},mix:function(a,d,c,f){a.superProt||(a.superProt={});for(var g in d)a.superProt[g]=b.isFunction(d[g])?a.superProt[g]?function(c,a){return function(){a.apply(this,arguments);d[c].apply(this,arguments)}}(g,a.superProt[g]):d[g]:d[g],a[g]||(a[g]=d[g]);c&&b.extend(a,c);d.toString!=d.constructor.prototype.toString&&(a.superProt.toString=function(){d.toString.apply(a,arguments)});f&&(a.prototype&&d.prototype)&&b.inherit(a,d,f);return a},inherit:function(a,
d,c,f,g){var e=function(){};e.prototype=d.prototype;g=g||{notCover:!0};b.extend(a,d,g);a.prototype=new e;a.prototype.constructor=a;a.superClass=d;a.superProt=d.prototype;if(d._onInherit)try{d._onInherit(a)}catch(h){}c&&b.extend(a,c);f&&b.extend(a.prototype,f)},isFunction:function(a){return"[object Function]"===window.Object.prototype.toString.call(a)},isArray:function(a){return"[object Array]"===window.Object.prototype.toString.call(a)},equals:function(a,d){if(typeof a==typeof d){if("object"!=typeof a)return a===
d;if(a===d)return!0;if(b.isArray(a)&&b.isArray(d)){if(a.length!=d.length)return!1;for(var c=0,f=a.length;c<f;c++)if(!b.equals(a[c],d[c]))return!1;return!0}if(!b.isArray(a)&&!b.isArray(d)){if(b.count(a)!=b.count(d))return!1;for(c in a)if(void 0==d[c]||!b.equals(a[c],d[c]))return!1;return!0}}return!1},clone:function(a){if(null==a||"object"!=typeof a)return a;var d=a.constructor;if(d!=window.Object&&d!=window.Array)return a;if(d==window.Date||d==window.RegExp||d==window.Function||d==window.String||d==
window.Number||d==window.Boolean)return new d(a);try{var c=new d,f;for(f in a)c[f]=b.clone(a[f]);return c}catch(g){return a}},isEmpty:function(a){if(b.isArray(a))return 0==a.length;for(var d in a)return!1;return!0},each:function(a,d,c){var f,g=0,e=a.length,h=void 0===e||b.isFunction(a);if(c)if(h)for(f in a){if(!1===d.apply(a[f],c))break}else for(;g<e&&!1!==d.apply(a[g++],c););else if(h)for(f in a){if(!1===d.call(a[f],f,a[f]))break}else for(;g<e&&!1!==d.call(a[g],g,a[g++]););return a},contain:function(a,
d){var c=!1;b.each(a,function(a,b){if(b===d)return c=!0,!1});return c},count:function(a){if(b.isArray(a))return a.length;var d=0,c;for(c in a)d++;return d},toArray:e,genMethod:function(a,d,c){d=b.isArray(d)?d:d.split(",");for(var f=0;f<d.length;f++){var g=d[f];a[g]=c(g)}}},e=e();return b});
handy.add("Browser","handy.base.Object",function(e){var b={},a={};e.genMethod(a,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(c){return function(a){var f=b[c];return!a&&"string"===typeof f&&/^[\d\.]+$/.test(f)?parseInt(f):f}});e=window.navigator.userAgent;var d;(d=e.match(/MSIE ([\d.]+)/))?b.ie=d[1]:(d=e.match(/Firefox\/([\d.]+)/))?b.firefox=d[1]:(d=e.match(/Chrome\/([\d.]+)/))?
b.chrome=d[1]:(d=e.match(/Opera.([\d.]+)/))?b.opera=d[1]:(d=e.match(/Version\/([\d.]+).*Safari/))?b.safari=d[1]:0;/windows|win32/i.test(e)?b.windows=!0:/linux/i.test(e)?b.linux=!0:/macintosh/i.test(e)?b.mac=!0:0;/trident/i.test(e)?b.trident=!0:/webkit/i.test(e)?b.webkit=!0:/gecko/i.test(e)?b.gecko=!0:/presto/i.test(e)?b.presto=!0:0;/MetaSr/i.test(e)?b.sogou=!0:/Maxthon/i.test(e)?b.maxthon=!0:/TencentTraveler/i.test(e)?b.tt=!0:/TheWorld/i.test(e)?b.theWorld=!0:/360[S|E]E/i.test(e)?b.is360=!0:0;var c;
if((c=e.match(/AppleWebKit\/([\d.]*)/))&&c[1])if(/ Mobile\//.test(e)&&e.match(/iPad|iPod|iPhone/)){b.mobile="ios";if((c=e.match(/OS ([^\s]*)/))&&c[1])b.ios=c[1].replace("_",".");if((c=e.match(/iPad|iPod|iPhone/))&&c[0])b[c[0].toLowerCase()]=b.ios}else if(/ Android/i.test(e)){if(/Mobile/.test(e)&&(b.mobile="android"),(c=e.match(/Android ([^\s]*);/))&&c[1])b.android=c[1]}else if(c=e.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))b.mobile=c[0].toLowerCase();var f;try{if(b.ie){var g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
g&&(f=g.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(g=navigator.plugins["Shockwave Flash"])){var k=g.description.split(" ");d=0;for(var h=k.length;d<h;d++)if(0<parseInt(k[d])){f=k[d];break}}}catch(j){}b.flash=f?f:null;return a});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(e,b,a){function d(b,d,e){e=e||"log";if(d||c.showInPage){var h=a.expando+"debugDiv",j=top.document;(d=j.getElementById(h))?d.style.display="block":(d=j.createElement("DIV"),d.id=h,d.innerHTML='<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.style.height=\''+
j.body.offsetHeight+'px\';">\u5168\u5c4f</a>&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.style.height=\'100px\';">\u6536\u8d77</a><div style="padding-top:5px"></div>',d.style.position="absolute",d.style.width=j.body.offsetWidth-20+"px",d.style.left=0,d.style.top=0,d.style.right=0,d.style.height="100px",d.style.backgroundColor="#aaa",d.style.fontSize="12px",d.style.padding="10px",d.style.overflow="auto",d.style.zIndex=9999999,d.style.opacity=0.5,d.style.filter="alpha(opacity=50)",j.body.appendChild(d));
h=j.createElement("DIV");h.innerHTML=e+" : "+JSON.stringify(b,null,"<br/>");d=d.getElementsByTagName("DIV")[0];d.innerHTML=d.innerHTML+h.innerHTML+"<br/>"}try{console[e](b)}catch(q){}}var c={level:0,LOG_LEVEL:1,INFO_LEVEL:2,WARN_LEVEL:3,ERROR_LEVEL:4,DEBUG_LEVEL:5,showInPage:!("console"in window)||!!b.mobile(),log:function(a,b){c.level>c.LOG_LEVEL||d(a,!!b,"log")},info:function(a,b){this.level>c.INFO_LEVEL||d(a,!!b,"info")},warn:function(a,b){c.level>c.WARN_LEVEL||d(a,!!b,"warn")},error:function(a,
b){c.level>c.ERROR_LEVEL||d(a,!!b,"error")},time:function(a,b,e){c.level>c.INFO_LEVEL||(b?d((a||"")+", \u6d88\u8017\u65f6\u95f4:"+((new Date).getTime()-(c.lastTime||0)),!!e):c.lastTime=(new Date).getTime())},debug:function(a){if(!(c.level>c.DEBUG_LEVEL)&&("undefined"==typeof a||a()))debugger}};return c});
handy.add("Function","handy.base.Object",function(){return{bind:function(e,b,a){var d=Array.prototype.slice.call(arguments,2);return function(){Array.prototype.push.apply(d,arguments);return e.apply(b,d)}},intercept:function(e,b,a,d){a=a||window;d=d||a||window;if(Object.isFunction(b))return function(){var c=arguments;d.target=a;d.method=e;return!1!=b.apply(d,c)?e.apply(a,c):null}}}});
handy.add("Loader",["handy.base.Debug","handy.base.Object","handy.base.Function"],function(e,b,a){function d(c){function a(c){return/\.(css|js)$/.test(c)?q[c]&&"loaded"==q[c].status:m.urlMap&&m.urlMap[c]?m.urlMap[c].chkExist():b.namespace(c)}if("string"==typeof c)return a(c);for(var d=[],f=0,e=c.length;f<e;f++){var g=a(c[f]);if(g)d.push(g);else return!1}return d}function c(c,a){function b(){b.isCalled||(b.isCalled=!0,clearTimeout(j),a())}if("SCRIPT"===c.nodeName){var d=c,g=b;d.onload=d.onerror=d.onreadystatechange=
function(){/loaded|complete|undefined/.test(d.readyState)&&(d.onload=d.onerror=d.onreadystatechange=null,k.removeChild(d),d=null,setTimeout(g,0))}}else{var h=b;window.hasOwnProperty("attachEvent")?c.attachEvent("onload",h):setTimeout(function(){f(c,h)},0)}var j=setTimeout(function(){e.error("Time is out:",c.src);b()},m.timeout)}function f(c,a){if(!a.isCalled){var b;if(h)c.sheet&&(b=!0);else if(c.sheet)try{c.sheet.cssRules&&(b=!0)}catch(d){if("SecurityError"===d.name||"NS_ERROR_DOM_SECURITY_ERR"===
d.name)b=!0}setTimeout(function(){b?a():f(c,a)},1)}}function g(c){m.showLoading(!1);q[c].status="loaded";for(var a=j.length-1;0<=a;a--){var b=j[a],f=d(b.deps);f&&(j.splice(a,1),b.callback.apply(null,f))}m.traceLog&&e.info("Loader Response: "+c)}var k=document.head||document.getElementsByTagName("head")[0]||document.documentElement,h=navigator.userAgent.indexOf("AppleWebKit"),j=[],q={},m={traceLog:!0,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(c,a,d){2==arguments.length&&
(d=a,a=[]);m.require(a,function(){var a;if("function"==typeof d)try{a=d.apply(null,arguments)}catch(f){e.error("Loader "+c+":factory define error:"+f.message);return}else a=d;b.namespace(c,a)})},require:function(b,f){for(var h="string"==typeof b?[b]:b,t=[],r=[],p=!0,l=0,u=h.length;l<u;l++){var n=h[l],s=d(n);s?r.push(s):(t.push(n),p&&(p=!1,j.push({deps:h,callback:f})),m.traceLog&&e.info("Resource not found: "+n))}if(0==t.length)return f&&f.apply(null,r),0==r.length?r[0]:r;p=!1;h=0;for(r=t.length;h<
r;h++)if(l=t[h],!q[l]){p=l;n=m.urlMap&&m.urlMap[p]&&m.urlMap[p].url;if(!n){u="";n=m.rootPath;if("string"==typeof n)u=n;else if("object"==typeof n)for(s in s=void 0,n)0==p.indexOf(s)&&(u=n[s],p=p.replace(s,""));else u="";n=/.css$/.test(p)?0==p.indexOf("/")?p:"/css/"+p:/.js$/.test(p)?p:p.replace(/\./g,"/")+".js";0!=n.indexOf("/")&&(n="/"+n);n=u+n}p=!0;q[l]={id:l,status:"loading"};u=a.bind(g,null,l);if(/.css$/.test(n))a:{l=n;n=k.getElementsByTagName("link");for(s=0;s<n.length;s++){var x=n[s].href;!m.skinNode&&
0<=x.indexOf(m.skinName)&&(m.skinNode=n[s]);if(0<=x.indexOf(l)||0<=l.indexOf(x))break a}n=document.createElement("link");n.rel="stylesheet";n.href=l;c(n,u);k.insertBefore(n,m.skinNode);m.traceLog&&e.info("Loader request:"+l)}else l=n,n=document.createElement("script"),n.async="async",n.src=l,n.type="text/javascript",c(n,u),k.appendChild(n),m.traceLog&&e.info("Loader request:"+l)}p&&m.showLoading(!0)}};return m});
handy.add("Date",function(){var e=window.Date,b={getWeek:function(a,b){var c=a.getDay();b&&(c=(c+(b%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[c]},isWeeken:function(a){return 0==a.getDay()||6==a.getDay()},getDaysInMonth:function(a){a=new e(a.getFullYear(),a.getMonth()+1,0);return a.getDate()},getDaysInYear:function(a){var b=new e(a.getFullYear(),0,0);a=new e(a.getFullYear()+1,0,0);return Math.floor((a.getTime()-b.getTime())/864E5)},getDayIndexOfYear:function(a){var b=new e("1/1/"+
a.getFullYear());return Math.ceil((a.getTime()-b.getTime())/864E5)},format:function(a,d){d=d||"yyyy-MM-dd HH:mm:ss";a=a||new e;var c=a.getHours(),f=Math.floor((a.getMonth()+3)/3),c={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":0==c%12?12:c%12,"H+":c,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":b.getWeek(a),"q+":f,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][f-1],"S+":a.getMilliseconds()},g;for(g in c)RegExp("("+g+")").test(d)&&(f=RegExp.$1.length,d=d.replace(RegExp.$1,1==f?c[g]:("00"+
c[g]).slice(-f)));return d},parse:function(a,b){for(var c=(b||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),f=a.match(/\d+/g),g=new e,k=0;k<f.length;k++){var h=c[k],j=parseInt(f[k]);switch(h){case "yyyy":g.setFullYear(j);break;case "MM":g.setMonth(j-1);break;case "dd":g.setDate(j);break;case "HH":g.setHours(j);break;case "mm":g.setMinutes(j);break;case "ss":g.setSeconds(j);break;case "SS":g.setMilliseconds(j)}}return g}};return b});
handy.add("String",function(){var e={stripTags:function(b){return b.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(b){var a=document.createElement("div");b=document.createTextNode(b);a.appendChild(b);return a.innerHTML},unescapeHTML:function(b){var a=document.createElement("div");a.innerHTML=e.stripTags(b);return a.childNodes[0].nodeValue},decodeHTML:function(b){b=b.replace(/&lt;/gi,"<");b=b.replace(/&gt;/gi,">");b=b.replace(/&quot;/gi,'"');b=b.replace(/&apos;/gi,"'");b=b.replace(/<\/?br>/gi,"\n");
b=b.replace(/&amp;/gi,"&");return b=b.replace(/&nbsp;/gi," ")},encodeHTML:function(b){b=b.replace(/&/gi,"&amp;");b=b.replace(/</gi,"&lt;");b=b.replace(/>/gi,"&gt;");b=b.replace(/\"/gi,"&quot;");b=b.replace(/\'/gi,"&apos;");b=b.replace(/\n/gi,"</br>");return b=b.replace(/ /gi,"&nbsp;")},trim:function(b){return b=b.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(b,a){a||(a=/[,%\'\"\/\\;|\<\>\^]/);return-1<b.search(a)},len:function(b){return b.replace(/[^\x00-\xff]/g,"**").length},left:function(b,
a,d){if(e.len(b)>a){!0===d?d=2:0<d||(d=0);var c=0,f=0;for(a-=d;f<a;)255<b.charCodeAt(c)?f+=2:f++,c++;b=b.substring(0,c);for(c=0;c<d;c++)b+="."}return b},isNumber:function(b){return 0==b.search(/^\d+$/g)},hasChn:function(b){return/[\u4E00-\u9FA5]+/.test(b)},isChn:function(b){return/^[\u4E00-\u9FA5]+$/.test(b)},addParam:function(b,a){a&&(b+=(-1<b.indexOf("?")?"&":"?")+a);return b}};return e});
handy.add("Cookie",function(){return{get:function(e,b){var a=e+"=",d="",c=document.cookie;if(0<c.length){var f=c.indexOf(a);-1!=f&&(f+=a.length,a=c.indexOf(";",f),-1==a&&(a=c.length),d=c.substring(f,a),b||(d=unescape(d)))}return d},set:function(e,b,a){var d=[];void 0!=e&&void 0!=b&&d.push(e+"="+escape(b));a&&(void 0!=a.path&&d.push("path="+a.path),void 0!=a.domain&&d.push("domain="+a.domain),void 0!=a.expires&&d.push("expires="+a.expires),a.secure&&d.push("secure"));document.cookie=d.join(";")},del:function(e){var b=
new Date;b.setTime(b.getTime()-1);document.cookie=e+"=;expires="+b.toGMTString()}}});handy.add("Util",function(){var e=0;return{isWindow:function(b){return null!=b&&b==b.window},getUuid:function(){return e++},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(b){var a=top.location.hash;0<=a.indexOf("#")&&(b=a.replace(/#[^\?]*/,b));top.location.hash=b}}});
handy.add("Template",function(e){var b={},a=/^=/,d="".trim,c={openTag:"<%",closeTag:"%>",_setValue:function(c,b){return c.replace(a,function(c,a){return b&&b[a]||""})},_add:function(c){return d?"$r+="+c+";\n":"$r.push("+c+");\n"},_parseHtml:function(a){a=a.replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n");return c._add('"'+a+'"')},_parseScript:function(b){b=b.replace(/this/g,"$data");0==b.indexOf("=")&&(b=c._add(b.replace(a,"")));return b+"\n"},_compile:function(a){var b="var $r="+
(d?'""':"[]")+";\n";e.Object.each(a.split(c.openTag),function(a,d){var f=d.split(c.closeTag);1==f.length?b+=c._parseHtml(f[0]):(b+=c._parseScript(f[0]),f[1]&&(b+=c._parseHtml(f[1])))});b+="return "+(d?"$r;":'$r.join("");');$D.log(b);return new Function("$data",b)},tmpl:function(a,d){var k,h,j;if("string"==typeof a)k=a;else if(k=a.tmpl,j=a.id)if(b[j])h=b[j];else{var q=document.getElementById(j);q&&(k=(q.value||q.innerHTML).replace(/\s/g,""))}if(!h){if(!k){e.Debug.error("\u6a21\u677f\u672a\u5b9a\u4e49");
return}h=c._compile(k);j&&(b[j]=h)}$D.log(h);return d?h(d):h}};return c});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(e,b,a){function d(c){if(c==q)return!1;var a=j.contentWindow.document;a.open();a.write("<!doctype html><html><body>"+c+"</body></html>");a.close();q=c;e.log("set:"+j.contentWindow.document.body.innerText)}function c(){var c=b.getHash(),a=j.contentWindow.document.body.innerText;c!=q?(d(c),f(c)):a!=q&&(e.log("update:"+j.contentWindow.document.body.innerText),b.setHash(a))}function f(c){var a=v.listeners,b;for(b in a)a[b](c)}var g,
k=0,h=document,j,q,m=h.documentMode,w="onhashchange"in window&&(void 0===m||7<m),v={delay:50,listen:function(e,m){if(!g)if(g=!0,v.listeners={},w)$(window).on("hashchange",function(){f(b.getHash())});else j=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(h.body)[0],$(j).one("load",function(){d(b.getHash());setInterval(c,v.delay)});if(m in v.listeners)throw Error("Duplicate name");m=m||a.expando+ ++k;v.listeners[m]=e;return m},unListen:function(c){for(var a in v.listeners)(!c||
c==a)&&delete v.listeners[a]}};return v});handy.add("Support","Browser",function(e){if(6==e.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(b){}return{}})(function(e){$H=e.noConflict();$D=$H.Debug;$HB=$H.Browser;$HC=$H.Cookie;$HD=$H.Date;$HF=$H.Function;$HO=$H.Object;$HS=$H.String;$HU=$H.Util;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}}})(handy);
$Define("handy.component.ComponentManager",function(){var e=$HO.createClass(),b=$H.expando+"_cmp_",a={},d={};$HO.extend(e,{registerType:function(c,b){a[c]=b;b.prototype.xtype=c},getClass:function(c){return a[c]},register:function(c){d[c.getId()]=c},unRegister:function(c){delete d[c.getId()]},destroy:function(){},generateId:function(c,a){var e=b+(c||$H.Util.getUuid());if(!0!=a&&d[e])$D.error("id\u91cd\u590d:"+e);else return e},get:function(c){return d[c]||d[e.generateId(c,!0)]}});return e});
$Define("handy.component.AbstractComponent","handy.component.ComponentManager",function(e){var b=$HO.createClass(),a=/^(<[a-zA-Z]+)/,d=/(class=")/;$HO.extend(b,{define:function(c){var a=$HO.createClass();$HO.inherit(a,b,null,null,{ignore:["define"]});e.registerType(c,a);return a},html:function(c){c.autoRender=!1;return(new this(c)).getHtml()}});$HO.extend(b.prototype,{xtype:"AbstractComponent",renderTo:null,hidden:!1,disabled:!1,hideMode:"display",autoRender:!0,renderBy:"append",notListen:!1,extCls:"",
radius:null,shadow:!1,shadowInset:!1,isMini:!1,isFocus:!1,isInline:!1,html:null,isSuspend:!1,_customEvents:["beforeRender","afterRender","show","hide","destroy"],_defaultEvents:["click","mouseover","focus"],initialize:function(c){this.doConfig(c);this.parseItems();c=$H.Template.tmpl({id:this.xtype,tmpl:this.tmplStr||(this.tmplStr=this.tmpl.join(""))},this);var b=this.getId();c=c.replace(a,'$1 id="'+b+'"');c=this.html=c.replace(d,"$1"+this.getExtCls());this.fire("beforeRender");!1!=this.autoRender&&
(this.renderTo[this.renderBy](c),this.afterRender());e.register(this)},doConfig:function(c){var a=this;a.params=c;var b=a.listeners||[];a._listeners=c.listeners?b.concat(c.listeners):b.concat();$HO.extend(a,c,{notCover:function(b){var d=a[b],e=$HO.contain(a._customEvents,b),g=$HO.contain(a._defaultEvents,b);(e||g)&&a._listeners.push({type:b,notEl:e,handler:c[b]});if(null!=d&&"object"==typeof d||$HO.isFunction(d))return!0}});a.renderTo=c.renderTo?$(c.renderTo):$(document.body);a.children=[]},getId:function(){return this._id||
(this._id=e.generateId(this.cid))},getEl:function(){return this._container},getHtml:function(){return this.html},getChildrenHtml:function(){for(var a=this.children,b=[],d=0;d<a.length;d++)b.push(a[d].getHtml());return b.join("")},getExtCls:function(){var a=[];this.extCls&&a.push(this.extCls);this.disabled&&a.push("w-disable");this.radius&&a.push("w-radius-"+this.radius);this.isMini&&a.push("w-mini");this.shadow&&a.push("w-shadow");this.shadowInset&&a.push("w-shadow-inset");this.isFocus&&a.push("w-focus");
this.isInline&&a.push("w-inline");return 0<a.length?a.join(" ")+" ":""},afterRender:function(){this._container=$("#"+this.getId());this.rendered=!0;!0!=this.notListen&&this.initListeners();this.disabled&&this.suspendListeners();this.fire("afterRender");delete this.html},find:function(a){return this.getEl().find(a)},hide:function(){this.getEl().hide();this.fire("hide")},show:function(){this.getEl().show();this.fire("show")},enable:function(){this.resumeListeners();this.getEl().removeClass("w-disable")},
disable:function(){this.suspendListeners();this.getEl().addClass("w-disable")},fire:function(a){for(var b=this._listeners.length-1;0<=b;b--){var d=this._listeners[b];if(d.type==a){var e=d.delegation;e({obj:this,data:d.data})}}},listen:function(a){var b=this,d=a.type,e=b._listeners,h=a.el,j=a.method||"bind",q=a.selector,m=a.data,w=a.delegation=function(){if(!0!=b.isSuspend)return a.handler.apply(a.scope||b,arguments)},h=h?"string"==typeof h?b.find(h):h:b.getEl();if(!a.notEl)if(q)if(m)h[j](q,d,m,w);
else h[j](q,d,w);else if(m)h[j](d,m,w);else h[j](d,w);e.push(a)},unlisten:function(a){for(var b=a.type,d=a.el||this.getEl(),e="delegate"==a.method?"undelegate":"unbind",h=a.selector,j,q=this._listeners.length-1;0<=q;q--){var m=this._listeners[q];if(m.handler==a.handler){j=m.delegation;this._listeners.splice(q,1);break}}if(!a.notEl)if(h)d[e](h,b,j);else d[e](b,j)},initListeners:function(){this._container=this._container||$("#"+this._id);var a=this._listeners;this._listeners=[];for(var b=a.length-1;0<=
b;b--)this.listen(a[b]);this.callChild("initListeners")},clearListeners:function(){for(var a=this._listeners,b=a.length-1;0<=b;b--)this.unlisten(a[b]);this.callChild("clearListeners")},suspendListeners:function(){this.isSuspend=!0;this.callChild("suspendListeners")},resumeListeners:function(){this.isSuspend=!1;this.callChild("resumeListeners")},each:function(a,b){$HO.each(this.children,a,b)},callChild:function(a){for(var b=this.children,d=0,e=b.length;d<e;d++)b[d][a]()},add:function(a){this.children.push(a);
a.parent=this},remove:function(a){for(var b=this.children,d=!1,e=0,h=b.length;e<h;e++)b[e]==a&&(b.splice(e,1),a.destroy(),d=!0);return d},parseItem:function(){},parseItems:function(){var a=this.params.items;if(a)for(var a=a.length?a:[a],b=0,d=a.length;b<d;b++){var k=a[b];this.defItem&&$HO.extend(k,this.defItem,{notCover:!0});this.parseItem(k);var h=e.getClass(k.xtype);k.autoRender=!1;k=new h(k);this.add(k)}},destroy:function(){e.unregister(this);this.fire("destroy");this.clearListeners();this.callChild("destroy");
this.getEl().remove();delete this._listeners;delete this._contianer;delete this.children}});return b});$Define("handy.component.Icon","handy.component.AbstractComponent",function(e){e=e.define("Icon");$HO.extend(e.prototype,{tmpl:['<span class="w-icon w-icon-<%=this.name%><%if(this.hasBg){%> w-icon-bg<%}%>"></span>']});return e});
$Define("handy.component.Button","handy.component.AbstractComponent",function(e){e=e.define("Button");$HO.extend(e.prototype,{text:"",color:null,iconPos:"left",radius:"big",shadow:!0,isInline:!0,tmpl:'<a class="w-btn<%if(this.color){%> w-btn-<%=this.color%><%};if(!this.text){%> w-btn-icon-notxt<%};if(this.hasIcon&&this.text){%> w-btn-icon-<%=this.iconPos%><%}%>">;<span class="w-btn-txt"><%=this.text%></span>;<%=this.getChildrenHtml()%>;</a>'.split(";"),parseItem:function(b){"Icon"==b.xtype&&(this.hasIcon=
!0)}});return e});
$Define("handy.component.Input","handy.component.AbstractComponent",function(e){e=e.define("Input");$HO.extend(e.prototype,{type:"",radius:"normal",iconPos:"left",btnPos:"right",tmpl:['<div class="w-input<%if(this.hasIcon){%> w-input-icon-<%=this.iconPos%><%}%>','<%if(this.hasBtn){%> w-input-btn-<%=this.btnPos%><%}%>">',"<%=this.getChildrenHtml()%>",'<input type="text" class="js-input w-input-txt"<%if(this.placeholder){%> placeholder="<%=this.placeholder%><%}%>"/>',"</div>"],listeners:[{type:"focus",el:".js-input",
handler:function(){this.getEl().addClass("w-focus")}},{type:"blur",el:".js-input",handler:function(){this.getEl().removeClass("w-focus")}}],doConfig:function(b){this.constructor.superProt.doConfig.call(this,b);"search"==this.type&&(this.params.items||(this.params.items=[]),this.params.items.push({xtype:"Icon",name:"search",hasBg:!0}))},parseItem:function(b){"Icon"==b.xtype?this.hasIcon=!0:"Button"==b.xtype&&(this.hasBtn=!0)}});return e});
$Define("handy.component.Tab","handy.component.AbstractComponent",function(e){e=e.define("Tab");$HO.extend(e.prototype,{defItem:{xtype:"Button",radius:null,isInline:!1,shadow:!1},tmpl:['<div class="w-tab">','<ul class="c-clear">',"<%for(var i=0,len=this.children.length;i<len;i++){%>",'<li class="w-tab-item" style="width:<%=100/len%>%">',"<%=this.children[i].getHtml()%>","</li>","<%}%>","</ul>","<%for(var i=0,len=this.children.length;i<len;i++){%>",'<div class="js-tab-content">',"<%=this.children[i].content%>",
"</div>","<%}%>","</div>"],listeners:[{type:"click",handler:function(){}}],parseItem:function(){}});return e});$Define("handy.module.AbstractModule","handy.base.Object",function(e){var b=e.createClass();e.extend(b.prototype,{isLoaded:!1,isActived:!1,useCache:!0,cache:function(){},init:function(){},beforeRender:function(){},render:function(){},afterRender:function(){},reset:function(){},exit:function(){return!0},initialize:function(a){this.conf=a}});return b});
$Define("handy.module.AbstractNavigator","handy.base.Object",function(e){var b=e.createClass();e.extend(b.prototype,{navigate:function(){}});return b});
$Define("handy.module.History","handy.base.HashChange",function(e){var b=$HO.createClass(),a=0;$HO.extend(b.prototype,{initialize:function(a){this.key=a||"handy";this.states=[];e.listen($H.Function.bind(this.stateChange,this))},stateChange:function(){var a=this.getCurrentState();if(a)a.onStateChange(a.param,!0)},saveState:function(b){var c=this.key+ ++a;this.states.push(c);this.states[c]=b;$HU.setHash("#"+JSON.stringify({hKey:c,param:b.param}))},getCurrentState:function(){try{var a=JSON.parse($HU.getHash().replace("#",
""));return this.states[a.hKey]}catch(b){$H.Debug.warn("History.getCurrentState:parse hash error:"+b.message)}},getPreState:function(){try{for(var a=JSON.parse($HU.getHash().replace("#","")).hKey,b=this.states,e=b.length,g=0;g++;g<e)if(b[g]==a)return 0<g?b[b[--g]]:null}catch(k){$H.Debug.error("History.getPreState error:"+k.message)}},back:function(){var a=this.getPreState();if(a)a.onStateChange(a.param)}});return b});
$Define("handy.module.ModuleManager","handy.module.History",function(e){var b=$HO.createClass();$HO.extend(b.prototype,{initialize:function(a){a&&(this.conf=a,$HO.extend(this,a),this.container=a.container?$(a.container):$(document.body));this.defModPackage+=".";this.history=new e;this.modules={}},go:function(a,b){var c=a.modName,e=this.currentMod,g=this.modules,k=g[e];if(e==c)k.reset();else{if(k&&!k.exit())return!1;(c=g[c])&&c.useCache?(this.showMod(c),c.cache(a)):this.createMod(a);!0!=b&&this.history.saveState({onStateChange:$H.Function.bind(this.go,
this),param:a})}},createMod:function(a){var b=this,c=a.modName;$Require(b.defModPackage+c,function(e){e=new e;e.name=c;e.mType=c;e.initParam=a;e.init(a);e.beforeRender();var g=b.getModWrapper(c);e.wrapper=g;var k=e.container=e.container?$(e.container):b.container;e.getHtml&&(g.html(e.getHtml()),k.append(g));e.render(g);b.showMod(e);e.afterRender();b.modules[c]=e})},getModWrapper:function(a){a="modWrapper_"+a;var b=$("#"+a);0==b.length&&(b=$('<div id="'+a+'"></div>'));return b},showMod:function(a){if(this.navigator&&
this.navigator.navigate(a,this))return!1;this.hideAll();a.wrapper.show();a.isActive=!0},hideAll:function(){var a=this.modules,b;for(b in a)a[b].wrapper.hide(),a[b].isActive=!1}});return b});
