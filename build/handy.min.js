/* Handy v1.0.0-dev | 2014-06-24 | zhengyinhui100@gmail.com */
(function(){var g=window.handy,b=window.$,e=window.handy=window.$=function(){};e.version="1.0.0";e.isDebug="undefined"==typeof gEnv?!1:"dev"==gEnv;e.expando=("handy-"+e.version).replace(/\./g,"_");e.add=function(a,c,d){d||(d=c,c=null);e.base||(e.base={});var f=[];if(c)if("string"==typeof c)f.push(e.base.Object.ns(c));else for(var b=0;b<c.length;b++)f.push(e.base.Object.ns(c[b]));f.push(e);c=d.apply(window,f);e.base[a]=e[a]=c;if(0<="Browser,Class,Array,Geo,Cookie,Date,Events,Function,Json,Object,String,Template,Util".indexOf(a))for(var j in c)e.isDebug&&
("undefined"!=typeof e[j]&&"console"in window&&!Function[j])&&(console.log(e[j]),console.log(a+"\u547d\u540d\u51b2\u7a81:"+j)),e[j]=c[j]};e.noConflict=function(a){window.$===e&&(window.$=b);a&&window.handy===e&&(window.handy=g);return e};e.noop=function(){}})();
handy.add("Json",function(){function g(a){f.lastIndex=0;f.test(a)&&(a=a.replace(f,function(a){var f=h[a];return"string"===typeof f?f:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));return'"'+a+'"'}function b(f,h){var e,j,k,m,v=c,u,l=h[f];l&&("object"===typeof l&&"function"===typeof l.toJSON)&&(l=l.toJSON(f));"function"===typeof a&&(l=a.call(h,f,l));switch(typeof l){case "undefined":return"undefined";case "string":return g(l);case "number":return isFinite(l)?String(l):"null";case "boolean":case "null":return String(l);
case "object":if(!l)return"null";c+=d;u=[];if("[object Array]"===Object.prototype.toString.apply(l)){m=l.length;for(e=0;e<m;e+=1)u[e]=b(e,l)||"null";k=0===u.length?"[]":c?"[\n"+c+u.join(",\n"+c)+"\n"+v+"]":"["+u.join(",")+"]";c=v;return k}if(a&&"object"===typeof a){m=a.length;for(e=0;e<m;e+=1)"string"===typeof a[e]&&(j=a[e],(k=b(j,l))&&u.push(g(j)+(c?": ":":")+k))}else for(j in l)Object.prototype.hasOwnProperty.call(l,j)&&(k=b(j,l))&&u.push(g(j)+(c?": ":":")+k);k=0===u.length?"{}":c?"{\n"+c+u.join(",\n"+
c)+"\n"+v+"}":"{"+u.join(",")+"}";c=v;return k}}var e="JSON"in window,a,c,d,f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k=/^[\],:{}\s]*$/,m=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,l=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
n=/(?:^|:|,)(?:\s*\[)+/g;return{stringify:function(f,h,j,g){if(e&&!g)return JSON.stringify.apply(null,arguments);var k;d=c="";if("number"===typeof j)for(k=0;k<j;k+=1)d+=" ";else"string"===typeof j&&(d=j);if((a=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return b("",{"":f})},parseJson:function(a,f,c){function d(a,c){var b,h,e=a[c];if(e&&"object"===typeof e)for(b in e)Object.prototype.hasOwnProperty.call(e,
b)&&(h=d(e,b),void 0!==h?e[b]=h:delete e[b]);return f.call(a,c,e)}if(e&&!c)return JSON.parse.apply(null,arguments);var b;a=String(a);j.lastIndex=0;j.test(a)&&(a=a.replace(j,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(k.test(a.replace(m,"@").replace(l,"]").replace(n,"")))return b=eval("("+a+")"),"function"===typeof f?d({"":b},""):b;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var g;g=(g=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(g[0])?function(a,c,d){var f=[];if(a.length){c=c||0;for(d=d||a.length;c<d;c++)f.push(a[c])}return f}:function(a,c,d){return Array.prototype.slice.call(a,c||0,d||a.length)};var b={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},ns:function(a,c){var d=null,f,h,e,g;a=b.alias(a);h=a.split(".");d=h[0];d=(e=2==arguments.length)?eval("(function(){if (typeof "+d+' == "undefined"){'+
d+" = {};}return "+d+";})()"):eval("(function(){if (typeof "+d+' != "undefined")return '+d+";})()");f=1;for(g=h.length;f<g;++f){if(f==g-1&&e)d[h[f]]=c;else if(e||d&&d[h[f]])d[h[f]]=d[h[f]]||{};else return;d=d[h[f]]}return d},alias:function(a,c){var d=b._alias;if(c)d[a]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+a+":"+d[a]):d[a]=c;else{if(a){var f=a,h=a.length-1;do{if(d[f])return d[f]+a.substring(h);h=f.lastIndexOf(".")}while(0<h&&(f=f.substring(0,h)));return a}return d}},extend:function(a,c,
d){if(!c||b.isStr(c)||b.isNum(c))return a;var f=d?d.notCover:!1,h=d?d.cover:null;d=d?d.IsClone:!1;a=a||{};var e=a.constructor,g=e.$isClass,m,l;for(l in c)if(m=c[l],(!h||b.contains(h,l))&&c.hasOwnProperty(l)){var n=a.hasOwnProperty(l),p=!0===f?n:!1;b.isArr(f)?p=b.contains(f,l)&&n:b.isFunc(f)&&(p=f(l,m));p||(m=d?b.clone(m):m,g&&(b.isFunc(m)&&!m.$name)&&(m.$name=l,m.$owner=e),a[l]=m)}return a},extendIf:function(a,c){return b.extend(a,c,{notCover:!0})},mix:function(a,c,d){a.superProto||(a.superProto=
{});for(var f in c)a.superProto[f]=b.isFunc(c[f])?a.superProto[f]?function(a,f){return function(){f.apply(this,arguments);c[a].apply(this,arguments)}}(f,a.superProto[f]):c[f]:c[f],a[f]||(a[f]=c[f]);d&&b.extend(a,d);c.toString!=c.constructor.prototype.toString&&(a.superProto.toString=function(){c.toString.apply(a,arguments)});return a},isNum:function(a){return"number"==typeof a},isStr:function(a){return"string"==typeof a},isBool:function(a){return"boolean"==typeof a},isSimple:function(a){return b.isStr(a)||
b.isNum(a)||b.isBool(a)},isUndef:function(a){return"undefined"==typeof a},isFunc:function(a){return"[object Function]"===e.prototype.toString.call(a)},isArr:function(a){return"[object Array]"===e.prototype.toString.call(a)},isObj:function(a){return"object"==typeof a&&!b.isArr(a)},isClass:function(a){return b.isFunc(a)&&!0===a.$isClass},isInstance:function(a){return a&&a.constructor&&!0===a.constructor.$isClass},equals:function(a,c){if(typeof a==typeof c){if("object"!=typeof a)return a===c;if(a===
c)return!0;if(b.isArr(a)&&b.isArr(c)){if(a.length!=c.length)return!1;for(var d=0,f=a.length;d<f;d++)if(!b.equals(a[d],c[d]))return!1;return!0}if(!b.isArr(a)&&!b.isArr(c)){if(b.count(a)!=b.count(c))return!1;for(d in a)if(void 0===c[d]||!b.equals(a[d],c[d]))return!1;return!0}}return!1},clone:function(a){if(null==a||"object"!=typeof a)return a;var c=a.constructor;if(c!=e&&c!=window.Array)return a;if(c==window.Date||c==window.RegExp||c==window.Function||c==window.String||c==window.Number||c==window.Boolean)return new c(a);
try{var d=new c,f;for(f in a)d[f]=b.clone(a[f]);return d}catch(h){return a}},isEmpty:function(a){if(b.isArr(a))return 0==a.length;for(var c in a)return!1;return!0},each:function(a,c,d){if(a){var f,h=0,e=a.length,g=void 0===e||b.isFunc(a);if(d)if(g)for(f in a){if(!1===c.apply(a[f],d))break}else for(;h<e&&!1!==c.apply(a[h],d);)f=a.length,e==f?h++:e=f;else if(g)for(f in a){if(!1===c.call(a[f],f,a[f]))break}else for(;h<e&&!1!==c.call(a[h],h,a[h]);)f=a.length,e==f?h++:e=f;return a}},contains:function(a,
c){if(!a)return!1;var d=!1;b.each(a,function(a,h){if(b.equals(h,c))return d=!0,!1});return d},largeThan:function(a,c){if("object"==typeof a&&"object"==typeof c){var d=!0;b.each(c,function(f){if(!b.equals(c[f],a[f]))return d=!1});return d}},count:function(a){if(b.isArr(a))return a.length;var c=0,d;for(d in a)c++;return c},removeUndefined:function(a,c){var d=b.isArr(a);if(c){if(d){var f=[];b.each(a,function(a,c){void 0!==c&&f.push(c)});return f}return b.extend({},a,{isClone:!0,notCover:function(a,f){return void 0===
f}})}b.each(a,function(f,c){void 0===c&&(d?a.splice(f,1):delete a[f])});return a},toArray:g,fromArray:function(a){for(var c={},d=0,f=a.length;d<f;d++){var b=a[d];c[b.name]=b.value}return c},generateMethod:function(a,c,d){c=b.isArr(c)?c:c.split(",");for(var f=0;f<c.length;f++){var h=c[f];a[h]=d(h)}}},e=window.Object;return b});
handy.add("Browser","handy.base.Object",function(g){var b={},e={};g.generateMethod(e,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(a){return function(f){var c=b[a];return!f&&"string"===typeof c&&/^[\d\.]+$/.test(c)?parseInt(c):c}});g=window.navigator.userAgent;var a;(a=g.match(/MSIE ([\d.]+)/))?b.ie=a[1]:(a=g.match(/Firefox\/([\d.]+)/))?b.firefox=a[1]:(a=g.match(/Chrome\/([\d.]+)/))?
b.chrome=a[1]:(a=g.match(/Opera.([\d.]+)/))?b.opera=a[1]:(a=g.match(/Version\/([\d.]+).*Safari/))?b.safari=a[1]:0;/windows|win32/i.test(g)?b.windows=!0:/linux/i.test(g)?b.linux=!0:/macintosh/i.test(g)?b.mac=!0:0;/trident/i.test(g)?b.trident=!0:/webkit/i.test(g)?b.webkit=!0:/gecko/i.test(g)?b.gecko=!0:/presto/i.test(g)?b.presto=!0:0;/MetaSr/i.test(g)?b.sogou=!0:/Maxthon/i.test(g)?b.maxthon=!0:/TencentTraveler/i.test(g)?b.tt=!0:/TheWorld/i.test(g)?b.theWorld=!0:/360[S|E]E/i.test(g)?b.is360=!0:0;var c;
if((c=g.match(/AppleWebKit\/([\d.]*)/))&&c[1])if(/ Mobile\//.test(g)&&g.match(/iPad|iPod|iPhone/)){b.mobile="ios";if((c=g.match(/OS ([^\s]*)/))&&c[1])b.ios=c[1].replace("_",".");if((c=g.match(/iPad|iPod|iPhone/))&&c[0])b[c[0].toLowerCase()]=b.ios}else if(/ Android/i.test(g)){if(/Mobile/.test(g)&&(b.mobile="android"),(c=g.match(/Android ([^\s]*);/))&&c[1])b.android=c[1]}else if(c=g.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))b.mobile=c[0].toLowerCase();var d;try{if(b.ie){var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
f&&(d=f.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(f=navigator.plugins["Shockwave Flash"])){var h=f.description.split(" ");a=0;for(var j=h.length;a<j;a++)if(0<parseInt(h[a])){d=h[a];break}}}catch(k){}b.flash=d?d:null;return e});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(g,b,e){var a={level:e.isDebug?0:5,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!b.mobile(),out:function(c,d,f){f=f||"log";if(d||a.showInPage){var b=e.expando+"debugDiv",j=top.document,g=j.getElementById(b);g?g.style.display="block":(g=j.createElement("DIV"),g.id=b,g.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+j.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u6536\u8d77</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',g.style.position="fixed",g.style.width="100%",g.style.left=0,g.style.top=0,g.style.right=0,g.style.height="100%",g.style.backgroundColor="#aaa",g.style.fontSize="12px",g.style.padding="10px",g.style.zIndex=9999999999,g.style.opacity=0.95,g.style.filter="alpha(opacity=95)",j.body.appendChild(g));b=g.getElementsByTagName("DIV")[0];c=c instanceof Error?c.message:c;j="string"==typeof c?c:e.Json.stringify(c,null,"&nbsp;&nbsp;&nbsp;&nbsp;",
!0);j=j.replace(/\n|\\n/g,"<br/>");b.innerHTML+="<div"+("log"==f?"":' style="color:'+("error"==f?"red":"info"==f?"green":"yellow"))+'">'+f+":<br/>"+j+"</div><br/><br/>";b.scrollTop=b.scrollHeight}b=arguments.callee.caller;b.$owner||(b=b.caller);try{if(b.$owner)console[f]("["+b.$owner.$ns+"->"+b.$name+"]");console[f](c)}catch(m){}},log:function(c,d){a.level>a.LOG_LEVEL||a.out(c,!!d,"log")},info:function(c,d){this.level>a.INFO_LEVEL||a.out(c,!!d,"info")},warn:function(c,d){a.level>a.WARN_LEVEL||a.out(c,
!!d,"warn")},error:function(c,d){if(!(a.level>a.ERROR_LEVEL)&&(a.out(c,!!d,"error"),c instanceof Error))throw c;},time:function(c,d,f){a.level>a.INFO_LEVEL||(c?("boolean"==typeof d&&(f=d,d=""),a.out((d||"")+((new Date).getTime()-(a.lastTime||0)),!!f)):a.lastTime=(new Date).getTime())},debug:function(c){if(!(a.level>a.DEBUG_LEVEL)&&!1!==c)debugger}};return a});
handy.add("Function",function(g){return{bind:function(b,e,a){var c=Array.prototype.slice.call(arguments,2);return function(){var a=c.slice();Array.prototype.push.apply(a,arguments);return b.apply(e,a)}},intercept:function(b,e,a,c){return g.Object.isFunc(b)&&g.Object.isFunc(e)?function(){var d=a||this,f={},h=arguments;f.scope=c;f.target=d;f.method=b;return!1!=e.apply(f,h)?b.apply(d,h):!1}:b||e}}});
handy.add("Class",["B.Object","B.Debug"],function(g,b){var e={createClass:function(a){var c=function(){var a,f,b=arguments;if(this.constructor==c)a=this;else return a=b.callee,f=function(){},f.prototype=a.prototype,f=new f,a.apply(f,b),f;if(f=a.initialize)return f.apply(a,b)};c.$isClass=!0;c.derive=function(a,f,c){var b=e.createClass();e.inherit(b,this,a,f,c);return b};c.prototype.callSuper=function(a,f){a&&(!a.$isClass&&void 0!==a.length)&&(f=a,a=null);var c=arguments.callee.caller,b=c.$owner.superProto;
f=f||c.arguments;a=a?a.prototype:b||this.constructor.superProto;c=c.$name;if(a&&(c=a[c],g.isFunc(c)))return c.apply(this,f)};a&&this.ns(a,c);return c},inherit:function(a,c,d,f,e){var j=function(){};j.prototype=c.prototype;g.extend(a,c,e);a.prototype=new j;a.prototype.constructor=a;a.superClass=c;a.superProto=c.prototype;if(c._onInherit)try{c._onInherit(a)}catch(k){b.error(k)}f&&g.extend(a,f);d&&g.extend(a.prototype,d)},getSingleton:function(a){return(a="string"==typeof a?g.ns(a):a)&&(a.$singleton||
(a.$singleton=new a))}};return e});
handy.add("Loader",["B.Debug","B.Object","B.Function"],function(g,b,e){function a(a){var f={},c=[],d=[];"string"==typeof a&&(a=[a]);for(var e=0,h=a.length;e<h;e++){var j=a[e],j=b.alias(j),g;g=j;g=/\.(css|js)$/.test(g)?s[g]&&"loaded"==s[g].status:q.urlMap&&q.urlMap[g]?q.urlMap[g].chkExist():b.ns(g);g?c.push(g):d.push(j)}f.exist=c;f.notExist=d;return f}function c(a,f){function c(){c.isCalled||(c.isCalled=!0,clearTimeout(l),f())}if("SCRIPT"===a.nodeName){var b=a,e=c,h=function(){/loaded|complete|undefined/.test(b.readyState)&&
(b.onload=b.onerror=b.onreadystatechange=null,m.removeChild(b),b=null,setTimeout(e,0))};b.onload=b.onreadystatechange=h;b.onerror=function(){g.error(j+"load script error:\n"+b.src);h()}}else{var k=c;window.hasOwnProperty("attachEvent")?a.attachEvent("onload",k):setTimeout(function(){d(a,k)},0)}var l=setTimeout(function(){g.error("Time is out:"+a.src);c()},q.timeout)}function d(a,f){if(!f.isCalled){var c;if(l)a.sheet&&(c=!0);else if(a.sheet)try{a.sheet.cssRules&&(c=!0)}catch(b){if("SecurityError"===
b.name||"NS_ERROR_DOM_SECURITY_ERR"===b.name)c=!0}setTimeout(function(){c?f():d(a,f)},1)}}function f(a){q.showLoading(!1);p--;s[a].status="loaded";q.traceLog&&g.log(j+"Response:\n"+a);h()}function h(){for(var f=n.length-1;0<=f;f--){var c=n[f],d=a(c.deps);if(0===d.notExist.length){n.splice(f,1);c.callback.apply(null,d.exist);h();break}else if(0==f&&0==p){for(f=n.length-1;0<=f;f--){for(var c=n[f],d=a(c.deps),e=d.notExist,j=!1,m=n.length-1;0<=m;m--)if(b.contains(e,n[m].id)){j=!0;break}j||g.error(k+c.id);
g.warn(c.id);g.warn("----notExist : "+d.notExist)}g.error(k+d.notExist)}}}var j="[Handy Loader] ",k=j+"not found: ",m=document.head||document.getElementsByTagName("head")[0]||document.documentElement,l=navigator.userAgent.indexOf("AppleWebKit"),n=[],p=0,s={},q={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(a,f,c){a=b.alias(a);2==arguments.length&&(c=f,f=[]);if(b.isFunc(c))for(var d,e=c.toString(),h=/\$Require\s*\(\s*['"]([^'"]+)['"]\s*\)/g;d=h.exec(e);)f.push(d[1]);
q.require(f,function(){var f;if("function"==typeof c)try{q.traceLog&&g.log(j+"define:\n"+a),f=c.apply(null,arguments)}catch(d){d.message=j+a+":\nfactory define error:\n"+d.message;g.error(d);return}else f=c;if(f){b.ns(a,f);var e=typeof f;if("object"==e||"function"==e)f.$ns=a}else g.warn(j+"factory no return:\n"+a)},a)},require:function(d,h,l){var v="string"==typeof d?[d]:d;d=[];for(var u=[],w=!0,r=0,y=v.length;r<y;r++){var x=v[r],x=b.alias(x),z=a(x);0<z.notExist.length?(d.push(x),w&&(w=!1,n.push({id:l,
deps:v,callback:h})),q.traceLog&&g.log(k+x)):u.push(z.exist[0])}if(0==d.length)return h&&h.apply(null,u),1==u.length?u[0]:u;v=!1;h=0;for(l=d.length;h<l;h++)if(u=d[h],!s[u]){v=u;r=q.urlMap&&q.urlMap[v]&&q.urlMap[v].url;if(!r){w="";r=q.rootPath;if("string"==typeof r)w=r;else if("object"==typeof r)for(y in y=void 0,r)0==v.indexOf(y)&&(w=r[y],v=v.replace(y,""));else w="";r=/.css$/.test(v)?0==v.indexOf("/")?v:"/css/"+v:/.js$/.test(v)?v:v.replace(/\./g,"/")+".js";r=w.replace(/\/$/,"")+"/"+r.replace(/^\//,
"")}v=!0;s[u]={id:u,status:"loading"};w=e.bind(f,null,u);q.traceLog&&g.log(j+"request:\n"+r);if(/.css$/.test(r))a:{u=r;r=m.getElementsByTagName("link");for(y=0;y<r.length;y++)if(x=r[y].href,!q.skinNode&&0<=x.indexOf(q.skinName)&&(q.skinNode=r[y]),0<=x.indexOf(u)||0<=u.indexOf(x))break a;r=document.createElement("link");r.rel="stylesheet";r.href=u;c(r,w);q.skinNode?m.insertBefore(r,q.skinNode):m.appendChild(r)}else u=r,r=document.createElement("script"),r.async="async",r.src=u,r.type="text/javascript",
c(r,w),m.appendChild(r);p++}v&&q.showLoading(!0)}};return q});
handy.add("Events",function(g){return{_eventCache:{},_execEvtCache:[],_parseEvents:function(b,e){var a=/\s+/;if("object"==typeof b){for(var c in b)e([c,b[c]]);return!0}if("string"==typeof b&&a.test(b)){a=b.split(a);c=0;for(var d=a.length;c<d;c++)e([a[c]]);return!0}return!1},_parseCustomEvents:function(b,e,a){var c=this,d=g.toArray(arguments,2);return c._parseEvents(e,function(a){c[b].apply(c,a.concat(d))})},_delegateHandler:function(b,e){var a=this;return function(c){if(!0!=a.isSuspend||0<c.indexOf(":"))return b.apply(e||
a,arguments)}},_pushEvent:function(b){this._execEvtCache.push(b)},_execEvents:function(){var b=this,e,a=b._execEvtCache;g.each(a,function(c,d){a.splice(c,1);var f=d.delegation;"number"==typeof d.times&&(1<d.times?d.times--:b.off(d.name,d.handler));e=f.apply(b,d.args)});return e},on:function(b,e,a,c){if(!this._parseCustomEvents("on",b,e,a,c)){"number"==typeof a&&(c=a,a=null);var d=this._eventCache,f=d[b];f||(f=d[b]=[]);b=this._delegateHandler(e,a);f.push({times:c,handler:e,context:a,delegation:b})}},
once:function(b,e,a){var c=g.toArray(arguments);c.push(1);this.on.apply(this,c)},off:function(b,e){if("all"==b)return this._eventCache={},!0;if(!this._parseCustomEvents("off",b,e)){var a=this._eventCache,c=b.indexOf(".");if(!e&&0>=c){for(var d in a)(d.split(".")[0]==b||0==c&&0<=d.indexOf(b))&&delete a[d];return!0}c=a[b];if(!c)return!1;if(e){a=0;for(d=c.length;a<d;a++)if(c[a].handler==e)return c.splice(a,1),!0}else return delete a[b],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=
!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(b,e){function a(a){if(a)for(var d=0,e=a.length;d<e;d++){var h=a[d];h.args=f;h.name=b;c._pushEvent(h)}}var c=this,d=g.toArray(arguments);d.unshift("trigger");if(!c._parseCustomEvents.apply(c,d)){var d=c._eventCache,f=g.toArray(arguments),h;if(0<b.indexOf("."))h=d[b],a(h);else for(var j in d)if(h=b.indexOf("."),j.split(".")[0]==b||0==h&&0<=j.indexOf(b))h=d[j],a(h);a(d.all);return c._execEvents()}}}});
handy.add("Date",function(){var g=window.Date,b={getWeek:function(a,c){var d=a.getDay();c&&(d=(d+(c%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[d]},isWeeken:function(a){return 0==a.getDay()||6==a.getDay()},getDaysInMonth:function(a){a=new g(a.getFullYear(),a.getMonth()+1,0);return a.getDate()},getDaysInYear:function(a){var c=new g(a.getFullYear(),0,0);a=new g(a.getFullYear()+1,0,0);return Math.floor((a.getTime()-c.getTime())/864E5)},getDayIndexOfYear:function(a){var c=new g("1/1/"+
a.getFullYear());return Math.ceil((a.getTime()-c.getTime())/864E5)},formatDate:function(a,c){"string"==typeof a&&(a=b.parseDate(a));if("object"!=typeof a)return a;c=c||"yyyy-MM-dd HH:mm:ss";var d=a.getHours(),f=Math.floor((a.getMonth()+3)/3),d={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":0==d%12?12:d%12,"H+":d,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":b.getWeek(a),"q+":f,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][f-1],"S+":a.getMilliseconds()},e;for(e in d)RegExp("("+e+")").test(c)&&
(f=RegExp.$1.length,c=c.replace(RegExp.$1,1==f?d[e]:("00"+d[e]).slice(-f)));return c},parseDate:function(a,c){var d=typeof a,f=new g;if("number"==d)return f.setTime(a),f;if("string"!=d)return a;var d=(c||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),e=a.match(/\d+/g);if(e){f.setDate(1);for(var j=0;j<e.length;j++){var k=d[j],m=parseInt(e[j]);switch(k){case "yyyy":f.setFullYear(m);break;case "MM":f.setMonth(m-1);break;case "dd":k=b.getDaysInMonth(f);m>k&&(m=k);f.setDate(m);break;case "HH":f.setHours(m);
break;case "mm":f.setMinutes(m);break;case "ss":f.setSeconds(m);break;case "SS":f.setMilliseconds(m)}}return f}},now:function(a){var c=new g;if(a&&!0!==a)"number"!=typeof a&&(a=b.parseDate(a).getTime()),e=a-c.getTime();else return c.setTime(c.getTime()+e),a&&(c=b.formatDate(c)),c},howLong:function(a,c){if(a){a=b.parseDate(a);var d=b.now().getTime()-a.getTime();if(!1!=c){var f;if(60>(d/=6E4))f="\u5206\u949f",d=d||1;else if(24>(d/=60))f="\u5c0f\u65f6";else if(30>(d/=24))f="\u5929";else return"30\u5929\u524d";
d=(Math.floor(0<d?d:1)||1)+f+"\u524d"}return d}}},e=0;return b});
handy.add("String",function(){var g={stripTags:function(b){return b.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(b){if(!b)return b;var e=document.createElement("div");b=document.createTextNode(b);e.appendChild(b);return e.innerHTML},unescapeHTML:function(b){var e=document.createElement("div");e.innerHTML=g.stripTags(b);return e.childNodes[0].nodeValue},decodeHTML:function(b){b=b.replace(/&lt;/gi,"<");b=b.replace(/&gt;/gi,">");b=b.replace(/&quot;/gi,'"');b=b.replace(/&apos;/gi,"'");b=b.replace(/<\/?br>/gi,
"\n");b=b.replace(/&amp;/gi,"&");return b=b.replace(/&nbsp;/gi," ")},encodeHTML:function(b){b=b.replace(/&/gi,"&amp;");b=b.replace(/</gi,"&lt;");b=b.replace(/>/gi,"&gt;");b=b.replace(/\"/gi,"&quot;");b=b.replace(/\'/gi,"&apos;");b=b.replace(/\n/gi,"</br>");return b=b.replace(/ /gi,"&nbsp;")},trim:function(b){return b=b.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(b,e){e||(e=/[,%\'\"\/\\;|\<\>\^]/);return-1<b.search(e)},len:function(b){return b.replace(/[^\x00-\xff]/g,"**").length},
left:function(b,e,a){if(g.len(b)>e){!0===a?a=2:0<a||(a=0);var c=0,d=0;for(e-=a;d<e;)255<b.charCodeAt(c)?d+=2:d++,c++;b=b.substring(0,c);for(c=0;c<a;c++)b+="."}return b},isNumStr:function(b){return 0==b.search(/^\d+$/g)},hasChn:function(b){return/[\u4E00-\u9FA5]+/.test(b)},isChn:function(b){return/^[\u4E00-\u9FA5]+$/.test(b)},addParam:function(b,e){e&&(b+=(-1<b.indexOf("?")?"&":"?")+e);return b}};return g});
handy.add("Cookie",function(){return{getCookie:function(g,b){var e=g+"=",a="",c=document.cookie;if(0<c.length){var d=c.indexOf(e);-1!=d&&(d+=e.length,e=c.indexOf(";",d),-1==e&&(e=c.length),a=c.substring(d,e),b||(a=unescape(a)))}return a},setCookie:function(g,b,e){var a=[];void 0!==g&&void 0!==b&&a.push(g+"="+escape(b));e&&(void 0!==e.path&&a.push("path="+e.path),void 0!==e.domain&&a.push("domain="+e.domain),void 0!==e.expires&&a.push("expires="+e.expires),e.secure&&a.push("secure"));document.cookie=
a.join(";")},delCookie:function(g){var b=new Date;b.setTime(b.getTime()-1);document.cookie=g+"=;expires="+b.toGMTString()}}});
handy.add("Util","B.Object",function(g){var b=0;return{isWindow:function(b){return null!=b&&b==b.window},uuid:function(){return++b},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(b){var a=top.location.hash;0<=a.indexOf("#")&&(b=a.replace(/#[^\?]*/,b));top.location.hash=b},position:function(b){for(var a=0,c=0;b;)a+=b.offsetLeft,c+=b.offsetTop,b=b.offsetParent;return{top:c,left:a}},result:function(b,a){var c=b[a];return g.isFunc(c)?c():c}}});
handy.add("Array","B.Object",function(g,b){function e(a){return a}function a(a){return function(f){return f[a]}}function c(f){return null==f?e:b.isFunc(f)?f:a(f)}function d(a){return function(f){if(f===a)return!0;for(var c in a)if(a[c]!==f[c])return!1;return!0}}function f(a){return function(f,b,d){var e={};b=c(b);g.each(f,function(c,h){var g=b.call(d,h,c,f);a(e,g,h)});return e}}var h={map:function(a,f,c){var b=[];if(null==a)return b;var d=Array.prototype.map;if(d&&a.map===d)return a.map(f,c);g.each(a,
function(a,d){b.push(f.call(c,d,a))});return b},pluck:function(f,c){return this.map(f,a(c))},some:function(a,f,c){var d=!1;if(null==a||!f)return d;var e=Array.prototype.some;if(e&&a.some===e)return a.some(f,c);b.each(a,function(a,b,e){if(d||(d=f.call(c,b,a,e)))return!1});return!!d},every:function(a,f,c){var d=!0;if(null==a||!f)return d;var e=Array.prototype.every;if(e&&a.every===e)return a.every(f,c);b.each(a,function(a,b,e){if(!(d=f.call(c,b,a,e)))return!1});return!!d},indexOf:function(a,f,c){if(null==
a)return-1;var d=0,b=a.length;if(c)if("number"==typeof c)d=0>c?Math.max(0,b+c):c;else return d=h.sortedIndex(a,f),a[d]===f?d:-1;var e=Array.prototype.indexOf;if(e&&a.indexOf===e)return a.indexOf(f,c);for(;d<b;d++)if(a[d]===f)return d;return-1},find:function(a,f,c){var d;this.some(a,function(a,b,e){if(f.call(c,a,b,e))return d=a,!0});return d},filter:function(a,f,c){var d=[];if(null==a)return d;var e=Array.prototype.filter;if(e&&a.filter===e)return a.filter(f,c);b.each(a,function(a,b,e){f.call(c,b,
a,e)&&d.push(b)});return d},where:function(a,f){return this.filter(a,d(f))},findWhere:function(a,f){return this.find(a,d(f))},invoke:function(a,f){var c=Array.prototype.slice.call(arguments,2),d=g.isFunc(f);return this.map(a,function(a){return(d?f:a[f]).apply(a,c)})},sortedIndex:function(a,f,d,b,e){d=c(d);f=d.call(b,f);for(var h=0,g=a.length;h<g;){var q=h+g>>>1,t=d.call(b,a[q]);(e?t>f:t<f)?h=q+1:g=q}return h},sortBy:function(a,f,d,b){f=c(f);return this.pluck(this.map(a,function(a,c,b){return{value:a,
index:c,criteria:f.call(d,a,c,b)}}).sort(function(a,f){var c=a.criteria,d=f.criteria;if(c!==d){if(c>d||void 0===c)return b?-1:1;if(c<d||void 0===d)return b?1:-1}return a.index-f.index}),"value")},groupBy:f(function(a,f,c){a[f]?a[f].push(c):a[f]=[c]}),countBy:f(function(a,f){a[f]?a[f]++:a[f]=1})};return h});
handy.add("Geo",function(g){return{distance:function(b,e,a){function c(a){a.get?a=[a.get("latitude"),a.get("longitude")]:g.isObj(a)&&(a=[a.latitude,a.longitude]);return a}var d,f;b=c(b);d=b[0];b=b[1];e=c(e);f=e[0];e=e[1];var h=d*Math.PI/180,j=f*Math.PI/180,h=6371*Math.acos(Math.cos(j)*Math.cos(h)*Math.cos(b*Math.PI/180-e*Math.PI/180)+Math.sin(j)*Math.sin(h)),h=h.toFixed(2);if(!1!=a){if(isNaN(h))if(d==f&&b==e&&g.isNum(d)&&g.isNum(b))h=0;else return"\u672a\u77e5";h+="km"}return h}}});
handy.add("Template",["B.Object","B.String","B.Debug","B.Function"],function(g,b,e){function a(a){var f=typeof a;"string"!==f&&(a="number"===f?a+"":"");return a}function c(a,f){var c=f.fn,d="";if(a){if(void 0!==a.length)for(var b=0,e=a.length;b<e;b++)d+=c(a[b]);else for(b in a)d+=c(a[b]);return d}}function d(a,f){var c=f.fn,d=[];if(a){if(void 0!==a.length)for(var b=0,e=a.length;b<e;b++)d.push(c(a[b]));else for(b in a)d.push(c(a[b]));return d.join("")}}function f(a){a=a.replace(/("|\\)/g,"\\$1").replace(/\r/g,
"\\r").replace(/\n/g,"\\n");return p?"$r+="+('"'+a+'"')+";":"$r.push("+('"'+a+'"')+");"}function h(a,f){f=f||{};var c=a.exp.replace(/"/g,"'"),c=b.trim(c).replace(/\s{2,}/g," "),d=f.helpers,e=d&&d.parseValue,h=a.blockName,g=a.children,j=a.num,l,t="\nif($tmp||$tmp===0){"+(p?"$r+=$tmp;":"$r.push($tmp);")+"}";l=(a.inverse?"inverse:true,":"")+"num:"+j+',context:$me,exp:"'+c+'",helpers:$helpers,data:$data}';d=d&&d.getValue?'$helpers.getValue.call($me,"'+c+'",$data,{'+l+")":"($data&&$data."+c+")";h?(c="$program"+
j,l='$tmp = $helpers["'+h+'"].call($me,'+d+", {fn:"+c+","+l+");"+t,g&&(t=k(g,f),t=q[0]+"\n"+t.join("\n")+"\n"+q[1],n.splice(2,0,"\nfunction "+c+"($data){\n"+t+"\n}\n"))):((g=c.match(/([^\s]+)\s([^\n]+)/))?(c=g[1],l="if (helper = $helpers."+c+') {\n$tmp = helper.call($me,"'+g[2]+'",{'+l+'); \n}else{$tmp="";}'):(l="if (helper = $helpers."+c+') {\n$tmp = helper.call($me,"",{'+l+"); \n}else{\nhelper = "+d+"; $tmp = typeof helper === functionType ? helper.call($me,{"+l+") : helper;\n"+(e?"\n$tmp=$helpers.parseValue.call($me,$tmp,{"+
l+");":"")+"}",m.isEscape?"\n$tmp=escape($tmp);":""),l+=t);return l}function j(a,f){if(a){var c=f||{},d=m.openTag,b=m.closeTag,h,g;c.children?g=c.children:c.children=g=[];if(0<=(h=a.indexOf(d))){var k=a.substring(0,h);k&&g.push({html:k});a=a.substring(h+d.length);if(0==a.indexOf("#"))if(a=a.substring(1),k=a.match(/^[a-z]+/)){var l=k[0];h=a.indexOf(b);k=a.substring(l.length+1,h);a=a.substring(h+b.length);k={num:++s,blockName:l,exp:k};g.push(k);var t=d+"/"+l+b;a:{h=a;for(var b=RegExp(d+"[#/]"+l+"((?!"+
b+").)*"+b,"ig"),q=0;d=b.exec(h);)if(d[0]==t)if(0==q){h=d.index;break a}else q--;else q++;h=-1}if(-1==h){e.error("\u672a\u627e\u5230\u5757\u7ed3\u675f\u4f4d\u7f6e:"+t);return}d=a.substring(0,h);a=a.substring(h+t.length);j(d,k);if("if"==l){l=k.children;t=0;for(d=l.length;t<d;t++)b=l[t],"else"==b.exp&&(b.exp=k.exp,b.blockName="if",b.num=++s,b.inverse=!0,b.children=l.slice(t+1),g.push(b),k.children=l.slice(0,t))}}else{e.error("\u627e\u4e0d\u5230\u8f85\u52a9\u51fd\u6570:"+a);return}else h=a.indexOf(b),
g.push({num:++s,exp:a.substring(0,h)}),a=a.substring(h+b.length);j(a,c)}else a&&g.push({html:a});return c}}function k(a,c){var d=[];if(a)for(var b=0,e=a.length;b<e;b++){var g=a[b];g.html?d.push(f(g.html)):g.exp&&d.push(h(g,c))}return d}var m={openTag:"{{",closeTag:"}}",isTrim:!0,isEscape:!1,getIfPlusJoin:function(){return p},registerHelper:function(a,f,c){g.isObj(f)?(t[a]||(t[a]={}),g.extend(t[a],f)):t[a][f]=c},tmpl:function(a,f,c){var d,b,h;if("string"==typeof a)d=a;else if(void 0!==a.length)d=a.join("");
else if(d=a.tmpl,h=a.id)if(l[h])b=l[h];else if(!d){var p=document.getElementById(h);p&&(d=(p.value||p.innerHTML).replace(/\s/g,""))}if(!b){if(!d){e.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}a:{var p=m.openTag,x=m.closeTag;d=d.replace(RegExp(p+"!((?!"+x+").)*"+x,"ig"),"");m.isTrim&&(d=d.replace(/^[\s\n]+/,"").replace(/[\s\n]+$/,"").replace(RegExp("("+x+"|\\>)(\\s|\\n)+(?=("+p+"|<))","ig"),"$1").replace(RegExp(x+"[\\s\\n]+([^\\n]+)[\\s\\n]+(?=("+p+"|<))","ig"),x+"$1"));n=[q[0]];n.push('var escape=$helpers.escape,functionType="function",$me=this;');
var p=a&&a.ns,z;p?(z=g.extend({},t["default"]),z=g.extend(z,t[p])):z=t["default"];a.helpers=z;d=j(d);s=0;a=k(d.children,a);n=n.concat(a);n.push(q[1]);a=n.join("\n");try{var G=window.Function.apply(null,["$T","$helpers","$data",a]);b=function(a,f){return G.call(f||a,m,z,a)};break a}catch(I){e.log(a),e.error(I)}b=void 0}h&&(l[h]=b)}if(f)try{return b(f,c)}catch(J){e.log(b.toString()),e.error(J)}else return b}},l={},n,p="".trim,s=0,q=["var $r="+(p?'""':"[]")+",$tmp,helper;","return "+(p?"$r;":'$r.join("");')],
t={"default":{"if":function(a,f){var c=f.data;g.isFunc(a)&&(a=a.call(c));if(a&&!f.inverse||!a&&f.inverse)return f.fn(c)},unless:function(a,f){f.inverse=!0;return f.helpers["if"].call(this,a,f)},each:p?c:d,escape:function(f){return b.encodeHTML(a(f))},trim:b.trim}};return m});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(g,b,e){function a(a){if(a==m)return!1;var f=k.contentWindow.document;f.open();f.write("<!doctype html><html><body>"+a+"</body></html>");f.close();m=a;g.log("set:"+k.contentWindow.document.body.innerText)}function c(){var f=b.getHash(),c=k.contentWindow.document.body.innerText;f!=m?(a(f),d(f)):c!=m&&(g.log("update:"+k.contentWindow.document.body.innerText),b.setHash(c))}function d(a){var f=p.listeners,c;for(c in f)f[c](a)}var f,
h=0,j=document,k,m,l=j.documentMode,n="onhashchange"in window&&(void 0===l||7<l),p={delay:50,listen:function(g,m){if(!f&&!f)if(f=!0,p.listeners={},n)$(window).on("hashchange",function(){d(b.getHash())});else k=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(j.body)[0],$(k).one("load",function(){a(b.getHash());setInterval(c,p.delay)});if(m in p.listeners)$D.error(Error("Duplicate name"));else return m=m||e.expando+ ++h,p.listeners[m]=g,m},unListen:function(a){for(var f in p.listeners)(!a||
a==f)&&delete p.listeners[f]}};return p});handy.add("Support","B.Browser",function(g){var b={mediaQuery:function(){var a;if(g.mobile())a="hui-mobile";else{a="hui-pc";var c=g.ie();c&&(a+=" ie"+c)}document.documentElement.className+=" "+a}};b.mediaQuery();if(6==g.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}return b});
handy.add("Validator",["B.String","B.Object"],function(g,b){var e={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(a,c){var d=c.rules,f;for(f in d){var b=d[f],g=("function"==typeof b?b:e[f])(a,b);if(!g)return d=c.error||e.error,f=c.messages&&
c.messages[f]||e.messages[f],f=f.replace(/\{([^\}]+)\}/g,function(a,f){return b[f]||0==f&&b||c[f]||b||""}),d&&d(f),g}return!0},required:function(a){return 0<g.trim(""+a).length},email:function(a){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a){return!/Invalid|NaN/.test((new Date(a)).toString())},dateISO:function(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a){return/^\d+$/.test(a)},creditcard:function(a){if(/[^0-9 \-]+/.test(a))return!1;var c=0,d=0,f=!1;a=a.replace(/\D/g,"");for(var b=a.length-1;0<=b;b--){d=a.charAt(b);d=parseInt(d,10);if(f&&9<(d*=2))d-=9;c+=d;f=!f}return 0===c%10},min:function(a,c){return a>=c},max:function(a,
c){return a<=c},range:function(a,c){return a>=c[0]&&a<=c[1]},minlength:function(a,c){return(b.isArr(a)?a.length:g.trim(""+a).length)>=c},maxlength:function(a,c){return(b.isArr(a)?a.length:g.trim(""+a).length)<=c},rangelength:function(a,c){var d=b.isArr(a)?a.length:g.trim(""+a).length;return d>=c[0]&&d<=c[1]},equalTo:function(a,c){return a===c}};return e});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(g,b,e){b={_init:function(){!a&&g.ie()&&(d=document.getElementById("LocalStorageUserDataDiv"),d||(d=document.createElement("DIV"),d.style.display="none",d.id="LocalStorageUserDataDiv",d.addBehavior("#default#userData"),document.body.appendChild(d),d.load(f)))},getItem:function(f){f=a?c.getItem(f):d.getAttribute(f);return f=e.parseJson(f)},setItem:function(b,g){g=e.stringify(g);try{a?c.setItem(b,g):(d.setAttribute(b,g),d.save(f))}catch(k){return $D.error(k),
!1}return!0},removeItem:function(b){a?c.removeItem(b):(d.removeAttribute(b),d.save(f))},clear:function(){a?c.clear():d.unload()}};var a=window.localStorage&&window.localStorage.getItem,c=window.localStorage,d,f=document.domain;b._init();return b});(function(g){Hui=H=$H=g.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};g=window.$;g.fn.remove=$H.intercept(g.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
$Define("CM.AbstractEvents",function(){var g=$H.createClass();$H.extend(g.prototype,$H.Events);$H.extend(g.prototype,{initialize:function(){this._eventCache={};this._listenTo=[]},_parseListenToEvents:function(b,e,a,c){var d=this,f=$H.toArray(arguments,3);return d._parseEvents(a,function(a){a.unshift(e);d[b].apply(d,a.concat(f))})},listenTo:function(b,e,a,c,d){if(!this._parseListenToEvents("listenTo",b,e,a,c,d)){"number"==typeof c&&(d=c,c=null);c=c||this;var f=this._delegateHandler(a,c);this._listenTo.push({target:b,
name:e,delegation:f,handler:a});b.on(e,f,c,d)}},unlistenTo:function(b,e,a){if(!this._parseListenToEvents("unlistenTo",b,e,a)){var c=this._listenTo,d="all"==b;$H.each(c,function(f,h){if(d||h.name==e&&h.handler==a&&h.target==b)h.target.off(h.name,h.delegation),c.splice(f,1)})}}});return g});
$Define("CM.DataStore",function(){var g=$H.createClass();$H.extend(g.prototype,{get:function(e,a){var c;e=$H.isClass(e)?e.$ns:$H.isInstance(e)?e.constructor.$ns:$H.alias(e);if(c=b[e]){if(a){if($H.isObj(a)){var d=[];$H.each(c,function(f,c){$H.largeThan(c,a)&&d.push(c)});return d}return c[a]}return c}},find:function(){},push:function(e,a){"string"!=typeof e&&(a=e,e=null);var c=a.constructor.$ns;(b[c]||(b[c]={}))[a.id]=a;e&&(b[e]||(b[e]=a))}});var b={};$S=$H.getSingleton(g);return g});
$Define("CM.AbstractDao","B.LocalStorage",function(g){var b=$H.createClass();$H.extend(b.prototype,{_ajaxMethodMap:{create:"POST",update:"POST",patch:"PATCH","delete":"DELETE",read:"GET"},_localMethodMap:{create:"setItem",update:"setItem",patch:"setItem","delete":"removeItem",read:"getItem"},ajax:function(b){b=this.parseParam(b);var a=$H.intercept(b.error,this.error);b.error=$H.intercept(a,b.beforeErr);a=$H.intercept(b.success,this.success);b.success=$H.intercept(a,b.beforeSucc);b.beforeSend=$H.intercept($H.bind(this.beforeSend,
this),b.beforeSend);b.complete=$H.intercept($H.bind(this.complete,this),b.complete);return $.ajax(b)},parseParam:$H.noop,beforeSend:function(){this.showLoading(!0)},complete:function(){this.showLoading(!1)},error:$H.noop,success:$H.noop,showLoading:$H.noop,get:function(){},set:function(){},remove:function(){},sync:function(b,a,c){c=c||{};var d=c.storeType||"remote",f={type:"POST",dataType:"json"};c.url||(f.url=a.getUrl());if(null==c.data&&a&&("create"===b||"update"===b||"patch"===b))f.data=c.attrs||
a.toJSON(c);if("remote"==d)f.url+="/"+b+".do",$H.extend(f,c),this.ajax(f);else g[this._localMethodMap[b]](f);a.trigger("request",a,c)}});return b});
$Define("CM.Model",["CM.AbstractDao","CM.AbstractEvents","CM.DataStore"],function(g,b){var e=b.derive({idAttribute:"id",$isModel:!0,_pending:!1,_validate:function(a,c){if(!c.validate||!this.validate)return!0;a=$H.extend({},this._attributes,a);var b=this.validationError=this.validate(a,c)||null;if(!b)return!0;this.trigger("invalid",this,b,$H.extend(c,{validationError:b}));return!1},_doDepends:function(a,c){var b=this.fields,f,e,g={},k,m;for(m in b)if((f=b[m])&&(e=f.depends))for(f=0;f<e.length;f++)if(a.hasOwnProperty(e[f])){g[m]=
void 0;k=!0;break}k&&this.set(g,null,{silent:c})},_parseFields:function(a){var c;if(!(c=this.fields))return a;var b,f,e,g,k={},m;for(m in a){f=a[m];if(b=c[m]){e=b.type;g=b.options;if(b=b.parse)f=b.apply(this,[f,a]);$H.isStr(e)&&("Date"==e?f=$H.parseDate(f):0<e.indexOf(".")&&(e=$H.ns(e)));$H.isClass(e)&&!(f instanceof e)&&(e.get?(b={},(f=e.get(f,g,b))&&(f._changedTmp=b.changed)):(b=this.get(m))?(e=b.set(f),f=b,f._changedTmp=e.changed):(f=new e(f,g),f._changedTmp=!0))}k[m]=f}return k},_onAttrEvent:function(a,
c,b,f){if(!("invalid"==c||"sync"==c||"request"==c||0==c.indexOf("change:")))if("add"!=c||$H.isInstance(f)){var e=this.get(a),g=$H.toArray(arguments,1);this.trigger.apply(this,["change:"+a,this,e].concat(g));this.trigger.apply(this,["change",this].concat(g));this._attrEvts[a]=1;g={};g[a]=e;this._doDepends(g)}},initialize:function(a,c){this.callSuper();this.uuid=$H.uuid();this.dao=this.dao||$H.getSingleton(g);var b=a||{};c||(c={});this.cid=$H.Util.uuid();this._attributes={};this._attrEvts={};c.collection&&
(this.collection=c.collection);c.parse&&(b=this.parse(b,c)||{});b=$H.extendIf(b,this.getDefaults());this.init&&this.init();this.set(b,c);this._changed={}},getDefaults:function(){var a={},c;if(c=this.fields)for(var b in c){var f=c[b];a[b]=f&&$H.isObj(f)?f.def:f}return a},toJSON:function(){return $H.clone(this._attributes)},sync:function(a,b,d){this.lastSyncTime=$H.now();return this.dao.sync(a,b,d)},get:function(a){return this._attributes[a]},escape:function(a){return $H.String.escapeHTML(this.get(a))},
has:function(a){a=this.get(a);return null!==a&&void 0!==a},set:function(a,b,d){var f,h={result:this};"object"===typeof a?(f=a,d=b):(f={})[a]=b;d||(d={});f instanceof e&&(f=f._attributes);f=this._parseFields(f);if(!this._validate(f,d))return h.invalid=!0,h;var g=d.unset;a=d.silent;var k={};b=this._changing;this._changing=!0;b||(this._previousAttributes=$H.Object.clone(this._attributes),this._changed={});var m=this._attributes,l=this._previousAttributes;this.idAttribute in f&&(this.id=f[this.idAttribute]);
for(var n in f){b=f[n];var p=m[n],s=p&&$H.isInstance(p),q=b&&$H.isInstance(b);if(s||q){if(g)delete m[n],p&&this.unlistenTo(p,"all");else if(m[n]=b,!p||p.id!=b.id)b._changedTmp=!0,p&&this.unlistenTo(p,"all"),this.listenTo(b,"all",$H.bind(this._onAttrEvent,this,n));if(g||b._changedTmp)k[n]=b;delete b._changedTmp}else $H.equals(m[n],b)||(k[n]=b),$H.equals(l[n],b)?delete this._changed[n]:this._changed[n]=b,g?delete m[n]:m[n]=b}f=!$H.isEmpty(k);if(!a){f&&(this._pending=d);for(var t in k)this._attrEvts[t]||
this.trigger("change:"+t,this,m[t],d)}if(!a)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);this._changing=this._pending=!1;f&&this._doDepends(k,a);h.changed=f;this._attrEvts={};return h},unset:function(a,b){b=b||{};b.unset=!0;return this.set(a,void 0,b)},clear:function(a){var b={},d;for(d in this._attributes)b[d]=void 0;a=a||{};a.unset=!0;return this.set(b,a)},each:function(a){$H.each(this._attributes,a)},hasChanged:function(a){var b=this._changed;return null==
a?!$H.isEmpty(b):$H.contains(b,a)},changedAttrbutes:function(a){if(!a)return this.hasChanged()?$H.clone(this._changed):!1;var b,d=!1,f=this._changing?this._previousAttributes:this._attributes,e;for(e in a)if(!$H.equals(f[e],b=a[e]))(d||(d={}))[e]=b;return d},previous:function(a){return null==a||!this._previousAttributes?null:this._previousAttributes[a]},fetch:function(a){var b=this;b.set("fetching",!0);a=a?$H.clone(a):{};void 0===a.parse&&(a.parse=!0);var d=a.success,f=a.beforeSet;a.success=function(e){b.set("fetching",
!1);e=b.parse(e,a);if(!(f&&!1==f(b,e,a))){if(b.set(e,a).invalid)return!1;d&&d(b,e,a);b.trigger("sync",b,e,a)}};b.sync("read",b,a)},save:function(a,b,d){var f=this,e;null==a||"object"===typeof a?(e=a,d=b):(e={})[a]=b;$H.isFunc(d)&&(d={success:d});d=$H.extend({validate:!0},d);if(e&&d.now){if(f.set(e,d).invalid)return!1}else if(!f._validate(e,d))return!1;void 0===d.parse&&(d.parse=!0);var g=d.success;d.success=function(a){var b=f.parse(a,d);d.now||(b=$H.extend(e||{},b));if($H.isObj(b)&&f.set(b,d).invalid)return!1;
g&&g(f,a,d);f.trigger("sync",f,a,d)};a=f.isNew()?"create":d.update?"update":"patch";if("patch"===a){if(b=f.changedAttrbutes(e),!b){g&&g(f,d);return}}else b=$H.extend({},f._attributes),b=$H.extend(b,e);for(var k in b)$H.isInstance(b[k])&&delete b[k];d.attrs=b;f.sync(a,f,d)},destroy:function(a){var b=this;a=a?$H.clone(a):{};var d=a.success,f=function(){b.trigger("destroy",b,b.collection,a);b.off("all")};a.success=function(e){(!a.now||b.isNew())&&f();d&&d(b,e,a);b.isNew()||b.trigger("sync",b,e,a)};if(b.isNew())return a.success(),
!1;b.sync("delete",b,a);a.now&&f()},getUrl:function(){var a=$H.result(this,"url")||$H.result(this.collection,"url");a||$D.error(Error("\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2aurl\u5c5e\u6027\u6216\u8005\u51fd\u6570"));return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a){return a.code?a.data:a},clone:function(){return new this.constructor(this._attributes)},isNew:function(){return void 0===this.id},isValid:function(a){return this._validate({},$H.extend(a||{},
{validate:!0}))}},{get:function(a,b,d){if(a){var f,e;e=!1;if(e=a[this.prototype.idAttribute])f=$S.get(this,e);f?e=f.set(a).changed:(f=new this(a,b),(b=$S.get(f,f.id))?(e=b.set(a).changed,f=b):(e=!0,$S.push(f)));d&&(d.changed=e);return f}}});return e});
$Define("CM.Collection",["CM.AbstractDao","CM.AbstractEvents","CM.Model","CM.DataStore"],function(g,b,e){var a=b.derive({model:e,$isCollection:!0,_getIterator:function(a){return $H.isFunc(a)?a:function(b){return b.get(a)}},_reset:function(){this.length=0;this._models=[];this._byId={}},_prepareModel:function(a,b){if(a instanceof e)return a;b=b?$H.clone(b):{};b.collection=this;var c=this.model.get(a,b);if(!c.validationError)return c;this.trigger("invalid",this,c.validationError,b);return!1},_addReference:function(a){this._byId[a.cid]=
a;null!=a.id&&(this._byId[a.id]=a);a.collection||(a.collection=this);a.on("all",this._onModelEvent,this)},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,e){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(b,e),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))},initialize:function(a,b){var c=this;
c.callSuper();c.dao=c.dao||$H.getSingleton(g);b||(b={});b.model&&(c.model=b.model);b.url&&(c.url=b.url);void 0!==b.comparator&&(c.comparator=b.comparator);void 0!==b.desc&&(c.desc=b.desc);c._reset();a&&c.reset(a,$H.extend({silent:!0},b));var e=c.comparator;if($H.isStr(e))c.on("change:"+e,function(a,b){c.sortItem(b)})},toJSON:function(a){return $H.map(this._models,function(b){return b.toJSON(a)})},sync:function(a,b,c){this.lastSyncTime=$H.now();return this.dao.sync(a,b,c)},add:function(a,b){b=$H.extend({add:!0,
remove:!1,merge:!1},b);return this.set(a,b).result},remove:function(a,b){var c=!$H.isArr(a);a=c?[a]:$H.clone(a);b||(b={});var e,g,m,l;e=0;for(g=a.length;e<g;e++)if(l=a[e]=this.get(a[e]))delete this._byId[l.id],delete this._byId[l.cid],m=this.indexOf(l),this._models.splice(m,1),this.length--,b.silent||(b.index=m,l.trigger("remove",l,this,b)),this._removeReference(l,b);return c?a[0]:a},set:function(b,f){if(!b)return{result:this};f=$H.extend({add:!0,remove:!1,merge:!0},f);b instanceof a&&(b=b._models);
f.parse&&(b=this.parse(b,f));var c=!$H.isArr(b)?b?[b]:[]:$H.clone(b),g=this._models,k,m,l,n,p,s,q=f.at,t=this.model,E=this.comparator&&null==q&&!1!==f.sort,F=f.add,v=f.merge,u=f.remove,w=!1;k=0;for(m=c.length;k<m;k++)if(p=c[k]||{},l=p instanceof e?n=p:p[t.prototype.idAttribute||"id"],s=this.get(l))u&&(this.remove(s,f),w=!0),v&&(p=p===n?n.attributes:p,f.parse&&(p=s.parse(p,f)),l=s.set(p,f).changed,w=w||l),c[k]=s;else if(F&&(f.id=l,n=c[k]=this._prepareModel(p,f)))this._addReference(n,f),E&&(q=this.sortedIndex(n)),
null!=q?g.splice(q,0,n):g.push(n),this.length+=1,f.silent||n.trigger("add",n,this,f,q),w=!0;return{changed:w,result:this}},each:function(a){$H.each(this._models,a)},eachDesc:function(a){for(var b=this._models,c=b.length-1;0<=c;c--)a(c,b[c])},reset:function(a,b){b||(b={});for(var c=0,e=this._models.length;c<e;c++)this._removeReference(this._models[c],b);b.previousModels=this._models;this._reset();a&&(a=this.add(a,$H.extend({silent:!0},b)).result);b.silent||this.trigger("reset",this,b);return a},push:function(a,
b){return this.add(a,$H.extend({at:this.length},b)).result},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){return this.add(a,$H.extend({at:0},b)).result},shift:function(a){var b=this.at(0);this.remove(b,a);return b},slice:function(){return Array.prototype.slice.apply(this._models,arguments)},get:function(a){return null==a?void 0:this._byId[a]||this._byId[a.id]||this._byId[a.cid]},size:function(){return this.length},at:function(a){return this._models[a]},
where:function(a,b){return $H.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var f in a)if(a[f]!==b.get(f))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){this.comparator||$D.error(Error("\u6ca1\u6709\u6bd4\u8f83\u5668"));a||(a={});"string"==typeof this.comparator||1===this.comparator.length?this._models=this.sortBy(this.comparator,this,a.desc):this._models.sort($H.Function.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},
sortItem:function(a,b){void 0===b&&(b=this.sortedIndex(a));var c=this.indexOf(a),e=this._models;e.splice(c,1);e.splice(b,0,a);this.trigger("sortItem",a,b,c,this)},pluck:function(a){return $H.invoke(this._models,"get",a)},getUrl:function(){return this.url},fetch:function(a){var b=this;b.fetching=!0;a=a?$H.clone(a):{};var c=a.success,e=a.beforeSet;a.success=function(g){b.fetching=!1;g=b.parse(g,a);e&&!1==e(b,g,a)||(b[a.reset?"reset":a.add?"add":"set"](g,a),c&&c(b,g,a),b.trigger("sync",b,g,a))};return b.sync("read",
b,a)},create:function(a,b){var c=this;b=b?$H.clone(b):{};if(!(a=c._prepareModel(a,b)))return!1;b.now&&c.add(a,b);var e=b.success;b.success=function(a,d){b.now||c.add(a,b);e&&e(a,d,b)};a.save(null,b);return a},parse:function(a){return a.code?a.data:a},clone:function(){return new this.constructor(this._models)}}),c=$H.Array;$H.each("map some every find filter invoke indexOf".split(" "),function(b,f){a.prototype[f]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(this._models);return c[f].apply(c,
a)}});a.prototype.sortedIndex=function(a,b,e){var g=this._getIterator(this.comparator);e=this.desc||e;return c.sortedIndex(this._models,a,g,b,e)};$H.each(["sortBy","groupBy","countBy"],function(b,f){a.prototype[f]=function(a,b,e){a=this._getIterator(a);e=this.desc||e;return c[f](this._models,a,b,e)}});return a});
$Define("CM.AbstractManager",function(){var g=$H.createClass();$H.extend(g.prototype,{initialize:function(){this._types={};this._all={}},type:"manager",registerType:function(b,e){this._types[b]=e;e.prototype.xtype=b},getClass:function(b){return $H.isClass(b)?b:this._types[b]||$H.ns(b)},register:function(b,e){var a=b.cid=e.cid||$H.uuid(),c=b._id=this.generateId(a,b.xtype);this._all[c]=b;this._all[a]=b},unregister:function(b){var e=this._all,a=b.getId(),c=b.getCid();e[a]==b&&delete e[a];e[c]==b&&delete e[c]},
eachInEl:function(b,e){var a=this;b.find(".js-"+a.type).each(function(b,d){d=$(d);var f=d.attr("id");(f=a.get(f))&&e(f)})},generateId:function(b,e){var a=$H.expando+"-"+this.type+"-"+e+"-"+(b||$H.uuid());if(this._all[a])$D.error("id\u91cd\u590d:"+a);else return a},get:function(b){return this._all[b]}});return g});
$Define("CM.ViewManager","CM.AbstractManager",function(g){var b=$H.createClass();$H.inherit(b,g,{type:"view",initialize:function(){var b=this;b.callSuper();$H.on("afterRender",function(a,c){b.afterRender(c)});$H.on("removeEl",function(a,c){b.destroy(c)})},afterRender:function(b){this.eachInEl(b,function(a){a.afterRender()})},destroy:function(b){this.eachInEl(b,function(a){a.destroy(!0)})}});$V=$H.getSingleton(b);return b});
$Define("CM.AbstractView",["CM.ViewManager","CM.AbstractEvents"],function(g,b){return b.derive({xtype:"View",renderBy:"append",autoRender:!0,listeners:[],_parseListenEvents:function(b,a){var c=this;return c._parseEvents(a.name,function(d){var f=$H.extend({},a);f.name=d[0];2==d.length&&(f.handler=d[1]);c[b].call(c,f)})},initialize:function(b){b=b||{};this.callSuper();this._listeners=[];this.listeners=$H.clone(this.listeners);this.manager=this.constructor.manager||$H.getSingleton(g);this.manager.register(this,
b);this.doConfig(b);this.init(b);this.parseItems();!1!=this.autoRender&&this.render();this.inited=!0},init:$H.noop,doConfig:function(b){b=(this.initParam=b)||{};$H.extend(this,b);var a;this.renderTo=(a=b.renderTo)?$(a):$(document.body)},getId:function(){return this._id},getCid:function(){return this.cid},getEl:function(){return this._container},getHtml:function(){return this.html},render:function(){var b=this.getHtml();this.renderTo[this.renderBy](b);this._container=$("#"+this.getId());this.initListeners()},
findEl:function(b){return this.getEl().find(b)},parseItems:$H.noop,callChild:$H.noop,listen:function(b){if(!this._parseListenEvents("listen",b)){var a=b.name,c=b.context,d=b.times,f=b.target,g=b.custom||f||$H.contains(this._customEvents,a),j=b.handler;$H.isFunc(f)&&(f=f.call(this));if(g)b=$H.removeUndefined([f,a,j,c,d]),this[f?"listenTo":"on"].apply(this,b);else if(this.listened){var f=this._listeners,d=b.el,g=b.method||"bind",k=b.selector,m=b.data,c=b.delegation=this._delegateHandler(j,c);$H.isFunc(d)&&
(d=d.call(this));d=d?"string"==typeof d?this.findEl(d):d:this.getEl();if(k)if(m)d[g](k,a,m,c);else d[g](k,a,c);else if(m)d[g](a,m,c);else d[g](a,c);f.push(b)}else this.listeners.push(b)}},unlisten:function(b){if(!this._parseListenEvents("unlisten",b)){var a=b.name,c=b.handler;if(b.custom)this.off(a,c);else{var d=b.el,f="delegate"==b.method?"undelegate":"unbind";b=b.selector;for(var g,d=d?"string"==typeof d?this.findEl(d):d:this.getEl(),j=this._listeners.length-1;0<=j;j--){var k=this._listeners[j];
if(k.handler==c){g=k.delegation;this._listeners.splice(j,1);break}}if(b)d[f](b,a,g);else d[f](a,g)}}},initListeners:function(){if(this.listened)return!1;this.listened=!0;for(var b=this.listeners,a=b.length-1;0<=a;a--)this.listen(b[a]);this.callChild()},clearListeners:function(){for(var b=this._listeners,a=b.length-1;0<=a;a--)this.unlisten(b[a]);this.off("all");this.unlistenTo("all");this.callChild()},destroy:function(){if(!this.destroyed)return this.clearListeners(),this.unlistenTo("all"),this.getEl().remove(),
this.destroyed=!0,this.manager.unregister(this),delete this._container,delete this.renderTo,delete this.html,!0}})});
$Define("CM.ModelView",["B.Template","CM.AbstractView","CM.Model","CM.Collection"],function(g,b,e,a){function c(a,b){return b.get?b.get(a):b[a]}function d(a,b){for(var c=b.context,d=b.data,e=b.num,g=b.type,j="bindAttr-"+(c.getCid()+"-"+e),m=[],l=[],p=c.ifBind(e,d),q=g&&c.ifBind(e,d,!0);e=k.exec(a);)"id"==e[2]?j=0==e[3].indexOf("this.")?c[e[3].substring(5)]:f(e[3],d):l.push(e);m.push('id="'+j+'"');for(var n,s,A,B,C=0,K=l.length;C<K;C++){e=l[C];s=e[2];n=e[3];n=n.split(" ");A=[];for(var D=0;D<n.length;D++)((B=
h(c,j,s,n[D],p,q,d))||0===B)&&A.push(B);n=A.join(" ");s?(g&&"value"==s&&(b.value=n),n=(e[1]||"")+n+e[4]):n&&(n=n+'="'+n+'"');n&&m.push(n)}return" "+m.join(" ")+" "}function f(a,b){return!a?a:0==a.indexOf("#")?a.substring(1):c(a,b)}function h(a,b,c,d,e,g,h){var j;b="#"+b;var k=d.indexOf("?"),m=d.indexOf(":");if(0==d.indexOf("this."))return a[d.substring(5)];if(0<k||0<m){g=d.substring(0,0<k?k:m);var l=0>k?"":d.substring(k+1,0<m?m:d.length),n=0>m?"":d.substring(m+1,d.length);j=f(g,h);e&&0!=g.indexOf("#")&&
a.listenTo(h,"change:"+g,function(a,f,d){a=$(b);c?"class"==c?d?(n&&a.removeClass(n),l&&a.addClass(l)):(l&&a.removeClass(l),n&&a.addClass(n)):a.attr(c,d?l:n):d?a.prop(l,!0):a.prop(l,!1)});return j?l:n}j=f(d,h);0!=d.indexOf("#")&&(e&&a.listenTo(h,"change:"+d,function(a,f,d){a=$(b);"class"==c?(a.removeClass(j),a.addClass(d),j=d):a.attr(c,d||"")}),"value"==c&&g&&a.listen({name:"input propertychange",el:b,handler:function(a){h.set(d,a.target.value)}}));return j}b=b.derive({bindType:"both",initialize:function(){this._bindModelNums=
{};this._bindElNums={};this.callSuper()},doConfig:function(){this.callSuper();var a=this.modelClass||e;this.model||(this.model=new a(this.data));this.xmodel=this.model},preTmpl:function(){var a=this.tmpl;$H.isArr(a)&&(a=a.join(""));var b=l.test(a),f="#js-"+this.manager.type+" #js-"+this.xtype;if(b){if(b=a.match(n)[1])s.test(a)||(b=b.replace(/([^\s]+)/g,"#$1")),f+=" "+b;a=a.replace(n,"")}f=' id=this._id class="'+f+'"';this.tmpl=a=p.test(a)?a.replace(q,"$1"+f):a.replace(m,"$1 {{bindAttr"+f+"}}")},getTmplFn:function(){var a=
this.tmpl,b=this.constructor;if(!$H.isFunc(a)&&!$H.isFunc(a=b.tmpl))this.preTmpl(),a=b.tmpl=$H.tmpl({tmpl:this.tmpl,ns:"ModelView"});return this.tmpl=a},getHtml:function(){return this.html?this.html:this.html=this.getTmplFn()(this.xmodel,this)},ifBind:function(b,f,c){if(!c&&"el"==this.bindType||c&&"model"==this.bindType)return!1;c=c?this._bindElNums:this._bindModelNums;f=!c[b]&&(f&&(f instanceof e||f instanceof a)||!f);c[b]=1;return f},getMetaMorph:function(a,b){return $("#metamorph-"+a+(b?"-end":
"-start"))},updateMetaMorph:function(a,b,f){if("append"==f)this.getMetaMorph(a,!0).before(b);else{var c=this.getMetaMorph(a);if(0!=c.length){a="metamorph-"+a+"-end";for(var d=c[0].nextSibling,e;d&&d.id!=a;)e=$(d),d=d.nextSibling,e.remove();void 0!==b&&c.after(b);"remove"==f&&(c.remove(),$(d).remove())}}},wrapMetaMorph:function(a,b){return'<script id="metamorph-'+a+'-start" type="text/x-placeholder">\x3c/script>'+(void 0===b?"":b)+'<script id="metamorph-'+a+'-end" type="text/x-placeholder">\x3c/script>'},
get:function(a){return this.xmodel.get(a)},set:function(a,b){this.xmodel.set(a,b)},update:function(a){this.xmodel.set(a)},getXmodel:function(){return this.xmodel}});g.registerHelper("ModelView",{"if":function(a,b){var f=b.context,c=b.data,d=b.exp;$H.isFunc(a)&&(a=a.call(c));var e;if(a&&!b.inverse||!a&&b.inverse)e=b.fn(c);var g=b.num,h=f.getCid()+"-"+g;f.ifBind(g,c)&&f.listenTo(c,"change:"+d,function(a,c,d){var e;if(d&&!b.inverse||!d&&b.inverse)e=b.fn(c);f.updateMetaMorph(h,e)});return f.wrapMetaMorph(h,
e)},unless:function(a,b){b.inverse=!0;return b.helpers["if"].call(this,a,b)},each:function(b,f){var c=f.context,d=f.fn,e=j?"":[],g=f.num,h=c.getCid()+"-"+g;if(b){var k;if(b instanceof a)b.each(function(a,b){k=c.wrapMetaMorph(h+"-"+b.uuid,d(b));j?e+=k:e.push(k)}),c.ifBind(g,b)&&(c.listenTo(b,"add",function(a,b,f,e){a=c.wrapMetaMorph(h+"-"+b.uuid,d(b));(e=e.at)?(f=f.at(e-1),$("#metamorph-"+(h+"-"+f.uuid)+"-end").after(a)):$("#metamorph-"+h+"-end").before(a)}),c.listenTo(b,"remove",function(a,b){c.updateMetaMorph(h+
"-"+b.uuid,"","remove")}));else if(void 0!==b.length)for(var m=0,g=b.length;m<g;m++)k=c.wrapMetaMorph(h+"-"+m,d(b[m])),j?e+=k:e.push(k);else for(m in b)k=c.wrapMetaMorph(h+"-"+m,d(b[m])),j?e+=k:e.push(k);return c.wrapMetaMorph(h,j?e:e.join(""))}},getValue:c,parseValue:function(a,b){var f=b.context,c=b.data,d=b.exp,e=g.isEscape,h=b.helpers,j=b.num,k=f.getCid()+"-"+j;f.ifBind(j,c)&&f.listenTo(c,"change:"+d,function(a,b,c){e&&(c=h.escape(c));f.updateMetaMorph(k,c)});e&&(a=h.escape(a));return f.wrapMetaMorph(k,
a)},bindAttr:d,input:function(a,b){b.type="input";return"<input "+d(a,b)+"/>"},textarea:function(a,b){b.type="textarea";return"<textarea "+d(a,b)+">"+b.value+"</textarea>"}});var j=g.getIfPlusJoin(),k=/((\w+)=['"]?)?([#\w][\s\w\.\?:#-]*)(['"]?)(?!\w*=)/g,m=/[^<]*(<[a-zA-Z]+)/,l=/^[^>]+class=/,n=/class=['"]?([#\w][\s\w\.\?:#-]*)(['"]?)(?!\w*=)/,p=/^[^>]+{{bindAttr/,s=/^[^>]+{{bindAttr((?!}}).)class=/,q=/({{bindAttr)/;return b});
$Define("CM.View",["CM.ViewManager","CM.ModelView","CM.Model","B.Template"],function(g,b,e,a){var c=/^(<[a-zA-Z]+)/,d=b.derive({xtype:"View",xConfig:{},tmpl:"<div>{{placeItem}}</div>",bindRefType:"bindRef",fastUpdateMethod:{renderTo:function(a){this.getEl()[this.renderBy]($(a))},hidden:function(a){a?this.hide():this.show()},disabled:function(a){a?this.disable():this.enable()}},_customEvents:"beforeRender render afterRender beforeShow show afterShow beforeHide hide afterHide beforeUpdate update afterUpdate beforeDestroy destroy afterDestroy add remove".split(" "),
_defaultEvents:"mousedown mouseup mouseover mousemove mouseenter mouseleave dragstart drag dragenter dragleave dragover drop dragend touchstart touchmove touchend touchcancel keydown keyup keypress click dblclick focus focusin focusout contextmenu change submit".split(" "),_applyArray:function(a,b){var c=this,d=arguments,e=d.callee.caller,g=e.$owner.prototype;0==d.length?(d=e.arguments,d=$H.toArray(d),a=e.$name,b=d.shift()):d=$H.toArray(d,2);return $H.isArr(b)?($H.each(b,function(b,e){g[a].apply(c,
[e].concat(d))}),!0):!1},initialize:function(){this.items=[];this.children=[];this.callSuper()},doConfig:function(a){var b=this;if(!b.configed){b.configed=!0;b.initParam=a;"string"==typeof a&&(a={text:a});var c=a||{};$H.extend(b,c,{notCover:function(a,f){var d;if(d=/^{{(((?!}}).)+)}}$/.exec(f))d=d[1],(b.refModelAttrs||(b.refModelAttrs={}))[a]=d;d=$H.contains(b._customEvents,a);if($H.contains(b._defaultEvents,a))return b.listeners.push({name:a,handler:c[a]}),!0;if(d)return b.on(a,c[a]),!0;if("defItem"==
a)return b[a]=$H.extend(b[a],f),!0;if("listener"==a)return b.listeners=b.listeners.concat($H.isArr(f)?f:[f]),!0;if("items"==a)return b.add(f),!0;if("extCls"==a&&b[a])return b[a]+=" "+f,!0;if("xtype"==a)return"View"==b[a]&&(b[a]="string"==typeof f?f:f.$ns),!0}});if(a=c.renderTo){if($H.isFunc(a))a=a.call(b);else if($H.isStr(a)&&0==a.indexOf(">")){var d=b.parent;a=d.inited&&d.findEl(a.substring(1))}else a=$(a);b.renderTo=a}else b.renderTo=$(document.body);if(a=b.getRefModel()){var d=b.refModelAttrs,
g;for(g in d){var l=d[g];if(0<l.indexOf("."))var n=l.split("."),l=(l=a.get(n[0]))&&l.get(n[1]);else l=a.get(l);b[g]=l}}g=b.xConfig;a=b.modelClass;if(!a&&!(a=b.constructor.modelClass))a=g?e.derive({fields:g}):e,a=b.constructor.modelClass=a;var p={};$H.each(g,function(a){var c=b[a];void 0!==c&&(p[a]=c)});b.xmodel=new a(p);b.bindRefModel()}},getHtml:function(){this.getId();var a,b=this.extCls||"";"visibility"==this.displayMode?a="visibility:hidden;":b+=" hui-hidden";var d=this.callSuper();a&&(d=d.replace(c,
'$1 style="'+a+'"'));b&&(d=d.replace(/(class=['"])/,"$1"+b+" "));if(a=this.wrapHtml)d=a[0]+d+a[1];return this.html=d},findHtml:function(a){a=this.find(a);for(var b=[],c=0;c<a.length;c++)b.push(a[c].getHtml());return b.join("")},initStyle:function(){var a=this.getEl(),b=this.style||{};void 0!==this.width&&(b.width=this.width);void 0!==this.height&&(b.height=this.height);a.css(b)},beforeRender:function(){return this.trigger("beforeRender")},render:function(){if(!1==this.beforeRender())return!1;var a=
this.getHtml();this.renderTo[this.renderBy](a);this.afterRender()},afterRender:function(){if(this.rendered)return!1;this.trigger("render");this.callChild();this._container=$("#"+this.getId());this.rendered=!0;this.initStyle();!0!=this.notListen&&this.initListeners();this.disabled&&this.disable();this.trigger("afterRender");this.hidden||this.show()},beforeShow:function(){return this.trigger("beforeShow")},show:function(a,b){var c=this;if(!1==c.beforeShow()||c.showed||b&&c.hidden)return!1;if(!a&&c.delayShow)setTimeout(function(){d.prototype.show.call(c,
!0)},0);else{c.trigger("show");c.showed=!0;c.hidden=!1;var e=c.getEl();"visibility"==c.displayMode?e.css({visibility:"visible"}):e.removeClass("hui-hidden");c.callChild([null,!0]);c.afterShow()}},afterShow:function(){var a=this;setTimeout(function(){a.trigger("afterShow")},0)},beforeHide:function(){return this.trigger("beforeHide")},hide:function(a){if(!1==this.beforeHide()||!this.showed)return!1;this.showed=!1;var b=this.getEl();"visibility"==this.displayMode?b.css({visibility:"hidden"}):b.addClass("hui-hidden");
!0!=a&&(this.hidden=!0);this.trigger("hide");this.callChild([!0]);this.afterHide()},afterHide:function(){this.trigger("afterHide")},enable:function(){this.resume();this.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")},disable:function(){this.suspend();this.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled","disabled")},getContent:function(a,b){b?!b instanceof d&&(b=this.find(b)[0]):b=this;return!1==a?b.children:b.getEl().html()},setContent:function(a,
b){if(b)return!b instanceof d&&(b=this.find(b)[0]),b.setContent(a);if("string"==typeof a)this.set("content",a),this.remove();else return this.set("content",""),this.add(a)},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0;this.callChild()},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1;this.callChild()},parentsEl:function(a){return this.getEl().parents(a)},get:function(a){var b=this.xConfig,c=this.xmodel;return c&&void 0!==b[a]?c.get(a):this[a]},set:function(a,b){var c=
{};c[a]=b;this.fastUpdate(c)||(this[a]=b)},getRefModel:function(){var a;if(a=this.refModel||this.model)return a;for(var b=this.parent;b;){if(a=b.refModel||b.model)return this.refModel=a;if(b.parent)b=b.parent;else return b.model}},bindRefModel:function(){function a(f,d){var k;if(0<d.indexOf(".")){var n=d.split(".");d=n[0];k=n[1]}("both"==c||"bindRef"==c)&&b.listenTo(e,"change:"+d,function(a,c,d){k&&(d=d&&d.get(k));b.set(f,d)});("both"==c||"bindXmodel"==c)&&b.listenTo(g,"change:"+f,function(a,b,c){k?
(a=e,(a=a.get(d))&&a.set(k,c)):e.set(d,c)})}var b=this,c=b.bindRefType,d=b.refModelAttrs;if(c&&d){var e=b.getRefModel(),g=b.xmodel,n;for(n in d)a(n,d[n])}},each:function(a,b){for(var c=this.children,d=c.length,e,g=0;g<d;){e=c[g];e=b?a.apply(e,b):a(g,e);if(!1===e)break;d==c.length?g++:d=c.length}},match:function(a,b){if("*"==a)return!0;b=b||this;var c,d,e;a=a.replace(/^#([^\s,\[]+)/,"[cid=$1]");a=a.replace(/^\.([^\s,\[]+)/,"[cClass=$1]");a=a.replace(/^([^\[]+)/,"[xtype=$1]");for(var g=/\[([^=|\!]+)(=|\!=)([^=]*)\]/g;c=
g.exec(a);){d=c[1];e=c[2];c=c[3];if("false"==c||"true"==c)c=eval(c);d=b.get?b.get(d):b[d];if("="===e?d!=c:d==c)return!1}return!0},find:function(a,b){var c=this;b=b||[];if(a)if($H.isNum(a))b.push(c.children[a]);else if($H.isStr(a)){if(0<a.indexOf(","))return $H.each(a.split(","),function(a,f){b=b.concat(c.find(f))}),b;var d=0==a.indexOf(">"),e=a.replace(/^>?\s?/,""),g=e.search(/\s/),n;0<g&&(n=e.substring(g+1),e=e.substring(0,g));c.each(function(c,g){g.match(e)&&(n?g.find(n,b):b.push(g));d||g.find(a,
b)})}else{if($H.isFunc(a)){var p=$H.isClass(a);c.each(function(c,d){(p&&d instanceof a||!p&&a(d))&&b.push(d);d.find(a,b)})}}else b=b.concat(c.children);return b},parents:function(a){for(var b=this;b.parent;)if(b=b.parent,a&&this.match(a,b))return b;return a||b===this?null:b},index:function(){var a=this,b=a.parent;if(b){var c;b.each(function(b,d){if(d==a)return c=b,!1});return c}return null},callChild:function(a,b){0!=this.children.length&&(a&&"string"!=typeof a&&(b=a,a=null),a=a||arguments.callee.caller.$name,
this.each(function(c,d){b?d[a].apply(d,b):d[a].call(d)}))},add:function(a,b){if(!this._applyArray()){var c=void 0===b;if(this.startParseItems){if(a instanceof d)a.parent=this;else{this.defItem&&$H.extend(a,this.defItem,{notCover:!0});this.parseItem(a);var e=this.manager.getClass(a.xtype);if(e){var g=a.renderTo;!this.inited&&($H.isStr(g)&&0==g.indexOf(">"))&&(g=null);g||(a.autoRender=!1);a.parent=this;a=new e(a)}else $D.error("xtype:"+a.xtype+"\u672a\u627e\u5230")}e=this.children;c?e.push(a):e.splice(b,
0,a);this.trigger("add",a,b);return a}e=this.items;c?e.push(a):e.splice(b,0,a)}},remove:function(a){if(!this._applyArray()){var b=this.children,c=!1,e;if($H.isNum(a))e=a,a=b[e];else if($H.isStr(a)||$H.isFunc(a)){a=this.find(a);for(var g=0,l=a.length;g<l;g++){if(!1==this.remove(a[g]))return!1;c=!0}}else if(a instanceof d)if(a.parent==this){g=0;for(l=b.length;g<l;g++)if(b[g]==a){e=g;break}}else return a.parent.remove(a);void 0!==e&&!1!=a.destroy(!0)&&(b.splice(e,1),c=!0);this.trigger("remove",a);return c}},
parseItem:function(){},parseItems:function(){this.startParseItems=!0;var a=this.items;if(a)for(var a=$H.isArr(a)?a:[a],b=0,c=a.length;b<c;b++)this.add(a[b])},beforeUpdate:function(){return this.trigger("beforeUpdate")},fastUpdate:function(a){var b=this,c=b.xmodel;if(!c)return!1;var d=b.xConfig,e=b.fastUpdateMethod,g=!0,n={};$H.each(a,function(a,b){d.hasOwnProperty(a)||(e[a]?n[a]=b:g=!1)});return g?(c.set(a),$H.each(n,function(a,c){e[a].call(b,c)}),!0):!1},update:function(a,b){if(!a||!1==this.beforeUpdate())return!1;
var c;if(!0===this.fastUpdate(a))c=this;else{c=this.parent;var d=$("<span></span>").insertBefore(this.getEl());b||(void 0===a.autoRender&&(a.autoRender=!0),a=$H.extend(a,this.initParam,{notCover:!0}));a=$H.extend(a,{xtype:this.xtype,renderBy:"replaceWith",renderTo:d},{notCover:["xtype"]});if(!a.cid||a.cid==this.cid)a._id=this._id;if(c){var e=this.index();if(!1==c.remove(this))return d.remove(),!1;c=c.add(a,e)}else{if(!1==this.destroy())return d.remove(),!1;c=new this.constructor(a)}}this.trigger("update",
c);this.afterUpdate(c);return c},replace:function(a){return this.update(a,!0)},afterUpdate:function(a){this.trigger("afterUpdate",a)},beforeDestroy:function(){return this.trigger("beforeDestroy")},destroy:function(a){if(!1==this.beforeDestroy())return!1;if(!this.destroyed)return this.callChild(),this.trigger("destroy"),this.clearListeners(),this.getEl().remove(),this.destroyed=!0,!a&&this.parent&&this.parent.remove(this),this.manager.unregister(this),delete this.initParam,delete this._container,delete this.renderTo,
delete this._listeners,delete this.html,delete this.xmodel,delete this.children,this.afterDestroy(),!0},afterDestroy:function(){this.trigger("afterDestroy")}},{extend:function(a){var b=this.prototype;$H.extend(b,a,{notCover:function(c){if("_customEvents"==c||"listeners"==c)return b[c]=(a[c]||[]).concat(b[c]||[]),!0;if("xtype"==c||"constructor"==c)return!0;if("xConfig"==c||"fastUpdateMethod"==c)return b[c]=$H.extendIf(a[c],b[c]),!0}})},html:function(a){return(new this($H.extend({autoRender:!1},a))).getHtml()}});
a.registerHelper("ModelView",{placeItem:function(a,b){var c=b.context,d=b.num,e=c.getCid()+"-"+d,g=c.findHtml(a);if(c.ifBind(d))c.on("add",function(b,d,g){if(d.match(a.replace(/^>\s?/,""))){if(void 0!==g){b=c.getMetaMorph(e);for(var h=0;h<g;h++)b=b.next();b.after(d.getHtml())}else c.updateMetaMorph(e,d.getHtml(),"append");d.afterRender()}});return c.wrapMetaMorph(e,g)}});c=/[^<]*(<[a-zA-Z]+)/;return d});
$Define("C.ComponentManager",["CM.AbstractManager","CM.ViewManager"],function(g,b){var e=g.derive({type:"component",initialize:function(){var a=$H.getSingleton(b);this._types=a._types;this._all=a._all}});$CM=new e;return e});
$Define("C.AbstractComponent",["CM.ViewManager","CM.View"],function(g,b){$C=$H.ns("C",{});var e=$H.createClass();$H.inherit(e,b,{xtype:"AbstractComponent",xConfig:{extCls:"",tType:"",theme:"",cls:"",radius:null,shadow:!1,shadowInset:!1,shadowSurround:!1,shadowOverlay:!1,isMini:!1,isActive:!1,isFocus:!1,isInline:!1,activeCls:"hui-active",cmpCls:{depends:["cls"],parse:function(){return"hui-"+this.get("cls")}},tTypeCls:{depends:["tType"],parse:function(){var a=this.get("tType");return a?"hui-"+this.get("cls")+
"-"+a:""}},themeCls:{depends:["theme"],parse:function(){return this.get("theme")?"hui-"+this.get("cls")+"-"+this.get("theme"):""}},activeClass:{depends:["isActive","activeCls"],parse:function(){return this.get("isActive")?this.get("activeCls"):""}},radiusCls:{depends:["radius"],parse:function(){var a=this.get("radius");return a?"hui-radius-"+a:""}}},hasConfig:function(a,b){if(!b)return!1;if($H.isArr(b))for(var d=0,e=b.length;d<e;d++){if(this.match(a,b[d]))return!0}else if(this.match(a,b))return!0;
return!1},doConfig:function(){this.callSuper();this.icon&&this.add({xtype:"Icon",name:this.icon});this.isMini&&(this.defItem=$H.extend({isMini:!0},this.defItem))},preTmpl:function(){this.callSuper();this.tmpl=this.tmpl.replace(/(class=['"])/,"$1#js-component cmpCls tTypeCls themeCls radiusCls isMini?hui-mini shadow?hui-shadow shadowSurround?hui-shadow-surround shadowOverlay?hui-shadow-overlay shadowInset?hui-shadow-inset activeClass isFocus?hui-focus isInline?hui-inline ")},active:function(){this.update({isActive:!0})},
unactive:function(){this.update({isActive:!1})},txt:function(a){return void 0!==a?this.set("text",a):this.get("text")},valid:function(){var a=this.validator;if(a){var b=this.val();a.error||(a.error=function(a){new $C.Tips({text:a,theme:"error"})});return a=$H.Validator.valid(b,a)}for(var b=this.children,d=0,e=b.length;d<e;d++)if(a=b[d].valid(),!a)return a;return!0}},{define:function(a,b){var d=$H.createClass();$H.inherit(d,b||e,null,null,{notCover:function(a){return"define"==a}});$H.getSingleton(g).registerType(a,
d);return $C[a]=d}});return e});$Define("C.Icon","C.AbstractComponent",function(g){g=g.define("Icon");g.extend({xConfig:{cls:"icon",hasBg:!0,isAlt:!1,name:"",iconName:{depends:["name"],parse:function(){return"hui-icon-"+this.get("name")}}},tmpl:'<span {{bindAttr class="isAlt?hui-alt-icon iconName hasBg?hui-icon-bg"}}></span>',doConfig:function(b){$H.isStr(b)&&(b={name:b});this.callSuper([b])}});return g});
$Define("C.Button","C.AbstractComponent",function(g){g=g.define("Button");g.extend({xConfig:{cls:"btn",text:"",theme:"gray",markType:"",iconPos:"",activeCls:"hui-btn-active",isBack:!1,radius:"little",shadow:!0,isInline:!0,hasText:{depends:["text"],parse:function(){var b=this.get("text");return b||0===b}},iconPosCls:{depends:["iconPos"],parse:function(){var b=this.get("iconPos");return b?"hui-btn-icon-"+b:""}},markCls:{depends:["markType"],parse:function(){var b=this.get("markType");return b?"hui-btn-mark-"+
b:""}}},cls:"btn",defItem:{xtype:"Icon"},tmpl:'<a href="javascript:;" hidefocus="true" {{bindAttr class="hasText:hui-btn-icon-notxt isBack?hui-btn-back markCls iconPosCls"}}><span class="hui-btn-txt">{{text}}</span>{{placeItem}}<span class="hui-btn-mark"></span></a>'});return g});
$Define("C.Desc",["C.AbstractComponent","CM.Model","CM.Collection"],function(g){g=g.define("Desc");g.extend({xConfig:{cls:"desc",icon:"",text:"",iconCls:{depends:["icon"],parse:function(){var b=this.get("icon");return b?"hui-icon-"+b:""}}},tmpl:'<div class="hui-content-desc">{{#if icon}}<span {{bindAttr class="#hui-icon #hui-mini #hui-alt-icon iconCls #hui-light"}}></span>{{/if}}{{text}}</div>'});return g});
$Define("C.Panel","C.AbstractComponent",function(g){g=g.define("Panel");g.extend({xConfig:{cls:"panel",content:"",isLoading:!1,loadingTxt:"\u6b63\u5728\u52a0\u8f7d\u4e2d..."},tmpl:'<div>{{#if isLoading}}<div class="hui-panel-loading"><div class="hui-mask"></div><div class="hui-loading-container"><div class="hui-tips hui-tips-big hui-tips-black hui-radius-little"><span class="hui-icon hui-icon-loading"></span><span class="hui-tips-txt">{{loadingTxt}}</span></div></div></div>{{/if}}{{#if content}}{{content}}{{else}}{{placeItem}}{{/if}}</div>'});
return g});
$Define("C.Popup","C.AbstractComponent",function(g){g=g.define("Popup");var b=0,e;g.extend({delayShow:!0,clickHide:!0,showPos:"center",destroyWhenHide:!0,shadowOverlay:!0,tmpl:"<div>{{placeItem}}</div>",doConfig:function(){this.callSuper();this.clickHide&&this.listeners.push({name:"click",el:$(document),handler:function(){this.hide()}});$H.android()&&(this.listeners.push({name:"show",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.show")&&$("input,textarea,select").attr("disabled","disabled")}}),
this.listeners.push({name:"hide",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.hide")&&setTimeout(function(){$("input,textarea,select").removeAttr("disabled")},500)}}))},afterShow:function(){var a=this,c=a.getEl();c.css("z-index",1E3*b+1E3);if(!a.width&&a.parent){var d=a.width=a.parent.getEl().outerWidth();c.css("width",d)}c=a.showPos;if("string"==typeof c)a[c]();else"function"==typeof c&&c.call(a);a.noMask||a.mask();a.timeout&&setTimeout(function(){a.destroyed||a.hide()},a.timeout)},
hide:function(){!1!=this.callSuper()&&(this.noMask||this.unmask(),this.destroyWhenHide&&this.destroy())},top:function(){this.getEl().css({left:"80px",top:"8px",position:"fixed"})},center:function(){var a=this.getEl(),b=this.width||a.outerWidth(),d=this.height||a.outerHeight(),e=document,b=((e.documentElement.offsetWidth||e.body.offsetWidth)-b)/2,d=((e.documentElement.clientHeight||e.body.clientHeight)-d)/2+(e.documentElement.scrollTop||e.body.scrollTop),d=10>d?window.screen.height/2-200:d;a.css({left:b+
"px",top:d-(this.offsetTop||0)+"px"})},followEl:function(a){a=a||this.parent.getEl();a=$H.position(a[0]);this.getEl().css(a)},mask:function(){e?e.appendTo(this.renderTo):e=$('<div class="hui-mask" style="display:none;"></div>').appendTo(this.renderTo);e.css("z-index",1E3*b+998);0==b&&e.show();b++},unmask:function(){b--;0==b?e.hide():e.css("z-index",1E3*(b-1)+998)}});return g});
$Define("C.ControlGroup","C.AbstractComponent",function(g){g=g.define("ControlGroup");g.extend({xConfig:{cls:"ctrlgp",direction:"v",directionCls:{depends:["direction"],parse:function(){return"hui-ctrlgp-"+this.get("direction")}}},multi:!1,defItem:{xtype:"Button",radius:null,shadow:!1,isInline:!1},tmpl:'<div {{bindAttr class="directionCls"}}>{{placeItem}}</div>',listeners:[{name:"click",selector:".js-item",method:"delegate",handler:function(b){var e=$(b.currentTarget),e=this.find("> [_id="+e.attr("id")+
"]");0<e.length&&(e=e[0].index(),this.onItemClick(b,e))}}],doConfig:function(){var b=this;b.callSuper();"h"==b.get("direction")&&b.listen({name:"afterRender add remove",custom:!0,handler:function(){b.layout()}})},parseItem:function(b){b.extCls=(b.extCls||"")+"js-item"},layout:function(){if(this.rendered){var b=this.children.length,e=Math.floor(100/b);this.findEl("> .js-item").each(function(a,c){var d=$(c);0==a?(d.removeClass("hui-item-last"),d.addClass("hui-item-first")):a==b-1?(d.removeClass("hui-item-first"),
d.addClass("hui-item-last")):(d.removeClass("hui-item-first"),d.removeClass("hui-item-last"));c.style.width=a<b-1?e+"%":100-e*(b-1)+"%"})}},select:function(b){if(!this.notSelect&&(b="number"==typeof b?this.children[b]:"string"==typeof b?this.find(b)[0]:b))if(!this.multi&&!b.multi){var e=this.getSelected();e&&this.selectItem(e,!1);this.selectItem(b)}else this.selectItem(b,!b.get("selected"))},getSelected:function(b){var e=[];this.each(function(a,c){if(c.get(c.select?"selected":"isActive"))e.push(b?
a:c)});return 0<e.length?this.multi?e:e[0]:null},selectItem:function(b,e){(e=!1!=e)?b.select?b.select():b.active():b.select?b.select(e):b.unactive()},val:function(b){var e=this;if(void 0!==b){var a=(""+b).split(",");e.each(function(b,d){$H.contains(a,d.get("value"))?e.selectItem(d,!0):e.selectItem(d,!1)})}else return a=[],e.each(function(b,d){d.get("selected")&&a.push(d.value)}),a.join(",")},onItemClick:function(b,e){this.select(e);this.itemClick&&this.itemClick(this.children[e],e)}});return g});
$Define("C.Radio","C.AbstractComponent",function(g){g=g.define("Radio");g.extend({xConfig:{cls:"radio",name:"",text:"",value:"",selected:!1},tmpl:'<div {{bindAttr class="#hui-btn #hui-btn-gray selected?hui-radio-on"}}><span class="hui-icon hui-icon-radio"></span><input type="radio" {{bindAttr selected?checked name="name" value="value"}}/><span class="hui-radio-txt">{{text}}</span></div>',select:function(b){this.update({selected:!1!=b})},val:function(b){if(void 0!==b)this.set("value",b);else return this.get("value")}});
return g});
$Define("C.Checkbox","C.AbstractComponent",function(g){g=g.define("Checkbox");g.extend({xConfig:{cls:"chkbox",name:"",text:"",value:"",selected:!1},multi:!0,tmpl:'<div {{bindAttr class="#hui-btn #hui-btn-gray selected?hui-chkbox-on"}}><span class="hui-icon hui-icon-chkbox"></span><input type="checkbox" {{bindAttr selected?checked name="name" value="value"}}/><span class="hui-chkbox-txt">{{text}}</span></div>',select:function(b){this.update({selected:!1!=b})},val:function(b){if(void 0!==b)this.set("value",
b);else return this.get("value")}});return g});
$Define("C.Select","C.AbstractComponent",function(g){g=g.define("Select");g.extend({xConfig:{cls:"select",name:"",text:"\u8bf7\u9009\u62e9...",value:"",radius:"little",iconPos:"right",iconPosCls:{depends:["iconPos"],parse:function(){var b=this.get("iconPos");return b?"hui-btn-icon-"+b:""}}},optionClick:function(){},defItem:{xtype:"Menu",hidden:!0,markType:"hook",showPos:"followEl",renderTo:"body"},_customEvents:["change"],tmpl:'<div {{bindAttr class="#hui-btn #hui-btn-gray iconPosCls"}}><span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span><input {{bindAttr value="value" name="name"}}/><span class="hui-btn-txt">{{text}}</span></div>',listeners:[{name:"click",
handler:function(){this.showOptions()}}],doConfig:function(b){var e=this;e.callSuper();var a=$H.clone(b.options);e.defTxt=e.get("text");for(var c=!1,d=0,f=a.length;d<f;d++){var g=a[d],j=g.value;if(void 0!==j&&j==b.value){e.set("text",g.text);c=g.selected=!0;break}}c||delete e.value;e.add({itemClick:function(a){a=a.get("value");e.val(a)},width:e.optionWidth||e.width,items:a})},showOptions:function(){this.children[0].show()},val:function(b){if(void 0!==b){if(this.get("value")!=b){var e=this.children[0],
a=e.find("> [value="+b+"]");0<a.length&&(a=a[0],this.set("value",b),this.txt(a.get("text")),e.select(a),this.trigger("change",b,a))}}else return this.get("value")},clearValue:function(){var b=this.children[0];b.selectItem(b.getSelected(),!1);this.set("value","");this.set("text",this.defTxt)}});return g});
$Define("C.Input","C.AbstractComponent",function(g){g=g.define("Input");g.extend({xConfig:{cls:"input",isTextarea:!1,name:"",value:"",placeholder:"",radius:"little",iconPos:"",btnPos:"",iconPosCls:{depends:["iconPos"],parse:function(){var b=this.get("iconPos");return b?"hui-input-icon-"+b:""}},btnPosCls:{depends:["btnPos"],parse:function(){var b=this.get("btnPos");return b?"hui-input-btn-"+b:""}}},fastUpdateMethod:{inputHeight:function(b){this.findEl("input,textarea").css("height",b)}},type:"",withClear:!1,
tmpl:'<div {{bindAttr class="iconPosCls btnPosCls"}}>{{placeItem}}{{#if isTextarea}}{{textarea class="#js-input" name="name" placeholder="placeholder" value=value}}{{else}}{{input type="#text" class="#js-input #hui-input-txt" name="name" placeholder="placeholder" value="value"}}{{/if}}</div>',listeners:[{name:"focus",el:".js-input",handler:function(){this.getEl().addClass("hui-focus")}},{name:"blur",el:".js-input",handler:function(){this.getEl().removeClass("hui-focus")}}],doConfig:function(b){var e=
this;"search"==b.type&&(e.icon="search");e.callSuper();b.isTextarea&&e.listeners.push({name:"input propertychange",el:".js-input",handler:function(){e.getEl().height("auto");var a=e.findEl(".js-input"),b=a[0].scrollHeight;50<=b&&a.css("height",b)}});e.withClear&&e.add({xtype:"Button",radius:"big",icon:"delete",click:function(){this.parent.findEl("input").val("").focus()}});if(b.inputHeight)e.on("afterRender",function(){e.findEl("input,textarea").css("height",b.inputHeight)})},parseItem:function(b){"Icon"==
b.xtype?this.get("iconPos")||this.set("iconPos","left"):"Button"==b.xtype&&(this.get("btnPos")||this.set("btnPos","right"))},val:function(b){var e=this.findEl("input,textarea");if(void 0!==b)e.val(b);else return e.val()},focus:function(){this.findEl("input").focus()}});return g});
$Define("C.Label","C.AbstractComponent",function(g){g=g.define("Label");g.extend({xConfig:{cls:"label",text:"",color:"",textAlign:"",forName:"",colorCls:{depends:["color"],parse:function(){var b=this.get("color");return b?"hui-label-"+b:""}},textAlignCls:{depends:["textAlign"],parse:function(){var b=this.get("textAlign");return b?"c-txt-"+b:""}}},tmpl:'<label {{bindAttr class="colorCls textAlignCls" for="forName"}}>{{text}}</label>'});return g});
$Define("C.RowItem","C.AbstractComponent",function(g){g=g.define("RowItem");g.extend({xConfig:{cls:"rowitem",text:"",underline:!1,hasArrow:!1,newsNum:0,newsNumTxt:{depends:["newsNum"],parse:function(){var b=this.get("newsNum");return b?9<b?"9+":b:0}}},tmpl:'<div {{bindAttr class="underline?hui-rowitem-underline"}}>{{placeItem}}<div class="hui-rowitem-txt">{{text}}</div>{{#if newsNumTxt}}<span class="hui-news-tips">{{newsNumTxt}}</span>{{else}}{{#if hasArrow}}<a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="\u8be6\u60c5"><span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span></a>{{/if}}{{/if}}</div>',
doConfig:function(b){this.callSuper();var e=this.get("text");!e&&0!==e&&this.set("text","&nbsp;");void 0!==this.text&&!b.hasOwnProperty("underline")&&this.set("underline",!0);b.click&&!b.hasOwnProperty("hasArrow")&&this.set("hasArrow",!0)}});return g});$Define("C.Set","C.AbstractComponent",function(g){g=g.define("Set");g.extend({xConfig:{cls:"set",title:""},tmpl:'<div><h1 class="hui-set-title">{{title}}</h1><div class="hui-set-content">{{placeItem}}</div></div>'});return g});
$Define("C.Field","C.AbstractComponent",function(g){g=g.define("Field");g.extend({xConfig:{cls:"field",noPadding:!1},defItem:{xtype:"RowItem",xrole:"content"},tmpl:'<div><div class="hui-field-left">{{placeItem > [xrole=title]}}</div><div {{bindAttr class="#hui-field-right noPadding?hui-field-nopadding"}}>{{placeItem > [xrole=content]}}</div></div>',doConfig:function(b){var e=b.title;$H.isSimple(e)&&(e={text:e});e=$H.extend({xtype:"Label",xrole:"title"},e);this.add(e);e=b.content;void 0===e&&!b.items&&
(e="");$H.isSimple(e)&&(e={text:e,underline:!0});e&&(this.noPadding=!0,this.add(e));b=$.extend({},b);delete b.title;delete b.content;this.callSuper([b])}});return g});$Define("C.Form","C.AbstractComponent",function(g){g=g.define("Form");g.extend({xConfig:{cls:"form"},tmpl:'<div><form action=""><div class="hui-form-tips c-txt-error"></div>{{placeItem}}</form></div>'});return g});
$Define("C.TabItem",["C.AbstractComponent","C.Panel"],function(g){g=g.define("TabItem");g.extend({xConfig:{cls:"tabitem"},defItem:{xtype:"Button",xrole:"title",radius:null,isInline:!1,shadow:!1},_customEvents:["selectchange"],tmpl:"<div>{{placeItem > [xrole=title]}}</div>",initialize:function(){this.callSuper();this.titleCmp=this.find("> [xrole=title]")[0];this.contentCmp=this.find("> [xrole=content]")[0]},doConfig:function(b){this.callSuper();var e=b.title;"string"==typeof e&&(e={text:e});"object"==
typeof e&&this.add(e);b=b.content;"string"==typeof b&&(b={xtype:"Panel",content:b});"object"==typeof b&&($H.extend(b,{xrole:"content",hidden:!this.selected,extCls:"js-content"}),this.add(b))},parseItem:function(b){this.selected&&"title"==b.xrole&&(b.isActive=!0);b.icon&&void 0===b.iconPos&&(b.iconPos="top");this.activeType&&(b.activeCls="hui-btn-active-"+this.activeType)},select:function(b){var e=this.titleCmp,a=this.contentCmp;!1==b?(e.unactive(),a&&a.hide(),this.set("selected",!1),this.trigger("selectchange",
!1)):(e.active(),a&&a.show(),this.set("selected",!0),this.trigger("selectchange",!0))},getContent:function(b,e){e||(e=this.contentCmp);return this.callSuper([b,e])},setContent:function(b,e){e||(e=this.contentCmp);return this.callSuper([b,e])}});return g});
$Define("C.Tab",["C.AbstractComponent","C.TabItem","C.ControlGroup"],function(g,b,e){g=g.define("Tab",e);g.extend({xConfig:{cls:"tab",direction:"h"},defItem:{xtype:"TabItem"},tmpl:'<div>{{placeItem > TabItem}}<div class="c-clear"></div>{{placeItem > TabItem > [xrole=content]}}</div>',parseItem:function(a){this.activeType&&(a.activeType=this.activeType);this.callSuper()},setTabContent:function(a,b){b=b||this.getSelected(!0);this.findEl(".js-tab-content").index(b).html(a)}});return g});
$Define("C.Toolbar","C.AbstractComponent",function(g){g=g.define("Toolbar");g.extend({xConfig:{cls:"tbar",title:"",isHeader:!1,isFooter:!1},defItem:{xtype:"Button",theme:"black"},tmpl:'<div {{bindAttr class="isHeader?hui-header isFooter?hui-footer"}}>{{placeItem}}{{#if title}}<h1 class="hui-tbar-title js-tbar-txt">{{title}}</h1>{{/if}}</div>',parseItem:function(b){"Button"==b.xtype&&(b.shadowSurround=!0,"left"==b.pos?b.extCls=(b.extCls||"")+" hui-tbar-btn-left":"right"==b.pos&&(b.extCls=(b.extCls||
"")+" hui-tbar-btn-right"))}});return g});
$Define("C.Tips",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(g,b){var e=g.define("Tips",b);e.extend({xConfig:{cls:"tips",text:"",radius:"normal",theme:"black"},timeout:2E3,tmpl:'<div {{bindAttr class="text:hui-tips-notxt"}}>{{placeItem}}{{#if text}}<span class="hui-tips-txt">{{text}}</span>{{/if}}</div>',doConfig:function(a){"loading"==a.type?$H.extend(this,{text:"\u6b63\u5728\u52a0\u8f7d\u4e2d...",timeout:null,noMask:!0,icon:"loading"}):"miniLoading"==a.type?$H.extend(this,{showPos:"top",
clickHide:!1,destroyWhenHide:!1,timeout:null,delayShow:!1,shadowOverlay:null,theme:null,noMask:!0,tType:"mini",items:{xtype:"Icon",name:"loading-mini",hasBg:!1}}):"topTips"==a.type&&$H.extend(this,{showPos:"top",noMask:!0,tType:"mini"});this.callSuper()}});return e});
$Define("C.Dialog",["C.AbstractComponent","C.Popup"],function(g,b){var e=g.define("Dialog",b);$H.extend(e,{alert:function(a){return new e({contentMsg:a,noClose:!0,noCancel:!0})},confirm:function(a,b){return new e({contentMsg:a,noClose:!0,okCall:function(){return b&&b(!0)},cancelCall:function(){return b&&b(!1)}})},prompt:function(a,b,d){d||(d=b,b="");return new e({contentMsg:a,noClose:!0,items:{xtype:"Input",xrole:"dialog-content",value:b},okCall:function(){var a=this.find("Input")[0].val();return d&&
d(a)}})}});e.extend({xConfig:{cls:"dialog",radius:"little",content:"",contentTitle:"",contentMsg:""},okTxt:"\u786e\u5b9a",cancelTxt:"\u53d6\u6d88",clickHide:!1,tmpl:'<div>{{placeItem > [xrole=dialog-header]}}<div class="hui-dialog-body">{{#if content}}{{content}}{{else}}<div class="hui-body-content c-clear"><h1 class="hui-content-title">{{contentTitle}}</h1><div class="hui-content-msg">{{contentMsg}}</div>{{placeItem > [xrole=dialog-content]}}</div>{{/if}}{{#unless noAction}}<div class="hui-body-action">{{placeItem > [xrole=dialog-action]}}</div>{{/unless}}</div></div>',
doConfig:function(a){var b=this;b.callSuper();a=a.items;b.title&&!b.hasConfig("[xrole=dialog-header]",a)&&b.add({xtype:"Toolbar",title:b.title,theme:"gray",xrole:"dialog-header",extCls:"hui-dialog-header",items:!b.noClose&&{xtype:"Button",radius:"big",icon:"delete",isMini:!1,theme:"gray",pos:"left",click:function(){b.hide()}}});!b.noAction&&!b.hasConfig("[xrole=dialog-action]",a)&&(a=[],b.noCancel||a.push({title:{isActive:1==b.activeBtn,text:b.cancelTxt,click:function(){!1!=(b.cancelCall&&b.cancelCall())&&
b.hide()}}}),b.noOk||a.push({title:{text:b.okTxt,isActive:2==b.activeBtn,click:function(){!1!=(b.okCall&&b.okCall())&&b.hide()}}}),b.add({xtype:"Tab",xrole:"dialog-action",theme:"border-top",notSelect:!0,items:a}))}});return e});
$Define("C.Menu",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(g,b,e){g=g.define("Menu",b);g.extend(e.prototype);g.extend({xConfig:{cls:"menu"},markType:null,destroyWhenHide:!1,defItem:{xtype:"Button",radius:null,shadow:!1,theme:null,isInline:!1},tmpl:'<div {{bindAttr class="directionCls"}}>{{placeItem}}</div>',doConfig:function(){this.callSuper(e);this.callSuper()},parseItem:function(a){e.prototype.parseItem.call(this,a);var b=this.markType;b?"hook"==b&&(a.items={name:"check",isAlt:!0,
hasBg:!1},a.iconPos="left",a.activeCls="hui-item-select"):this.notSelect=!0;a.isActive=a.selected}});return g});
$Define("C.DatePicker",["C.AbstractComponent","C.Dialog"],function(g,b){function e(a,b,e,g,j){for(a={xtype:"Select",xrole:"dialog-content",name:"dialogSelect",value:a,width:50,cClass:g,optionWidth:100,iconPos:"bottom",extCls:"hui-dp-"+g,options:[],defItem:{showPos:"center"},change:function(){var a=this.parent,b=a.val(!0);if("month"==this.cClass){var b=$H.getDaysInMonth(b),c=a.find(".date > Menu")[0],d=c.find();c.val()>b&&c.val(b);for(c=28;31>c;c++)d[c].hidden=c<b?!1:!0}b=a.val();a.val(b);a.trigger("change")}};b<=
e;b++)a.options.push({text:"minute"==g&&10>b?"0"+b:b,value:b,hidden:j&&b>j});return a}var a=g.define("DatePicker",b);a.getInstance=function(b){var d,e=b.formator||"default",g=a.instance||(a.instance={});(d=g[e])?(d.host!=b.host&&(d.host=b.host,d.off("change confirm"),b.change&&d.on("change",b.change),b.confirm&&d.on("confirm",b.confirm),b.date&&d.val(b.date)),d.show()):d=g[e]=new a($H.extend(b,{destroyWhenHide:!1}));return d};a.extend({xConfig:{cls:"dp"},extCls:"hui-dialog",_customEvents:["change",
"confirm"],doConfig:function(a){var b=this;a=a||{};var f=a.date;$H.isStr(f)&&(f=$H.parseDate(f));for(var f=f||$H.now(),g=a.formator||(a.formator="yyyy-MM-dd HH:mm"),j=$H.formatDate(f,g),k=[],m=$H.getDaysInMonth(f),g=g.match(/[a-zA-Z]+/g),l=j.match(/\d+/g),n=0;n<g.length;n++){var p=g[n],s=parseInt(l[n]);switch(p){case "yyyy":k.push(e(s,s,s+10,"year"));break;case "MM":k.push(e(s,1,12,"month"));break;case "dd":k.push(e(s,1,31,"date",m));break;case "HH":k.push(e(s,0,23,"hour"));break;case "mm":k.push(e(s,
0,59,"minute"))}}$H.extend(a,{contentTitle:j+" \u661f\u671f"+$H.getWeek(f),items:k,okCall:function(){return b.trigger("confirm")}});b.callSuper([a])},val:function(a){var b=this.find("Select"),e=this.formator;if(!a||$H.isBool(a)){for(var g="",j=0;j<b.length;j++)1==j||2==j?g+="-":3==j?g+=" ":4==j&&(g+=":"),g+=b[j].val();b=$H.parseDate(g);return a?b:$H.formatDate(b,e)}var k=g=a;$H.isStr(a)?k=$H.parseDate(a,e):g=$H.formatDate(a,e);a=g.match(/\d+/g);for(j=0;j<b.length;j++)b[j].val(a[j]);this.set("contentTitle",
g+" \u661f\u671f"+$H.getWeek(k))}});return a});
$Define("C.DateSelect",["C.AbstractComponent","C.DatePicker"],function(g,b){var e=g.define("DateSelect");e.extend({xConfig:{cls:"dsel",name:"",value:"right",text:{depends:["value"],parse:function(){var a=this.get("value");return a?a+" \u661f\u671f"+$H.getWeek($H.parseDate(a)):"\u8bf7\u9009\u62e9..."}},radius:"little",iconPos:"right",iconPosCls:{depends:["iconPos"],parse:function(){var a=this.get("iconPos");return a?"hui-btn-icon-"+a:""}}},_customEvents:["change","confirm"],tmpl:'<div {{bindAttr class="#hui-btn #hui-btn-gray iconPosCls"}}><span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span><input {{bindAttr value="value" name="name"}}/><span class="hui-btn-txt">{{text}}</span></div>',
listeners:[{name:"click",handler:function(){this.showDialog()}}],doConfig:function(a){var b=a.date;b||(b=$H.now(),b.setMinutes(0));this.date=b;a=$H.formatDate(b,a.formator||(a.formator="yyyy-MM-dd HH:mm"));this.set("value",a);this.callSuper()},showDialog:function(){var a=this;b.getInstance({date:a.get("value"),formator:a.formator,host:a,confirm:function(){a.set("value",this.val());a.trigger("change");return a.trigger("confirm")}})},val:function(a){if(!a||$H.isBool(a)){var b=this.get("value");return a?
$H.parseDate(b):b}a=$H.formatDate(a,this.formator);this.get("value")!=a&&(this.set("value",a),this.trigger("change"))}});return e});
$Define("C.Hcard","C.AbstractComponent",function(g){g=g.define("Hcard");g.extend({xConfig:{cls:"hcard",image:"",title:"",titleDesc:"",hasArrow:!1,newsNum:0,newsNumTxt:{depends:["newsNum"],parse:function(){var b=this.get("newsNum");return b?9<b?"9+":b:0}}},defItem:{xtype:"Desc"},tmpl:'<div {{bindAttr class="image?hui-hcard-hasimg"}}>{{#if image}}<div class="hui-hcard-img js-img"><img {{bindAttr src="image"}}></div>{{/if}}<div class="hui-hcard-content js-content"><div class="hui-content-title">{{title}}<span class="hui-title-desc">{{titleDesc}}</span></div>{{placeItem > [xtype=Desc]}}</div>{{placeItem > [xtype!=Desc]}}{{#if newsNumTxt}}<span class="hui-news-tips">{{newsNumTxt}}</span>{{else}}{{#if hasArrow}}<a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="\u8be6\u60c5"><span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span></a>{{/if}}{{/if}}</div>',doConfig:function(b){var e=
this;e.callSuper();b.click&&void 0===e.hasArrow&&e.set("hasArrow",!0);if(b=e.desc)1==b.length&&e.set("theme","little"),e.add(b);e.imgClick&&e.listen({name:"click",selector:".js-img",method:"delegate",handler:function(){e.imgClick.call(e)}});e.contentClick&&e.listen({name:"click",selector:".js-content",method:"delegate",handler:function(){e.contentClick.call(e)}})}});return g});
$Define("C.Vcard","C.AbstractComponent",function(g){g=g.define("Vcard");g.extend({xConfig:{cls:"vcard",image:"",title:"",extraTitle:""},tmpl:'<div><div {{bindAttr class="#hui-vcard-title image?hui-title-hasimg #c-clear"}}><div class="hui-title-img"><img {{bindAttr src="image"}}></div><div class="hui-title-txt">{{title}}</div><div class="hui-title-extra">{{extraTitle}}</div></div>{{placeItem > [xrole!=action]}}<div class="hui-vcard-action">{{placeItem > [xrole=action]}}</div></div>',doConfig:function(b){this.callSuper();
if(b=b.action)b=$H.extend({xtype:"Button",radius:null,isInline:!1,xrole:"action"},b),this.add(b)}});return g});
$Define("C.Conversation","C.AbstractComponent",function(g){g=g.define("Conversation");g.extend({xConfig:{cls:"conversation",theme:"left",time:"",image:"",content:""},tmpl:'<div class="c-clear"><div class="hui-conver-time">{{time}}</div><div class="hui-conver-img js-conver-img"><img {{bindAttr src="image"}}></div><div class="hui-conver-content">{{content}}<div class="hui-triangle"><div class="hui-triangle hui-triangle-inner"></div></div></div></div>',doConfig:function(){var b=this;b.callSuper();b.imgClick&&
b.listen({name:"click",selector:".js-conver-img",method:"delegate",handler:function(){b.imgClick.call(b)}})}});return g});
$Define("C.ModelList","C.AbstractComponent",function(g){g=g.define("ModelList");g.extend({xConfig:{cls:"mlist",isEmpty:!1,emptyTips:"\u6682\u65e0",pdTxt:"",pdComment:"\u4e0a\u6b21\u5237\u65b0\u65f6\u95f4\uff1a",pdTime:"",hasMoreBtn:!0,moreBtnTxt:"\u67e5\u770b\u66f4\u591a",showBtnIfEmpty:!1,hasPullRefresh:!1,showMoreBtn:{depends:["isEmpty","showBtnIfEmpty"],parse:function(){return this.get("showBtnIfEmpty")||!this.get("isEmpty")}}},pullTxt:"\u4e0b\u62c9\u53ef\u5237\u65b0",flipTxt:"\u677e\u5f00\u53ef\u5237\u65b0",
releaseTxt:"\u6b63\u5728\u5237\u65b0",maxNumFromCache:20,scrollPos:"top",pulldownIsRefresh:!0,tmpl:'<div class="hui-list"><div class="hui-list-inner">{{#if hasPullRefresh}}<div class="hui-list-pulldown hui-pd-pull c-h-middle-container"><div class="c-h-middle"><span class="hui-icon hui-alt-icon hui-icon-arrow-d hui-light"></span><span class="hui-icon hui-alt-icon hui-icon-loading-mini"></span><div class="hui-pd-txt">{{#if pdTxt}}<div class="js-txt">{{pdTxt}}</div>{{/if}}{{#if pdComment}}<div class="js-comment hui-pd-comment"><span class="js-pdComment">{{pdComment}}</span><span class="js-pdTime">{{pdTime}}</span></div>{{/if}}</div></div></div>{{/if}}{{#if isEmpty}}<div class="hui-list-empty js-empty">{{emptyTips}}</div>{{/if}}<div class="js-item-container">{{placeItem}}</div>{{#if hasMoreBtn}}<div {{bindAttr class="#hui-list-more showMoreBtn:hui-hidden"}}><a href="javascript:;" hidefocus="true" class="hui-btn hui-btn-gray hui-shadow hui-inline hui-radius-little"><span class="hui-btn-txt">{{moreBtnTxt}}</span></a></div>{{/if}}</div></div>',
doConfig:function(){var b=this;b.callSuper();b.set("pdTxt",b.pullTxt);b.itemXtype&&((b.defItem||(b.defItem={})).xtype=b.itemXtype);var e=b.model;0==e.size()?b.set("isEmpty",!0):b.loadMore();b.listenTo(e,{add:function(a,c){b.addListItem(c)},remove:function(a,c){b.removeListItem(c)},sortItem:function(a,c,d){a=b.find(function(a){return a.model&&a.model.id==c.id});a=a[0];a=a.getEl();a.parent().children("div").eq(d).before(a)},reset:function(){b.removeListItem("emptyAll")}});e=b.hasPullRefresh&&window.iScroll&&
!$H.ie();b.set("hasPullRefresh",e);e&&(b.listen({name:"afterRender",handler:function(){var a=this,b=a.getEl(),d=b.find(".hui-list-pulldown");a.scroller=new window.iScroll(b[0],{useTransition:!0,topOffset:50,onRefresh:function(){d.hasClass("hui-pd-refresh")&&(d.removeClass("hui-pd-refresh hui-pd-release"),a.set("pdTxt",a.pullTxt))},onScrollMove:function(){5<this.y&&!d.hasClass("hui-pd-release")?(d.addClass("hui-pd-release"),a.set("pdTxt",a.flipTxt),this.minScrollY=0):5>this.y&&d.hasClass("hui-pd-release")&&
(d.removeClass("hui-pd-release"),a.set("pdTxt",a.pullTxt),this.minScrollY=-50)},onScrollEnd:function(){d.hasClass("hui-pd-release")&&(d.addClass("hui-pd-refresh"),a.set("pdTxt",a.releaseTxt),a.pulldownIsRefresh?a.refresh():a.loadMore())}})}}),b.listenTo(b.model,"sync",function(){b.set("pdTime",$H.formatDate($H.now(),"HH:mm"));setTimeout(function(){b.refreshScroller()},0)}),b.listen({name:"afterShow",handler:function(){b.refreshScroller();"bottom"==b.scrollPos&&b.scrollTo("bottom")}}),b.listen({name:"click",
method:"delegate",selector:".hui-list-more",handler:function(){b.pulldownIsRefresh?b.loadMore():b.refresh()}}))},addListItem:function(b,e){this.set("isEmpty",!1);if(void 0===e){e=this.model.indexOf(b);var a=this.inited?this.children.length:this.items.length;e=e>a?a:e}this.add({model:b},e);this.refreshScroller()},removeListItem:function(b){"emptyAll"==b?this.remove(this.children):this.remove(function(e){return e.model&&e.model.id==b.id});0==this.children.length&&this.set("isEmpty",!0);this.refreshScroller()},
refreshScroller:function(){this.scroller&&this.getEl()[0].clientHeight&&this.scroller.refresh()},scrollTo:function(b,e,a){var c=this.scroller;$H.isStr(b)?"top"==b?c.scrollTo(0,-50):"bottom"==b&&(b=this.findEl(".hui-list-inner")[0].clientHeight,c.scrollTo(0,-b)):c.scrollTo(b,e,a)},loadMore:function(){var b=this,e=b.model,a=b.children.length,c=e.size();if(c>a){var d=b.maxNumFromCache,f=a,g=a+d;b.pulldownIsRefresh?e.each(function(a,c){a>=f&&a<g&&b.addListItem(c)}):(g=c-a,f=g-d,e.eachDesc(function(a,
c){a>=f&&a<g&&b.addListItem(c,0)}));b.refreshScroller()}else b.getMore()},showLoading:function(b){var e=this.scroller,a=e.minScrollY;e.minScrollY=10;b&&this.findEl(".hui-list-pulldown").addClass("hui-pd-release");e.scrollTo(0,0,200);setTimeout(function(){e.minScrollY=a},250)},destroy:function(){this.scroller&&(this.scroller.destroy(),this.scroller=null);this.callSuper()}});return g});
$Define("M.AbstractModule","CM.View",function(g){var b=$H.createClass();$H.inherit(b,g,{useCache:$H.noop,cache:$H.noop,init:$H.noop,reset:$H.noop,exit:function(){return!0},cleanCache:function(){this.clearCache=!0}});return b});$Define("M.AbstractNavigator","handy.base.Object",function(g){var b=$H.createClass();g.extend(b.prototype,{navigate:function(){}});return b});
$Define("M.History","handy.base.HashChange",function(g){var b=$H.createClass(),e=0;$H.extend(b.prototype,{initialize:function(a,b){"function"==typeof a&&(b=a,a=null);this.error=b||$H.noop;this.key=a||"handy";this.states=[];g.listen($H.Function.bind(this.stateChange,this))},stateChange:function(){var a=this.getHashParam(),b=a.hKey,d=this.currentKey,e=this.states,g=e[d];if(b==d)return!1;(e=e[b])?a=e.onStateChange(e.param,!0):($D.warn("hisory state not found"),a=this.error("stateNotFound",a));!0!=a?
(a={hKey:d,param:g.param},this.saveHash(a)):this.currentKey=b},saveState:function(a){var b=this.currentKey=this.key+ ++e;this.states.push(b);this.states[b]=a;a=a.param;this.saveHash({hKey:b,modName:a&&a.modName})},saveHash:function(a){$H.setHash("#"+$H.Json.stringify(a))},getHashParam:function(){try{var a=$H.getHash().replace("#","");return $H.parseJson(a)}catch(b){$H.Debug.warn("History.getCurrentState:parse hash error:"+b.message)}},getCurrentState:function(){try{var a=this.getHashParam();return this.states[a.hKey]}catch(b){$H.Debug.warn("History.getCurrentState:parse hash error:"+
b.message)}},getPreState:function(){try{for(var a=this.getHashParam().hKey,b=this.states,d=b.length,e=0;e++;e<d)if(b[e]==a)return 0<e?b[b[--e]]:null}catch(g){$H.Debug.error("History.getPreState error:"+g.message,g)}},back:function(){var a=this.getPreState();if(a)a.onStateChange(a.param)}});return b});
$Define("M.ModuleManager",["M.History","CM.AbstractManager"],function(g,b){var e=$H.createClass();$H.inherit(e,b,{type:"module",_createMod:function(a){var b=this,d=a.modName;b.modules[d]={waiting:!0};$Require(b.defModPackage+d,function(e){var g={renderTo:b.container,name:d,xtype:d,extCls:"js-module m-module m-"+d.replace(/\./g,"-"),hidden:!0};$H.extend(g,a);e=new e(g);b.modules[d]=e;$H.trigger("afterRender",e.getEl());b.requestMod==d&&b._showMod(e)})},_showMod:function(a){var b=this.modules[this.currentMod];
if(!this.navigator||!this.navigator.navigate(a,b,this))b&&b.hide(),a.show();b&&(b.isActive=!1);a.isActive=!0;this.currentMod=a.name},_destroy:function(a){a.destroy();delete this.modules[a.name]},initialize:function(a){var b=this;b.callSuper();a&&(b.conf=a,$H.extend(b,a),b.container=a.container?$(a.container):$(document.body));b.defModPackage+=".";b.history=new g(function(a,e){b.go(e.param)});b.modules={}},go:function(a,b){"string"==typeof a&&(a={modName:a});var d=a.modName,e=this.currentMod,g=this.modules,
j=g[e];if(e==d)j.waiting||j.reset();else{if(j&&!j.waiting)if(j._forceExit)j._forceExit=!1;else if(!1==j.exit())return!1;this.requestMod=d;(d=g[d])?!0!=d.notCache&&!0!=d.clearCache&&!1!=d.useCache(a)?(!1==d.clearCache,this._showMod(d),d.cache(a)):d.waiting||(this._destroy(d),this._createMod(a)):this._createMod(a);!0!=b&&this.history.saveState({onStateChange:$H.Function.bind(this.go,this),param:a});return!0}},update:function(a,b){var d=a.update(b);d&&(this.modules[a.name]=d,$H.trigger("afterRender",
d.getEl()));return d},clearCache:function(a){a.notCache=!0},back:function(a){a&&(this.modules[this.currentMod]._forceExit=!0);history.back()}});return e});
