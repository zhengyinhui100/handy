/* Handy v1.0.0-dev | 2014-03-21 | zhengyinhui100@gmail.com */
(function(){var e=window.handy,d=window.$,b=window.handy=window.$=function(){};b.version="1.0.0";b.expando="handy"+(b.version+Math.random()).replace(/\D/g,"");b.add=function(a,c,f){f||(f=c,c=null);if(!c||!b.Loader){b.base||(b.base={});var h=[];if(c)if("string"==typeof c)h.push(b.base.Object.namespace(c));else for(var d=0;d<c.length;d++)h.push(b.base.Object.namespace(c[d]));h.push(b);c=f.apply(window,h);b.base[a]=b[a]=c;if(0<="Browser,Class,Collection,Cookie,Events,Function,Json,Object,String,Template,Util".indexOf(a))for(var g in c)"undefined"!=
typeof b[g]&&("console"in window&&!Function[g])&&(console.log(b[g]),console.log(a+"\u547d\u540d\u51b2\u7a81:"+g)),b[g]=c[g]}else b.Loader.require(c,function(){Array.prototype.push.call(arguments,b);b.base[a]=b[a]=f.apply(window,arguments)})};b.noConflict=function(a){window.$===b&&(window.$=d);a&&window.handy===b&&(window.handy=e);return b};b.noop=function(){}})();
handy.add("Json",function(){function e(c){h.lastIndex=0;h.test(c)&&(c=c.replace(h,function(c){var a=j[c];return"string"===typeof a?a:"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)}));return'"'+c+'"'}function d(b,h){var j,g,k,l,n=c,m,r=h[b];r&&("object"===typeof r&&"function"===typeof r.toJSON)&&(r=r.toJSON(b));"function"===typeof a&&(r=a.call(h,b,r));switch(typeof r){case "string":return e(r);case "number":return isFinite(r)?String(r):"null";case "boolean":case "null":return String(r);case "object":if(!r)return"null";
c+=f;m=[];if("[object Array]"===Object.prototype.toString.apply(r)){l=r.length;for(j=0;j<l;j+=1)m[j]=d(j,r)||"null";k=0===m.length?"[]":c?"[\n"+c+m.join(",\n"+c)+"\n"+n+"]":"["+m.join(",")+"]";c=n;return k}if(a&&"object"===typeof a){l=a.length;for(j=0;j<l;j+=1)"string"===typeof a[j]&&(g=a[j],(k=d(g,r))&&m.push(e(g)+(c?": ":":")+k))}else for(g in r)Object.prototype.hasOwnProperty.call(r,g)&&(k=d(g,r))&&m.push(e(g)+(c?": ":":")+k);k=0===m.length?"{}":c?"{\n"+c+m.join(",\n"+c)+"\n"+n+"}":"{"+m.join(",")+
"}";c=n;return k}}var b="JSON"in window,a,c,f,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k=/^[\],:{}\s]*$/,l=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,n=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,m=/(?:^|:|,)(?:\s*\[)+/g;
return{stringify:function(h,j,g,e){if(b&&!e)return JSON.stringify.apply(null,arguments);var k;f=c="";if("number"===typeof g)for(k=0;k<g;k+=1)f+=" ";else"string"===typeof g&&(f=g);if((a=j)&&"function"!==typeof j&&("object"!==typeof j||"number"!==typeof j.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return d("",{"":h})},parseJson:function(c,a,f){function h(c,b){var f,d,j=c[b];if(j&&"object"===typeof j)for(f in j)Object.prototype.hasOwnProperty.call(j,
f)&&(d=h(j,f),void 0!==d?j[f]=d:delete j[f]);return a.call(c,b,j)}if(b&&!f)return JSON.parse.apply(null,arguments);var d;c=String(c);g.lastIndex=0;g.test(c)&&(c=c.replace(g,function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)}));if(k.test(c.replace(l,"@").replace(n,"]").replace(m,"")))return d=eval("("+c+")"),"function"===typeof a?h({"":d},""):d;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var e;e=(e=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(e[0])?function(b,a,c){var f=[];if(b.length){a=a||0;for(c=c||b.length;a<c;a++)f.push(b[a])}return f}:function(b,a,c){return Array.prototype.slice.call(b,a||0,c||b.length)};var d={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},namespace:function(b,a){var c=null,f,h,j,g;b=d.alias(b);h=b.split(".");c=h[0];c=(j=2==arguments.length)?eval("(function(){if (typeof "+c+' == "undefined"){'+
c+" = {};}return "+c+";})()"):eval("(function(){if (typeof "+c+' != "undefined")return '+c+";})()");f=1;for(g=h.length;f<g;++f){if(f==g-1&&j)c[h[f]]=a;else if(j||c&&c[h[f]])c[h[f]]=c[h[f]]||{};else return;c=c[h[f]]}return c},alias:function(b,a){var c=d._alias;if(a)c[b]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+b+":"+c[b]):c[b]=a;else{if(b){var f=b,h=b.length-1;do{if(c[f])return c[f]+b.substring(h);h=f.lastIndexOf(".")}while(0<h&&(f=f.substring(0,h)));return b}return c}},extend:function(b,a,
c){var f=c?c.notCover:!1,h=c?c.cover:null;c=c?c.IsClone:!1;b=b||{};var j=b.constructor,g=j.$isClass,e,l;for(l in a)if(e=a[l],(!h||d.contains(h,l))&&a.hasOwnProperty(l)){var n=b.hasOwnProperty(l),m=!0===f?n:!1;d.isArray(f)?m=d.contains(f,l)&&n:d.isFunction(f)&&(m=f(l,e));m||(e=c?d.clone(e):e,g&&d.isFunction(e)&&(e.$name=l,e.$owner=j),b[l]=e)}return b},mix:function(b,a,c){b.superProto||(b.superProto={});for(var f in a)b.superProto[f]=d.isFunction(a[f])?b.superProto[f]?function(c,b){return function(){b.apply(this,
arguments);a[c].apply(this,arguments)}}(f,b.superProto[f]):a[f]:a[f],b[f]||(b[f]=a[f]);c&&d.extend(b,c);a.toString!=a.constructor.prototype.toString&&(b.superProto.toString=function(){a.toString.apply(b,arguments)});return b},isFunction:function(b){return"[object Function]"===window.Object.prototype.toString.call(b)},isArray:function(b){return"[object Array]"===window.Object.prototype.toString.call(b)},isClass:function(b){return d.isFunction(b)&&!0===b.$isClass},equals:function(b,a){if(typeof b==
typeof a){if("object"!=typeof b)return b===a;if(b===a)return!0;if(d.isArray(b)&&d.isArray(a)){if(b.length!=a.length)return!1;for(var c=0,f=b.length;c<f;c++)if(!d.equals(b[c],a[c]))return!1;return!0}if(!d.isArray(b)&&!d.isArray(a)){if(d.count(b)!=d.count(a))return!1;for(c in b)if(void 0==a[c]||!d.equals(b[c],a[c]))return!1;return!0}}return!1},clone:function(b){if(null==b||"object"!=typeof b)return b;var a=b.constructor;if(a!=window.Object&&a!=window.Array)return b;if(a==window.Date||a==window.RegExp||
a==window.Function||a==window.String||a==window.Number||a==window.Boolean)return new a(b);try{var c=new a,f;for(f in b)c[f]=d.clone(b[f]);return c}catch(h){return b}},isEmpty:function(b){if(d.isArray(b))return 0==b.length;for(var a in b)return!1;return!0},each:function(b,a,c){var f,h=0,j=b.length,g=void 0===j||d.isFunction(b);if(c)if(g)for(f in b){if(!1===a.apply(b[f],c))break}else for(;h<j&&!1!==a.apply(b[h],c);)f=b.length,j==f?h++:j=f;else if(g)for(f in b){if(!1===a.call(b[f],f,b[f]))break}else for(;h<
j&&!1!==a.call(b[h],h,b[h]);)f=b.length,j==f?h++:j=f;return b},contains:function(b,a){var c=!1;d.each(b,function(b,h){if(d.equals(h,a))return c=!0,!1});return c},largeThan:function(b,a){if("object"==typeof b&&"object"==typeof a){var c=!0;d.each(a,function(f){if(!d.equals(a[f],b[f]))return c=!1});return c}},count:function(b){if(d.isArray(b))return b.length;var a=0,c;for(c in b)a++;return a},removeUndefined:function(b,a){var c=d.isArray(b);if(a){if(c){var f=[];d.each(b,function(c,a){void 0!==a&&f.push(a)});
return f}return d.extend({},b,{isClone:!0,notCover:function(c,a){return void 0===a}})}d.each(b,function(a,f){void 0===f&&(c?b.splice(a,1):delete b[a])});return b},toArray:e,getSingleton:function(b){b="string"==typeof b?d.namespace(b):b;return b._singleton||(b._singleton=new b)},generateMethod:function(b,a,c){a=d.isArray(a)?a:a.split(",");for(var f=0;f<a.length;f++){var h=a[f];b[h]=c(h)}}};return d});
handy.add("Browser","handy.base.Object",function(e){var d={},b={};e.generateMethod(b,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(c){return function(a){var b=d[c];return!a&&"string"===typeof b&&/^[\d\.]+$/.test(b)?parseInt(b):b}});e=window.navigator.userAgent;var a;(a=e.match(/MSIE ([\d.]+)/))?d.ie=a[1]:(a=e.match(/Firefox\/([\d.]+)/))?d.firefox=a[1]:(a=e.match(/Chrome\/([\d.]+)/))?
d.chrome=a[1]:(a=e.match(/Opera.([\d.]+)/))?d.opera=a[1]:(a=e.match(/Version\/([\d.]+).*Safari/))?d.safari=a[1]:0;/windows|win32/i.test(e)?d.windows=!0:/linux/i.test(e)?d.linux=!0:/macintosh/i.test(e)?d.mac=!0:0;/trident/i.test(e)?d.trident=!0:/webkit/i.test(e)?d.webkit=!0:/gecko/i.test(e)?d.gecko=!0:/presto/i.test(e)?d.presto=!0:0;/MetaSr/i.test(e)?d.sogou=!0:/Maxthon/i.test(e)?d.maxthon=!0:/TencentTraveler/i.test(e)?d.tt=!0:/TheWorld/i.test(e)?d.theWorld=!0:/360[S|E]E/i.test(e)?d.is360=!0:0;var c;
if((c=e.match(/AppleWebKit\/([\d.]*)/))&&c[1])if(/ Mobile\//.test(e)&&e.match(/iPad|iPod|iPhone/)){d.mobile="ios";if((c=e.match(/OS ([^\s]*)/))&&c[1])d.ios=c[1].replace("_",".");if((c=e.match(/iPad|iPod|iPhone/))&&c[0])d[c[0].toLowerCase()]=d.ios}else if(/ Android/i.test(e)){if(/Mobile/.test(e)&&(d.mobile="android"),(c=e.match(/Android ([^\s]*);/))&&c[1])d.android=c[1]}else if(c=e.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))d.mobile=c[0].toLowerCase();var f;try{if(d.ie){var h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
h&&(f=h.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(h=navigator.plugins["Shockwave Flash"])){var j=h.description.split(" ");a=0;for(var g=j.length;a<g;a++)if(0<parseInt(j[a])){f=j[a];break}}}catch(k){}d.flash=f?f:null;return b});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(e,d,b){var a={level:0,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!d.mobile(),out:function(c,f,h){h=h||"log";if(f||a.showInPage){f=b.expando+"debugDiv";var d=top.document,g=d.getElementById(f);g?g.style.display="block":(g=d.createElement("DIV"),g.id=f,g.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+d.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u5168\u5c4f</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',g.style.position="fixed",g.style.width=d.body.offsetWidth-20+"px",g.style.left=0,g.style.top=0,g.style.right=0,g.style.height="150px",g.style.backgroundColor="#aaa",g.style.fontSize="12px",g.style.padding="10px",g.style.zIndex=9999999999,g.style.opacity=0.8,g.style.filter="alpha(opacity=80)",d.body.appendChild(g));f=g.getElementsByTagName("DIV")[0];d=b.Json.stringify(c,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0).replace(/\n/g,"<br/>");f.innerHTML+=
h+" : "+d+"<br/>";f.scrollTop=f.scrollHeight}try{console[h](c)}catch(e){}},log:function(c,b){a.level>a.LOG_LEVEL||a.out(c,!!b,"log")},info:function(c,b){this.level>a.INFO_LEVEL||a.out(c,!!b,"info")},warn:function(c,b){a.level>a.WARN_LEVEL||a.out(c,!!b,"warn")},error:function(c,b){if(!(a.level>a.ERROR_LEVEL)&&(a.out(c,!!b,"error"),c instanceof Error))throw c;},time:function(c,b,h){a.level>a.INFO_LEVEL||(c?("boolean"==typeof b&&(h=b,b=""),a.out((b||"")+((new Date).getTime()-(a.lastTime||0)),!!h)):a.lastTime=
(new Date).getTime())},debug:function(c){if(!(a.level>a.DEBUG_LEVEL)&&!1!==c)debugger}};return a});handy.add("Function",function(e){return{bind:function(d,b,a){var c=Array.prototype.slice.call(arguments,2);return function(){Array.prototype.push.apply(c,arguments);return d.apply(b,c)}},intercept:function(d,b,a,c){return e.Object.isFunction(d)&&e.Object.isFunction(b)?function(){var f=a||this,h={},j=arguments;h.scope=c;h.target=f;h.method=d;return!1!=b.apply(h,j)?d.apply(f,j):!1}:d}}});
handy.add("Class",["B.Object","B.Debug"],function(e,d){var b={createClass:function(a){var c=function(){var a,b;a=this.constructor==c?this:arguments.callee;if(b=a.initialize){for(var d in a)"object"==typeof a[d]&&(a[d]=e.clone(a[d]));return b.apply(a,arguments)}};c.$isClass=!0;c.extend=function(a,h,d){var g=b.createClass();b.inherit(g,c,a,h,d);return g};c.prototype.callSuper=function(c,a){c&&(!c.$isClass&&void 0!=c.length)&&(a=c,c=null);var b=arguments.callee.caller,d=b.$owner.superProto;c=c?c.prototype:
d||this.constructor.superProto;b=b.$name;if(c&&(b=c[b],e.isFunction(b)))return a?b.apply(this,a):b.call(this)};a&&this.namespace(a,c);return c},inherit:function(a,c,b,h,j){var g=function(){};g.prototype=c.prototype;e.extend(a,c,j);a.prototype=new g;a.prototype.constructor=a;a.superClass=c;a.superProto=c.prototype;if(c._onInherit)try{c._onInherit(a)}catch(k){d.error(k)}h&&e.extend(a,h);b&&e.extend(a.prototype,b)}};return b});
handy.add("Loader",["handy.base.Debug","handy.base.Object","handy.base.Function"],function(e,d,b,a){function c(c){function a(c){return/\.(css|js)$/.test(c)?m[c]&&"loaded"==m[c].status:p.urlMap&&p.urlMap[c]?p.urlMap[c].chkExist():d.namespace(c)}if("string"==typeof c)return a(c);for(var b=[],f=0,h=c.length;f<h;f++){var j=a(c[f]);if(j)b.push(j);else return!1}return b}function f(c,a){function b(){b.isCalled||(b.isCalled=!0,clearTimeout(g),a())}if("SCRIPT"===c.nodeName){var f=c,d=b;f.onload=f.onerror=
f.onreadystatechange=function(){/loaded|complete|undefined/.test(f.readyState)&&(f.onload=f.onerror=f.onreadystatechange=null,k.removeChild(f),f=null,setTimeout(d,0))}}else{var j=b;window.hasOwnProperty("attachEvent")?c.attachEvent("onload",j):setTimeout(function(){h(c,j)},0)}var g=setTimeout(function(){e.error("Time is out:"+c.src);b()},p.timeout)}function h(c,a){if(!a.isCalled){var b;if(l)c.sheet&&(b=!0);else if(c.sheet)try{c.sheet.cssRules&&(b=!0)}catch(f){if("SecurityError"===f.name||"NS_ERROR_DOM_SECURITY_ERR"===
f.name)b=!0}setTimeout(function(){b?a():h(c,a)},1)}}function j(c){p.showLoading(!1);m[c].status="loaded";p.traceLog&&e.info("Loader Response: "+c);g()}function g(){for(var a=n.length-1;0<=a;a--){var b=n[a],f=c(b.deps);if(f){n.splice(a,1);b.callback.apply(null,f);g();break}}}var k=document.head||document.getElementsByTagName("head")[0]||document.documentElement,l=navigator.userAgent.indexOf("AppleWebKit"),n=[],m={},p={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(c,
a,b){2==arguments.length&&(b=a,a=[]);p.require(a,function(){var a;if("function"==typeof b)try{a=b.apply(null,arguments),p.traceLog&&e.info("Loader define: "+c)}catch(f){f.message="Loader "+c+":factory define error:"+f.message;e.error(f);return}else a=b;d.namespace(c,a);var h=typeof a;if("object"==h||"Function"==h)a.$ns=c})},require:function(h,d){for(var g="string"==typeof h?[h]:h,l=[],u=[],s=!0,t=0,r=g.length;t<r;t++){var q=g[t],v=c(q);v?u.push(v):(l.push(q),s&&(s=!1,n.push({deps:g,callback:d})),
p.traceLog&&e.info("Resource not found: "+q))}if(0==l.length)return d&&d.apply(null,u),0==u.length?u[0]:u;s=!1;g=0;for(u=l.length;g<u;g++)if(t=l[g],!m[t]){s=t;s=a.Object.alias(s);q=p.urlMap&&p.urlMap[s]&&p.urlMap[s].url;if(!q){r="";q=p.rootPath;if("string"==typeof q)r=q;else if("object"==typeof q)for(v in v=void 0,q)0==s.indexOf(v)&&(r=q[v],s=s.replace(v,""));else r="";q=/.css$/.test(s)?0==s.indexOf("/")?s:"/css/"+s:/.js$/.test(s)?s:s.replace(/\./g,"/")+".js";0!=q.indexOf("/")&&(q="/"+q);q=r+q}s=
!0;m[t]={id:t,status:"loading"};r=b.bind(j,null,t);if(/.css$/.test(q))a:{t=q;q=k.getElementsByTagName("link");for(v=0;v<q.length;v++){var w=q[v].href;!p.skinNode&&0<=w.indexOf(p.skinName)&&(p.skinNode=q[v]);if(0<=w.indexOf(t)||0<=t.indexOf(w))break a}q=document.createElement("link");q.rel="stylesheet";q.href=t;f(q,r);k.insertBefore(q,p.skinNode);p.traceLog&&e.info("Loader request:"+t)}else t=q,q=document.createElement("script"),q.async="async",q.src=t,q.type="text/javascript",f(q,r),k.appendChild(q),
p.traceLog&&e.info("Loader request:"+t)}s&&p.showLoading(!0)}};return p});
handy.add("Events",function(e){return{_eventCache:{},_parseEvents:function(d,b){var a=/\s+/;if("object"==typeof d){for(var c in d)b([c,d[c]]);return!0}if("string"==typeof d&&a.test(d)){a=d.split(a);c=0;for(var f=a.length;c<f;c++)b([a[c]]);return!0}return!1},_parseCustomEvents:function(d,b,a){var c=this,f=e.toArray(arguments,2);return c._parseEvents(b,function(a){c[d].apply(c,a.concat(f))})},_delegateHandler:function(d,b){var a=this;return function(){if(!0!=a.isSuspend)return d.apply(b||a,arguments)}},
on:function(d,b,a,c){if(!this._parseCustomEvents("on",d,b,a,c)){"number"==typeof a&&(c=a,a=null);var f=this._eventCache,h=f[d];h||(h=f[d]=[]);d=this._delegateHandler(b,a);h.push({times:c,handler:b,context:a,delegation:d})}},once:function(d,b,a){var c=e.toArray(arguments);this.on.apply(this,c.push(1))},off:function(d,b){if("all"==d)return this._eventCache={},!0;if(!this._parseCustomEvents("off",d,b)){var a=this._eventCache,c=d.indexOf(".");if(!b&&0>=c){for(var f in a)(f.split(".")[0]==d||0==c&&0<=
f.indexOf(d))&&delete a[f];return!0}c=a[d];if(!c)return!1;if(b){a=0;for(f=c.length;a<f;a++)if(c[a].handler==b)return c.splice(a,1),!0}else return delete a[d],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(d,b){function a(a){if(a)for(var b=0,f=a.length;b<f;b++){var d=a[b],g=d.delegation;"number"==typeof d.times&&(1<d.times?d.times--:c.off(k,d.handler));j=g.apply(null,h)}}var c=this,f=e.toArray(arguments);
f.unshift("trigger");if(!c._parseCustomEvents.apply(c,f)){var f=c._eventCache,h=e.toArray(arguments,1),j,g;if(0<d.indexOf("."))g=f[d],a(g);else for(var k in f)if(g=d.indexOf("."),k.split(".")[0]==d||0==g&&0<=k.indexOf(d))g=f[k],a(g);a(f.all);return j}}}});
handy.add("Date",function(){var e=window.Date,d={getWeek:function(b,a){var c=b.getDay();a&&(c=(c+(a%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[c]},isWeeken:function(b){return 0==b.getDay()||6==b.getDay()},getDaysInMonth:function(b){b=new e(b.getFullYear(),b.getMonth()+1,0);return b.getDate()},getDaysInYear:function(b){var a=new e(b.getFullYear(),0,0);b=new e(b.getFullYear()+1,0,0);return Math.floor((b.getTime()-a.getTime())/864E5)},getDayIndexOfYear:function(b){var a=new e("1/1/"+
b.getFullYear());return Math.ceil((b.getTime()-a.getTime())/864E5)},format:function(b,a){a=a||"yyyy-MM-dd HH:mm:ss";b=b||new e;var c=b.getHours(),f=Math.floor((b.getMonth()+3)/3),c={"y+":b.getFullYear(),"M+":b.getMonth()+1,"d+":b.getDate(),"h+":0==c%12?12:c%12,"H+":c,"m+":b.getMinutes(),"s+":b.getSeconds(),"w+":d.getWeek(b),"q+":f,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][f-1],"S+":b.getMilliseconds()},h;for(h in c)RegExp("("+h+")").test(a)&&(f=RegExp.$1.length,a=a.replace(RegExp.$1,1==f?c[h]:("00"+
c[h]).slice(-f)));return a},parse:function(b,a){for(var c=(a||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),f=b.match(/\d+/g),d=new e,j=0;j<f.length;j++){var g=c[j],k=parseInt(f[j]);switch(g){case "yyyy":d.setFullYear(k);break;case "MM":d.setMonth(k-1);break;case "dd":d.setDate(k);break;case "HH":d.setHours(k);break;case "mm":d.setMinutes(k);break;case "ss":d.setSeconds(k);break;case "SS":d.setMilliseconds(k)}}return d},parseObject:function(b){return new e(b.year+1900,b.month,b.date,b.hours,b.minutes,
b.seconds)}};return d});
handy.add("String",function(){var e={stripTags:function(d){return d.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(d){var b=document.createElement("div");d=document.createTextNode(d);b.appendChild(d);return b.innerHTML},unescapeHTML:function(d){var b=document.createElement("div");b.innerHTML=e.stripTags(d);return b.childNodes[0].nodeValue},decodeHTML:function(d){d=d.replace(/&lt;/gi,"<");d=d.replace(/&gt;/gi,">");d=d.replace(/&quot;/gi,'"');d=d.replace(/&apos;/gi,"'");d=d.replace(/<\/?br>/gi,"\n");
d=d.replace(/&amp;/gi,"&");return d=d.replace(/&nbsp;/gi," ")},encodeHTML:function(d){d=d.replace(/&/gi,"&amp;");d=d.replace(/</gi,"&lt;");d=d.replace(/>/gi,"&gt;");d=d.replace(/\"/gi,"&quot;");d=d.replace(/\'/gi,"&apos;");d=d.replace(/\n/gi,"</br>");return d=d.replace(/ /gi,"&nbsp;")},trim:function(d){return d=d.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(d,b){b||(b=/[,%\'\"\/\\;|\<\>\^]/);return-1<d.search(b)},len:function(d){return d.replace(/[^\x00-\xff]/g,"**").length},left:function(d,
b,a){if(e.len(d)>b){!0===a?a=2:0<a||(a=0);var c=0,f=0;for(b-=a;f<b;)255<d.charCodeAt(c)?f+=2:f++,c++;d=d.substring(0,c);for(c=0;c<a;c++)d+="."}return d},isNumber:function(d){return 0==d.search(/^\d+$/g)},hasChn:function(d){return/[\u4E00-\u9FA5]+/.test(d)},isChn:function(d){return/^[\u4E00-\u9FA5]+$/.test(d)},addParam:function(d,b){b&&(d+=(-1<d.indexOf("?")?"&":"?")+b);return d}};return e});
handy.add("Cookie",function(){return{getCookie:function(e,d){var b=e+"=",a="",c=document.cookie;if(0<c.length){var f=c.indexOf(b);-1!=f&&(f+=b.length,b=c.indexOf(";",f),-1==b&&(b=c.length),a=c.substring(f,b),d||(a=unescape(a)))}return a},setCookie:function(e,d,b){var a=[];void 0!=e&&void 0!=d&&a.push(e+"="+escape(d));b&&(void 0!=b.path&&a.push("path="+b.path),void 0!=b.domain&&a.push("domain="+b.domain),void 0!=b.expires&&a.push("expires="+b.expires),b.secure&&a.push("secure"));document.cookie=a.join(";")},
delCookie:function(e){var d=new Date;d.setTime(d.getTime()-1);document.cookie=e+"=;expires="+d.toGMTString()}}});handy.add("Util",function(e){var d=0;return{isWindow:function(b){return null!=b&&b==b.window},getUuid:function(){return d++},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(b){var a=top.location.hash;0<=a.indexOf("#")&&(b=a.replace(/#[^\?]*/,b));top.location.hash=b},result:function(b,a){var c=b[a];return e.Object.isFunction(c)?c():c}}});
handy.add("Collection","B.Object",function(e,d){function b(c){return c}function a(c){return function(a){return a[c]}}function c(c){return function(a){if(a===c)return!0;for(var b in c)if(c[b]!==a[b])return!1;return!0}}return{map:function(c,a,b){var d=[];if(null==c)return d;var k=Array.prototype.map;if(k&&c.map===k)return c.map(a,b);e.each(c,function(c,f){d.push(a.call(b,f,c))});return d},pluck:function(c,b){return this.map(c,a(b))},some:function(c,a,b){var g=!1;if(null==c||!a)return g;var e=Array.prototype.some;
if(e&&c.some===e)return c.some(a,b);d.each(c,function(c,f,d){if(g||(g=a.call(b,f,c,d)))return!1});return!!g},every:function(c,a,b){var g=!0;if(null==c||!a)return g;var e=Array.prototype.every;if(e&&c.every===e)return c.every(a,b);d.each(c,function(c,f,d){if(!(g=a.call(b,f,c,d)))return!1});return!!g},find:function(c,a,b){var d;this.some(c,function(c,f,e){if(a.call(b,c,f,e))return d=c,!0});return d},filter:function(c,a,b){var g=[];if(null==c)return g;var e=Array.prototype.filter;if(e&&c.filter===e)return c.filter(a,
b);d.each(c,function(c,f,d){a.call(b,f,c,d)&&g.push(f)});return g},where:function(a,b){return this.filter(a,c(b))},findWhere:function(a,b){return this.find(a,c(b))},invoke:function(c,a){var b=Array.prototype.slice.call(arguments,2),d=e.isFunction(a);return this.map(c,function(c){return(d?a:c[a]).apply(c,b)})},sortBy:function(c,h,j){var g=h;h=null==g?b:d.isFunction(g)?g:a(g);return this.pluck(this.map(c,function(c,a,b){return{value:c,index:a,criteria:h.call(j,c,a,b)}}).sort(function(c,a){var b=c.criteria,
f=a.criteria;if(b!==f){if(b>f||void 0===b)return 1;if(b<f||void 0===f)return-1}return c.index-a.index}),"value")}}});
handy.add("Template",function(e){var d={},b=/^=/,a="".trim,c={openTag:"<%",closeTag:"%>",_add:function(c){return a?"$r+="+c+";\n":"$r.push("+c+");\n"},_parseHtml:function(a){a=a.replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n");return c._add('"'+a+'"')},_parseScript:function(a){a=a.replace(/this/g,"$data");0==a.indexOf("=")&&(a=c._add(a.replace(b,"")+'||""'));return a+"\n"},_compile:function(b){var d="var $r="+(a?'""':"[]")+";\n";e.Object.each(b.split(c.openTag),function(a,b){var f=
b.split(c.closeTag);1==f.length?d+=c._parseHtml(f[0]):(d+=c._parseScript(f[0]),f[1]&&(d+=c._parseHtml(f[1])))});d+="return "+(a?"$r;":'$r.join("");');return new Function("$data",d)},tmpl:function(a,b){var j,g,k;if("string"==typeof a)j=a;else if(j=a.tmpl,k=a.id)if(d[k])g=d[k];else{var l=document.getElementById(k);l&&(j=(l.value||l.innerHTML).replace(/\s/g,""))}if(!g){if(!j){e.Debug.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}g=c._compile(j);k&&(d[k]=g)}return b?g(b):g}};return c});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(e,d,b){function a(c){if(c==l)return!1;var a=k.contentWindow.document;a.open();a.write("<!doctype html><html><body>"+c+"</body></html>");a.close();l=c;e.log("set:"+k.contentWindow.document.body.innerText)}function c(){var c=d.getHash(),b=k.contentWindow.document.body.innerText;c!=l?(a(c),f(c)):b!=l&&(e.log("update:"+k.contentWindow.document.body.innerText),d.setHash(b))}function f(c){var a=p.listeners,b;for(b in a)a[b](c)}var h,
j=0,g=document,k,l,n=g.documentMode,m="onhashchange"in window&&(void 0===n||7<n),p={delay:50,listen:function(e,l){if(!h&&!h)if(h=!0,p.listeners={},m)$(window).on("hashchange",function(){f(d.getHash())});else k=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(g.body)[0],$(k).one("load",function(){a(d.getHash());setInterval(c,p.delay)});if(l in p.listeners)$D.error(Error("Duplicate name"));else return l=l||b.expando+ ++j,p.listeners[l]=e,l},unListen:function(c){for(var a in p.listeners)(!c||
c==a)&&delete p.listeners[a]}};return p});handy.add("Support","B.Browser",function(e){var d={mediaQuery:function(){var a;if(e.mobile())a="hui-mobile";else{a="hui-pc";var c=e.ie();c&&(a+=" ie"+c)}document.documentElement.className+=" "+a}};d.mediaQuery();if(6==e.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(b){}return d});
handy.add("Validator",["B.String","B.Object"],function(e,d){var b={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(a,c){var d=c.rules,h;for(h in d){var j=d[h],g=("function"==typeof j?j:b[h])(a,j);if(!g)return d=c.error||b.error,h=c.messages&&
c.messages[h]||b.messages[h],h=h.replace(/\{([^\}]+)\}/g,function(a,b){return j[b]||0==b&&j||c[b]||j||""}),d&&d(h),g}return!0},required:function(a){return 0<e.trim(""+a).length},email:function(a){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a){return!/Invalid|NaN/.test((new Date(a)).toString())},dateISO:function(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a){return/^\d+$/.test(a)},creditcard:function(a){if(/[^0-9 \-]+/.test(a))return!1;var c=0,b=0,d=!1;a=a.replace(/\D/g,"");for(var j=a.length-1;0<=j;j--){b=a.charAt(j);b=parseInt(b,10);if(d&&9<(b*=2))b-=9;c+=b;d=!d}return 0===c%10},min:function(a,c){return a>=c},max:function(a,
c){return a<=c},range:function(a,c){return a>=c[0]&&a<=c[1]},minlength:function(a,c){return(d.isArray(a)?a.length:e.trim(""+a).length)>=c},maxlength:function(a,c){return(d.isArray(a)?a.length:e.trim(""+a).length)<=c},rangelength:function(a,c){var b=d.isArray(a)?a.length:e.trim(""+a).length;return b>=c[0]&&b<=c[1]},equalTo:function(a,c){return a===c}};return b});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(e,d,b){d={_init:function(){!a&&e.ie()&&(f=document.getElementById("LocalStorageUserDataDiv"),f||(f=document.createElement("DIV"),f.style.display="none",f.id="LocalStorageUserDataDiv",f.addBehavior("#default#userData"),document.body.appendChild(f),f.load(h)))},getItem:function(d){d=a?c.getItem(d):f.getAttribute(d);return d=b.parseJson(d)},setItem:function(d,g){g=b.stringify(g);try{a?c.setItem(d,g):(f.setAttribute(d,g),f.save(h))}catch(e){return $D.error(e),
!1}return!0},removeItem:function(b){a?c.removeItem(b):(f.removeAttribute(b),f.save(h))},clear:function(){a?c.clear():f.unload()}};var a=window.localStorage&&window.localStorage.getItem,c=window.localStorage,f,h=document.domain;d._init();return d})(function(e){Hui=H=$H=e.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};e=window.$;e.fn.remove=$H.intercept(e.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
$Define("CM.AbstractEvents",function(){var e=$H.createClass();$H.extend(e.prototype,$H.Events);$H.extend(e.prototype,{_eventCache:{},_listenTo:[],_parseListenToEvents:function(d,b,a,c){var f=this,h=$H.toArray(arguments,3);return f._parseEvents(a,function(c){c.unshilft(b);f[d].apply(f,c.concat(h))})},listenTo:function(d,b,a,c,f){if(!this._parseListenToEvents("listenTo",d,b,a,c,f)){"number"==typeof c&&(f=c,c=null);var h=this._delegateHandler(a,c);this._listenTo.push({target:d,name:b,delegation:h,handler:a});
d.on(b,h,c||this,f)}},unlistenTo:function(d,b,a){if(!this._parseListenToEvents("unlistenTo",d,b,a))for(var c=this._listenTo,f="all"==d,h,j=0,g=c.length;j<g;j++)if(h=c[j],f||h.name==b&&h.handler==a&&h.target==d)d.off(b,h.delegation),c.splice(j,1)}});return e});
$Define("CM.AbstractDao","B.LocalStorage",function(e){var d=$H.createClass();$H.extend(d.prototype,{ajax:function(b){this.beforeSend(b);b.error=$H.intercept(this.error,b.error);b.success=$H.intercept(this.success,b.success);return $.ajax(b)},beforeSend:$H.noop,error:$H.noop,success:$H.noop,get:function(){},set:function(){},remove:function(){},sync:function(b){b=b||{};var a=b.type||"remote";b=b.param;if("remote"==a)this.ajax(b);else e[a+"Item"](b)}});return d});
$Define("CM.AbstractManager",function(){var e=$H.createClass();$H.extend(e.prototype,{_types:{},_all:{},type:"manager",registerType:function(d,b){this._types[d]=b;b.prototype.xtype=d},getClass:function(d){return this._types[d]},register:function(d){this._all[d.getId()]=d},unregister:function(d){var b=this._all,a=d.getId();b[a]==d&&delete b[a]},eachInEl:function(d,b){var a=this;d.find(".js-"+a.type).each(function(c,d){d=$(d);var h=d.attr("id");(h=a.get(h))&&b(h)})},generateId:function(d,b){var a=$H.expando+
"_"+this.type+"_"+(d||$H.Util.getUuid());if(!0!=b&&this._all[a])$D.error("id\u91cd\u590d:"+a);else return a},get:function(d){var b=this._all;return b[d]||b[this.generateId(d,!0)]}});return e});
$Define("CM.ViewManager","CM.AbstractManager",function(e){var d=$H.createClass();$H.inherit(d,e,{type:"view",initialize:function(){var b=this;$H.on("afterRender",function(a){b.afterRender(a)});$H.on("removeEl",function(a){b.destroy(a)})},afterRender:function(b){this.eachInEl(b,function(a){a.afterRender()})},destroy:function(b){this.eachInEl(b,function(a){a.destroy(!0)})}});$V=$H.getSingleton(d);return d});
$Define("CM.View",["CM.ViewManager","CM.AbstractEvents"],function(e,d){var b=/^(<[a-zA-Z]+)/,a=/^[^>]+class=/,c=/(class=")/,f=d.extend({xtype:"View",autoRender:!0,renderBy:"append",children:[],_customEvents:"beforeRender render afterRender beforeShow show afterShow beforeHide hide afterHide beforeUpdate update afterUpdate beforeDestroy destroy afterDestroy".split(" "),_defaultEvents:"mousedown mouseup mouseover mousemove mouseenter mouseleave dragstart drag dragenter dragleave dragover drop dragend touchstart touchmove touchend touchcancel keydown keyup keypress click dblclick focus focusin focusout contextmenu change submit".split(" "),
_parseListenEvents:function(c,a){var b=this;return b._parseEvents(a.name,function(d){a.name=d[0];2==d.length&&(a.handler=d[0]);b[c].call(b,a)})},initialize:function(c){this.manager=this.constructor.manager||$H.getSingleton(e);this.doConfig(c);this.parseItems();!1!=this.autoRender&&this.render();this.manager.register(this)},doConfig:function(c){var a=this;a.params=c;a.settings=$H.clone(c);a.renderTo=c.renderTo?$(c.renderTo):$(document.body);var b=a.listeners||[];c.listeners&&(b=b.concat(c.listeners));
a._listeners=b;$H.extend(a,c,{notCover:function(b){var d=a[b],f=$H.contains(a._customEvents,b);if($H.contains(a._defaultEvents,b))a._listeners.push({name:b,handler:c[b]});else if(f)a.on(b,c[b]);if(null!=d&&"object"==typeof d||$H.isFunction(d))return!0}});c.defItem&&$H.extend(a.defItem,c.defItem)},getEl:function(){return this._container},getId:function(){return this._id||(this._id=this.manager.generateId(this.cid))},initHtml:function(){"string"!=typeof this.tmpl&&(this.tmpl=this.constructor.prototype.tmpl=
this.tmpl.join(""));return $H.Template.tmpl({id:this.xtype,tmpl:this.tmpl},this)},getHtml:function(){var d=this.getId(),f;f="visibility"==this.displayMode?"visibility:hidden;":"display:none;";var g=this.initHtml(),e=a.test(g),l="js-"+this.manager.type+" "+this.extCls+" ";e&&(g=g.replace(c,"$1"+l));return g=g.replace(b,'$1 id="'+d+'" style="'+f+'"'+(e?"":' class="'+l+'"'))},findHtml:function(c){c=">*"==c?this.children:this.find(c);for(var a=[],b=0;b<c.length;b++)a.push(c[b].getHtml());return a.join("")},
initStyle:function(){var c=this.getEl(),a=this.style||{};void 0!=this.width&&(a.width=this.width);void 0!=this.height&&(a.height=this.height);c.css(a)},beforeRender:function(){return this.trigger("beforeRender")},render:function(){if(!1==this.beforeRender())return!1;this.trigger("render");var c=this.getHtml();this.renderTo[this.renderBy](c);this.afterRender()},afterRender:function(){if(this.rendered)return!1;this.callChild();this._container=$("#"+this.getId());this.rendered=!0;this.initStyle();!0!=
this.notListen&&this.initListeners();this.disabled&&this.disable();this.trigger("afterRender");this.hidden||this.show()},beforeShow:function(){return this.trigger("beforeShow")},show:function(c,a){var b=this;if(!1==b.beforeShow()||b.showed||a&&b.hidden)return!1;if(!c&&b.delayShow)setTimeout(function(){f.prototype.show.call(b,!0)},0);else{b.trigger("show");b.showed=!0;var d=b.getEl();"visibility"==b.displayMode?d.css({visibility:"visible"}):d.show();b.callChild([null,!0]);b.afterShow()}},afterShow:function(){this.trigger("afterShow")},
beforeHide:function(){return this.trigger("beforeHide")},hide:function(){if(!1==this.beforeHide()||!this.showed)return!1;this.showed=!1;var c=this.getEl();"visibility"==this.displayMode?c.css({visibility:"hidden"}):c.hide();this.trigger("hide");this.afterHide()},afterHide:function(){this.trigger("afterHide")},enable:function(){this.resume();this.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")},disable:function(){this.suspend();this.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled",
"disabled")},listen:function(c){if(!this._parseListenEvents("listen",c)){var a=c.name,b=c.context,d=c.times,f=c.target,e=c.custom,m=c.handler;if(f||e)c=$H.removeUndefined([f,a,m,b,d]),this[e?"on":"listenTo"].apply(this,c);else if(c.custom)this.on.apply(this,a,m,b,d);else{var e=this._listeners,d=c.el,f=c.method||"bind",p=c.selector,x=c.data,b=c.delegation=this._delegateHandler(m,b);$H.mobile()&&"click"==a&&(a="touchend");d=d?"string"==typeof d?this.find(d):d:this.getEl();if(p)if(x)d[f](p,a,x,b);else d[f](p,
a,b);else if(x)d[f](a,x,b);else d[f](a,b);e.push(c)}}},unlisten:function(c){if(!this._parseListenEvents("unlisten",c)){var a=c.name,b=c.handler;if(c.custom)this.off(a,b);else{var d=c.el,f="delegate"==c.method?"undelegate":"unbind";c=c.selector;var e;$H.mobile()&&"click"==a&&(a="touchend");for(var d=d?"string"==typeof d?this.find(d):d:this.getEl(),m=this._listeners.length-1;0<=m;m--){var p=this._listeners[m];if(p.handler==b){e=p.delegation;this._listeners.splice(m,1);break}}if(c)d[f](c,a,e);else d[f](a,
e)}}},initListeners:function(){if(this.listened)return!1;this.listened=!0;var c=this._listeners;this._listeners=[];for(var a=c.length-1;0<=a;a--)this.listen(c[a]);this.callChild()},clearListeners:function(){for(var c=this._listeners,a=c.length-1;0<=a;a--)this.unlisten(c[a]);this.off("all");this.callChild()},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0;this.callChild()},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1;this.callChild()},each:function(c,a){for(var b=
this.children,d=b.length,f,e=0;e<d;){f=b[e];f=a?c.apply(f,a):c(e,f);if(!1===f)break;d==b.length?e++:d=b.length}},match:function(c,a){if("*"==c)return!0;var b=a||this,d,f,e;c=c.replace(/^([^\[]+)/,'[xtype="$1"]');for(var m=/\[([^=|\!]+)(=|\!=)([^=]+)\]/g;d=m.exec(c);)if(f=d[1],e=d[2],d=eval(d[3]),"="===e?b[f]!=d:b[f]==d)return!1;return!0},find:function(c,a){var b=this;if(0!=c.indexOf("$"))return b.getEl().find(c);a=a||[];if(0<c.indexOf(","))return $H.each(c.split(","),function(c,d){a=a.concat(b.find(d))}),
a;var d=1==c.indexOf(">"),f=c.replace(/^\$>?\s?/,""),e=f.search(/\s|>/),m;0<e&&(m=f.substring(e),f=f.substring(0,e));b.each(function(b,e){e.match(f)&&(m?e.find("$"+m,a):a.push(e));d||e.find(c,a)});return a},parents:function(c){if(c&&0!=c.indexOf("$"))return this.getEl().parents(c);for(var a=this;a.parent;)if(a=a.parent,c&&this.match(c,a))return a;return c||a===this?null:a},index:function(){var c=this,a=c.parent;if(a){var b;a.each(function(a,d){if(d==c)return b=a,!1});return b}return null},callChild:function(c,
a){0!=this.children.length&&(c&&"string"!=typeof c&&(a=c,c=null),c=c||arguments.callee.caller.$name,this.each(function(b,d){a?d[c].apply(d,a):d[c].call(d)}))},add:function(c){this.children.push(c);c.parent=this},remove:function(c){for(var a=this.children,b=!1,d=0,f=a.length;d<f;d++)a[d]==c&&(a.splice(d,1),c.destroy(),b=!0);return b},addItem:function(c){var a=this.settings,b=a.items;b?$H.isArray(b)||(a.items=[b]):a.items=[];a.items.push(c)},parseItem:function(){},parseItems:function(){var c=this.settings.items;
if(c)for(var c=c.length?c:[c],a=0,b=c.length;a<b;a++){var d=c[a];this.defItem&&$H.extend(d,this.defItem,{notCover:!0});this.parseItem(d);var f=this.manager.getClass(d.xtype);f?(d.renderTo||(d.autoRender=!1),d=new f(d),this.add(d)):$D.error("xtype:"+d.xtype+"\u672a\u627e\u5230")}},beforeUpdate:function(){return this.trigger("beforeUpdate")},update:function(c){var a=this;if(!1==a.beforeUpdate())return!1;var b=a.parent;c=$H.extend({renderBy:"before",renderTo:a.getEl()},c);b&&(c=$H.extend(b.defItem,c),
b.parseItem(c));if(!c.cid||c.cid==a.cid)c._id=a._id;var d=new a.constructor(c);b&&(d.parent=b,b.each(function(c,f){if(f==a)return b.children.splice(c,1,d),!1}));a.destroy();a.trigger("update");a.afterUpdate(d);return d},afterUpdate:function(c){this.trigger("afterUpdate",c)},beforeDestroy:function(){return this.trigger("beforeDestroy")},destroy:function(){if(!1==this.beforeDestroy()||this.destroyed)return!1;this.callChild();this.trigger("destroy");this.clearListeners();this.getEl().remove();this.destroyed=
!0;this.parent&&this.parent.remove(this);this.manager.unregister(this);delete this.params;delete this.settings;delete this._container;delete this.renderTo;delete this._listeners;delete this.children;this.afterDestroy()},afterDestroy:function(){this.trigger("afterDestroy")}},{extend:function(c){var a=this.prototype;$H.extend(a,c,{notCover:function(b){if($H.contains(["_customEvents","listeners"],b))return a[b]=(c[b]||[]).concat(a[b]||[]),!0;if("xtype"==b||"constructor"==b)return!0}})},html:function(c){return(new this($H.extend({autoRender:!1},
c))).getHtml()}});return f});
$Define("CM.Model",["CM.AbstractDao","CM.AbstractEvents"],function(e,d){return d.extend({_pending:!1,idAttribute:"id",_validate:function(b,a){if(!a.validate||!this.validate)return!0;b=$H.extend({},this.attributes,b);var c=this.validationError=this.validate(b,a)||null;if(!c)return!0;this.trigger("invalid",this,c,$H.extend(a,{validationError:c}));return!1},initialize:function(b,a){this.dao=this.dao||$H.getSingleton(e);var c=b||{};a||(a={});this.cid=$H.Util.getUuid();this.attributes={};a.collection&&
(this.collection=a.collection);a.parse&&(c=this.parse(c,a)||{});c=$H.extend(c,$H.Util.result(this,"defaults"),{notCover:!0});this.set(c,a);this.changed={}},toJson:function(){return $H.clone(this.attributes)},sync:function(b,a,c){return this.dao.sync.apply(this,arguments)},get:function(b){return this.attributes[b]},escape:function(b){return $H.String.escapeHTML(this.get(b))},has:function(b){b=this.get(b);return null!=b&&void 0!=b},set:function(b,a,c){var d;"object"===typeof b?(d=b,c=a):(d={})[b]=a;
c||(c={});if(!this._validate(d,c))return!1;var e=c.unset;b=c.silent;var j=[],g=this._changing;this._changing=!0;g||(this._previousAttributes=$H.Object.clone(this.attributes),this.changed={});var k=this.attributes,l=this._previousAttributes;this.idAttribute in d&&(this.id=d[this.idAttribute]);for(var n in d)a=d[n],$H.equals(k[n],a)||j.push(n),$H.equals(l[n],a)?delete this.changed[n]:this.changed[n]=a,e?delete k[n]:k[n]=a;if(!b){j.length&&(this._pending=c);a=0;for(d=j.length;a<d;a++)this.trigger("change:"+
j[a],this,k[j[a]],c)}if(g)return this;if(!b)for(;this._pending;)c=this._pending,this._pending=!1,this.trigger("change",this,c);this._changing=this._pending=!1;return this},unset:function(b,a){a=a||{};a.unset=!0;return this.set(b,void 0,a)},clear:function(b){var a={},c;for(c in this.attributes)a[c]=void 0;b=b||{};b.unset=!0;return this.set(a,b)},hasChanged:function(b){var a=this.changed;return null==b?!$H.isEmpty(a):$H.contains(a,b)},changedAttrbutes:function(b){if(!b)return this.hasChanged()?$H.clone(this.changed):
!1;var a,c=!1,d=this._changing?this._previousAttributes:this.attributes,e;for(e in b)if(!$H.equals(d[e],a=b[e]))(c||(c={}))[e]=a;return c},previous:function(b){return null==b||!this._previousAttributes?null:this._previousAttributes[b]},fetch:function(b){var a=this;b=b?$H.clone(b):{};void 0===b.parse&&(b.parse=!0);var c=b.success;b.success=function(d){if(!a.set(a.parse(d,b),b))return!1;c&&c(a,d,b);a.trigger("sync",a,d,b)};(void 0)(a,b);return a.sync("read",a,b)},save:function(b,a,c){var d,e=this.attributes;
null==b||"object"===typeof b?(d=b,c=a):(d={})[b]=a;c=$H.extend({validate:!0},c);if(d&&!c.wait){if(!this.set(d,c))return!1}else if(!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=$H.extend({},e,d));void 0===c.parse&&(c.parse=!0);var j=this,g=c.success;c.success=function(a){j.attributes=e;var b=j.parse(a,c);c.wait&&(b=$H.extend(d||{},b));if($H.isObject(b)&&!j.set(b,c))return!1;g&&g(j,a,c);j.trigger("sync",j,a,c)};(void 0)(this,c);b=this.isNew()?"create":c.patch?"patch":"update";"patch"===
b&&(c.oAttrs=d);b=this.sync(b,this,c);d&&c.wait&&(this.attributes=e);return b},destroy:function(b){b=b?$H.clone(b):{};var a=this,c=b.success,d=function(){a.trigger("destroy",a,a.collection,b)};b.success=function(e){(b.wait||a.isNew())&&d();c&&c(a,e,b);a.isNew()||a.trigger("sync",a,e,b)};if(this.isNew())return b.success(),!1;(void 0)(this,b);var e=this.sync("delete",this,b);b.wait||d();return e},url:function(){var b=$H.Util.result(this,"urlRoot")||$H.Util.result(this.collection,"url");b||$D.error(Error("\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2aurl\u5c5e\u6027\u6216\u8005\u51fd\u6570"));
return this.isNew()?b:b.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(b){return b},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(b){return this._validate({},$H.extend(b||{},{validate:!0}))}})});
$Define("CM.Collection",["CM.AbstractDao","CM.AbstractEvents","CM.Model"],function(e,d,b){var a=d.extend({_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(c,a){if(c instanceof b)return c;a=a?$H.clone(a):{};a.collection=this;var d=new this.model(c,a);if(!d.validationError)return d;this.trigger("invalid",this,d.validationError,a);return!1},_addReference:function(c){this._byId[c.cid]=c;null!=c.id&&(this._byId[c.id]=c);c.collection||(c.collection=this);c.on("all",this._onModelEvent,
this)},_removeReference:function(c){this===c.collection&&delete c.collection;c.off("all",this._onModelEvent,this)},_onModelEvent:function(c,a,b,d){("add"===c||"remove"===c)&&b!==this||("destroy"===c&&this.remove(a,d),a&&c==="change:"+a.idAttribute&&(delete this._byId[a.previous(a.idAttribute)],null!=a.id&&(this._byId[a.id]=a)),this.trigger.apply(this,arguments))},initialize:function(c,a){this.dao=this.dao||$H.getSingleton(e);a||(a={});a.model&&(this.model=a.model);void 0!==a.comparator&&(this.comparator=
a.comparator);this._reset();c&&this.reset(c,$H.extend({silent:!0},a))},toJSON:function(c){return $H.Collection.map(this,function(a){return a.toJSON(c)})},sync:function(c,a,b){return this.dao.sync({method:c,param:b})},add:function(c,a){$H.extend(a,{add:!0,remove:!1,merge:!1});return this.set(c,a)},remove:function(c,a){var b=!$H.isArray(c);c=b?[c]:$H.clone(c);a||(a={});var d,e,k,l;d=0;for(e=c.length;d<e;d++)if(l=c[d]=this.get(c[d]))delete this._byId[l.id],delete this._byId[l.cid],k=this.indexOf(l),
this.models.splice(k,1),this.length--,a.silent||(a.index=k,l.trigger("remove",l,this,a)),this._removeReference(l,a);return b?c[0]:c},set:function(c,a){a=$H.Util.extend(a,{add:!0,remove:!0,merge:!0});a.parse&&(c=this.parse(c,a));var d=!$H.isArray(c),e=d?c?[c]:[]:$H.clone(c),g,k,l,n,m,p,x=a.at,z=this.model,y=this.comparator&&null==x&&!1!==a.sort,A="string"==typeof this.comparator?this.comparator:null,u=[],s=[],t={},r=a.add,q=a.merge,v=a.remove,w=!y&&r&&v?[]:!1;g=0;for(k=e.length;g<k;g++){m=e[g]||{};
l=m instanceof b?n=m:m[z.prototype.idAttribute||"id"];if(l=this.get(l))v&&(t[l.cid]=!0),q&&(m=m===n?n.attributes:m,a.parse&&(m=l.parse(m,a)),l.set(m,a),y&&(!p&&l.hasChanged(A))&&(p=!0)),e[g]=l;else if(r){n=e[g]=this._prepareModel(m,a);if(!n)continue;u.push(n);this._addReference(n,a)}n=l||n;w&&(n.isNew()||!t[n.id])&&w.push(n);t[n.id]=!0}if(v){g=0;for(k=this.length;g<k;++g)t[(n=this.models[g]).cid]||s.push(n);s.length&&this.remove(s,a)}if(u.length||w&&w.length)if(y&&(p=!0),this.length+=u.length,null!=
x){g=0;for(k=u.length;g<k;g++)this.models.splice(x+g,0,u[g])}else{w&&(this.models.length=0);m=w||u;g=0;for(k=m.length;g<k;g++)this.models.push(m[g])}p&&this.sort({silent:!0});if(!a.silent){g=0;for(k=u.length;g<k;g++)(n=u[g]).trigger("add",n,this,a);(p||w&&w.length)&&this.trigger("sort",this,a)}return d?e[0]:e},reset:function(c,a){a||(a={});for(var b=0,d=this.models.length;b<d;b++)this._removeReference(this.models[b],a);a.previousModels=this.models;this._reset();c=this.add(c,$H.extend({silent:!0},
a));a.silent||this.trigger("reset",this,a);return c},push:function(a,b){return this.add(a,$H.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){return this.add(a,$H.extend({at:0},b))},shift:function(a){var b=this.at(0);this.remove(b,a);return b},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a]||this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},
where:function(a,b){return $H.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var d in a)if(a[d]!==b.get(d))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){this.comparator||$D.error(Error("\u6ca1\u6709\u6bd4\u8f83\u5668"));a||(a={});"string"==typeof this.comparator||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort($H.Function.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return $H.Collection.invoke(this.models,
"get",a)},fetch:function(a){var b=this;a=a?$H.clone(a):{};a.url||(a.url=b.url);void 0===a.parse&&(a.parse=!0);var d=a.success;a.success=function(e){b[a.reset?"reset":"set"](e,a);d&&d(b,e,a);b.trigger("sync",b,e,a)};return b.sync("get",b,a)},create:function(a,b){var d=this;b=b?$H.clone(b):{};if(!(a=d._prepareModel(a,b)))return!1;b.wait||d.add(a,b);var e=b.success;b.success=function(a,c){b.wait&&d.add(a,b);e&&e(a,c,b)};a.save(null,b);return a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)}});
$H.each(["some","every","find","filter","invoke"],function(c){a.prototype[c]=function(){var a=Array.prototype.slice.call(arguments),b=$H.Collection;a.unshift(this.models);return b[c].apply(b,a)}});return a});$Define("C.ComponentManager",["CM.AbstractManager","CM.ViewManager"],function(e,d){var b=e.extend({type:"component",initialize:function(){var a=$H.getSingleton(d);this._types=a._types;this._all=a._all}});$CM=new b;return b});
$Define("C.AbstractComponent",["CM.ViewManager","CM.View"],function(e,d){$C=$H.namespace("C",{});var b=$H.createClass();$H.inherit(b,d,{xtype:"AbstractComponent",activeCls:"hui-active",hasConfig:function(a,c){if(!c)return!1;if($H.isArray(c))for(var b=0,d=c.length;b<d;b++){if(this.match(a,c[b]))return!0}else if(this.match(a,c))return!0;return!1},doConfig:function(a){this.callSuper([a]);this.cls||(this.cls=this.xtype.toLowerCase());this.extCls=this.getExtCls();this.icon&&this.addItem({xtype:"Icon",
name:this.icon});this.isMini&&(this.defItem=$H.extend({isMini:!0},this.defItem))},getExtCls:function(){var a=["js-component"];this.extCls&&a.push(this.extCls);this.theme&&a.push("hui-"+this.cls+"-"+this.theme);this.radius&&a.push("hui-radius-"+this.radius);this.isMini&&a.push("hui-mini");this.shadow&&a.push("hui-shadow");this.shadowSurround&&a.push("hui-shadow-surround");this.shadowOverlay&&a.push("hui-shadow-overlay");this.shadowInset&&a.push("hui-shadow-inset");this.isActive&&a.push(this.activeCls);
this.isFocus&&a.push("hui-focus");this.isInline&&a.push("hui-inline");return 0<a.length?a.join(" "):""},active:function(){this.getEl().addClass(this.activeCls)},unactive:function(){this.getEl().removeClass(this.activeCls)},txt:function(a){var c=this.find(".js-"+this.cls+"-txt");0==c.length&&(c=this.find(".hui-"+this.cls+"-txt"));if(void 0!=a)c.text(a);else return c.text()},valid:function(){var a=this.settings.validator;if(a){var c=this.val();a.error||(a.error=function(a){new $C.Tips({text:a,theme:"error"})});
return a=$H.Validator.valid(c,a)}for(var c=this.children,b=0,d=c.length;b<d;b++)if(a=c[b].valid(),!a)return a;return!0}},{define:function(a,c){var d=$H.createClass();$H.inherit(d,c||b,null,null,{notCover:function(a){return"define"==a}});$H.getSingleton(e).registerType(a,d);return $C[a]=d}});return b});
$Define("C.Popup","C.AbstractComponent",function(e){e=e.define("Popup");var d=0,b;e.extend({delayShow:!0,clickHide:!0,showPos:"center",shadowOverlay:!0,tmpl:['<div class="hui-popup"><%=this.findHtml("$>*")%></div>'],doConfig:function(a){this.callSuper([a]);this.clickHide&&this._listeners.push({name:"click",el:$(document),handler:function(){this.hide()}});$H.android()&&(this._listeners.push({name:"show",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.show")&&$("input,textarea,select").attr("disabled",
"disabled")}}),this._listeners.push({name:"hide",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.hide")&&setTimeout(function(){$("input,textarea,select").removeAttr("disabled")},500)}}))},afterShow:function(){var a=this,c=a.getEl();c.css("z-index",1E3*d+1E3);if(!a.width&&a.parent){var b=a.width=a.parent.getEl().outerWidth();c.css("width",b)}c=a.showPos;if("string"==typeof c)a[c]();else"function"==typeof c&&c.call(a);a.noMask||a.mask();a.timeout&&setTimeout(function(){a.destroyed||
a.hide()},a.timeout)},hide:function(){!1!=this.callSuper()&&(this.noMask||this.unmask(),this.notDestroy||this.destroy())},center:function(){var a=this.getEl(),c=this.width||a.width(),b=this.height||a.height(),d=document,c=((d.documentElement.offsetWidth||d.body.offsetWidth)-c)/2,b=((d.documentElement.clientHeight||d.body.clientHeight)-b)/2+(d.documentElement.scrollTop||d.body.scrollTop),b=10>b?window.screen.height/2-200:b;a.css({left:c+"px",top:b-(this.offsetTop||0)+"px"})},followEl:function(a){a=
(a||this.parent.getEl()).position();this.getEl().css(a)},mask:function(){b||(b=$('<div class="hui-mask" style="display:none;"></div>').appendTo(document.body));b.css("z-index",1E3*d+998);0==d&&b.show();d++},unmask:function(){d--;0==d?b.hide():b.css("z-index",1E3*(d-1)+998)}});return e});
$Define("C.ControlGroup","C.AbstractComponent",function(e){e=e.define("ControlGroup");e.extend({multi:!1,defItem:{xtype:"Button",extCls:"js-item",radius:null,shadow:!1,isInline:!1},tmpl:['<div class="hui-ctrlgp<%if(this.direction=="h"){%> hui-ctrlgp-h<%}else{%> hui-ctrlgp-v<%}%>">','<%=this.findHtml("$>*")%>',"</div>"],listeners:[{name:"click",selector:".js-item",method:"delegate",handler:function(d){var b=$(d.currentTarget),b=$V.get(b.attr("id")).index();this.onItemClick(d,b)}}],select:function(d){if(!this.notSelect&&
(d="number"==typeof d?this.children[d]:"string"==typeof d?this.find(d)[0]:d))if(!this.multi&&!d.multi){var b=this.getSelected();b&&this.selectItem(b,!1);this.selectItem(d)}else this.selectItem(d,!d.selected)},getSelected:function(d){var b=[];this.each(function(a,c){c.selected&&b.push(d?a:c)});return 0<b.length?this.multi?b:b[0]:null},selectItem:function(d,b){(b=!1!=b)?(d.selected=b,d.select?d.select():d.active()):(d.selected=b,d.select?d.select(b):d.unactive())},val:function(d){if(d){var b=d.split(",");
this.each(function(a,c){c.select($H.contains(b,c.value))})}else return d=this.find("$>[selected=true]"),b=[],$H.each(d,function(a,c){b.push(c.value)}),b.join(",")},onItemClick:function(d,b){this.select(b);this.itemClick&&this.itemClick(this.children[b],b)}});return e});
$Define("C.Icon","C.AbstractComponent",function(e){e=e.define("Icon");e.extend({tmpl:'<span class="hui-icon;<%if(this.isAlt){%>; hui-alt-icon;<%}%>; hui-icon-<%=this.name%>;<%if(!this.noBg){%>; hui-icon-bg;<%}%>"></span>'.split(";")});return e});
$Define("C.Button","C.AbstractComponent",function(e){e=e.define("Button");e.extend({iconPos:"left",theme:"gray",activeCls:"hui-btn-blue",cls:"btn",defItem:{xtype:"Icon"},radius:"normal",shadow:!0,isInline:!0,tmpl:'<a href="javascript:;" hidefocus="true" class="hui-btn,<%if(!this.text){%> hui-btn-icon-notxt<%},if(this.isBack){%> hui-btn-back<%},if(this.hasIcon&&this.text){%> hui-btn-icon-<%=this.iconPos%><%}%>">,<span class="hui-btn-txt"><%=this.text%></span>,<%=this.findHtml("$>*")%>,</a>'.split(","),parseItem:function(d){"Icon"==
d.xtype&&(this.hasIcon=!0)}});return e});
$Define("C.Radio","C.AbstractComponent",function(e){e=e.define("Radio");e.extend({tmpl:'<div class="hui-radio hui-btn hui-btn-gray<%if(this.selected){%> hui-radio-on<%}%>">;<span class="hui-icon hui-icon-radio"></span>;<input type="radio"<%if(this.selected){%> checked=true<%}%>;<%if(this.name){%> name="<%=this.name%>"<%}%>;<%if(this.value){%> value="<%=this.value%>"<%}%>/>;<span class="hui-radio-txt"><%=this.text%></span>;</div>'.split(";"),select:function(d){this.selected=d=!1!=d;var b=this.find("input"),
a=this.getEl();d?(b.attr("checked",!0),a.addClass("hui-radio-on")):(b.removeAttr("checked"),a.removeClass("hui-radio-on"))},val:function(d){if(d)this.value=d,this.find("input").val(d);else return this.value}});return e});
$Define("C.Checkbox","C.AbstractComponent",function(e){e=e.define("Checkbox");e.extend({text:"",value:"",selected:!1,multi:!0,cls:"chkbox",tmpl:'<div class="hui-chkbox hui-btn hui-btn-gray<%if(this.selected){%> hui-chkbox-on<%}%>">;<span class="hui-icon hui-icon-chkbox"></span>;<input type="checkbox"<%if(this.selected){%> checked=true<%}%>;<%if(this.name){%> name="<%=this.name%>"<%}%>;<%if(this.value){%> value="<%=this.value%>"<%}%>/>;<span class="hui-chkbox-txt"><%=this.text%></span>;</div>'.split(";"),select:function(d){this.selected=
d=!1!=d;var b=this.find("input"),a=this.getEl();d?(b.attr("checked",!0),a.addClass("hui-chkbox-on")):(b.removeAttr("checked"),a.removeClass("hui-chkbox-on"))},val:function(d){if(d)this.value=d,this.find("input").val(d);else return this.value}});return e});
$Define("C.Select","C.AbstractComponent",function(e){e=e.define("Select");e.extend({text:"\u8bf7\u9009\u62e9...",value:"",radius:"little",optionClick:function(){},defItem:{xtype:"Menu",hidden:!0,markType:"dot",renderTo:"body"},_customEvents:["change"],tmpl:['<div class="hui-select hui-btn hui-btn-gray hui-btn-icon-right">','<span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span>','<input value="<%=this.value%>" name="<%=this.name%>"/>','<span class="hui-btn-txt js-select-txt"><%=this.text%></span>',
"</div>"],listeners:[{name:"click",handler:function(){this.showOptions()}}],doConfig:function(d){var b=this;b.callSuper([d]);for(var a=d.options,c=0,e=a.length;c<e;c++){var h=a[c];if(h.value==d.value){b.text=h.text;h.selected=!0;break}}b.addItem({itemClick:function(a){b.val(a.value)},width:b.width,items:a})},showOptions:function(){this.children[0].show()},val:function(d){if(d){if(this.value!=d){var b=this.children[0],a=b.find('$>[value="'+d+'"]');0<a.length&&(this.trigger("change"),a=a[0],this.value=
d,this.find("input").attr("value",d),this.txt(a.text),b.select(a))}}else return this.value}});return e});
$Define("C.Input","C.AbstractComponent",function(e){e=e.define("Input");e.extend({radius:"little",iconPos:"left",btnPos:"right",tmpl:'<div class="hui-input;<%if(this.hasIcon){%>; hui-input-icon-<%=this.iconPos%>;<%}%>;<%if(this.hasBtn){%>; hui-input-btn-<%=this.btnPos%>;<%}%>">;<%=this.findHtml("$>*")%>;<%if(this.type=="textarea"){%>;<textarea class="js-input";<%}else{%>;<input type="text" class="js-input hui-input-txt";<%}%> ; name="<%=this.name%>";<%if(this.placeholder){%>; placeholder="<%=this.placeholder%>";<%}%>;<%if(this.type=="textarea"){%>;><%=this.value%></textarea>;<%}else{%>; value="<%=this.value%>"/>;<%}%> ;</div>'.split(";"),listeners:[{name:"focus",
el:".js-input",handler:function(){this.getEl().addClass("hui-focus")}},{name:"blur",el:".js-input",handler:function(){this.getEl().removeClass("hui-focus")}}],doConfig:function(d){var b=this;b.callSuper([d]);"search"==b.type?b.icon="search":"textarea"==b.type&&b._listeners.push({name:"input propertychange",el:".js-input",handler:function(){var a=b.find(".js-input");a.css("height",a[0].scrollHeight)}});b.withClear&&b.addItem({xtype:"Button",radius:"big",icon:"delete",click:function(){this.parent.find("input").val("").focus()}})},
parseItem:function(d){"Icon"==d.xtype?this.hasIcon=!0:"Button"==d.xtype&&(this.hasBtn=!0)},val:function(d){var b=this.find("input,textarea");if(d)b.val(d);else return b.val()},focus:function(){this.find("input").focus()}});return e});$Define("C.Set","C.AbstractComponent",function(e){e=e.define("Set");e.extend({tmpl:'<div class="hui-set">;<h1 class="hui-set-title"><%=this.title%></h1>;<div class="hui-set-content">;<%=this.findHtml("$>*")%>;</div>;</div>'.split(";")});return e});
$Define("C.Field","C.AbstractComponent",function(e){e=e.define("Field");e.extend({tmpl:'<div class="hui-form-field">;<label class="hui-form-left" for="<%=this.forName%>"><%=this.label%></label>;<div class="hui-form-right">;<%=this.text%>;<%=this.findHtml("$>*")%>;</div>;</div>'.split(";")});return e});
$Define("C.Form","C.AbstractComponent",function(e){e=e.define("Form");e.extend({tmpl:'<div class="hui-form">;<form action="">;<div class="hui-form-tips c-error"></div>;<%=this.findHtml("$>*")%>;</form>;</div>'.split(";")});return e});
$Define("C.Tab",["C.AbstractComponent","C.ControlGroup"],function(e,d){var b=e.define("Tab",d);b.extend({defItem:{xtype:"Button",radius:null,isInline:!1,extCls:"js-item",iconPos:"top",shadow:!1},tmpl:['<div class="hui-tab">','<ul class="c-clear">',"<%for(var i=0,len=this.children.length;i<len;i++){","var width=Math.floor(100/len);%>",'<li class="hui-tab-item" style="width:<%=(i==len-1)?(100-width*(len-1)):width%>%">',"<%=this.children[i].getHtml()%>","</li>","<%}%>","</ul>","<%if(this.hasContent){%>",
"<%for(var i=0,len=this.children.length;i<len;i++){%>",'<div class="js-tab-content"<%if(!this.children[i].selected){%> style="display:none"<%}%>>',"<%=this.children[i].content%>","</div>","<%}%>","<%}%>","</div>"],doConfig:function(a){this.callSuper([a]);this.activeType&&(this.defItem.activeCls="hui-btn-active-"+this.activeType)},parseItem:function(a){a.selected&&(a.isActive=!0)},onItemClick:function(a,c){this.hasContent&&this.find(".js-tab-content").hide().eq(c).show();this.callSuper([a,c])},setContent:function(a,
c){a=a||this.getSelected(!0);this.find("js-tab-content").index(a).html(c)}});return b});
$Define("C.Toolbar","C.AbstractComponent",function(e){e=e.define("Toolbar");e.extend({cls:"tbar",defItem:{xtype:"Button",theme:"black",pos:"right",isMini:!0},tmpl:['<div class="hui-tbar<%if(this.type=="header"){%> hui-header<%}else if(this.type=="footer"){%> hui-footer<%}%>">','<%=this.findHtml(">*")%>','<%if(this.title){%><h1 class="hui-tbar-title js-tbar-txt"><%=this.title%></h1><%}%>',"</div>"],parseItem:function(d){"Button"==d.xtype&&(d.shadowSurround=!0,"left"==d.pos?d.extCls=(d.extCls||"")+
" hui-tbar-btn-left":"right"==d.pos&&(d.extCls=(d.extCls||"")+" hui-tbar-btn-right"))}});return e});$Define("C.Tips",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(e,d){var b=e.define("Tips",d);b.extend({theme:"black",timeout:2E3,radius:"normal",tmpl:['<div class="hui-tips<%if(!this.text){%> hui-tips-notxt<%}%>">','<%=this.findHtml("$>*")%>','<%if(this.text){%><span class="hui-tips-txt"><%=this.text%></span><%}%>',"</div>"]});return b});
$Define("C.Dialog",["C.AbstractComponent","C.Popup"],function(e,d){var b=e.define("Dialog",d);$H.extend(b,{alert:function(a){return new b({contentMsg:a,noClose:!0,noCancel:!0})},confirm:function(a,c){return new b({contentMsg:a,noClose:!0,okCall:function(){return c&&c(!0)},cancelCall:function(){return c&&c(!1)}})},prompt:function(a,c,d){d||(d=c,c="");return new b({contentMsg:a,noClose:!0,items:{xtype:"Input",xrole:"dialog-content",value:c},okCall:function(){var a=this.find("$Input")[0].val();return d&&
d(a)}})}});b.extend({okTxt:"\u786e\u5b9a",cancelTxt:"\u53d6\u6d88",clickHide:!1,radius:"little",tmpl:'<div class="hui-dialog">;<%=this.findHtml("$>[xrole=\'dialog-header\']")%>;<div class="hui-dialog-body">;<%if(this.content){%><%=this.content%><%}else{%>;<div class="hui-body-content">;<h1 class="hui-content-title"><%=this.contentTitle%></h1>;<div class="hui-content-msg"><%=this.contentMsg%></div>;<%=this.findHtml("$>[xrole=\'dialog-content\']")%>;</div>;<%}%>;<%if(!this.noAction){%>;<div class="hui-body-action">;<%=this.findHtml("$>[xrole=\'dialog-action\']")%>;</div>;<%}%>;</div>;</div>'.split(";"),
doConfig:function(a){var c=this;c.callSuper([a]);a=a.items;c.title&&!c.hasConfig('[xrole="dialog-header"]',a)&&c.addItem({xtype:"Toolbar",title:c.title,theme:"gray",xrole:"dialog-header",extCls:"hui-dialog-header",items:!c.noClose&&{xtype:"Button",radius:"big",icon:"delete",isMini:!1,theme:"gray",pos:"left",click:function(){c.hide()}}});!c.noAction&&!c.hasConfig('[xrole="dialog-action"]',a)&&(a=[],c.noCancel||a.push({xtype:"Button",radius:null,isActive:1==c.activeBtn,text:c.cancelTxt,click:function(){!1!=
(c.cancelCall&&c.cancelCall())&&c.hide()}}),c.noOk||a.push({xtype:"Button",text:c.okTxt,isActive:2==c.activeBtn,radius:null,click:function(){!1!=(c.okCall&&c.okCall())&&c.hide()}}),c.addItem({xtype:"Tab",xrole:"dialog-action",theme:"border-top",notSelect:!0,items:a}))}});return b});
$Define("C.Menu",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(e,d,b){e=e.define("Menu",d);e.extend(b.prototype);e.extend({notDestroy:!0,tmpl:['<div class="hui-menu<%if(this.markType=="dot"){%> hui-menu-mark<%}%>">',"<ul>","<%for(var i=0,len=this.children.length;i<len;i++){%>",'<li class="hui-menu-item<%if(this.children[i].selected){%> hui-item-mark<%}%>">',"<%=this.children[i].getHtml()%>",'<%if(this.markType=="dot"){%><span class="hui-icon-mark"></span><%}%>',"</li>","<%}%>","</ul>",
"</div>"],selectItem:function(a,c){c=!1!=c;"dot"==this.markType?(a.selected=c,a.getEl().parent()[!1==c?"removeClass":"addClass"]("hui-item-mark")):"active"==this.markType?b.prototype.selectItem.call(this,a,c):a.selected=c}});return e});$Define("C.List",["C.AbstractComponent","C.ControlGroup"],function(e,d){var b=e.define("List",d);b.extend({tmpl:['<div class="hui-list">','<div class="hui-list-item c-clear">',"</div>","</div>"]});return b});
$Define("M.AbstractModule","CM.View",function(e){var d=$H.createClass();$H.inherit(d,e,{useCache:!0,cache:function(){},init:function(){},reset:function(){},exit:function(){return!0}});return d});$Define("M.AbstractNavigator","handy.base.Object",function(e){var d=$H.createClass();e.extend(d.prototype,{navigate:function(){}});return d});
$Define("M.History","handy.base.HashChange",function(e){var d=$H.createClass(),b=0;$H.extend(d.prototype,{initialize:function(a,c){"function"==typeof a&&(c=a,a=null);this.error=c||$H.noop;this.key=a||"handy";this.states=[];e.listen($H.Function.bind(this.stateChange,this))},stateChange:function(){var a=this.getHashParam(),c=a.hKey,b=this.currentKey,d=this.states,e=d[b];if(c==b&&$H.equals(a.param,e.param))return!1;(d=d[c])?a=d.onStateChange(d.param,!0):($D.warn("hisory state not found"),a=this.error("stateNotFound",
a));!0!=a?(a={hKey:b,param:e.param},this.saveHash(a)):this.currentKey=c},saveState:function(a){var c=this.currentKey=this.key+ ++b;this.states.push(c);this.states[c]=a;this.saveHash({hKey:c,param:a.param})},saveHash:function(a){$H.setHash("#"+$H.Json.stringify(a))},getHashParam:function(){try{var a=$H.getHash().replace("#","");return $H.parseJson(a)}catch(c){$H.Debug.warn("History.getCurrentState:parse hash error:"+c.message)}},getCurrentState:function(){try{var a=this.getHashParam();return this.states[a.hKey]}catch(c){$H.Debug.warn("History.getCurrentState:parse hash error:"+
c.message)}},getPreState:function(){try{for(var a=this.getHashParam().hKey,c=this.states,b=c.length,d=0;d++;d<b)if(c[d]==a)return 0<d?c[c[--d]]:null}catch(e){$H.Debug.error("History.getPreState error:"+e.message,e)}},back:function(){var a=this.getPreState();if(a)a.onStateChange(a.param)}});return d});
$Define("M.ModuleManager",["M.History","CM.AbstractManager"],function(e,d){var b=$H.createClass();$H.inherit(b,d,{type:"module",_createMod:function(a){var c=this,b=a.modName;c.modules[b]={waiting:!0};$Require(c.defModPackage+b,function(d){d=new d({renderTo:a.renderTo||c.container,name:b,xtype:b,_id:c.generateId(),extCls:"js-module m-module",hidden:!0});c.modules[b]=d;$H.trigger("afterRender",d.getEl());c.requestMod==b&&c._showMod(d)})},_showMod:function(a){var b=this.modules[this.currentMod];if(!this.navigator||
!this.navigator.navigate(a,b,this))b&&b.hide(),a.show();b&&(b.isActive=!1);a.isActive=!0;this.currentMod=a.name},_destroy:function(a){a.destroy();delete this.modules[a.name]},initialize:function(a){var b=this;a&&(b.conf=a,$H.extend(b,a),b.container=a.container?$(a.container):$(document.body));b.defModPackage+=".";b.history=new e(function(a,d){b.go(d.param)});b.modules={}},go:function(a,b){"string"==typeof a&&(a={modName:a});var d=a.modName,e=this.currentMod,j=this.modules,g=j[e];if(e==d)g.waiting||
g.reset();else{if(g&&!g.waiting)if(g._forceExit)g._forceExit=!1;else if(!1==g.exit())return!1;this.requestMod=d;(d=j[d])?d.useCache?(this._showMod(d),d.cache(a)):d.waiting||(this._destroy(d),this._createMod(a)):this._createMod(a);!0!=b&&this.history.saveState({onStateChange:$H.Function.bind(this.go,this),param:a});return!0}},back:function(a){a&&(this.modules[this.currentMod]._forceExit=!0);history.back()}});return b});
