/* Handy v1.0.0-dev | 2014-05-18 | zhengyinhui100@gmail.com */
(function(){var g=window.handy,b=window.$,f=window.handy=window.$=function(){};f.version="1.0.0";f.isDebug="undefined"==typeof gEnv?!1:"dev"==gEnv;f.expando="handy"+(f.version+Math.random()).replace(/\D/g,"");f.add=function(a,c,d){d||(d=c,c=null);f.base||(f.base={});var e=[];if(c)if("string"==typeof c)e.push(f.base.Object.ns(c));else for(var b=0;b<c.length;b++)e.push(f.base.Object.ns(c[b]));e.push(f);c=d.apply(window,e);f.base[a]=f[a]=c;if(0<="Browser,Class,Array,Geo,Cookie,Date,Events,Function,Json,Object,String,Template,Util".indexOf(a))for(var j in c)f.isDebug&&
("undefined"!=typeof f[j]&&"console"in window&&!Function[j])&&(console.log(f[j]),console.log(a+"\u547d\u540d\u51b2\u7a81:"+j)),f[j]=c[j]};f.noConflict=function(a){window.$===f&&(window.$=b);a&&window.handy===f&&(window.handy=g);return f};f.noop=function(){}})();
handy.add("Json",function(){function g(a){e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(a){var e=h[a];return"string"===typeof e?e:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));return'"'+a+'"'}function b(e,f){var h,j,k,p,n=c,x,l=f[e];l&&("object"===typeof l&&"function"===typeof l.toJSON)&&(l=l.toJSON(e));"function"===typeof a&&(l=a.call(f,e,l));switch(typeof l){case "undefined":return"undefined";case "string":return g(l);case "number":return isFinite(l)?String(l):"null";case "boolean":case "null":return String(l);
case "object":if(!l)return"null";c+=d;x=[];if("[object Array]"===Object.prototype.toString.apply(l)){p=l.length;for(h=0;h<p;h+=1)x[h]=b(h,l)||"null";k=0===x.length?"[]":c?"[\n"+c+x.join(",\n"+c)+"\n"+n+"]":"["+x.join(",")+"]";c=n;return k}if(a&&"object"===typeof a){p=a.length;for(h=0;h<p;h+=1)"string"===typeof a[h]&&(j=a[h],(k=b(j,l))&&x.push(g(j)+(c?": ":":")+k))}else for(j in l)Object.prototype.hasOwnProperty.call(l,j)&&(k=b(j,l))&&x.push(g(j)+(c?": ":":")+k);k=0===x.length?"{}":c?"{\n"+c+x.join(",\n"+
c)+"\n"+n+"}":"{"+x.join(",")+"}";c=n;return k}}var f="JSON"in window,a,c,d,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,n=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
l=/(?:^|:|,)(?:\s*\[)+/g;return{stringify:function(e,h,j,k){if(f&&!k)return JSON.stringify.apply(null,arguments);var g;d=c="";if("number"===typeof j)for(g=0;g<j;g+=1)d+=" ";else"string"===typeof j&&(d=j);if((a=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return b("",{"":e})},parseJson:function(a,e,c){function d(a,c){var b,f,h=a[c];if(h&&"object"===typeof h)for(b in h)Object.prototype.hasOwnProperty.call(h,
b)&&(f=d(h,b),void 0!==f?h[b]=f:delete h[b]);return e.call(a,c,h)}if(f&&!c)return JSON.parse.apply(null,arguments);var b;a=String(a);j.lastIndex=0;j.test(a)&&(a=a.replace(j,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(k.test(a.replace(p,"@").replace(n,"]").replace(l,"")))return b=eval("("+a+")"),"function"===typeof e?d({"":b},""):b;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var g;g=(g=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(g[0])?function(a,c,d){var e=[];if(a.length){c=c||0;for(d=d||a.length;c<d;c++)e.push(a[c])}return e}:function(a,c,d){return Array.prototype.slice.call(a,c||0,d||a.length)};var b={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},ns:function(a,c){var d=null,e,f,j,k;a=b.alias(a);f=a.split(".");d=f[0];d=(j=2==arguments.length)?eval("(function(){if (typeof "+d+' == "undefined"){'+
d+" = {};}return "+d+";})()"):eval("(function(){if (typeof "+d+' != "undefined")return '+d+";})()");e=1;for(k=f.length;e<k;++e){if(e==k-1&&j)d[f[e]]=c;else if(j||d&&d[f[e]])d[f[e]]=d[f[e]]||{};else return;d=d[f[e]]}return d},alias:function(a,c){var d=b._alias;if(c)d[a]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+a+":"+d[a]):d[a]=c;else{if(a){var e=a,f=a.length-1;do{if(d[e])return d[e]+a.substring(f);f=e.lastIndexOf(".")}while(0<f&&(e=e.substring(0,f)));return a}return d}},extend:function(a,c,
d){if(!c||b.isStr(c)||b.isNum(c))return a;var e=d?d.notCover:!1,f=d?d.cover:null;d=d?d.IsClone:!1;a=a||{};var j=a.constructor,k=j.$isClass,g,n;for(n in c)if(g=c[n],(!f||b.contains(f,n))&&c.hasOwnProperty(n)){var l=a.hasOwnProperty(n),m=!0===e?l:!1;b.isArr(e)?m=b.contains(e,n)&&l:b.isFunc(e)&&(m=e(n,g));m||(g=d?b.clone(g):g,k&&b.isFunc(g)&&(g.$name=n,g.$owner=j),a[n]=g)}return a},extendIf:function(a,c){return b.extend(a,c,{notCover:!0})},mix:function(a,c,d){a.superProto||(a.superProto={});for(var e in c)a.superProto[e]=
b.isFunc(c[e])?a.superProto[e]?function(a,e){return function(){e.apply(this,arguments);c[a].apply(this,arguments)}}(e,a.superProto[e]):c[e]:c[e],a[e]||(a[e]=c[e]);d&&b.extend(a,d);c.toString!=c.constructor.prototype.toString&&(a.superProto.toString=function(){c.toString.apply(a,arguments)});return a},isNum:function(a){return"number"==typeof a},isStr:function(a){return"string"==typeof a},isBool:function(a){return"boolean"==typeof a},isSimple:function(a){return b.isStr(a)||b.isNum(a)||b.isBool(a)},
isUndef:function(a){return"undefined"==typeof a},isFunc:function(a){return"[object Function]"===f.prototype.toString.call(a)},isArr:function(a){return"[object Array]"===f.prototype.toString.call(a)},isObj:function(a){return"object"==typeof a&&!b.isArr(a)},isClass:function(a){return b.isFunc(a)&&!0===a.$isClass},equals:function(a,c){if(typeof a==typeof c){if("object"!=typeof a)return a===c;if(a===c)return!0;if(b.isArr(a)&&b.isArr(c)){if(a.length!=c.length)return!1;for(var d=0,e=a.length;d<e;d++)if(!b.equals(a[d],
c[d]))return!1;return!0}if(!b.isArr(a)&&!b.isArr(c)){if(b.count(a)!=b.count(c))return!1;for(d in a)if(void 0==c[d]||!b.equals(a[d],c[d]))return!1;return!0}}return!1},clone:function(a){if(null==a||"object"!=typeof a)return a;var c=a.constructor;if(c!=f&&c!=window.Array)return a;if(c==window.Date||c==window.RegExp||c==window.Function||c==window.String||c==window.Number||c==window.Boolean)return new c(a);try{var d=new c,e;for(e in a)d[e]=b.clone(a[e]);return d}catch(h){return a}},isEmpty:function(a){if(b.isArr(a))return 0==
a.length;for(var c in a)return!1;return!0},each:function(a,c,d){if(a){var e,f=0,j=a.length,k=void 0===j||b.isFunc(a);if(d)if(k)for(e in a){if(!1===c.apply(a[e],d))break}else for(;f<j&&!1!==c.apply(a[f],d);)e=a.length,j==e?f++:j=e;else if(k)for(e in a){if(!1===c.call(a[e],e,a[e]))break}else for(;f<j&&!1!==c.call(a[f],f,a[f]);)e=a.length,j==e?f++:j=e;return a}},contains:function(a,c){if(!a)return!1;var d=!1;b.each(a,function(a,f){if(b.equals(f,c))return d=!0,!1});return d},largeThan:function(a,c){if("object"==
typeof a&&"object"==typeof c){var d=!0;b.each(c,function(e){if(!b.equals(c[e],a[e]))return d=!1});return d}},count:function(a){if(b.isArr(a))return a.length;var c=0,d;for(d in a)c++;return c},removeUndefined:function(a,c){var d=b.isArr(a);if(c){if(d){var e=[];b.each(a,function(a,c){void 0!==c&&e.push(c)});return e}return b.extend({},a,{isClone:!0,notCover:function(a,e){return void 0===e}})}b.each(a,function(e,c){void 0===c&&(d?a.splice(e,1):delete a[e])});return a},toArray:g,fromArray:function(a){for(var c=
{},d=0,e=a.length;d<e;d++){var b=a[d];c[b.name]=b.value}return c},generateMethod:function(a,c,d){c=b.isArr(c)?c:c.split(",");for(var e=0;e<c.length;e++){var f=c[e];a[f]=d(f)}}},f=window.Object;return b});
handy.add("Browser","handy.base.Object",function(g){var b={},f={};g.generateMethod(f,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(a){return function(e){var c=b[a];return!e&&"string"===typeof c&&/^[\d\.]+$/.test(c)?parseInt(c):c}});g=window.navigator.userAgent;var a;(a=g.match(/MSIE ([\d.]+)/))?b.ie=a[1]:(a=g.match(/Firefox\/([\d.]+)/))?b.firefox=a[1]:(a=g.match(/Chrome\/([\d.]+)/))?
b.chrome=a[1]:(a=g.match(/Opera.([\d.]+)/))?b.opera=a[1]:(a=g.match(/Version\/([\d.]+).*Safari/))?b.safari=a[1]:0;/windows|win32/i.test(g)?b.windows=!0:/linux/i.test(g)?b.linux=!0:/macintosh/i.test(g)?b.mac=!0:0;/trident/i.test(g)?b.trident=!0:/webkit/i.test(g)?b.webkit=!0:/gecko/i.test(g)?b.gecko=!0:/presto/i.test(g)?b.presto=!0:0;/MetaSr/i.test(g)?b.sogou=!0:/Maxthon/i.test(g)?b.maxthon=!0:/TencentTraveler/i.test(g)?b.tt=!0:/TheWorld/i.test(g)?b.theWorld=!0:/360[S|E]E/i.test(g)?b.is360=!0:0;var c;
if((c=g.match(/AppleWebKit\/([\d.]*)/))&&c[1])if(/ Mobile\//.test(g)&&g.match(/iPad|iPod|iPhone/)){b.mobile="ios";if((c=g.match(/OS ([^\s]*)/))&&c[1])b.ios=c[1].replace("_",".");if((c=g.match(/iPad|iPod|iPhone/))&&c[0])b[c[0].toLowerCase()]=b.ios}else if(/ Android/i.test(g)){if(/Mobile/.test(g)&&(b.mobile="android"),(c=g.match(/Android ([^\s]*);/))&&c[1])b.android=c[1]}else if(c=g.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))b.mobile=c[0].toLowerCase();var d;try{if(b.ie){var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
e&&(d=e.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(e=navigator.plugins["Shockwave Flash"])){var h=e.description.split(" ");a=0;for(var j=h.length;a<j;a++)if(0<parseInt(h[a])){d=h[a];break}}}catch(k){}b.flash=d?d:null;return f});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(g,b,f){var a={level:f.isDebug?0:5,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!b.mobile(),out:function(c,d,e){e=e||"log";if(d||a.showInPage){var b=f.expando+"debugDiv",j=top.document,k=j.getElementById(b);k?k.style.display="block":(k=j.createElement("DIV"),k.id=b,k.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+j.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u6536\u8d77</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',k.style.position="fixed",k.style.width="100%",k.style.left=0,k.style.top=0,k.style.right=0,k.style.height="100%",k.style.backgroundColor="#aaa",k.style.fontSize="12px",k.style.padding="10px",k.style.zIndex=9999999999,k.style.opacity=0.95,k.style.filter="alpha(opacity=95)",j.body.appendChild(k));b=k.getElementsByTagName("DIV")[0];j="string"==typeof c?c:f.Json.stringify(c,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0);j=j.replace(/\n|\\n/g,"<br/>");
b.innerHTML+="<div"+("log"==e?"":' style="color:'+("error"==e?"red":"info"==e?"green":"yellow"))+'">'+e+":<br/>"+j+"</div><br/><br/>";b.scrollTop=b.scrollHeight}b=arguments.callee.caller;b.$owner||(b=b.caller);try{if(b.$owner)console[e]("["+b.$owner.$ns+"->"+b.$name+"]");console[e](c)}catch(g){}},log:function(c,d){a.level>a.LOG_LEVEL||a.out(c,!!d,"log")},info:function(c,d){this.level>a.INFO_LEVEL||a.out(c,!!d,"info")},warn:function(c,d){a.level>a.WARN_LEVEL||a.out(c,!!d,"warn")},error:function(c,
d){if(!(a.level>a.ERROR_LEVEL)&&(a.out(c,!!d,"error"),c instanceof Error))throw c;},time:function(c,d,e){a.level>a.INFO_LEVEL||(c?("boolean"==typeof d&&(e=d,d=""),a.out((d||"")+((new Date).getTime()-(a.lastTime||0)),!!e)):a.lastTime=(new Date).getTime())},debug:function(c){if(!(a.level>a.DEBUG_LEVEL)&&!1!==c)debugger}};return a});
handy.add("Function",function(g){return{bind:function(b,f,a){var c=Array.prototype.slice.call(arguments,2);return function(){var a=c.slice();Array.prototype.push.apply(a,arguments);return b.apply(f,a)}},intercept:function(b,f,a,c){return g.Object.isFunc(b)&&g.Object.isFunc(f)?function(){var d=a||this,e={},h=arguments;e.scope=c;e.target=d;e.method=b;return!1!=f.apply(e,h)?b.apply(d,h):!1}:b}}});
handy.add("Class",["B.Object","B.Debug"],function(g,b){var f={createClass:function(a){var c=function(){var a,e,b=arguments;if(this.constructor==c)a=this;else return a=b.callee,e=function(){},e.prototype=a.prototype,e=new e,a.apply(e,b),e;if(e=a.initialize){for(var f in a)"object"==typeof a[f]&&(a[f]=g.clone(a[f]));return e.apply(a,b)}};c.$isClass=!0;c.derive=function(a,e,c){var b=f.createClass();f.inherit(b,this,a,e,c);return b};c.prototype.callSuper=function(a,e){a&&(!a.$isClass&&void 0!=a.length)&&
(e=a,a=null);var c=arguments.callee.caller,b=c.$owner.superProto;e=e||c.arguments;a=a?a.prototype:b||this.constructor.superProto;c=c.$name;if(a&&(c=a[c],g.isFunc(c)))return c.apply(this,e)};a&&this.ns(a,c);return c},inherit:function(a,c,d,e,f){var j=function(){};j.prototype=c.prototype;g.extend(a,c,f);a.prototype=new j;a.prototype.constructor=a;a.superClass=c;a.superProto=c.prototype;if(c._onInherit)try{c._onInherit(a)}catch(k){b.error(k)}e&&g.extend(a,e);d&&g.extend(a.prototype,d)},getSingleton:function(a){return(a=
"string"==typeof a?g.ns(a):a)&&(a.$singleton||(a.$singleton=new a))}};return f});
handy.add("Loader",["B.Debug","B.Object","B.Function"],function(g,b,f,a){function c(a){var e={},c=[];"string"==typeof a&&(a=[a]);for(var d=0,f=a.length;d<f;d++){var h;h=a[d];h=/\.(css|js)$/.test(h)?s[h]&&"loaded"==s[h].status:t.urlMap&&t.urlMap[h]?t.urlMap[h].chkExist():b.ns(h);if(h)c.push(h);else return e.notExist=a[d],e}e.exist=c;return e}function d(a,c){function b(){b.isCalled||(b.isCalled=!0,clearTimeout(p),c())}if("SCRIPT"===a.nodeName){var d=a,f=b,h=function(){/loaded|complete|undefined/.test(d.readyState)&&
(d.onload=d.onerror=d.onreadystatechange=null,n.removeChild(d),d=null,setTimeout(f,0))};d.onload=d.onreadystatechange=h;d.onerror=function(){g.error(k+"load script error:\n"+d.src);h()}}else{var j=b;window.hasOwnProperty("attachEvent")?a.attachEvent("onload",j):setTimeout(function(){e(a,j)},0)}var p=setTimeout(function(){g.error("Time is out:"+a.src);b()},t.timeout)}function e(a,c){if(!c.isCalled){var d;if(l)a.sheet&&(d=!0);else if(a.sheet)try{a.sheet.cssRules&&(d=!0)}catch(b){if("SecurityError"===
b.name||"NS_ERROR_DOM_SECURITY_ERR"===b.name)d=!0}setTimeout(function(){d?c():e(a,c)},1)}}function h(a){t.showLoading(!1);q--;s[a].status="loaded";t.traceLog&&g.log(k+"Response:\n"+a);j()}function j(){for(var a=m.length-1;0<=a;a--){var e=m[a],d=c(e.deps);if(d.notExist)0==a&&0==q&&g.error(p+d.notExist);else{m.splice(a,1);e.callback.apply(null,d.exist);j();break}}}var k="[Handy Loader] ",p=k+"not found: ",n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,l=navigator.userAgent.indexOf("AppleWebKit"),
m=[],q=0,s={},t={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(e,c,d){e=a.Object.alias(e);2==arguments.length&&(d=c,c=[]);t.require(c,function(){var a;if("function"==typeof d)try{t.traceLog&&g.log(k+"define:\n"+e),a=d.apply(null,arguments)}catch(c){c.message=k+e+":\nfactory define error:\n"+c.message;g.error(c);return}else a=d;if(a){b.ns(e,a);var f=typeof a;if("object"==f||"function"==f)a.$ns=e}else g.error(k+"factory no return:\n"+e)})},require:function(e,b){for(var j=
"string"==typeof e?[e]:e,l=[],A=[],u=!0,z=0,B=j.length;z<B;z++){var r=j[z],r=a.Object.alias(r),w=c(r);w.notExist?(l.push(r),u&&(u=!1,m.push({deps:j,callback:b})),t.traceLog&&g.log(p+r)):A.push(w.exist[0])}if(0==l.length)return b&&b.apply(null,A),0==A.length?A[0]:A;u=!1;j=0;for(A=l.length;j<A;j++)if(z=l[j],!s[z]){u=z;r=t.urlMap&&t.urlMap[u]&&t.urlMap[u].url;if(!r){B="";r=t.rootPath;if("string"==typeof r)B=r;else if("object"==typeof r)for(w in w=void 0,r)0==u.indexOf(w)&&(B=r[w],u=u.replace(w,""));
else B="";r=/.css$/.test(u)?0==u.indexOf("/")?u:"/css/"+u:/.js$/.test(u)?u:u.replace(/\./g,"/")+".js";r=B.replace(/\/$/,"")+"/"+r.replace(/^\//,"")}u=!0;s[z]={id:z,status:"loading"};B=f.bind(h,null,z);t.traceLog&&g.log(k+"request:\n"+r);if(/.css$/.test(r))a:{z=r;r=n.getElementsByTagName("link");for(w=0;w<r.length;w++){var C=r[w].href;!t.skinNode&&0<=C.indexOf(t.skinName)&&(t.skinNode=r[w]);if(0<=C.indexOf(z)||0<=z.indexOf(C))break a}r=document.createElement("link");r.rel="stylesheet";r.href=z;d(r,
B);t.skinNode?n.insertBefore(r,t.skinNode):n.appendChild(r)}else z=r,r=document.createElement("script"),r.async="async",r.src=z,r.type="text/javascript",d(r,B),n.appendChild(r);q++}u&&t.showLoading(!0)}};return t});
handy.add("Events",function(g){return{_eventCache:{},_execEvtCache:[],_parseEvents:function(b,f){var a=/\s+/;if("object"==typeof b){for(var c in b)f([c,b[c]]);return!0}if("string"==typeof b&&a.test(b)){a=b.split(a);c=0;for(var d=a.length;c<d;c++)f([a[c]]);return!0}return!1},_parseCustomEvents:function(b,f,a){var c=this,d=g.toArray(arguments,2);return c._parseEvents(f,function(a){c[b].apply(c,a.concat(d))})},_delegateHandler:function(b,f){var a=this;return function(){if(!0!=a.isSuspend)return b.apply(f||
a,arguments)}},_pushEvent:function(b){this._execEvtCache.push(b)},_execEvents:function(){var b=this,f,a=b._execEvtCache;g.each(a,function(c,d){a.splice(c,1);var e=d.delegation;"number"==typeof d.times&&(1<d.times?d.times--:b.off(d.name,d.handler));f=e.apply(b,d.args)});return f},on:function(b,f,a,c){if(!this._parseCustomEvents("on",b,f,a,c)){"number"==typeof a&&(c=a,a=null);var d=this._eventCache,e=d[b];e||(e=d[b]=[]);b=this._delegateHandler(f,a);e.push({times:c,handler:f,context:a,delegation:b})}},
once:function(b,f,a){var c=g.toArray(arguments);c.push(1);this.on.apply(this,c)},off:function(b,f){if("all"==b)return this._eventCache={},!0;if(!this._parseCustomEvents("off",b,f)){var a=this._eventCache,c=b.indexOf(".");if(!f&&0>=c){for(var d in a)(d.split(".")[0]==b||0==c&&0<=d.indexOf(b))&&delete a[d];return!0}c=a[b];if(!c)return!1;if(f){a=0;for(d=c.length;a<d;a++)if(c[a].handler==f)return c.splice(a,1),!0}else return delete a[b],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=
!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(b,f){function a(a){if(a)for(var d=0,f=a.length;d<f;d++){var h=a[d];h.args=e;h.name=b;c._pushEvent(h)}}var c=this,d=g.toArray(arguments);d.unshift("trigger");if(!c._parseCustomEvents.apply(c,d)){var d=c._eventCache,e=g.toArray(arguments),h;if(0<b.indexOf("."))h=d[b],a(h);else for(var j in d)if(h=b.indexOf("."),j.split(".")[0]==b||0==h&&0<=j.indexOf(b))h=d[j],a(h);a(d.all);return c._execEvents()}}}});
handy.add("Date",function(){var g=window.Date,b={getWeek:function(a,c){var d=a.getDay();c&&(d=(d+(c%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[d]},isWeeken:function(a){return 0==a.getDay()||6==a.getDay()},getDaysInMonth:function(a){a=new g(a.getFullYear(),a.getMonth()+1,0);return a.getDate()},getDaysInYear:function(a){var c=new g(a.getFullYear(),0,0);a=new g(a.getFullYear()+1,0,0);return Math.floor((a.getTime()-c.getTime())/864E5)},getDayIndexOfYear:function(a){var c=new g("1/1/"+
a.getFullYear());return Math.ceil((a.getTime()-c.getTime())/864E5)},formatDate:function(a,c){c=c||"yyyy-MM-dd HH:mm:ss";var d=a.getHours(),e=Math.floor((a.getMonth()+3)/3),d={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":0==d%12?12:d%12,"H+":d,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":b.getWeek(a),"q+":e,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][e-1],"S+":a.getMilliseconds()},f;for(f in d)RegExp("("+f+")").test(c)&&(e=RegExp.$1.length,c=c.replace(RegExp.$1,1==e?d[f]:("00"+d[f]).slice(-e)));
return c},parseDate:function(a,c){var d=typeof a,e=new g;if("number"==d)return e.setTime(a),e;if("string"!=d)return a;var d=(c||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),b=a.match(/\d+/g);if(b){for(var f=0;f<b.length;f++){var k=d[f],p=parseInt(b[f]);switch(k){case "yyyy":e.setFullYear(p);break;case "MM":e.setMonth(p-1);break;case "dd":e.setDate(p);break;case "HH":e.setHours(p);break;case "mm":e.setMinutes(p);break;case "ss":e.setSeconds(p);break;case "SS":e.setMilliseconds(p)}}return e}},now:function(a){var c=
new g;if(a)"number"!=typeof a&&(a=b.parseDate(a).getTime()),f=a-c.getTime();else return c.setTime(c.getTime()+f),c},howLong:function(a,c){if(a){var d=b.now().getTime()-a.getTime();if(!1!=c){var e;if(60>(d/=6E4))e="\u5206\u949f",d=d||1;else if(24>(d/=60))e="\u5c0f\u65f6";else if(30>(d/=24))e="\u5929";else return"30\u5929\u524d";d=(Math.floor(d)||1)+e+"\u524d"}return d}}},f=0;return b});
handy.add("String",function(){var g={stripTags:function(b){return b.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(b){if(!b)return b;var f=document.createElement("div");b=document.createTextNode(b);f.appendChild(b);return f.innerHTML},unescapeHTML:function(b){var f=document.createElement("div");f.innerHTML=g.stripTags(b);return f.childNodes[0].nodeValue},decodeHTML:function(b){b=b.replace(/&lt;/gi,"<");b=b.replace(/&gt;/gi,">");b=b.replace(/&quot;/gi,'"');b=b.replace(/&apos;/gi,"'");b=b.replace(/<\/?br>/gi,
"\n");b=b.replace(/&amp;/gi,"&");return b=b.replace(/&nbsp;/gi," ")},encodeHTML:function(b){b=b.replace(/&/gi,"&amp;");b=b.replace(/</gi,"&lt;");b=b.replace(/>/gi,"&gt;");b=b.replace(/\"/gi,"&quot;");b=b.replace(/\'/gi,"&apos;");b=b.replace(/\n/gi,"</br>");return b=b.replace(/ /gi,"&nbsp;")},trim:function(b){return b=b.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(b,f){f||(f=/[,%\'\"\/\\;|\<\>\^]/);return-1<b.search(f)},len:function(b){return b.replace(/[^\x00-\xff]/g,"**").length},
left:function(b,f,a){if(g.len(b)>f){!0===a?a=2:0<a||(a=0);var c=0,d=0;for(f-=a;d<f;)255<b.charCodeAt(c)?d+=2:d++,c++;b=b.substring(0,c);for(c=0;c<a;c++)b+="."}return b},isNumStr:function(b){return 0==b.search(/^\d+$/g)},hasChn:function(b){return/[\u4E00-\u9FA5]+/.test(b)},isChn:function(b){return/^[\u4E00-\u9FA5]+$/.test(b)},addParam:function(b,f){f&&(b+=(-1<b.indexOf("?")?"&":"?")+f);return b}};return g});
handy.add("Cookie",function(){return{getCookie:function(g,b){var f=g+"=",a="",c=document.cookie;if(0<c.length){var d=c.indexOf(f);-1!=d&&(d+=f.length,f=c.indexOf(";",d),-1==f&&(f=c.length),a=c.substring(d,f),b||(a=unescape(a)))}return a},setCookie:function(g,b,f){var a=[];void 0!=g&&void 0!=b&&a.push(g+"="+escape(b));f&&(void 0!=f.path&&a.push("path="+f.path),void 0!=f.domain&&a.push("domain="+f.domain),void 0!=f.expires&&a.push("expires="+f.expires),f.secure&&a.push("secure"));document.cookie=a.join(";")},
delCookie:function(g){var b=new Date;b.setTime(b.getTime()-1);document.cookie=g+"=;expires="+b.toGMTString()}}});handy.add("Util","B.Object",function(g){var b=0;return{isWindow:function(b){return null!=b&&b==b.window},uuid:function(){return++b},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(b){var a=top.location.hash;0<=a.indexOf("#")&&(b=a.replace(/#[^\?]*/,b));top.location.hash=b},result:function(b,a){var c=b[a];return g.isFunc(c)?c():c}}});
handy.add("Array","B.Object",function(g,b){function f(a){return a}function a(a){return function(e){return e[a]}}function c(e){return null==e?f:b.isFunc(e)?e:a(e)}function d(a){return function(e){if(e===a)return!0;for(var c in a)if(a[c]!==e[c])return!1;return!0}}function e(a){return function(e,d,b){var f={};d=c(d);g.each(e,function(c,h){var g=d.call(b,h,c,e);a(f,g,h)});return f}}var h={map:function(a,e,c){var d=[];if(null==a)return d;var b=Array.prototype.map;if(b&&a.map===b)return a.map(e,c);g.each(a,
function(a,b){d.push(e.call(c,b,a))});return d},pluck:function(e,c){return this.map(e,a(c))},some:function(a,e,c){var d=!1;if(null==a||!e)return d;var f=Array.prototype.some;if(f&&a.some===f)return a.some(e,c);b.each(a,function(a,b,f){if(d||(d=e.call(c,b,a,f)))return!1});return!!d},every:function(a,e,c){var d=!0;if(null==a||!e)return d;var f=Array.prototype.every;if(f&&a.every===f)return a.every(e,c);b.each(a,function(a,b,f){if(!(d=e.call(c,b,a,f)))return!1});return!!d},indexOf:function(a,e,c){if(null==
a)return-1;var d=0,b=a.length;if(c)if("number"==typeof c)d=0>c?Math.max(0,b+c):c;else return d=h.sortedIndex(a,e),a[d]===e?d:-1;var f=Array.prototype.indexOf;if(f&&a.indexOf===f)return a.indexOf(e,c);for(;d<b;d++)if(a[d]===e)return d;return-1},find:function(a,e,c){var d;this.some(a,function(a,b,f){if(e.call(c,a,b,f))return d=a,!0});return d},filter:function(a,e,c){var d=[];if(null==a)return d;var f=Array.prototype.filter;if(f&&a.filter===f)return a.filter(e,c);b.each(a,function(a,b,f){e.call(c,b,
a,f)&&d.push(b)});return d},where:function(a,e){return this.filter(a,d(e))},findWhere:function(a,e){return this.find(a,d(e))},invoke:function(a,e){var c=Array.prototype.slice.call(arguments,2),d=g.isFunc(e);return this.map(a,function(a){return(d?e:a[e]).apply(a,c)})},sortedIndex:function(a,e,d,b){d=c(d);e=d.call(b,e);for(var f=0,h=a.length;f<h;){var g=f+h>>>1;d.call(b,a[g])<e?f=g+1:h=g}return f},sortBy:function(a,e,d){e=c(e);return this.pluck(this.map(a,function(a,c,b){return{value:a,index:c,criteria:e.call(d,
a,c,b)}}).sort(function(a,e){var c=a.criteria,d=e.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-e.index}),"value")},groupBy:e(function(a,e,c){a[e]?a[e].push(c):a[e]=[c]}),countBy:e(function(a,e){a[e]?a[e]++:a[e]=1})};return h});
handy.add("Geo",function(g){return{distance:function(b,f,a){function c(a){a.get?a=[a.get("latitude"),a.get("longitude")]:g.isObj(a)&&(a=[a.latitude,a.longitude]);return a}var d,e;b=c(b);d=b[0];b=b[1];f=c(f);e=f[0];f=f[1];d=d*Math.PI/180;e=e*Math.PI/180;b=6371*Math.acos(Math.cos(e)*Math.cos(d)*Math.cos(b*Math.PI/180-f*Math.PI/180)+Math.sin(e)*Math.sin(d));b=b.toFixed(2);if(!1!=a){if(isNaN(b))return"\u672a\u77e5";b+="km"}return b}}});
handy.add("Template",["B.Object","B.String","B.Debug","B.Function"],function(g,b,f,a,c){function d(a,e){var c=e.fn,d="";if(a){if(void 0!=a.length)for(var b=0,f=a.length;b<f;b++)d+=c(a[b]);else for(b in a)d+=c(a[b]);return d}}function e(a,e){var c=e.fn,d=[];if(a){if(void 0!=a.length)for(var b=0,f=a.length;b<f;b++)d.push(c(a[b]));else for(b in a)d.push(c(a[b]));return d.join("")}}function h(a){a=a.replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n");return q?"$r+="+('"'+a+'"')+";":"$r.push("+
('"'+a+'"')+");"}function j(a,e){e=e||{};var c=a.exp.replace(/"/g,"'"),d=a.blockName,b=a.children,f=a.num,h='$data && ($data.get?$data.get("'+c+'"):$data.'+c+")",g="\nif($tmp||$tmp===0){"+(q?"$r+=$tmp;":"$r.push($tmp);")+"}",j=(a.inverse?"inverse:true,":"")+"num:"+f+',context:me,exp:"'+c+'",helpers:$helpers},$data';d?(c="$program"+f,d="$tmp = $helpers."+d+".call(me,"+h+", {fn:"+c+","+j+");"+g,b&&(h=p(b,e),h=t[0]+"\n"+h.join("\n")+"\n"+t[1],m.splice(2,0,"\nfunction "+c+"($data){\n"+h+"\n}\n"))):((b=
c.match(/([^\s]+)\s([^\n]+)/))?(c=b[1],d="if (helper = $helpers."+c+') {\n$tmp = helper.call(me,"'+b[2]+'",{'+j+'); \n}else{$tmp="";}'):(d="if (helper = $helpers."+c+") {\n$tmp = helper.call(me,$data,{"+j+"); \n}else if($helpers.getValue){\n$tmp=$helpers.getValue.call(me,$data,{"+j+");}","else{\nhelper = "+h+"; $tmp = typeof helper === functionType ? helper.call(me,$data,{"+j+") : helper;\n}"+(e.helpers.getValue?"":n.isEscape?"\n$tmp=escape($tmp);":"")),d+=g);return d}function k(a,e){if(a){var c=
e||{},d=n.openTag,b=n.closeTag,h,g;c.children?g=c.children:c.children=g=[];if(0<=(h=a.indexOf(d))){var j=a.substring(0,h);j&&g.push({html:j});a=a.substring(h+d.length);if(0==a.indexOf("#"))if(a=a.substring(1),j=a.match(/^[a-z]+/)){var p=j[0];h=a.indexOf(b);j=a.substring(p.length+1,h);a=a.substring(h+b.length);j={num:++s,blockName:p,exp:j};g.push(j);var l=d+"/"+p+b;a:{h=a;for(var b=RegExp(d+"[#/]"+p+"((?!"+b+").)*"+b,"ig"),m=0;d=b.exec(h);)if(d[0]==l)if(0==m){h=d.index;break a}else m--;else m++;h=
-1}if(-1==h){f.error("\u672a\u627e\u5230\u5757\u7ed3\u675f\u4f4d\u7f6e:"+l);return}d=a.substring(0,h);a=a.substring(h+l.length);k(d,j);if("if"==p){p=j.children;l=0;for(d=p.length;l<d;l++)b=p[l],"else"==b.exp&&(b.exp=j.exp,b.blockName="if",b.num=++s,b.inverse=!0,b.children=p.slice(l+1),g.push(b),j.children=p.slice(0,l))}}else{f.error("\u627e\u4e0d\u5230\u8f85\u52a9\u51fd\u6570:"+a);return}else h=a.indexOf(b),g.push({num:++s,exp:a.substring(0,h)}),a=a.substring(h+b.length);k(a,c)}else a&&g.push({html:a});
return c}}function p(a,e){var c=[];if(a)for(var d=0,b=a.length;d<b;d++){var f=a[d];f.html?c.push(h(f.html)):f.exp&&c.push(j(f,e))}return c}var n={openTag:"{{",closeTag:"}}",isTrim:!0,isEscape:!0,getIfPlusJoin:function(){return q},registerHelper:function(a,e,c){g.isObj(e)?(y[a]||(y[a]={}),g.extend(y[a],e)):y[a][e]=c},tmpl:function(a,e){var d,b,h;if("string"==typeof a)d=a;else if(void 0!=a.length)d=a.join("");else if(d=a.tmpl,h=a.id)if(l[h])b=l[h];else if(!d){var j=document.getElementById(h);j&&(d=
(j.value||j.innerHTML).replace(/\s/g,""))}if(!b){if(!d){c.Debug.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}a:{if(n.isTrim){var j=n.openTag,q=n.closeTag;d=d.replace(/^[\s\n]+/,"").replace(/[\s\n]+$/,"").replace(RegExp("("+q+"|\\>)(\\s|\\n)+(?=("+j+"|<))","ig"),"$1").replace(RegExp(q+"[\\s\\n]+([^\\n]+)[\\s\\n]+(?=("+j+"|<))","ig"),q+"$1")}m=[t[0]];m.push('var escape=$helpers.escape,functionType="function",me=this;');var j=a&&a.ns,r;j?(r=g.extend({},y["default"]),r=g.extend(r,y[j])):r=y["default"];
a.helpers=r;var w=a.context;d=k(d);s=0;d=p(d.children,a);m=m.concat(d);m.push(t[1]);d=m.join("\n");try{var C=window.Function.apply(null,["$T","$helpers","$data",d]);f.log(C);b=function(a){return C.call(w||a,n,r,a)};break a}catch(E){f.log(d),f.error(E)}b=void 0}h&&(l[h]=b)}if(e)try{return b(e)}catch(F){f.log(b.toString()),f.error(F)}else return b}},l={},m,q="".trim,s=0,t=["var $r="+(q?'""':"[]")+",$tmp,helper;","return "+(q?"$r;":'$r.join("");')],y={"default":{"if":function(a,e,c){g.isFunc(a)&&(a=
a.call(c));if(a&&!e.inverse||!a&&e.inverse)return e.fn(c)},unless:function(a,e,c){e.inverse=!0;return e.helpers["if"].call(this,a,e,c)},each:q?d:e,escape:b.escapeHTML,trim:b.trim}};return n});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(g,b,f){function a(a){if(a==p)return!1;var e=k.contentWindow.document;e.open();e.write("<!doctype html><html><body>"+a+"</body></html>");e.close();p=a;g.log("set:"+k.contentWindow.document.body.innerText)}function c(){var e=b.getHash(),c=k.contentWindow.document.body.innerText;e!=p?(a(e),d(e)):c!=p&&(g.log("update:"+k.contentWindow.document.body.innerText),b.setHash(c))}function d(a){var e=m.listeners,c;for(c in e)e[c](a)}var e,
h=0,j=document,k,p,n=j.documentMode,l="onhashchange"in window&&(void 0===n||7<n),m={delay:50,listen:function(g,p){if(!e&&!e)if(e=!0,m.listeners={},l)$(window).on("hashchange",function(){d(b.getHash())});else k=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(j.body)[0],$(k).one("load",function(){a(b.getHash());setInterval(c,m.delay)});if(p in m.listeners)$D.error(Error("Duplicate name"));else return p=p||f.expando+ ++h,m.listeners[p]=g,p},unListen:function(a){for(var e in m.listeners)(!a||
a==e)&&delete m.listeners[e]}};return m});handy.add("Support","B.Browser",function(g){var b={mediaQuery:function(){var a;if(g.mobile())a="hui-mobile";else{a="hui-pc";var c=g.ie();c&&(a+=" ie"+c)}document.documentElement.className+=" "+a}};b.mediaQuery();if(6==g.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(f){}return b});
handy.add("Validator",["B.String","B.Object"],function(g,b){var f={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(a,c){var d=c.rules,e;for(e in d){var b=d[e],g=("function"==typeof b?b:f[e])(a,b);if(!g)return d=c.error||f.error,e=c.messages&&
c.messages[e]||f.messages[e],e=e.replace(/\{([^\}]+)\}/g,function(a,e){return b[e]||0==e&&b||c[e]||b||""}),d&&d(e),g}return!0},required:function(a){return 0<g.trim(""+a).length},email:function(a){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a){return!/Invalid|NaN/.test((new Date(a)).toString())},dateISO:function(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a){return/^\d+$/.test(a)},creditcard:function(a){if(/[^0-9 \-]+/.test(a))return!1;var c=0,d=0,e=!1;a=a.replace(/\D/g,"");for(var b=a.length-1;0<=b;b--){d=a.charAt(b);d=parseInt(d,10);if(e&&9<(d*=2))d-=9;c+=d;e=!e}return 0===c%10},min:function(a,c){return a>=c},max:function(a,
c){return a<=c},range:function(a,c){return a>=c[0]&&a<=c[1]},minlength:function(a,c){return(b.isArr(a)?a.length:g.trim(""+a).length)>=c},maxlength:function(a,c){return(b.isArr(a)?a.length:g.trim(""+a).length)<=c},rangelength:function(a,c){var d=b.isArr(a)?a.length:g.trim(""+a).length;return d>=c[0]&&d<=c[1]},equalTo:function(a,c){return a===c}};return f});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(g,b,f){b={_init:function(){!a&&g.ie()&&(d=document.getElementById("LocalStorageUserDataDiv"),d||(d=document.createElement("DIV"),d.style.display="none",d.id="LocalStorageUserDataDiv",d.addBehavior("#default#userData"),document.body.appendChild(d),d.load(e)))},getItem:function(e){e=a?c.getItem(e):d.getAttribute(e);return e=f.parseJson(e)},setItem:function(b,g){g=f.stringify(g);try{a?c.setItem(b,g):(d.setAttribute(b,g),d.save(e))}catch(k){return $D.error(k),
!1}return!0},removeItem:function(b){a?c.removeItem(b):(d.removeAttribute(b),d.save(e))},clear:function(){a?c.clear():d.unload()}};var a=window.localStorage&&window.localStorage.getItem,c=window.localStorage,d,e=document.domain;b._init();return b});(function(g){Hui=H=$H=g.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};g=window.$;g.fn.remove=$H.intercept(g.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
$Define("CM.AbstractEvents",function(){var g=$H.createClass();$H.extend(g.prototype,$H.Events);$H.extend(g.prototype,{_eventCache:{},_listenTo:[],_parseListenToEvents:function(b,f,a,c){var d=this,e=$H.toArray(arguments,3);return d._parseEvents(a,function(a){a.unshift(f);d[b].apply(d,a.concat(e))})},listenTo:function(b,f,a,c,d){if(!this._parseListenToEvents("listenTo",b,f,a,c,d)){"number"==typeof c&&(d=c,c=null);c=c||this;var e=this._delegateHandler(a,c);this._listenTo.push({target:b,name:f,delegation:e,
handler:a});b.on(f,e,c,d)}},unlistenTo:function(b,f,a){if(!this._parseListenToEvents("unlistenTo",b,f,a)){var c=this._listenTo,d="all"==b;$H.each(c,function(e,h){if(d||h.name==f&&h.handler==a&&h.target==b)h.target.off(h.name,h.delegation),c.splice(e,1)})}}});return g});
$Define("CM.DataStore",function(){var g=$H.createClass();$H.extend(g.prototype,{get:function(f,a){var c;if(c=b[f])return a?$H.where(c,a):c},push:function(f,a){"string"!=typeof f&&(a=f,f=null);var c=a.constructor.$ns;(b[c]||(b[c]=[])).push(a);f&&(b[f]||(b[f]=a))}});var b={};$S=$H.getSingleton(g);return g});
$Define("CM.AbstractDao","B.LocalStorage",function(g){var b=$H.createClass();$H.extend(b.prototype,{_ajaxMethodMap:{create:"POST",update:"POST",patch:"PATCH","delete":"DELETE",read:"GET"},_localMethodMap:{create:"setItem",update:"setItem",patch:"setItem","delete":"removeItem",read:"getItem"},ajax:function(b){b=this.parseParam(b);var a=$H.intercept(b.error,this.error);b.error=$H.intercept(a,b.beforeErr);a=$H.intercept(b.success,this.success);b.success=$H.intercept(a,b.beforeSucc);b.beforeSend=$H.intercept($H.bind(this.beforeSend,
this),b.beforeSend);b.complete=$H.intercept($H.bind(this.complete,this),b.complete);return $.ajax(b)},parseParam:$H.noop,beforeSend:function(){this.showLoading(!0)},complete:function(){this.showLoading(!1)},error:$H.noop,success:$H.noop,showLoading:$H.noop,get:function(){},set:function(){},remove:function(){},sync:function(b,a,c){c=c||{};var d=c.storeType||"remote",e={type:"POST",dataType:"json"};c.url||(e.url=a.getUrl());if(null==c.data&&a&&("create"===b||"update"===b||"patch"===b))e.data=c.attrs||
a.toJSON(c);if("remote"==d)e.url+="/"+b+".do",$H.extend(e,c),this.ajax(e);else g[this._localMethodMap[b]](e);a.trigger("request",a,c)}});return b});
$Define("CM.Model",["CM.AbstractDao","CM.AbstractEvents","CM.DataStore"],function(g,b){return b.derive({idAttribute:"id",_pending:!1,_validate:function(b,a){if(!a.validate||!this.validate)return!0;b=$H.extend({},this._attributes,b);var c=this.validationError=this.validate(b,a)||null;if(!c)return!0;this.trigger("invalid",this,c,$H.extend(a,{validationError:c}));return!1},_initDepFields:function(){var b=this.fields,a,c;for(c in b)if(a=b[c],a=a.depends)for(var d=0;d<a.length;d++)this.on("change:"+a[d],
$H.bind(this.set,this,c,null,null))},_parseFields:function(b){var a;if(!(a=this.fields))return b;var c,d,e,h={},g;for(g in b){d=b[g];if(c=a[g]){e=$H.isObj(c)?c.type:c;if(c=c.parse)d=c.apply(this,[d,b]);$H.isStr(e)&&("Date"==e?d=$H.parseDate(d):0<e.indexOf(".")&&(e=$H.ns(e)));$H.isClass(e)&&!(d instanceof e)&&(d=new e(d),d.on("all",$H.bind(this._onAttrEvent,this,g)))}h[g]=d}return h},_onAttrEvent:function(b,a){if(!("invalid"==a||"sync"==a)){var c=this.get(b);0!=a.indexOf("change:")&&(this.trigger("change:"+
b,this,c),this.trigger("change",this))}},initialize:function(b,a){this.uuid=$H.uuid();this.dao=this.dao||$H.getSingleton(g);this._initDepFields();var c=b||{};a||(a={});this.cid=$H.Util.uuid();this._attributes={};a.collection&&(this.collection=a.collection);a.parse&&(c=this.parse(c,a)||{});c=$H.extend(c,$H.Util.result(this,"defaults"),{notCover:!0});this.set(c,a);this._changed={};$S.push(this)},toJSON:function(){return $H.clone(this._attributes)},sync:function(b,a,c){return this.dao.sync(b,a,c)},get:function(b){return this._attributes[b]},
escape:function(b){return $H.String.escapeHTML(this.get(b))},has:function(b){b=this.get(b);return null!=b&&void 0!=b},set:function(b,a,c){var d;"object"===typeof b?(d=b,c=a):(d={})[b]=a;c||(c={});d=this._parseFields(d);if(!this._validate(d,c))return!1;var e=c.unset;b=c.silent;var h=[],g=this._changing;this._changing=!0;g||(this._previousAttributes=$H.Object.clone(this._attributes),this._changed={});var k=this._attributes,p=this._previousAttributes;this.idAttribute in d&&(this.id=d[this.idAttribute]);
for(var n in d)a=d[n],$H.equals(k[n],a)||h.push(n),$H.equals(p[n],a)?delete this._changed[n]:this._changed[n]=a,e?delete k[n]:k[n]=a;if(!b){h.length&&(this._pending=c);a=0;for(d=h.length;a<d;a++)this.trigger("change:"+h[a],this,k[h[a]],c)}if(g)return this;if(!b)for(;this._pending;)c=this._pending,this._pending=!1,this.trigger("change",this,c);this._changing=this._pending=!1;return this},unset:function(b,a){a=a||{};a.unset=!0;return this.set(b,void 0,a)},clear:function(b){var a={},c;for(c in this._attributes)a[c]=
void 0;b=b||{};b.unset=!0;return this.set(a,b)},each:function(b){$H.each(this._attributes,b)},hasChanged:function(b){var a=this._changed;return null==b?!$H.isEmpty(a):$H.contains(a,b)},changedAttrbutes:function(b){if(!b)return this.hasChanged()?$H.clone(this._changed):!1;var a,c=!1,d=this._changing?this._previousAttributes:this._attributes,e;for(e in b)if(!$H.equals(d[e],a=b[e]))(c||(c={}))[e]=a;return c},previous:function(b){return null==b||!this._previousAttributes?null:this._previousAttributes[b]},
fetch:function(b){var a=this;b=b?$H.clone(b):{};void 0===b.parse&&(b.parse=!0);var c=b.success,d=b.beforeSet;b.success=function(e){if(!(d&&!1==d(a,e,b))){if(!a.set(a.parse(e,b),b))return!1;c&&c(a,e,b);a.trigger("sync",a,e,b)}};a.sync("read",a,b)},save:function(b,a,c){var d=this,e;null==b||"object"===typeof b?(e=b,c=a):(e={})[b]=a;$H.isFunc(c)&&(c={success:c});c=$H.extend({validate:!0},c);if(e&&c.now){if(!d.set(e,c))return!1}else if(!d._validate(e,c))return!1;void 0===c.parse&&(c.parse=!0);var h=c.success;
c.success=function(a){var b=d.parse(a,c);c.now||(b=$H.extend(e||{},b));if($H.isObj(b)&&!d.set(b,c))return!1;h&&h(d,a,c);d.trigger("sync",d,a,c)};b=d.isNew()?"create":c.update?"update":"patch";if("patch"===b){a=d.changedAttrbutes(e);if(!a){h&&h(d,c);return}c.attrs=a}else a=$H.extend({},d._attributes),c.attrs=$H.extend(a,e);d.sync(b,d,c)},destroy:function(b){var a=this;b=b?$H.clone(b):{};var c=b.success,d=function(){a.trigger("destroy",a,a.collection,b);a.off("all")};b.success=function(e){(!b.now||
a.isNew())&&d();c&&c(a,e,b);a.isNew()||a.trigger("sync",a,e,b)};if(a.isNew())return b.success(),!1;a.sync("delete",a,b);b.now&&d()},getUrl:function(){var b=$H.result(this,"url")||$H.result(this.collection,"url");b||$D.error(Error("\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2aurl\u5c5e\u6027\u6216\u8005\u51fd\u6570"));return this.isNew()?b:b.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(b){return b.code&&b.data?b.data:b},clone:function(){return new this.constructor(this._attributes)},
isNew:function(){return void 0==this.id},isValid:function(b){return this._validate({},$H.extend(b||{},{validate:!0}))}})});
$Define("CM.Collection",["CM.AbstractDao","CM.AbstractEvents","CM.Model","CM.DataStore"],function(g,b,f){var a=b.derive({model:f,_reset:function(){this.length=0;this._models=[];this._byId={}},_prepareModel:function(a,e){if(a instanceof f)return a;e=e?$H.clone(e):{};e.collection=this;var b;if(e.id&&(b=(b=$S.get(this.model.$ns,{id:e.id}))&&b[0]))return b.set(a,e),b;b=new this.model(a,e);if(!b.validationError)return b;this.trigger("invalid",this,b.validationError,e);return!1},_addReference:function(a){this._byId[a.cid]=
a;null!=a.id&&(this._byId[a.id]=a);a.collection||(a.collection=this);a.on("all",this._onModelEvent,this)},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,e,b,c){("add"===a||"remove"===a)&&b!==this||("destroy"===a&&this.remove(e,c),e&&a==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))},initialize:function(a,b){this.dao=this.dao||
$H.getSingleton(g);b||(b={});b.model&&(this.model=b.model);b.url&&(this.url=b.url);void 0!==b.comparator&&(this.comparator=b.comparator);this._reset();a&&this.reset(a,$H.extend({silent:!0},b))},toJSON:function(a){return $H.map(this._models,function(b){return b.toJSON(a)})},sync:function(a,b,c){return this.dao.sync(a,b,c)},add:function(a,b){b=$H.extend({add:!0,remove:!1,merge:!1},b);return this.set(a,b)},remove:function(a,b){var c=!$H.isArr(a);a=c?[a]:$H.clone(a);b||(b={});var f,g,p,n;f=0;for(g=a.length;f<
g;f++)if(n=a[f]=this.get(a[f]))delete this._byId[n.id],delete this._byId[n.cid],p=this.indexOf(n),this._models.splice(p,1),this.length--,b.silent||(b.index=p,n.trigger("remove",n,this,b)),this._removeReference(n,b);return c?a[0]:a},set:function(a,b){if(a){b=$H.extend({add:!0,remove:!0,merge:!0},b);b.parse&&(a=this.parse(a,b));var c=!$H.isArr(a),g=c?a?[a]:[]:$H.clone(a),k,p,n,l,m,q,s,t=b.at,y=this.model,v=this.comparator&&null==t&&!1!==b.sort,D="string"==typeof this.comparator?this.comparator:null,
x=[],A=[],u={},z=b.add,B=b.merge,r=b.remove,w=!v&&z&&r?[]:!1;k=0;for(p=g.length;k<p;k++){m=g[k]||{};n=m instanceof f?l=m:m[y.prototype.idAttribute||"id"];if(q=this.get(n))r&&(u[q.cid]=!0),B&&(m=m===l?l.attributes:m,b.parse&&(m=q.parse(m,b)),q.set(m,b),v&&(!s&&q.hasChanged(D))&&(s=!0)),g[k]=q;else if(z){b.id=n;l=g[k]=this._prepareModel(m,b);if(!l)continue;x.push(l);this._addReference(l,b)}l=q||l;w&&(l.isNew()||!u[l.id])&&w.push(l);u[l.id]=!0}if(r){k=0;for(p=this.length;k<p;++k)u[(l=this._models[k]).cid]||
A.push(l);A.length&&this.remove(A,b)}if(x.length||w&&w.length)if(v&&(s=!0),this.length+=x.length,null!=t){k=0;for(p=x.length;k<p;k++)this._models.splice(t+k,0,x[k])}else{w&&(this._models.length=0);n=w||x;k=0;for(p=n.length;k<p;k++)this._models.push(n[k])}s&&this.sort({silent:!0});if(!b.silent){k=0;for(p=x.length;k<p;k++)(l=x[k]).trigger("add",l,this,b);(s||w&&w.length)&&this.trigger("sort",this,b)}return c?g[0]:g}},each:function(a){$H.each(this._models,a)},reset:function(a,b){b||(b={});for(var c=
0,f=this._models.length;c<f;c++)this._removeReference(this._models[c],b);b.previousModels=this._models;this._reset();a&&(a=this.add(a,$H.extend({silent:!0},b)));b.silent||this.trigger("reset",this,b);return a},push:function(a,b){return this.add(a,$H.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){return this.add(a,$H.extend({at:0},b))},shift:function(a){var b=this.at(0);this.remove(b,a);return b},slice:function(){return Array.prototype.slice.apply(this._models,
arguments)},get:function(a){return null==a?void 0:this._byId[a]||this._byId[a.id]||this._byId[a.cid]},size:function(){return this.length},at:function(a){return this._models[a]},where:function(a,b){return $H.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var e in a)if(a[e]!==b.get(e))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){this.comparator||$D.error(Error("\u6ca1\u6709\u6bd4\u8f83\u5668"));a||(a={});"string"==typeof this.comparator||1===this.comparator.length?
this._models=this.sortBy(this.comparator,this):this._models.sort($H.Function.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return $H.invoke(this._models,"get",a)},getUrl:function(){return this.url},fetch:function(a){var b=this;a=a?$H.clone(a):{};void 0===a.parse&&(a.parse=!0);var c=a.success,f=a.beforeSet;a.success=function(g){f&&!1==f(b,g,a)||(b[a.reset?"reset":a.add?"add":"set"](g,a),c&&c(b,g,a),b.trigger("sync",b,g,a))};return b.sync("read",b,
a)},create:function(a,b){var c=this;b=b?$H.clone(b):{};if(!(a=c._prepareModel(a,b)))return!1;b.now&&c.add(a,b);var f=b.success;b.success=function(a,d){b.now||c.add(a,b);f&&f(a,d,b)};a.save(null,b);return a},parse:function(a){return a.data},clone:function(){return new this.constructor(this._models)}}),c=$H.Array;$H.each("map some every find filter invoke indexOf".split(" "),function(b,e){a.prototype[e]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(this._models);return c[e].apply(c,
a)}});$H.each(["sortBy","groupBy","countBy"],function(b){a.prototype[b]=function(a,f){var g=$H.isFunc(a)?a:function(b){return b.get(a)};return c[b](this._models,g,f)}});return a});
$Define("CM.AbstractManager",function(){var g=$H.createClass();$H.extend(g.prototype,{_types:{},_all:{},type:"manager",registerType:function(b,f){this._types[b]=f;f.prototype.xtype=b},getClass:function(b){return $H.isClass(b)?b:this._types[b]||$H.ns(b)},register:function(b,f){var a=b.cid=f.cid||$H.uuid(),a=b._id=this.generateId(a);this._all[a]=b},unregister:function(b){var f=this._all,a=b.getId();f[a]==b&&delete f[a]},eachInEl:function(b,f){var a=this;b.find(".js-"+a.type).each(function(b,d){d=$(d);
var e=d.attr("id");(e=a.get(e))&&f(e)})},generateId:function(b,f){var a=$H.expando+"_"+this.type+"_"+(b||$H.uuid());if(!0!=f&&this._all[a])$D.error("id\u91cd\u590d:"+a);else return a},get:function(b){var f=this._all;return f[b]||f[this.generateId(b,!0)]}});return g});
$Define("CM.ViewManager","CM.AbstractManager",function(g){var b=$H.createClass();$H.inherit(b,g,{type:"view",initialize:function(){var b=this;$H.on("afterRender",function(a,c){b.afterRender(c)});$H.on("removeEl",function(a,c){b.destroy(c)})},afterRender:function(b){this.eachInEl(b,function(a){a.afterRender()})},destroy:function(b){this.eachInEl(b,function(a){a.destroy(!0)})}});$V=$H.getSingleton(b);return b});
$Define("CM.AbstractView",["CM.ViewManager","CM.AbstractEvents"],function(g,b){var f=/^(<[a-zA-Z]+)/,a=/^[^>]+class=/,c=/(class=")/;return b.derive({xtype:"View",renderBy:"append",autoRender:!0,initialize:function(a){this.inited||(this.manager=this.constructor.manager||$H.getSingleton(g),this.manager.register(this,a),this.doConfig(a),this.init(a),this.parseItems(),!1!=this.autoRender&&this.render(),this.inited=!0)},init:$H.noop,doConfig:function(a){a=(this.initParam=a)||{};$H.extend(this,a);var b;
this.renderTo=(b=a.renderTo)?$(b):$(document.body)},getId:function(){return this._id},getCid:function(){return this.cid},getEl:function(){return this._container},initHtml:function(){var a=this.tmpl;$H.isFunc(a)||(this.tmpl=this.constructor.prototype.tmpl=$H.tmpl(a));return this.tmpl(this._config)},getHtml:function(){var b=this.getId(),e=this.initHtml(),g=a.test(e),j="js-"+this.manager.type+" js-"+this.xtype+" "+this.extCls+" ";g&&(e=e.replace(c,"$1"+j));return e=e.replace(f,'$1 id="'+b+'"'+(g?"":
' class="'+j+'"'))},parseItems:$H.noop,render:function(){var a=this.getHtml();this.renderTo[this.renderBy](a);this._container=$("#"+this.getId())},destroy:function(){if(!this.destroyed)return this.clearListeners(),this.getEl().remove(),this.destroyed=!0,this.manager.unregister(this),delete this._container,delete this.renderTo,!0}})});
$Define("CM.ModelView",["B.Template","CM.AbstractView","CM.Model","CM.Collection"],function(g,b,f,a){function c(a,b){return!a?a:0==a.indexOf("#")?a.substring(1):b.get?b.get(a):b[a]}function d(a,b,e,d,f,g){var m,q=d.indexOf("?"),s=d.indexOf(":");if(0<q||0<s){var t=d.substring(0,0<q?q:s),y=0>q?"":d.substring(q+1,0<s?s:d.length),v=0>s?"":d.substring(s+1,d.length);m=c(t,g);f&&0!=t.indexOf("#")&&a.listenTo(g,"change:"+t,function(a,c,d){a=$("#"+b);e?"class"==e?d?(v&&a.removeClass(v),y&&a.addClass(y)):(y&&
a.removeClass(y),v&&a.addClass(v)):a.attr(e,d?y:v):d?a.prop(y,!0):a.prop(y,!1)});return m?y:v}m=c(d,g);f&&0!=d.indexOf("#")&&a.listenTo(g,"change:"+d,function(a,c,d){a=$("#"+b);"class"==e?(a.removeClass(m),a.addClass(d),m=d):a.attr(e,d||"")});return m}b=b.derive({modelClass:f,_metaMorphs:{},doConfig:function(){this.callSuper();this.model||(this.model=new this.modelClass(this.data));this._config=this.model},initHtml:function(){var a=this.tmpl;$H.isFunc(a)||(this.tmpl=this.constructor.prototype.tmpl=
$H.tmpl({tmpl:a,context:this,ns:"ModelView"}));return this.tmpl(this.model)},ifBindModel:function(){},ifBindEl:function(){},updateMetaMorph:function(a,b,c){var e=$("#metamorph-"+a+"-start");if(0!=e.length){a="metamorph-"+a+"-end";for(var d=e[0].nextSibling,f;d&&d.id!=a;)f=$(d),d=d.nextSibling,f.remove();b&&e.after(b);c&&(e.remove(),$(d).remove())}},wrapMetaMorph:function(a,b){return'<script id="metamorph-'+b+'-start" type="text/x-placeholder">\x3c/script>'+(a||"")+'<script id="metamorph-'+b+'-end" type="text/x-placeholder">\x3c/script>'},
updateModel:function(a){this.model.set(a)},getModel:function(){return this.model}});g.registerHelper("ModelView",{"if":function(a,b,c){var e=b.context,d=b.exp;$H.isFunc(a)&&(a=a.call(c));var g;if(a&&!b.inverse||!a&&b.inverse)g=b.fn(c);a=e._metaMorphs;var m=b.num,q=e.getCid()+"-"+m;!a[m]&&c instanceof f&&(a[m]=1,e.listenTo(c,"change:"+d,function(a,c,f){var g;if(f&&!b.inverse||!f&&b.inverse)a={},a[d]=f,g=b.fn(a);e.updateMetaMorph(q,g)}));return e.wrapMetaMorph(g,q)},unless:function(a,b,c){b.inverse=
!0;return b.helpers["if"].call(this,a,b,c)},each:function(b,c){var d=c.context,f=c.fn,g=e?"":[],l=c.num,m=d.getCid()+"-"+l;if(b){var q;if(b instanceof a){b.each(function(a,b){q=d.wrapMetaMorph(f(b),l+"-"+b.uuid);e?g+=q:g.push(q)});var s=d._metaMorphs;s[l]||(s[l]=1,d.listenTo(b,"add",function(a,b,c,e){a=d.wrapMetaMorph(f(b),m+"-"+b.uuid);(e=e.at)?(c=c.at(e-1),$("#metamorph-"+(m+"-"+c.uuid)+"-end").after(a)):$("#metamorph-"+m+"-end").before(a)}),d.listenTo(b,"remove",function(a,b){d.updateMetaMorph(m+
"-"+b.uuid,"",!0)}))}else if(void 0!=b.length)for(var s=0,t=b.length;s<t;s++)q=d.wrapMetaMorph(f(b[s]),m+"-"+s),e?g+=q:g.push(q);else for(s in b)q=d.wrapMetaMorph(f(b[s]),m+"-"+s),e?g+=q:g.push(q);return d.wrapMetaMorph(e?g:g.join(""),m)}},getValue:function(a,b){var c=b.context,e=b.exp,d=g.isEscape,l=b.helpers,m=c._metaMorphs,q=b.num,s=c.getCid()+"-"+q;!m[q]&&a instanceof f&&(m[q]=1,c.listenTo(a,"change:"+e,function(a,b,e){d&&(e=l.escape(e));c.updateMetaMorph(s,e)}));e=a.get?a.get(e):a[e];d&&(e=l.escape(e));
return c.wrapMetaMorph(e,s)},bindAttr:function(a,b,e){var g=b.context;b=b.num;for(var n=/((\w+)=['"]?)?([#\w][\s\w\?:#-]*)(['"]?)(?!\w*=)/g,l="bindAttr-"+(g.getCid()+"-"+b),m,q=[],s=g._metaMorphs,t=[],y=!s[b]&&e instanceof f;m=n.exec(a);)"id"==m[2]?l=c(m[3],e):t.push(m);q.push('id="'+l+'"');for(var v,D,x,n=0,A=t.length;n<A;n++){m=t[n];a=m[2];v=m[3];v=v.split(" ");D=[];for(var u=0;u<v.length;u++)x=d(g,l,a,v[u],y,e),D.push(x);v=D.join(" ");a?v=(m[1]||"")+v+m[4]:v&&(v=v+'="'+v+'"');v&&q.push(v)}s[b]=
1;return" "+q.join(" ")+" "}});var e=g.getIfPlusJoin();return b});
$Define("CM.View",["CM.ViewManager","CM.AbstractView","B.Template"],function(g,b){var f=/^(<[a-zA-Z]+)/,a=/^[^>]+class=/,c=/(class=")/,d=b.derive({xtype:"View",_placeholder:'<script id="" type="text/x-placeholder">\x3c/script>',listeners:[],items:[],tmpl:'<div><%=this.findHtml(">*")%></div>',children:[],_customEvents:"beforeRender render afterRender beforeShow show afterShow beforeHide hide afterHide beforeUpdate update afterUpdate beforeDestroy destroy afterDestroy add remove".split(" "),_defaultEvents:"mousedown mouseup mouseover mousemove mouseenter mouseleave dragstart drag dragenter dragleave dragover drop dragend touchstart touchmove touchend touchcancel keydown keyup keypress click dblclick focus focusin focusout contextmenu change submit".split(" "),
_applyArray:function(a,b){var c=this,d=arguments,f=d.callee.caller,g=f.$owner.prototype;0==d.length?(d=f.arguments,d=$H.toArray(d),a=f.$name,b=d.shift()):d=$H.toArray(d,2);return $H.isArr(b)?($H.each(b,function(b,f){g[a].apply(c,[f].concat(d))}),!0):!1},_parseListenEvents:function(a,b){var c=this;return c._parseEvents(b.name,function(d){b.name=d[0];2==d.length&&(b.handler=d[1]);c[a].call(c,b)})},initialize:function(a){this.inited||(this.manager=this.constructor.manager||$H.getSingleton(g),this.doConfig(a),
this.init&&this.init(a),this.parseItems(),!1!=this.autoRender&&this.render(),this.manager.register(this),this.inited=!0)},doConfig:function(a){var b=this;b.initParam=a;"string"==typeof a&&(a={text:a});var c=a||{};$H.extend(b,c,{notCover:function(a,e){var d=$H.contains(b._customEvents,a);if($H.contains(b._defaultEvents,a))return b.listeners.push({name:a,handler:c[a]}),!0;if(d)return b.on(a,c[a]),!0;if("defItem"==a)return b[a]=$H.extend(b[a],e),!0;if("listener"==a)return b.listeners=b.listeners.concat($H.isArr(e)?
e:[e]),!0;if("items"==a)return b.add(e),!0;if("extCls"==a&&b[a])return b[a]+=" "+e,!0;if("xtype"==a)return"View"==b[a]&&(b[a]="string"==typeof e?e:e.$ns),!0}});if(a=c.renderTo){if($H.isFunc(a))a=a.call(b);else if($H.isStr(a)&&0==a.indexOf(">")){var d=b.parent;a=d.inited&&d.findEl(a.substring(1))}else a=$(a);b.renderTo=a}else b.renderTo=$(document.body)},initHtml:function(){var a=this.tmpl;$H.isFunc(a)||(this.tmpl=this.constructor.prototype.tmpl=$H.tmpl(a));return this.tmpl(this)},getHtml:function(){var b=
this.getId(),d;d="visibility"==this.displayMode?"visibility:hidden;":"display:none;";var g=this.initHtml(),k=a.test(g),p="js-"+this.manager.type+" js-"+this.xtype+" "+this.extCls+" ";k&&(g=g.replace(c,"$1"+p));return g=g.replace(f,'$1 id="'+b+'" style="'+d+'"'+(k?"":' class="'+p+'"'))},findHtml:function(a){a=this.find(a);for(var b=[],c=0;c<a.length;c++)b.push(a[c].getHtml());return b.join("")},initStyle:function(){var a=this.getEl(),b=this.style||{};void 0!=this.width&&(b.width=this.width);void 0!=
this.height&&(b.height=this.height);a.css(b)},beforeRender:function(){return this.trigger("beforeRender")},render:function(){if(!1==this.beforeRender())return!1;var a=this.getHtml();this.renderTo[this.renderBy](a);this.afterRender()},afterRender:function(){if(this.rendered)return!1;this.trigger("render");this.callChild();this._container=$("#"+this.getId());this.rendered=!0;this.initStyle();!0!=this.notListen&&this.initListeners();this.disabled&&this.disable();this.trigger("afterRender");this.hidden||
this.show()},beforeShow:function(){return this.trigger("beforeShow")},show:function(a,b){var c=this;if(!1==c.beforeShow()||c.showed||b&&c.hidden)return!1;if(!a&&c.delayShow)setTimeout(function(){d.prototype.show.call(c,!0)},0);else{c.trigger("show");c.showed=!0;var f=c.getEl();"visibility"==c.displayMode?f.css({visibility:"visible"}):f.show();c.callChild([null,!0]);c.afterShow()}},afterShow:function(){var a=this;setTimeout(function(){a.trigger("afterShow")},0)},beforeHide:function(){return this.trigger("beforeHide")},
hide:function(){if(!1==this.beforeHide()||!this.showed)return!1;this.showed=!1;var a=this.getEl();"visibility"==this.displayMode?a.css({visibility:"hidden"}):a.hide();this.trigger("hide");this.afterHide()},afterHide:function(){this.trigger("afterHide")},enable:function(){this.resume();this.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")},disable:function(){this.suspend();this.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled","disabled")},
getContent:function(a,b){b?!b instanceof d&&(b=this.find(b)[0]):b=this;return!1==a?b.children:b.getEl().html()},setContent:function(a,b){if(b)return!b instanceof d&&(b=this.find(b)[0]),b.setContent(a);var c=this.getEl();c.contents().remove();if("string"==typeof a)c.html(a);else return this.add(a)},listen:function(a){if(!this._parseListenEvents("listen",a)){var b=a.name,c=a.context,d=a.times,f=a.target,g=a.custom||f||$H.contains(this._customEvents,b),l=a.handler;$H.isFunc(f)&&(f=f.call(this));if(g)a=
$H.removeUndefined([f,b,l,c,d]),this[f?"listenTo":"on"].apply(this,a);else if(this.listened){var f=this._listeners,d=a.el,g=a.method||"bind",m=a.selector,q=a.data,c=a.delegation=this._delegateHandler(l,c);$H.isFunc(d)&&(d=d.call(this));d=d?"string"==typeof d?this.findEl(d):d:this.getEl();if(m)if(q)d[g](m,b,q,c);else d[g](m,b,c);else if(q)d[g](b,q,c);else d[g](b,c);f.push(a)}else this.listeners.push(a)}},unlisten:function(a){if(!this._parseListenEvents("unlisten",a)){var b=a.name,c=a.handler;if(a.custom)this.off(b,
c);else{var d=a.el,f="delegate"==a.method?"undelegate":"unbind";a=a.selector;for(var g,d=d?"string"==typeof d?this.findEl(d):d:this.getEl(),l=this._listeners.length-1;0<=l;l--){var m=this._listeners[l];if(m.handler==c){g=m.delegation;this._listeners.splice(l,1);break}}if(a)d[f](a,b,g);else d[f](b,g)}}},initListeners:function(){if(this.listened)return!1;this.listened=!0;var a=this.listeners;this._listeners=[];for(var b=a.length-1;0<=b;b--)this.listen(a[b]);this.callChild()},clearListeners:function(){for(var a=
this._listeners,b=a.length-1;0<=b;b--)this.unlisten(a[b]);this.off("all");this.unlistenTo("all");this.callChild()},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0;this.callChild()},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1;this.callChild()},findEl:function(a){return this.getEl().find(a)},parentsEl:function(a){return this.getEl().parents(a)},each:function(a,b){for(var c=this.children,d=c.length,f,g=0;g<d;){f=c[g];f=b?a.apply(f,b):a(g,f);if(!1===f)break;d==c.length?
g++:d=c.length}},match:function(a,b){if("*"==a)return!0;var c=b||this,d,f,g;a=a.replace(/^#([^\s,\[]+)/,"[cid=$1]");a=a.replace(/^\.([^\s,\[]+)/,"[cClass=$1]");a=a.replace(/^([^\[]+)/,"[xtype=$1]");for(var l=/\[([^=|\!]+)(=|\!=)([^=]+)\]/g;d=l.exec(a);){f=d[1];g=d[2];d=d[3];if("false"==d||"true"==d)d=eval(d);if("="===g?c[f]!=d:c[f]==d)return!1}return!0},find:function(a,b){var c=this;b=b||[];if($H.isNum(a))b.push(c.children[a]);else if($H.isStr(a)){if(0<a.indexOf(","))return $H.each(a.split(","),function(a,
d){b=b.concat(c.find(d))}),b;var d=0==a.indexOf(">"),f=a.replace(/^>?\s?/,""),g=f.search(/\s|>/),l;0<g&&(l=f.substring(g),f=f.substring(0,g));c.each(function(c,g){g.match(f)&&(l?g.find(l,b):b.push(g));d||g.find(a,b)})}else if($H.isFunc(a)){var m=$H.isClass(a);c.each(function(c,d){(m&&d instanceof a||!m&&a(d))&&b.push(d);d.find(a,b)})}return b},parents:function(a){for(var b=this;b.parent;)if(b=b.parent,a&&this.match(a,b))return b;return a||b===this?null:b},index:function(){var a=this,b=a.parent;if(b){var c;
b.each(function(b,d){if(d==a)return c=b,!1});return c}return null},callChild:function(a,b){0!=this.children.length&&(a&&"string"!=typeof a&&(b=a,a=null),a=a||arguments.callee.caller.$name,this.each(function(c,d){b?d[a].apply(d,b):d[a].call(d)}))},add:function(a,b){if(!this._applyArray()){var c=void 0==b;if(this.startParseItems){if(a instanceof d)a.parent=this;else{this.defItem&&$H.extend(a,this.defItem,{notCover:!0});this.parseItem(a);var f=this.manager.getClass(a.xtype);if(f){var g=a.renderTo;!this.inited&&
($H.isStr(g)&&0==g.indexOf(">"))&&(g=null);g||(this.inited?a.renderTo=this.getEl():a.autoRender=!1);a.parent=this;a=new f(a)}else $D.error("xtype:"+a.xtype+"\u672a\u627e\u5230")}f=this.children;c?f.push(a):f.splice(b,0,a);this.trigger("add",a);return a}f=this.items;c?f.push(a):f.splice(b,0,a)}},remove:function(a){if(!this._applyArray()){var b=this.children,c=!1,f;if($H.isNum(a))f=a,a=b[f];else if($H.isStr(a)||$H.isFunc(a)){a=this.find(a);for(var g=0,n=a.length;g<n;g++){if(!1==this.remove(a[g]))return!1;
c=!0}}else if(a instanceof d)if(a.parent==this){g=0;for(n=b.length;g<n;g++)if(b[g]==a){f=g;break}}else return a.parent.remove(a);void 0!=f&&!1!=a.destroy(!0)&&(b.splice(f,1),c=!0);this.trigger("remove",a);return c}},parseItem:function(){},parseItems:function(){this.startParseItems=!0;var a=this.items;if(a)for(var a=$H.isArr(a)?a:[a],b=0,c=a.length;b<c;b++)this.add(a[b])},beforeUpdate:function(){return this.trigger("beforeUpdate")},update:function(a,b){if(!1==this.beforeUpdate())return!1;a=a||{};var c=
this.parent,d=$("<span></span>").insertBefore(this.getEl());b||(void 0==a.autoRender&&(a.autoRender=!0),a=$H.extend(a,this.initParam,{notCover:!0}));a=$H.extend(a,{xtype:this.xtype,renderBy:"replaceWith",renderTo:d},{notCover:["xtype"]});if(!a.cid||a.cid==this.cid)a._id=this._id;if(c){var f=this.index();if(!1==c.remove(this))return d.remove(),!1;c=c.add(a,f)}else{if(!1==this.destroy())return d.remove(),!1;c=new this.constructor(a)}this.trigger("update",c);this.afterUpdate(c);return c},replace:function(a){return this.update(a,
!0)},afterUpdate:function(a){this.trigger("afterUpdate",a)},beforeDestroy:function(){return this.trigger("beforeDestroy")},destroy:function(a){if(!1==this.beforeDestroy())return!1;if(!this.destroyed)return this.callChild(),this.trigger("destroy"),this.clearListeners(),this.getEl().remove(),this.destroyed=!0,!a&&this.parent&&this.parent.remove(this),this.manager.unregister(this),delete this.initParam,delete this._container,delete this.renderTo,delete this._listeners,delete this.children,this.afterDestroy(),
!0},afterDestroy:function(){this.trigger("afterDestroy")}},{extend:function(a){var b=this.prototype;$H.extend(b,a,{notCover:function(c){if($H.contains(["_customEvents","listeners"],c))return b[c]=(a[c]||[]).concat(b[c]||[]),!0;if("xtype"==c||"constructor"==c)return!0}})},html:function(a){return(new this($H.extend({autoRender:!1},a))).getHtml()}});return d});
$Define("C.ComponentManager",["CM.AbstractManager","CM.ViewManager"],function(g,b){var f=g.derive({type:"component",initialize:function(){var a=$H.getSingleton(b);this._types=a._types;this._all=a._all}});$CM=new f;return f});
$Define("C.AbstractComponent",["CM.ViewManager","CM.View"],function(g,b){$C=$H.ns("C",{});var f=$H.createClass();$H.inherit(f,b,{xtype:"AbstractComponent",activeCls:"hui-active",hasConfig:function(a,b){if(!b)return!1;if($H.isArr(b))for(var d=0,e=b.length;d<e;d++){if(this.match(a,b[d]))return!0}else if(this.match(a,b))return!0;return!1},doConfig:function(){this.callSuper();this.cls||(this.cls=this.xtype.toLowerCase());this.extCls=this.getExtCls();this.icon&&this.add({xtype:"Icon",name:this.icon});
this.isMini&&(this.defItem=$H.extend({isMini:!0},this.defItem))},getExtCls:function(){var a=["js-component","hui-"+this.cls];this.extCls&&a.push(this.extCls);this.tType&&a.push("hui-"+this.cls+"-"+this.tType);this.theme&&a.push("hui-"+this.cls+"-"+this.theme);this.radius&&a.push("hui-radius-"+this.radius);this.isMini&&a.push("hui-mini");this.shadow&&a.push("hui-shadow");this.shadowSurround&&a.push("hui-shadow-surround");this.shadowOverlay&&a.push("hui-shadow-overlay");this.shadowInset&&a.push("hui-shadow-inset");
this.isActive&&a.push(this.activeCls);this.isFocus&&a.push("hui-focus");this.isInline&&a.push("hui-inline");return 0<a.length?a.join(" "):""},active:function(){this.getEl().addClass(this.activeCls)},unactive:function(){this.getEl().removeClass(this.activeCls)},txt:function(a){var b=this.findEl(".js-"+this.cls+"-txt");0==b.length&&(b=this.findEl(".hui-"+this.cls+"-txt"));if(void 0!=a)b.text(a);else return b.text()},valid:function(){var a=this.validator;if(a){var b=this.val();a.error||(a.error=function(a){new $C.Tips({text:a,
theme:"error"})});return a=$H.Validator.valid(b,a)}for(var b=this.children,d=0,e=b.length;d<e;d++)if(a=b[d].valid(),!a)return a;return!0}},{define:function(a,b){var d=$H.createClass();$H.inherit(d,b||f,null,null,{notCover:function(a){return"define"==a}});$H.getSingleton(g).registerType(a,d);return $C[a]=d}});return f});
$Define("C.Icon","C.AbstractComponent",function(g){g=g.define("Icon");g.extend({tmpl:'<span class="<%if(this.isAlt){%> hui-alt-icon<%}%> hui-icon-<%=this.name%><%if(!this.noBg){%> hui-icon-bg<%}%>"></span>',doConfig:function(b){$H.isStr(b)&&(b={name:b});this.callSuper([b])}});return g});
$Define("C.Button","C.AbstractComponent",function(g){g=g.define("Button");g.extend({iconPos:"left",theme:"gray",activeCls:"hui-btn-active",cls:"btn",defItem:{xtype:"Icon"},radius:"normal",shadow:!0,isInline:!0,tmpl:'<a href="javascript:;" hidefocus="true" class="<%if(!this.text){%> hui-btn-icon-notxt<%}if(this.isBack){%> hui-btn-back<%}if(this.hasIcon&&this.text){%> hui-btn-icon-<%=this.iconPos%><%}%>"><span class="hui-btn-txt"><%=this.text%></span><%=this.findHtml(">*")%></a>',parseItem:function(b){"Icon"==
b.xtype&&(this.hasIcon=!0)}});return g});
$Define("C.Panel","C.AbstractComponent",function(g){g=g.define("Panel");g.extend({isLoading:!1,loadingTxt:"\u6b63\u5728\u52a0\u8f7d\u4e2d...",tmpl:'<div><%if(this.isLoading){%><div class="hui-panel-loading"><div class="hui-mask"></div><div class="hui-loading-container"><div class="hui-tips hui-tips-big hui-tips-black hui-radius-little"><span class="hui-icon hui-icon-loading"></span><span class="hui-tips-txt"><%=this.loadingTxt%></span></div></div></div><%}%><%=this.content||this.findHtml(">*")%></div>'});return g});
$Define("C.Popup","C.AbstractComponent",function(g){g=g.define("Popup");var b=0,f;g.extend({delayShow:!0,clickHide:!0,showPos:"center",destroyWhenHide:!0,shadowOverlay:!0,tmpl:'<div><%=this.findHtml(">*")%></div>',doConfig:function(){this.callSuper();this.clickHide&&this.listeners.push({name:"click",el:$(document),handler:function(){this.hide()}});$H.android()&&(this.listeners.push({name:"show",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.show")&&$("input,textarea,select").attr("disabled",
"disabled")}}),this.listeners.push({name:"hide",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.hide")&&setTimeout(function(){$("input,textarea,select").removeAttr("disabled")},500)}}))},afterShow:function(){var a=this,c=a.getEl();c.css("z-index",1E3*b+1E3);if(!a.width&&a.parent){var d=a.width=a.parent.getEl().outerWidth();c.css("width",d)}c=a.showPos;if("string"==typeof c)a[c]();else"function"==typeof c&&c.call(a);a.noMask||a.mask();a.timeout&&setTimeout(function(){a.destroyed||
a.hide()},a.timeout)},hide:function(){!1!=this.callSuper()&&(this.noMask||this.unmask(),this.destroyWhenHide&&this.destroy())},top:function(){this.getEl().css({left:"80px",top:"8px",position:"fixed"})},center:function(){var a=this.getEl(),b=this.width||a.outerWidth(),d=this.height||a.outerHeight(),e=document,b=((e.documentElement.offsetWidth||e.body.offsetWidth)-b)/2,d=((e.documentElement.clientHeight||e.body.clientHeight)-d)/2+(e.documentElement.scrollTop||e.body.scrollTop),d=10>d?window.screen.height/
2-200:d;a.css({left:b+"px",top:d-(this.offsetTop||0)+"px"})},followEl:function(a){a=(a||this.parent.getEl()).position();this.getEl().css(a)},mask:function(){f||(f=$('<div class="hui-mask" style="display:none;"></div>').appendTo(document.body));f.css("z-index",1E3*b+998);0==b&&f.show();b++},unmask:function(){b--;0==b?f.hide():f.css("z-index",1E3*(b-1)+998)}});return g});
$Define("C.ControlGroup","C.AbstractComponent",function(g){g=g.define("ControlGroup");g.extend({multi:!1,cls:"ctrlgp",defItem:{xtype:"Button",extCls:"js-item",radius:null,shadow:!1,isInline:!1},tmpl:'<div class="<%if(this.direction=="h"){%> hui-ctrlgp-h<%}else{%> hui-ctrlgp-v<%}%>"><%=this.findHtml(">*")%></div>',listeners:[{name:"click",selector:".js-item",method:"delegate",handler:function(b){var f=$(b.currentTarget),f=this.find(">[_id="+f.attr("id")+"]");0<f.length&&(f=f[0].index(),this.onItemClick(b,
f))}}],select:function(b){if(!this.notSelect&&(b="number"==typeof b?this.children[b]:"string"==typeof b?this.find(b)[0]:b))if(!this.multi&&!b.multi){var f=this.getSelected();f&&this.selectItem(f,!1);this.selectItem(b)}else this.selectItem(b,!b.selected)},getSelected:function(b){var f=[];this.each(function(a,c){c.selected&&f.push(b?a:c)});return 0<f.length?this.multi?f:f[0]:null},selectItem:function(b,f){(f=!1!=f)?(b.selected=f,b.select?b.select():b.active()):(b.selected=f,b.select?b.select(f):b.unactive())},
val:function(b){if(b){var f=b.split(",");this.each(function(a,b){b.select($H.contains(f,b.value))})}else return b=this.find(">[selected=true]"),f=[],$H.each(b,function(a,b){f.push(b.value)}),f.join(",")},onItemClick:function(b,f){this.select(f);this.itemClick&&this.itemClick(this.children[f],f)}});return g});
$Define("C.Radio","C.AbstractComponent",function(g){g=g.define("Radio");g.extend({tmpl:'<div class="hui-btn hui-btn-gray<%if(this.selected){%> hui-radio-on<%}%>"><span class="hui-icon hui-icon-radio"></span><input type="radio"<%if(this.selected){%> checked=true<%}%><%if(this.name){%> name="<%=this.name%>"<%}%><%if(this.value){%> value="<%=this.value%>"<%}%>/><span class="hui-radio-txt"><%=this.text%></span></div>',select:function(b){this.selected=b=!1!=b;var f=this.findEl("input"),a=this.getEl();
b?(f.attr("checked",!0),a.addClass("hui-radio-on")):(f.removeAttr("checked"),a.removeClass("hui-radio-on"))},val:function(b){if(b)this.value=b,this.findEl("input").val(b);else return this.value}});return g});
$Define("C.Checkbox","C.AbstractComponent",function(g){g=g.define("Checkbox");g.extend({text:"",value:"",selected:!1,multi:!0,cls:"chkbox",tmpl:'<div class="hui-btn hui-btn-gray<%if(this.selected){%> hui-chkbox-on<%}%>"><span class="hui-icon hui-icon-chkbox"></span><input type="checkbox"<%if(this.selected){%> checked=true<%}%><%if(this.name){%> name="<%=this.name%>"<%}%><%if(this.value){%> value="<%=this.value%>"<%}%>/><span class="hui-chkbox-txt"><%=this.text%></span></div>',select:function(b){this.selected=
b=!1!=b;var f=this.findEl("input"),a=this.getEl();b?(f.attr("checked",!0),a.addClass("hui-chkbox-on")):(f.removeAttr("checked"),a.removeClass("hui-chkbox-on"))},val:function(b){if(b)this.value=b,this.findEl("input").val(b);else return this.value}});return g});
$Define("C.Select","C.AbstractComponent",function(g){g=g.define("Select");g.extend({text:"\u8bf7\u9009\u62e9...",value:"",radius:"little",optionClick:function(){},defItem:{xtype:"Menu",hidden:!0,markType:"dot",renderTo:"body"},_customEvents:["change"],tmpl:'<div class="hui-btn hui-btn-gray hui-btn-icon-right"><span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span><input value="<%=this.value%>" name="<%=this.name%>"/><span class="hui-btn-txt js-select-txt"><%=this.text%></span></div>',
listeners:[{name:"click",handler:function(){this.showOptions()}}],doConfig:function(b){var f=this;f.callSuper();for(var a=b.options,c=!1,d=0,e=a.length;d<e;d++){var g=a[d];if(g.value==b.value){f.text=g.text;c=g.selected=!0;break}}c||delete f.value;f.add({itemClick:function(a){f.val(a.value)},width:f.width,items:a})},showOptions:function(){this.children[0].show()},val:function(b){if(b){if(this.value!=b){var f=this.children[0],a=f.find(">[value="+b+"]");0<a.length&&(this.trigger("change"),a=a[0],this.value=
b,this.findEl("input").attr("value",b),this.txt(a.text),f.select(a))}}else return this.value}});return g});
$Define("C.Input","C.AbstractComponent",function(g){g=g.define("Input");g.extend({radius:"little",iconPos:"left",btnPos:"right",tmpl:'<div class="<%if(this.hasIcon){%> hui-input-icon-<%=this.iconPos%><%}%><%if(this.hasBtn){%> hui-input-btn-<%=this.btnPos%><%}%>"><%=this.findHtml(">*")%><%if(this.type=="textarea"){%><textarea class="js-input"<%}else{%><input type="text" class="js-input hui-input-txt"<%}%>  name="<%=this.name%>"<%if(this.placeholder){%> placeholder="<%=this.placeholder%>"<%}%><%if(this.type=="textarea"){%>><%=this.value%></textarea><%}else{%> value="<%=this.value%>"/><%}%> </div>',listeners:[{name:"focus",
el:".js-input",handler:function(){this.getEl().addClass("hui-focus")}},{name:"blur",el:".js-input",handler:function(){this.getEl().removeClass("hui-focus")}}],doConfig:function(b){var f=this;"search"==b.type&&(f.icon="search");f.callSuper();"textarea"==f.type&&f.listeners.push({name:"input propertychange",el:".js-input",handler:function(){var a=f.findEl(".js-input"),b=a[0].scrollHeight;50<=b&&a.css("height",b)}});f.withClear&&f.add({xtype:"Button",radius:"big",icon:"delete",click:function(){this.parent.findEl("input").val("").focus()}})},
parseItem:function(b){"Icon"==b.xtype?this.hasIcon=!0:"Button"==b.xtype&&(this.hasBtn=!0)},val:function(b){var f=this.findEl("input,textarea");if(b)f.val(b);else return f.val()},focus:function(){this.findEl("input").focus()}});return g});$Define("C.Label","C.AbstractComponent",function(g){g=g.define("Label");g.extend({tmpl:'<label class="<%if(this.color){%> hui-label-<%=this.color%><%}%><%if(this.textAlign){%> c-txt-<%=this.textAlign%><%}%>" for="<%=this.forName%>"><%=this.text%></label>'});return g});
$Define("C.RowItem","C.AbstractComponent",function(g){g=g.define("RowItem");g.extend({cls:"rowitem",tmpl:'<div class="<%if(this.text){%> hui-rowitem-txt<%}%><%if(this.underline){%> hui-rowitem-underline<%}%>"><%=this.text%><%=this.findHtml(">*")%><%if(this.hasArrow){%><a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="\u8be6\u60c5"><span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span></a><%}%></div>',doConfig:function(b){this.callSuper();this.text||(this.text=
"&nbsp;");this.text&&void 0==this.underline&&(this.underline=!0);b.click&&void 0==this.hasArrow&&(this.hasArrow=!0)}});return g});$Define("C.Set","C.AbstractComponent",function(g){g=g.define("Set");g.extend({tmpl:'<div><h1 class="hui-set-title"><%=this.title%></h1><div class="hui-set-content"><%=this.findHtml(">*")%></div></div>'});return g});
$Define("C.Field","C.AbstractComponent",function(g){g=g.define("Field");g.extend({defItem:{xtype:"RowItem",xrole:"content"},tmpl:'<div class="<%if(this.noPadding){%> hui-field-nopadding<%}%>"><div class="hui-field-left"><%=this.findHtml(">[xrole=title]")%></div><div class="hui-field-right"><%=this.findHtml(">[xrole=content]")%></div></div>',doConfig:function(b){this.callSuper();var f=this.title;$H.isSimple(f)&&(f={text:f});f=$H.extend({xtype:"Label",xrole:"title"},f);this.add(f);f=this.content;void 0==
f&&!b.items&&(f="");$H.isSimple(f)&&(f={text:f,underline:!0});f&&(this.noPadding=!0,this.add(f))}});return g});$Define("C.Form","C.AbstractComponent",function(g){g=g.define("Form");g.extend({tmpl:'<div><form action=""><div class="hui-form-tips c-txt-error"></div><%=this.findHtml(">*")%></form></div>'});return g});
$Define("C.TabItem",["C.AbstractComponent","C.Panel"],function(g){g=g.define("TabItem");g.extend({defItem:{xtype:"Button",xrole:"title",radius:null,isInline:!1,iconPos:"top",shadow:!1},extCls:"js-item",tmpl:'<div><%=this.findHtml(">[xrole=title]")%></div>',initialize:function(){this.callSuper();this.titleCmp=this.find(">[xrole=title]")[0];this.contentCmp=this.find(">[xrole=content]")[0]},doConfig:function(b){this.callSuper();var f=b.title;"string"==typeof f&&(f={text:f});"object"==typeof f&&this.add(f);
b=b.content;"string"==typeof b&&(b={xtype:"Panel",content:b});"object"==typeof b&&($H.extend(b,{xrole:"content",hidden:!this.selected,extCls:"js-content"}),this.add(b));this.activeType&&(this.defItem.activeCls="hui-btn-active-"+this.activeType)},parseItem:function(b){this.selected&&"title"==b.xrole&&(b.isActive=!0)},select:function(b){var f=this.titleCmp,a=this.contentCmp;!1==b?(f.unactive(),a&&a.hide()):(f.active(),a&&a.show())},getContent:function(b,f){f||(f=this.contentCmp);return this.callSuper([b,
f])},setContent:function(b,f){f||(f=this.contentCmp);return this.callSuper([b,f])}});return g});
$Define("C.Tab",["C.AbstractComponent","C.TabItem","C.ControlGroup"],function(g,b,f){g=g.define("Tab",f);g.extend({cls:"tab",defItem:{xtype:"TabItem"},listeners:[{name:"afterRender add remove",custom:!0,handler:function(){this.layout()}}],tmpl:'<div><ul class="js-tab-btns c-clear"><%var aBtns=this.find(">TabItem");for(var i=0,len=aBtns.length;i<len;i++){%><li class="hui-tab-item"><%=aBtns[i].getHtml()%></li><%}%></ul><%=this.findHtml(">TabItem>[xrole=content]")%></div>',doConfig:function(){this.callSuper();
this.activeType&&(this.defItem.activeType=this.activeType)},layout:function(){var a=this.children.length,b=Math.floor(100/a);this.findEl(".js-tab-btns>li").each(function(d,e){e.style.width=d<a-1?b+"%":100-b*(a-1)+"%"})},setTabContent:function(a,b){b=b||this.getSelected(!0);this.findEl(".js-tab-content").index(b).html(a)}});return g});
$Define("C.Toolbar","C.AbstractComponent",function(g){g=g.define("Toolbar");g.extend({cls:"tbar",defItem:{xtype:"Button",theme:"black"},tmpl:'<div class="<%if(this.type=="header"){%> hui-header<%}else if(this.type=="footer"){%> hui-footer<%}%>"><%=this.findHtml(">*")%><%if(this.title){%><h1 class="hui-tbar-title js-tbar-txt"><%=this.title%></h1><%}%></div>',parseItem:function(b){"Button"==b.xtype&&(b.shadowSurround=!0,"left"==b.pos?b.extCls=(b.extCls||"")+" hui-tbar-btn-left":"right"==b.pos&&(b.extCls=
(b.extCls||"")+" hui-tbar-btn-right"))}});return g});
$Define("C.Tips",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(g,b){var f=g.define("Tips",b);f.extend({cls:"tips",tType:"big",theme:"black",timeout:1E3,radius:"normal",tmpl:'<div class="<%if(!this.text){%> hui-tips-notxt<%}%>"><%=this.findHtml(">*")%><%if(this.text){%><span class="hui-tips-txt"><%=this.text%></span><%}%></div>',doConfig:function(a){"loading"==a.type?$H.extend(this,{text:"\u6b63\u5728\u52a0\u8f7d\u4e2d...",timeout:null,noMask:!0,icon:"loading"}):"miniLoading"==a.type?
$H.extend(this,{showPos:"top",clickHide:!1,destroyWhenHide:!1,timeout:null,delayShow:!1,shadowOverlay:null,theme:null,noMask:!0,tType:"mini",items:{xtype:"Icon",name:"loading-mini",noBg:!0}}):"topTips"==a.type&&$H.extend(this,{showPos:"top",noMask:!0,tType:"mini"});this.callSuper()}});return f});
$Define("C.Dialog",["C.AbstractComponent","C.Popup"],function(g,b){var f=g.define("Dialog",b);$H.extend(f,{alert:function(a){return new f({contentMsg:a,noClose:!0,noCancel:!0})},confirm:function(a,b){return new f({contentMsg:a,noClose:!0,okCall:function(){return b&&b(!0)},cancelCall:function(){return b&&b(!1)}})},prompt:function(a,b,d){d||(d=b,b="");return new f({contentMsg:a,noClose:!0,items:{xtype:"Input",xrole:"dialog-content",value:b},okCall:function(){var a=this.find("Input")[0].val();return d&&
d(a)}})}});f.extend({okTxt:"\u786e\u5b9a",cancelTxt:"\u53d6\u6d88",clickHide:!1,radius:"little",tmpl:'<div><%=this.findHtml(">[xrole=dialog-header]")%><div class="hui-dialog-body"><%if(this.content){%><%=this.content%><%}else{%><div class="hui-body-content"><h1 class="hui-content-title"><%=this.contentTitle%></h1><div class="hui-content-msg"><%=this.contentMsg%></div><%=this.findHtml(">[xrole=dialog-content]")%></div><%}%><%if(!this.noAction){%><div class="hui-body-action"><%=this.findHtml(">[xrole=dialog-action]")%></div><%}%></div></div>',
doConfig:function(a){var b=this;b.callSuper();a=a.items;b.title&&!b.hasConfig("[xrole=dialog-header]",a)&&b.add({xtype:"Toolbar",title:b.title,theme:"gray",xrole:"dialog-header",extCls:"hui-dialog-header",items:!b.noClose&&{xtype:"Button",radius:"big",icon:"delete",isMini:!1,theme:"gray",pos:"left",click:function(){b.hide()}}});!b.noAction&&!b.hasConfig("[xrole=dialog-action]",a)&&(a=[],b.noCancel||a.push({title:{isActive:1==b.activeBtn,text:b.cancelTxt,click:function(){!1!=(b.cancelCall&&b.cancelCall())&&
b.hide()}}}),b.noOk||a.push({title:{text:b.okTxt,isActive:2==b.activeBtn,click:function(){!1!=(b.okCall&&b.okCall())&&b.hide()}}}),b.add({xtype:"Tab",xrole:"dialog-action",theme:"border-top",notSelect:!0,items:a}))}});return f});
$Define("C.Menu",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(g,b,f){g=g.define("Menu",b);g.extend(f.prototype);g.extend({notDestroy:!0,cls:"menu",tmpl:'<div class="<%if(this.markType=="dot"){%> hui-menu-mark<%}%>"><ul><%for(var i=0,len=this.children.length;i<len;i++){%><li class="hui-menu-item<%if(this.children[i].selected){%> hui-item-mark<%}%>"><%=this.children[i].getHtml()%><%if(this.markType=="dot"){%><span class="hui-icon-mark"></span><%}%></li><%}%></ul></div>',selectItem:function(a,
b){b=!1!=b;"dot"==this.markType?(a.selected=b,a.getEl().parent()[!1==b?"removeClass":"addClass"]("hui-item-mark")):"active"==this.markType?f.prototype.selectItem.call(this,a,b):a.selected=b}});return g});
$Define("C.Hcard","C.AbstractComponent",function(g){g=g.define("Hcard");g.extend({tmpl:'<div class="hui-hcard<%if(this.image){%> hui-hcard-hasimg"><div class="hui-hcard-img"><img src="<%=this.image%>"></div><%}else{%>"><%}%><div class="hui-hcard-content"><div class="hui-content-title"><%=this.title%></div><%var aDesc=this.desc;aDesc=$H.isArr(aDesc)?aDesc:[aDesc];for(var i=0;i<aDesc.length;i++){%><div class="hui-content-desc"><%var icon;if(icon=aDesc[i].icon){%><span class="hui-icon hui-mini hui-alt-icon hui-icon-<%=icon%> hui-light"></span><%}%><%=aDesc[i].text%></div><%}%></div><%=this.findHtml(">*")%><%if(this.hasArrow){%><a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="\u8be6\u60c5"><span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span></a><%}%></div>',doConfig:function(b){this.callSuper();
b.click&&void 0==this.hasArrow&&(this.hasArrow=!0)}});return g});
$Define("C.Vcard","C.AbstractComponent",function(g){g=g.define("Vcard");g.extend({tmpl:'<div class="hui-vcard"><div class="hui-vcard-title hui-title-hasimg c-clear"><div class="hui-title-img"><img alt="" src="<%=this.image%>"></div><div class="hui-title-txt"><%=this.title%></div><div class="hui-title-extra"><%=this.extraTitle%></div></div><%=this.findHtml(">[xrole!=action]")%><div class="hui-vcard-action"><%=this.findHtml(">[xrole=action]")%></div></div>',doConfig:function(b){this.callSuper();if(b=
b.action)b=$H.extend({xtype:"Button",radius:null,isInline:!1,xrole:"action"},b),this.add(b)}});return g});
$Define("C.ModelList","C.AbstractComponent",function(g){g=g.define("ModelList");g.extend({emptyTips:"\u6682\u65e0\u7ed3\u679c",pdText:"\u4e0b\u62c9\u53ef\u5237\u65b0",pdComment:"\u4e0a\u6b21\u5237\u65b0\u65f6\u95f4\uff1a",tmpl:'<div class="hui-list"><div class="hui-list-inner"><div<%if(this.children.length>0){%> style="display:none"<%}%> class="hui-list-empty js-empty"><%=this.emptyTips%></div><%if(this.hasPullRefresh){%><div class="hui-list-pulldown hui-pd-pull c-h-middle-container"><div class="c-h-middle"><span class="hui-icon hui-alt-icon hui-icon-arrow-d hui-light"></span><span class="hui-icon hui-alt-icon hui-icon-loading-mini"></span><div class="hui-pd-txt"><%if(this.pdText){%><div class="js-txt"><%=this.pdText%></div><%}%><%if(this.pdComment){%><div class="js-comment hui-pd-comment"><span class="js-pdComment"><%=this.pdComment%></span><span class="js-pdTime"><%=this.pdTime%></span></div><%}%></div></div></div><%}%><div class="js-item-container"><%=this.findHtml(">*")%></div><%if(this.hasPullRefresh){%><div class="hui-list-more"><a href="javascript:;" hidefocus="true" class="hui-btn hui-btn-gray hui-shadow hui-inline hui-radius-normal"><span class="hui-btn-txt">\u67e5\u770b\u66f4\u591a</span></a></div><%}%></div></div>',init:function(){var b=
this;b.itemXtype&&((b.defItem||(b.defItem={})).xtype=b.itemXtype);var f=b.model;f.each(function(a,c){b.addListItem(c)});b.listenTo(f,{add:function(a,c){b.addListItem(c)},remove:function(a,c){b.removeListItem(c)},reset:function(){b.removeListItem("emptyAll")}});b.hasPullRefresh=b.hasPullRefresh&&window.iScroll;b.hasPullRefresh&&(b.listen({name:"afterRender",handler:function(){var a=this,b=a.getEl(),d=b.find(".hui-list-pulldown"),e=d.find(".js-txt");a.scroller=new window.iScroll(b[0],{useTransition:!0,
topOffset:50,onRefresh:function(){d.hasClass("hui-pd-refresh")&&(d.removeClass("hui-pd-refresh hui-pd-release"),e.html("\u4e0b\u62c9\u53ef\u5237\u65b0"))},onScrollMove:function(){5<this.y&&!d.hasClass("hui-pd-release")?(d.addClass("hui-pd-release"),e.html("\u677e\u5f00\u53ef\u5237\u65b0"),this.minScrollY=0):5>this.y&&d.hasClass("hui-pd-release")&&(d.removeClass("hui-pd-release"),e.html("\u4e0b\u62c9\u53ef\u5237\u65b0"),this.minScrollY=-50)},onScrollEnd:function(){d.hasClass("hui-pd-release")&&(d.addClass("hui-pd-refresh"),
e.html("\u6b63\u5728\u5237\u65b0"),a.refresh())}})}}),b.listenTo(b.model,"sync",function(){b.findEl(".js-pdTime").html($H.formatDate($H.now(),"HH:mm"));setTimeout(function(){b.refreshScroller()},0)}),b.listen({name:"afterShow",handler:function(){b.refreshScroller()}}),b.listen({name:"click",method:"delegate",selector:".hui-list-more",handler:function(){b.getMore()}}))},addListItem:function(b){this.inited&&this.findEl(".js-empty").hide();this.add({model:b,renderTo:">.js-item-container"})},removeListItem:function(b){"emptyAll"==
b?this.remove(this.children):this.remove(function(f){return f.model&&f.model.id==b.id});0==this.children.length&&this.findEl(".js-empty").show()},refreshScroller:function(){this.scroller&&this.getEl()[0].clientHeight&&this.scroller.refresh()},destroy:function(){this.scroller&&(this.scroller.destroy(),this.scroller=null);this.callSuper()}});return g});
$Define("M.AbstractModule","CM.View",function(g){var b=$H.createClass();$H.inherit(b,g,{useCache:$H.noop,cache:$H.noop,init:$H.noop,reset:$H.noop,exit:function(){return!0},cleanCache:function(){this.clearCache=!0}});return b});$Define("M.AbstractNavigator","handy.base.Object",function(g){var b=$H.createClass();g.extend(b.prototype,{navigate:function(){}});return b});
$Define("M.History","handy.base.HashChange",function(g){var b=$H.createClass(),f=0;$H.extend(b.prototype,{initialize:function(a,b){"function"==typeof a&&(b=a,a=null);this.error=b||$H.noop;this.key=a||"handy";this.states=[];g.listen($H.Function.bind(this.stateChange,this))},stateChange:function(){var a=this.getHashParam(),b=a.hKey,d=this.currentKey,e=this.states,f=e[d];if(b==d)return!1;(e=e[b])?a=e.onStateChange(e.param,!0):($D.warn("hisory state not found"),a=this.error("stateNotFound",a));!0!=a?
(a={hKey:d,param:f.param},this.saveHash(a)):this.currentKey=b},saveState:function(a){var b=this.currentKey=this.key+ ++f;this.states.push(b);this.states[b]=a;this.saveHash({hKey:b,param:a.param})},saveHash:function(a){$H.setHash("#"+$H.Json.stringify(a))},getHashParam:function(){try{var a=$H.getHash().replace("#","");return $H.parseJson(a)}catch(b){$H.Debug.warn("History.getCurrentState:parse hash error:"+b.message)}},getCurrentState:function(){try{var a=this.getHashParam();return this.states[a.hKey]}catch(b){$H.Debug.warn("History.getCurrentState:parse hash error:"+
b.message)}},getPreState:function(){try{for(var a=this.getHashParam().hKey,b=this.states,d=b.length,e=0;e++;e<d)if(b[e]==a)return 0<e?b[b[--e]]:null}catch(f){$H.Debug.error("History.getPreState error:"+f.message,f)}},back:function(){var a=this.getPreState();if(a)a.onStateChange(a.param)}});return b});
$Define("M.ModuleManager",["M.History","CM.AbstractManager"],function(g,b){var f=$H.createClass();$H.inherit(f,b,{type:"module",_createMod:function(a){var b=this,d=a.modName;b.modules[d]={waiting:!0};$Require(b.defModPackage+d,function(e){var f={renderTo:b.container,name:d,xtype:d,_id:b.generateId(),extCls:"js-module m-module m-"+d.replace(/\./g,"-"),hidden:!0};$H.extend(f,a);e=new e(f);b.modules[d]=e;$H.trigger("afterRender",e.getEl());b.requestMod==d&&b._showMod(e)})},_showMod:function(a){var b=
this.modules[this.currentMod];if(!this.navigator||!this.navigator.navigate(a,b,this))b&&b.hide(),a.show();b&&(b.isActive=!1);a.isActive=!0;this.currentMod=a.name},_destroy:function(a){a.destroy();delete this.modules[a.name]},initialize:function(a){var b=this;a&&(b.conf=a,$H.extend(b,a),b.container=a.container?$(a.container):$(document.body));b.defModPackage+=".";b.history=new g(function(a,e){b.go(e.param)});b.modules={}},go:function(a,b){"string"==typeof a&&(a={modName:a});var d=a.modName,e=this.currentMod,
f=this.modules,g=f[e];if(e==d)g.waiting||g.reset();else{if(g&&!g.waiting)if(g._forceExit)g._forceExit=!1;else if(!1==g.exit())return!1;this.requestMod=d;(d=f[d])?!0!=d.notCache&&!0!=d.clearCache&&!1!=d.useCache(a)?(!1==d.clearCache,this._showMod(d),d.cache(a)):d.waiting||(this._destroy(d),this._createMod(a)):this._createMod(a);!0!=b&&this.history.saveState({onStateChange:$H.Function.bind(this.go,this),param:a});return!0}},update:function(a,b){var d=a.update(b);d&&(this.modules[a.name]=d,$H.trigger("afterRender",
d.getEl()));return d},clearCache:function(a){a.notCache=!0},back:function(a){a&&(this.modules[this.currentMod]._forceExit=!0);history.back()}});return f});
