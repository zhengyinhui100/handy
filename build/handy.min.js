/* Handy v1.0.0-dev | 2014-05-21 | zhengyinhui100@gmail.com */
(function(){var f=window.handy,d=window.$,b=window.handy=window.$=function(){};b.version="1.0.0";b.isDebug="undefined"==typeof gEnv?!1:"dev"==gEnv;b.expando="handy"+(b.version+Math.random()).replace(/\D/g,"");b.add=function(a,c,g){g||(g=c,c=null);b.base||(b.base={});var e=[];if(c)if("string"==typeof c)e.push(b.base.Object.ns(c));else for(var d=0;d<c.length;d++)e.push(b.base.Object.ns(c[d]));e.push(b);c=g.apply(window,e);b.base[a]=b[a]=c;if(0<="Browser,Class,Array,Geo,Cookie,Date,Events,Function,Json,Object,String,Template,Util".indexOf(a))for(var j in c)b.isDebug&&
("undefined"!=typeof b[j]&&"console"in window&&!Function[j])&&(console.log(b[j]),console.log(a+"\u547d\u540d\u51b2\u7a81:"+j)),b[j]=c[j]};b.noConflict=function(a){window.$===b&&(window.$=d);a&&window.handy===b&&(window.handy=f);return b};b.noop=function(){}})();
handy.add("Json",function(){function f(a){e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(a){var e=h[a];return"string"===typeof e?e:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));return'"'+a+'"'}function d(e,b){var h,j,k,l,m=c,y,s=b[e];s&&("object"===typeof s&&"function"===typeof s.toJSON)&&(s=s.toJSON(e));"function"===typeof a&&(s=a.call(b,e,s));switch(typeof s){case "undefined":return"undefined";case "string":return f(s);case "number":return isFinite(s)?String(s):"null";case "boolean":case "null":return String(s);
case "object":if(!s)return"null";c+=g;y=[];if("[object Array]"===Object.prototype.toString.apply(s)){l=s.length;for(h=0;h<l;h+=1)y[h]=d(h,s)||"null";k=0===y.length?"[]":c?"[\n"+c+y.join(",\n"+c)+"\n"+m+"]":"["+y.join(",")+"]";c=m;return k}if(a&&"object"===typeof a){l=a.length;for(h=0;h<l;h+=1)"string"===typeof a[h]&&(j=a[h],(k=d(j,s))&&y.push(f(j)+(c?": ":":")+k))}else for(j in s)Object.prototype.hasOwnProperty.call(s,j)&&(k=d(j,s))&&y.push(f(j)+(c?": ":":")+k);k=0===y.length?"{}":c?"{\n"+c+y.join(",\n"+
c)+"\n"+m+"}":"{"+y.join(",")+"}";c=m;return k}}var b="JSON"in window,a,c,g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k=/^[\],:{}\s]*$/,l=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,m=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
p=/(?:^|:|,)(?:\s*\[)+/g;return{stringify:function(e,h,j,f){if(b&&!f)return JSON.stringify.apply(null,arguments);var k;g=c="";if("number"===typeof j)for(k=0;k<j;k+=1)g+=" ";else"string"===typeof j&&(g=j);if((a=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return d("",{"":e})},parseJson:function(a,e,c){function g(a,c){var b,d,h=a[c];if(h&&"object"===typeof h)for(b in h)Object.prototype.hasOwnProperty.call(h,
b)&&(d=g(h,b),void 0!==d?h[b]=d:delete h[b]);return e.call(a,c,h)}if(b&&!c)return JSON.parse.apply(null,arguments);var d;a=String(a);j.lastIndex=0;j.test(a)&&(a=a.replace(j,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(k.test(a.replace(l,"@").replace(m,"]").replace(p,"")))return d=eval("("+a+")"),"function"===typeof e?g({"":d},""):d;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var f;f=(f=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(f[0])?function(a,c,g){var e=[];if(a.length){c=c||0;for(g=g||a.length;c<g;c++)e.push(a[c])}return e}:function(a,c,g){return Array.prototype.slice.call(a,c||0,g||a.length)};var d={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},ns:function(a,c){var g=null,e,b,j,f;a=d.alias(a);b=a.split(".");g=b[0];g=(j=2==arguments.length)?eval("(function(){if (typeof "+g+' == "undefined"){'+
g+" = {};}return "+g+";})()"):eval("(function(){if (typeof "+g+' != "undefined")return '+g+";})()");e=1;for(f=b.length;e<f;++e){if(e==f-1&&j)g[b[e]]=c;else if(j||g&&g[b[e]])g[b[e]]=g[b[e]]||{};else return;g=g[b[e]]}return g},alias:function(a,c){var g=d._alias;if(c)g[a]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+a+":"+g[a]):g[a]=c;else{if(a){var e=a,b=a.length-1;do{if(g[e])return g[e]+a.substring(b);b=e.lastIndexOf(".")}while(0<b&&(e=e.substring(0,b)));return a}return g}},extend:function(a,c,
g){if(!c||d.isStr(c)||d.isNum(c))return a;var e=g?g.notCover:!1,b=g?g.cover:null;g=g?g.IsClone:!1;a=a||{};var j=a.constructor,f=j.$isClass,l,m;for(m in c)if(l=c[m],(!b||d.contains(b,m))&&c.hasOwnProperty(m)){var p=a.hasOwnProperty(m),q=!0===e?p:!1;d.isArr(e)?q=d.contains(e,m)&&p:d.isFunc(e)&&(q=e(m,l));q||(l=g?d.clone(l):l,f&&d.isFunc(l)&&(l.$name=m,l.$owner=j),a[m]=l)}return a},extendIf:function(a,c){return d.extend(a,c,{notCover:!0})},mix:function(a,c,g){a.superProto||(a.superProto={});for(var e in c)a.superProto[e]=
d.isFunc(c[e])?a.superProto[e]?function(a,e){return function(){e.apply(this,arguments);c[a].apply(this,arguments)}}(e,a.superProto[e]):c[e]:c[e],a[e]||(a[e]=c[e]);g&&d.extend(a,g);c.toString!=c.constructor.prototype.toString&&(a.superProto.toString=function(){c.toString.apply(a,arguments)});return a},isNum:function(a){return"number"==typeof a},isStr:function(a){return"string"==typeof a},isBool:function(a){return"boolean"==typeof a},isSimple:function(a){return d.isStr(a)||d.isNum(a)||d.isBool(a)},
isUndef:function(a){return"undefined"==typeof a},isFunc:function(a){return"[object Function]"===b.prototype.toString.call(a)},isArr:function(a){return"[object Array]"===b.prototype.toString.call(a)},isObj:function(a){return"object"==typeof a&&!d.isArr(a)},isClass:function(a){return d.isFunc(a)&&!0===a.$isClass},equals:function(a,c){if(typeof a==typeof c){if("object"!=typeof a)return a===c;if(a===c)return!0;if(d.isArr(a)&&d.isArr(c)){if(a.length!=c.length)return!1;for(var g=0,e=a.length;g<e;g++)if(!d.equals(a[g],
c[g]))return!1;return!0}if(!d.isArr(a)&&!d.isArr(c)){if(d.count(a)!=d.count(c))return!1;for(g in a)if(void 0===c[g]||!d.equals(a[g],c[g]))return!1;return!0}}return!1},clone:function(a){if(null==a||"object"!=typeof a)return a;var c=a.constructor;if(c!=b&&c!=window.Array)return a;if(c==window.Date||c==window.RegExp||c==window.Function||c==window.String||c==window.Number||c==window.Boolean)return new c(a);try{var g=new c,e;for(e in a)g[e]=d.clone(a[e]);return g}catch(h){return a}},isEmpty:function(a){if(d.isArr(a))return 0==
a.length;for(var c in a)return!1;return!0},each:function(a,c,g){if(a){var e,b=0,j=a.length,f=void 0===j||d.isFunc(a);if(g)if(f)for(e in a){if(!1===c.apply(a[e],g))break}else for(;b<j&&!1!==c.apply(a[b],g);)e=a.length,j==e?b++:j=e;else if(f)for(e in a){if(!1===c.call(a[e],e,a[e]))break}else for(;b<j&&!1!==c.call(a[b],b,a[b]);)e=a.length,j==e?b++:j=e;return a}},contains:function(a,c){if(!a)return!1;var g=!1;d.each(a,function(a,b){if(d.equals(b,c))return g=!0,!1});return g},largeThan:function(a,c){if("object"==
typeof a&&"object"==typeof c){var g=!0;d.each(c,function(e){if(!d.equals(c[e],a[e]))return g=!1});return g}},count:function(a){if(d.isArr(a))return a.length;var c=0,g;for(g in a)c++;return c},removeUndefined:function(a,c){var g=d.isArr(a);if(c){if(g){var e=[];d.each(a,function(a,c){void 0!==c&&e.push(c)});return e}return d.extend({},a,{isClone:!0,notCover:function(a,e){return void 0===e}})}d.each(a,function(e,c){void 0===c&&(g?a.splice(e,1):delete a[e])});return a},toArray:f,fromArray:function(a){for(var c=
{},g=0,e=a.length;g<e;g++){var b=a[g];c[b.name]=b.value}return c},generateMethod:function(a,c,g){c=d.isArr(c)?c:c.split(",");for(var e=0;e<c.length;e++){var b=c[e];a[b]=g(b)}}},b=window.Object;return d});
handy.add("Browser","handy.base.Object",function(f){var d={},b={};f.generateMethod(b,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(a){return function(e){var c=d[a];return!e&&"string"===typeof c&&/^[\d\.]+$/.test(c)?parseInt(c):c}});f=window.navigator.userAgent;var a;(a=f.match(/MSIE ([\d.]+)/))?d.ie=a[1]:(a=f.match(/Firefox\/([\d.]+)/))?d.firefox=a[1]:(a=f.match(/Chrome\/([\d.]+)/))?
d.chrome=a[1]:(a=f.match(/Opera.([\d.]+)/))?d.opera=a[1]:(a=f.match(/Version\/([\d.]+).*Safari/))?d.safari=a[1]:0;/windows|win32/i.test(f)?d.windows=!0:/linux/i.test(f)?d.linux=!0:/macintosh/i.test(f)?d.mac=!0:0;/trident/i.test(f)?d.trident=!0:/webkit/i.test(f)?d.webkit=!0:/gecko/i.test(f)?d.gecko=!0:/presto/i.test(f)?d.presto=!0:0;/MetaSr/i.test(f)?d.sogou=!0:/Maxthon/i.test(f)?d.maxthon=!0:/TencentTraveler/i.test(f)?d.tt=!0:/TheWorld/i.test(f)?d.theWorld=!0:/360[S|E]E/i.test(f)?d.is360=!0:0;var c;
if((c=f.match(/AppleWebKit\/([\d.]*)/))&&c[1])if(/ Mobile\//.test(f)&&f.match(/iPad|iPod|iPhone/)){d.mobile="ios";if((c=f.match(/OS ([^\s]*)/))&&c[1])d.ios=c[1].replace("_",".");if((c=f.match(/iPad|iPod|iPhone/))&&c[0])d[c[0].toLowerCase()]=d.ios}else if(/ Android/i.test(f)){if(/Mobile/.test(f)&&(d.mobile="android"),(c=f.match(/Android ([^\s]*);/))&&c[1])d.android=c[1]}else if(c=f.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))d.mobile=c[0].toLowerCase();var g;try{if(d.ie){var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
e&&(g=e.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(e=navigator.plugins["Shockwave Flash"])){var h=e.description.split(" ");a=0;for(var j=h.length;a<j;a++)if(0<parseInt(h[a])){g=h[a];break}}}catch(k){}d.flash=g?g:null;return b});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(f,d,b){var a={level:b.isDebug?0:5,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!d.mobile(),out:function(c,g,e){e=e||"log";if(g||a.showInPage){var d=b.expando+"debugDiv",j=top.document,f=j.getElementById(d);f?f.style.display="block":(f=j.createElement("DIV"),f.id=d,f.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+j.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u6536\u8d77</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',f.style.position="fixed",f.style.width="100%",f.style.left=0,f.style.top=0,f.style.right=0,f.style.height="100%",f.style.backgroundColor="#aaa",f.style.fontSize="12px",f.style.padding="10px",f.style.zIndex=9999999999,f.style.opacity=0.95,f.style.filter="alpha(opacity=95)",j.body.appendChild(f));d=f.getElementsByTagName("DIV")[0];j="string"==typeof c?c:b.Json.stringify(c,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0);j=j.replace(/\n|\\n/g,"<br/>");
d.innerHTML+="<div"+("log"==e?"":' style="color:'+("error"==e?"red":"info"==e?"green":"yellow"))+'">'+e+":<br/>"+j+"</div><br/><br/>";d.scrollTop=d.scrollHeight}d=arguments.callee.caller;d.$owner||(d=d.caller);try{if(d.$owner)console[e]("["+d.$owner.$ns+"->"+d.$name+"]");console[e](c)}catch(l){}},log:function(c,g){a.level>a.LOG_LEVEL||a.out(c,!!g,"log")},info:function(c,g){this.level>a.INFO_LEVEL||a.out(c,!!g,"info")},warn:function(c,g){a.level>a.WARN_LEVEL||a.out(c,!!g,"warn")},error:function(c,
g){if(!(a.level>a.ERROR_LEVEL)&&(a.out(c,!!g,"error"),c instanceof Error))throw c;},time:function(c,g,e){a.level>a.INFO_LEVEL||(c?("boolean"==typeof g&&(e=g,g=""),a.out((g||"")+((new Date).getTime()-(a.lastTime||0)),!!e)):a.lastTime=(new Date).getTime())},debug:function(c){if(!(a.level>a.DEBUG_LEVEL)&&!1!==c)debugger}};return a});
handy.add("Function",function(f){return{bind:function(d,b,a){var c=Array.prototype.slice.call(arguments,2);return function(){var a=c.slice();Array.prototype.push.apply(a,arguments);return d.apply(b,a)}},intercept:function(d,b,a,c){return f.Object.isFunc(d)&&f.Object.isFunc(b)?function(){var g=a||this,e={},h=arguments;e.scope=c;e.target=g;e.method=d;return!1!=b.apply(e,h)?d.apply(g,h):!1}:d}}});
handy.add("Class",["B.Object","B.Debug"],function(f,d){var b={createClass:function(a){var c=function(){var a,e,b=arguments;if(this.constructor==c)a=this;else return a=b.callee,e=function(){},e.prototype=a.prototype,e=new e,a.apply(e,b),e;if(e=a.initialize)return e.apply(a,b)};c.$isClass=!0;c.derive=function(a,e,c){var d=b.createClass();b.inherit(d,this,a,e,c);return d};c.prototype.callSuper=function(a,e){a&&(!a.$isClass&&void 0!==a.length)&&(e=a,a=null);var c=arguments.callee.caller,b=c.$owner.superProto;
e=e||c.arguments;a=a?a.prototype:b||this.constructor.superProto;c=c.$name;if(a&&(c=a[c],f.isFunc(c)))return c.apply(this,e)};a&&this.ns(a,c);return c},inherit:function(a,c,b,e,h){var j=function(){};j.prototype=c.prototype;f.extend(a,c,h);a.prototype=new j;a.prototype.constructor=a;a.superClass=c;a.superProto=c.prototype;if(c._onInherit)try{c._onInherit(a)}catch(k){d.error(k)}e&&f.extend(a,e);b&&f.extend(a.prototype,b)},getSingleton:function(a){return(a="string"==typeof a?f.ns(a):a)&&(a.$singleton||
(a.$singleton=new a))}};return b});
handy.add("Loader",["B.Debug","B.Object","B.Function"],function(f,d,b,a){function c(a){var e={},c=[];"string"==typeof a&&(a=[a]);for(var b=0,g=a.length;b<g;b++){var h;h=a[b];h=/\.(css|js)$/.test(h)?u[h]&&"loaded"==u[h].status:r.urlMap&&r.urlMap[h]?r.urlMap[h].chkExist():d.ns(h);if(h)c.push(h);else return e.notExist=a[b],e}e.exist=c;return e}function g(a,c){function b(){b.isCalled||(b.isCalled=!0,clearTimeout(l),c())}if("SCRIPT"===a.nodeName){var g=a,d=b,h=function(){/loaded|complete|undefined/.test(g.readyState)&&(g.onload=
g.onerror=g.onreadystatechange=null,m.removeChild(g),g=null,setTimeout(d,0))};g.onload=g.onreadystatechange=h;g.onerror=function(){f.error(k+"load script error:\n"+g.src);h()}}else{var j=b;window.hasOwnProperty("attachEvent")?a.attachEvent("onload",j):setTimeout(function(){e(a,j)},0)}var l=setTimeout(function(){f.error("Time is out:"+a.src);b()},r.timeout)}function e(a,c){if(!c.isCalled){var b;if(p)a.sheet&&(b=!0);else if(a.sheet)try{a.sheet.cssRules&&(b=!0)}catch(g){if("SecurityError"===g.name||
"NS_ERROR_DOM_SECURITY_ERR"===g.name)b=!0}setTimeout(function(){b?c():e(a,c)},1)}}function h(a){r.showLoading(!1);x--;u[a].status="loaded";r.traceLog&&f.log(k+"Response:\n"+a);j()}function j(){for(var a=q.length-1;0<=a;a--){var e=q[a],b=c(e.deps);if(b.notExist)0==a&&0==x&&f.error(l+b.notExist);else{q.splice(a,1);e.callback.apply(null,b.exist);j();break}}}var k="[Handy Loader] ",l=k+"not found: ",m=document.head||document.getElementsByTagName("head")[0]||document.documentElement,p=navigator.userAgent.indexOf("AppleWebKit"),
q=[],x=0,u={},r={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(e,c,b){e=a.Object.alias(e);2==arguments.length&&(b=c,c=[]);r.require(c,function(){var a;if("function"==typeof b)try{r.traceLog&&f.log(k+"define:\n"+e),a=b.apply(null,arguments)}catch(c){c.message=k+e+":\nfactory define error:\n"+c.message;f.error(c);return}else a=b;if(a){d.ns(e,a);var g=typeof a;if("object"==g||"function"==g)a.$ns=e}else f.error(k+"factory no return:\n"+e)})},require:function(e,d){for(var j=
"string"==typeof e?[e]:e,p=[],s=[],v=!0,t=0,z=j.length;t<z;t++){var n=j[t],n=a.Object.alias(n),w=c(n);w.notExist?(p.push(n),v&&(v=!1,q.push({deps:j,callback:d})),r.traceLog&&f.log(l+n)):s.push(w.exist[0])}if(0==p.length)return d&&d.apply(null,s),1==s.length?s[0]:s;v=!1;j=0;for(s=p.length;j<s;j++)if(t=p[j],!u[t]){v=t;n=r.urlMap&&r.urlMap[v]&&r.urlMap[v].url;if(!n){z="";n=r.rootPath;if("string"==typeof n)z=n;else if("object"==typeof n)for(w in w=void 0,n)0==v.indexOf(w)&&(z=n[w],v=v.replace(w,""));
else z="";n=/.css$/.test(v)?0==v.indexOf("/")?v:"/css/"+v:/.js$/.test(v)?v:v.replace(/\./g,"/")+".js";n=z.replace(/\/$/,"")+"/"+n.replace(/^\//,"")}v=!0;u[t]={id:t,status:"loading"};z=b.bind(h,null,t);r.traceLog&&f.log(k+"request:\n"+n);if(/.css$/.test(n))a:{t=n;n=m.getElementsByTagName("link");for(w=0;w<n.length;w++){var A=n[w].href;!r.skinNode&&0<=A.indexOf(r.skinName)&&(r.skinNode=n[w]);if(0<=A.indexOf(t)||0<=t.indexOf(A))break a}n=document.createElement("link");n.rel="stylesheet";n.href=t;g(n,
z);r.skinNode?m.insertBefore(n,r.skinNode):m.appendChild(n)}else t=n,n=document.createElement("script"),n.async="async",n.src=t,n.type="text/javascript",g(n,z),m.appendChild(n);x++}v&&r.showLoading(!0)}};return r});
handy.add("Events",function(f){return{_eventCache:{},_execEvtCache:[],_parseEvents:function(d,b){var a=/\s+/;if("object"==typeof d){for(var c in d)b([c,d[c]]);return!0}if("string"==typeof d&&a.test(d)){a=d.split(a);c=0;for(var g=a.length;c<g;c++)b([a[c]]);return!0}return!1},_parseCustomEvents:function(d,b,a){var c=this,g=f.toArray(arguments,2);return c._parseEvents(b,function(a){c[d].apply(c,a.concat(g))})},_delegateHandler:function(d,b){var a=this;return function(){if(!0!=a.isSuspend)return d.apply(b||
a,arguments)}},_pushEvent:function(d){this._execEvtCache.push(d)},_execEvents:function(){var d=this,b,a=d._execEvtCache;f.each(a,function(c,g){a.splice(c,1);var e=g.delegation;"number"==typeof g.times&&(1<g.times?g.times--:d.off(g.name,g.handler));b=e.apply(d,g.args)});return b},on:function(d,b,a,c){if(!this._parseCustomEvents("on",d,b,a,c)){"number"==typeof a&&(c=a,a=null);var g=this._eventCache,e=g[d];e||(e=g[d]=[]);d=this._delegateHandler(b,a);e.push({times:c,handler:b,context:a,delegation:d})}},
once:function(d,b,a){var c=f.toArray(arguments);c.push(1);this.on.apply(this,c)},off:function(d,b){if("all"==d)return this._eventCache={},!0;if(!this._parseCustomEvents("off",d,b)){var a=this._eventCache,c=d.indexOf(".");if(!b&&0>=c){for(var g in a)(g.split(".")[0]==d||0==c&&0<=g.indexOf(d))&&delete a[g];return!0}c=a[d];if(!c)return!1;if(b){a=0;for(g=c.length;a<g;a++)if(c[a].handler==b)return c.splice(a,1),!0}else return delete a[d],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=
!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(d,b){function a(a){if(a)for(var b=0,g=a.length;b<g;b++){var h=a[b];h.args=e;h.name=d;c._pushEvent(h)}}var c=this,g=f.toArray(arguments);g.unshift("trigger");if(!c._parseCustomEvents.apply(c,g)){var g=c._eventCache,e=f.toArray(arguments),h;if(0<d.indexOf("."))h=g[d],a(h);else for(var j in g)if(h=d.indexOf("."),j.split(".")[0]==d||0==h&&0<=j.indexOf(d))h=g[j],a(h);a(g.all);return c._execEvents()}}}});
handy.add("Date",function(){var f=window.Date,d={getWeek:function(a,c){var b=a.getDay();c&&(b=(b+(c%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[b]},isWeeken:function(a){return 0==a.getDay()||6==a.getDay()},getDaysInMonth:function(a){a=new f(a.getFullYear(),a.getMonth()+1,0);return a.getDate()},getDaysInYear:function(a){var c=new f(a.getFullYear(),0,0);a=new f(a.getFullYear()+1,0,0);return Math.floor((a.getTime()-c.getTime())/864E5)},getDayIndexOfYear:function(a){var c=new f("1/1/"+
a.getFullYear());return Math.ceil((a.getTime()-c.getTime())/864E5)},formatDate:function(a,c){c=c||"yyyy-MM-dd HH:mm:ss";var b=a.getHours(),e=Math.floor((a.getMonth()+3)/3),b={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":0==b%12?12:b%12,"H+":b,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":d.getWeek(a),"q+":e,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][e-1],"S+":a.getMilliseconds()},h;for(h in b)RegExp("("+h+")").test(c)&&(e=RegExp.$1.length,c=c.replace(RegExp.$1,1==e?b[h]:("00"+b[h]).slice(-e)));
return c},parseDate:function(a,c){var b=typeof a,e=new f;if("number"==b)return e.setTime(a),e;if("string"!=b)return a;var b=(c||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),d=a.match(/\d+/g);if(d){for(var j=0;j<d.length;j++){var k=b[j],l=parseInt(d[j]);switch(k){case "yyyy":e.setFullYear(l);break;case "MM":e.setMonth(l-1);break;case "dd":e.setDate(l);break;case "HH":e.setHours(l);break;case "mm":e.setMinutes(l);break;case "ss":e.setSeconds(l);break;case "SS":e.setMilliseconds(l)}}return e}},now:function(a){var c=
new f;if(a)"number"!=typeof a&&(a=d.parseDate(a).getTime()),b=a-c.getTime();else return c.setTime(c.getTime()+b),c},howLong:function(a,c){if(a){var b=d.now().getTime()-a.getTime();if(!1!=c){var e;if(60>(b/=6E4))e="\u5206\u949f",b=b||1;else if(24>(b/=60))e="\u5c0f\u65f6";else if(30>(b/=24))e="\u5929";else return"30\u5929\u524d";b=(Math.floor(b)||1)+e+"\u524d"}return b}}},b=0;return d});
handy.add("String",function(){var f={stripTags:function(d){return d.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(d){if(!d)return d;var b=document.createElement("div");d=document.createTextNode(d);b.appendChild(d);return b.innerHTML},unescapeHTML:function(d){var b=document.createElement("div");b.innerHTML=f.stripTags(d);return b.childNodes[0].nodeValue},decodeHTML:function(d){d=d.replace(/&lt;/gi,"<");d=d.replace(/&gt;/gi,">");d=d.replace(/&quot;/gi,'"');d=d.replace(/&apos;/gi,"'");d=d.replace(/<\/?br>/gi,
"\n");d=d.replace(/&amp;/gi,"&");return d=d.replace(/&nbsp;/gi," ")},encodeHTML:function(d){d=d.replace(/&/gi,"&amp;");d=d.replace(/</gi,"&lt;");d=d.replace(/>/gi,"&gt;");d=d.replace(/\"/gi,"&quot;");d=d.replace(/\'/gi,"&apos;");d=d.replace(/\n/gi,"</br>");return d=d.replace(/ /gi,"&nbsp;")},trim:function(d){return d=d.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(d,b){b||(b=/[,%\'\"\/\\;|\<\>\^]/);return-1<d.search(b)},len:function(d){return d.replace(/[^\x00-\xff]/g,"**").length},
left:function(d,b,a){if(f.len(d)>b){!0===a?a=2:0<a||(a=0);var c=0,g=0;for(b-=a;g<b;)255<d.charCodeAt(c)?g+=2:g++,c++;d=d.substring(0,c);for(c=0;c<a;c++)d+="."}return d},isNumStr:function(d){return 0==d.search(/^\d+$/g)},hasChn:function(d){return/[\u4E00-\u9FA5]+/.test(d)},isChn:function(d){return/^[\u4E00-\u9FA5]+$/.test(d)},addParam:function(d,b){b&&(d+=(-1<d.indexOf("?")?"&":"?")+b);return d}};return f});
handy.add("Cookie",function(){return{getCookie:function(f,d){var b=f+"=",a="",c=document.cookie;if(0<c.length){var g=c.indexOf(b);-1!=g&&(g+=b.length,b=c.indexOf(";",g),-1==b&&(b=c.length),a=c.substring(g,b),d||(a=unescape(a)))}return a},setCookie:function(f,d,b){var a=[];void 0!==f&&void 0!==d&&a.push(f+"="+escape(d));b&&(void 0!==b.path&&a.push("path="+b.path),void 0!==b.domain&&a.push("domain="+b.domain),void 0!==b.expires&&a.push("expires="+b.expires),b.secure&&a.push("secure"));document.cookie=
a.join(";")},delCookie:function(f){var d=new Date;d.setTime(d.getTime()-1);document.cookie=f+"=;expires="+d.toGMTString()}}});handy.add("Util","B.Object",function(f){var d=0;return{isWindow:function(b){return null!=b&&b==b.window},uuid:function(){return++d},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(b){var a=top.location.hash;0<=a.indexOf("#")&&(b=a.replace(/#[^\?]*/,b));top.location.hash=b},result:function(b,a){var c=b[a];return f.isFunc(c)?c():c}}});
handy.add("Array","B.Object",function(f,d){function b(a){return a}function a(a){return function(e){return e[a]}}function c(e){return null==e?b:d.isFunc(e)?e:a(e)}function g(a){return function(e){if(e===a)return!0;for(var b in a)if(a[b]!==e[b])return!1;return!0}}function e(a){return function(e,b,g){var d={};b=c(b);f.each(e,function(c,h){var f=b.call(g,h,c,e);a(d,f,h)});return d}}var h={map:function(a,e,b){var c=[];if(null==a)return c;var g=Array.prototype.map;if(g&&a.map===g)return a.map(e,b);f.each(a,
function(a,g){c.push(e.call(b,g,a))});return c},pluck:function(e,b){return this.map(e,a(b))},some:function(a,e,b){var c=!1;if(null==a||!e)return c;var g=Array.prototype.some;if(g&&a.some===g)return a.some(e,b);d.each(a,function(a,g,d){if(c||(c=e.call(b,g,a,d)))return!1});return!!c},every:function(a,e,b){var c=!0;if(null==a||!e)return c;var g=Array.prototype.every;if(g&&a.every===g)return a.every(e,b);d.each(a,function(a,g,d){if(!(c=e.call(b,g,a,d)))return!1});return!!c},indexOf:function(a,e,b){if(null==
a)return-1;var c=0,g=a.length;if(b)if("number"==typeof b)c=0>b?Math.max(0,g+b):b;else return c=h.sortedIndex(a,e),a[c]===e?c:-1;var d=Array.prototype.indexOf;if(d&&a.indexOf===d)return a.indexOf(e,b);for(;c<g;c++)if(a[c]===e)return c;return-1},find:function(a,e,b){var c;this.some(a,function(a,g,d){if(e.call(b,a,g,d))return c=a,!0});return c},filter:function(a,e,b){var c=[];if(null==a)return c;var g=Array.prototype.filter;if(g&&a.filter===g)return a.filter(e,b);d.each(a,function(a,g,d){e.call(b,g,
a,d)&&c.push(g)});return c},where:function(a,e){return this.filter(a,g(e))},findWhere:function(a,e){return this.find(a,g(e))},invoke:function(a,e){var c=Array.prototype.slice.call(arguments,2),b=f.isFunc(e);return this.map(a,function(a){return(b?e:a[e]).apply(a,c)})},sortedIndex:function(a,e,b,g){b=c(b);e=b.call(g,e);for(var d=0,h=a.length;d<h;){var f=d+h>>>1;b.call(g,a[f])<e?d=f+1:h=f}return d},sortBy:function(a,e,b){e=c(e);return this.pluck(this.map(a,function(a,c,g){return{value:a,index:c,criteria:e.call(b,
a,c,g)}}).sort(function(a,e){var b=a.criteria,c=e.criteria;if(b!==c){if(b>c||void 0===b)return 1;if(b<c||void 0===c)return-1}return a.index-e.index}),"value")},groupBy:e(function(a,e,b){a[e]?a[e].push(b):a[e]=[b]}),countBy:e(function(a,e){a[e]?a[e]++:a[e]=1})};return h});
handy.add("Geo",function(f){return{distance:function(d,b,a){function c(a){a.get?a=[a.get("latitude"),a.get("longitude")]:f.isObj(a)&&(a=[a.latitude,a.longitude]);return a}var g,e;d=c(d);g=d[0];d=d[1];b=c(b);e=b[0];b=b[1];g=g*Math.PI/180;e=e*Math.PI/180;d=6371*Math.acos(Math.cos(e)*Math.cos(g)*Math.cos(d*Math.PI/180-b*Math.PI/180)+Math.sin(e)*Math.sin(g));d=d.toFixed(2);if(!1!=a){if(isNaN(d))return"\u672a\u77e5";d+="km"}return d}}});
handy.add("Template",["B.Object","B.String","B.Debug","B.Function"],function(f,d,b){function a(a){var e=typeof a;"string"!==e&&(a="number"===e?a+"":"");return a}function c(a,e){var b=e.fn,c="";if(a){if(void 0!==a.length)for(var g=0,d=a.length;g<d;g++)c+=b(a[g]);else for(g in a)c+=b(a[g]);return c}}function g(a,e){var b=e.fn,c=[];if(a){if(void 0!==a.length)for(var g=0,d=a.length;g<d;g++)c.push(b(a[g]));else for(g in a)c.push(b(a[g]));return c.join("")}}function e(a){a=a.replace(/("|\\)/g,"\\$1").replace(/\r/g,
"\\r").replace(/\n/g,"\\n");return q?"$r+="+('"'+a+'"')+";":"$r.push("+('"'+a+'"')+");"}function h(a,e){e=e||{};var b=a.exp.replace(/"/g,"'"),b=d.trim(b).replace(/\s{2,}/g," "),c=e.helpers,g=c&&c.parseValue,h=a.blockName,f=a.children,j=a.num,n,m="\nif($tmp||$tmp===0){"+(q?"$r+=$tmp;":"$r.push($tmp);")+"}";n=(a.inverse?"inverse:true,":"")+"num:"+j+',context:$me,exp:"'+b+'",helpers:$helpers,data:$data}';c=c&&c.getValue?'$helpers.getValue.call($me,"'+b+'",$data,{'+n+")":"($data&&$data."+b+")";h?(b="$program"+
j,n='$tmp = $helpers["'+h+'"].call($me,'+c+", {fn:"+b+","+n+");"+m,f&&(m=k(f,e),m=u[0]+"\n"+m.join("\n")+"\n"+u[1],p.splice(2,0,"\nfunction "+b+"($data){\n"+m+"\n}\n"))):((f=b.match(/([^\s]+)\s([^\n]+)/))?(b=f[1],n="if (helper = $helpers."+b+') {\n$tmp = helper.call($me,"'+f[2]+'",{'+n+'); \n}else{$tmp="";}'):n="if (helper = $helpers."+b+') {\n$tmp = helper.call($me,"",{'+n+"); \n}else{\nhelper = "+c+"; $tmp = typeof helper === functionType ? helper.call($me,{"+n+") : helper;\n}"+(g?"\n$tmp=$helpers.parseValue.call($me,$tmp,{"+
n+");":l.isEscape?"\n$tmp=escape($tmp);":""),n+=m);return n}function j(a,e){if(a){var c=e||{},g=l.openTag,d=l.closeTag,h,f;c.children?f=c.children:c.children=f=[];if(0<=(h=a.indexOf(g))){var k=a.substring(0,h);k&&f.push({html:k});a=a.substring(h+g.length);if(0==a.indexOf("#"))if(a=a.substring(1),k=a.match(/^[a-z]+/)){var u=k[0];h=a.indexOf(d);k=a.substring(u.length+1,h);a=a.substring(h+d.length);k={num:++x,blockName:u,exp:k};f.push(k);var m=g+"/"+u+d;a:{h=a;for(var d=RegExp(g+"[#/]"+u+"((?!"+d+").)*"+
d,"ig"),r=0;g=d.exec(h);)if(g[0]==m)if(0==r){h=g.index;break a}else r--;else r++;h=-1}if(-1==h){b.error("\u672a\u627e\u5230\u5757\u7ed3\u675f\u4f4d\u7f6e:"+m);return}g=a.substring(0,h);a=a.substring(h+m.length);j(g,k);if("if"==u){u=k.children;m=0;for(g=u.length;m<g;m++)d=u[m],"else"==d.exp&&(d.exp=k.exp,d.blockName="if",d.num=++x,d.inverse=!0,d.children=u.slice(m+1),f.push(d),k.children=u.slice(0,m))}}else{b.error("\u627e\u4e0d\u5230\u8f85\u52a9\u51fd\u6570:"+a);return}else h=a.indexOf(d),f.push({num:++x,
exp:a.substring(0,h)}),a=a.substring(h+d.length);j(a,c)}else a&&f.push({html:a});return c}}function k(a,b){var c=[];if(a)for(var g=0,d=a.length;g<d;g++){var f=a[g];f.html?c.push(e(f.html)):f.exp&&c.push(h(f,b))}return c}var l={openTag:"{{",closeTag:"}}",isTrim:!0,isEscape:!1,getIfPlusJoin:function(){return q},registerHelper:function(a,e,c){f.isObj(e)?(r[a]||(r[a]={}),f.extend(r[a],e)):r[a][e]=c},tmpl:function(a,e,c){var g,d,h;if("string"==typeof a)g=a;else if(void 0!==a.length)g=a.join("");else if(g=
a.tmpl,h=a.id)if(m[h])d=m[h];else if(!g){var t=document.getElementById(h);t&&(g=(t.value||t.innerHTML).replace(/\s/g,""))}if(!d){if(!g){b.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}a:{if(l.isTrim){var t=l.openTag,q=l.closeTag;g=g.replace(/^[\s\n]+/,"").replace(/[\s\n]+$/,"").replace(RegExp("("+q+"|\\>)(\\s|\\n)+(?=("+t+"|<))","ig"),"$1").replace(RegExp(q+"[\\s\\n]+([^\\n]+)[\\s\\n]+(?=("+t+"|<))","ig"),q+"$1")}p=[u[0]];p.push('var escape=$helpers.escape,functionType="function",$me=this;');var t=
a&&a.ns,n;t?(n=f.extend({},r["default"]),n=f.extend(n,r[t])):n=r["default"];a.helpers=n;g=j(g);x=0;a=k(g.children,a);p=p.concat(a);p.push(u[1]);a=p.join("\n");try{var w=window.Function.apply(null,["$T","$helpers","$data",a]);d=function(a,e){return w.call(e||a,l,n,a)};break a}catch(A){b.log(a),b.error(A)}d=void 0}h&&(m[h]=d)}if(e)try{return d(e,c)}catch(B){b.log(d.toString()),b.error(B)}else return d}},m={},p,q="".trim,x=0,u=["var $r="+(q?'""':"[]")+",$tmp,helper;","return "+(q?"$r;":'$r.join("");')],
r={"default":{"if":function(a,e){var c=e.data;f.isFunc(a)&&(a=a.call(c));if(a&&!e.inverse||!a&&e.inverse)return e.fn(c)},unless:function(a,e){e.inverse=!0;return e.helpers["if"].call(this,a,e)},each:q?c:g,escape:function(e){return d.encodeHTML(a(e))},trim:d.trim}};return l});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(f,d,b){function a(a){if(a==l)return!1;var e=k.contentWindow.document;e.open();e.write("<!doctype html><html><body>"+a+"</body></html>");e.close();l=a;f.log("set:"+k.contentWindow.document.body.innerText)}function c(){var e=d.getHash(),c=k.contentWindow.document.body.innerText;e!=l?(a(e),g(e)):c!=l&&(f.log("update:"+k.contentWindow.document.body.innerText),d.setHash(c))}function g(a){var e=q.listeners,c;for(c in e)e[c](a)}var e,
h=0,j=document,k,l,m=j.documentMode,p="onhashchange"in window&&(void 0===m||7<m),q={delay:50,listen:function(f,l){if(!e&&!e)if(e=!0,q.listeners={},p)$(window).on("hashchange",function(){g(d.getHash())});else k=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(j.body)[0],$(k).one("load",function(){a(d.getHash());setInterval(c,q.delay)});if(l in q.listeners)$D.error(Error("Duplicate name"));else return l=l||b.expando+ ++h,q.listeners[l]=f,l},unListen:function(a){for(var e in q.listeners)(!a||
a==e)&&delete q.listeners[e]}};return q});handy.add("Support","B.Browser",function(f){var d={mediaQuery:function(){var a;if(f.mobile())a="hui-mobile";else{a="hui-pc";var c=f.ie();c&&(a+=" ie"+c)}document.documentElement.className+=" "+a}};d.mediaQuery();if(6==f.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(b){}return d});
handy.add("Validator",["B.String","B.Object"],function(f,d){var b={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(a,c){var g=c.rules,e;for(e in g){var d=g[e],f=("function"==typeof d?d:b[e])(a,d);if(!f)return g=c.error||b.error,e=c.messages&&
c.messages[e]||b.messages[e],e=e.replace(/\{([^\}]+)\}/g,function(a,e){return d[e]||0==e&&d||c[e]||d||""}),g&&g(e),f}return!0},required:function(a){return 0<f.trim(""+a).length},email:function(a){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a){return!/Invalid|NaN/.test((new Date(a)).toString())},dateISO:function(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a){return/^\d+$/.test(a)},creditcard:function(a){if(/[^0-9 \-]+/.test(a))return!1;var c=0,b=0,e=!1;a=a.replace(/\D/g,"");for(var d=a.length-1;0<=d;d--){b=a.charAt(d);b=parseInt(b,10);if(e&&9<(b*=2))b-=9;c+=b;e=!e}return 0===c%10},min:function(a,c){return a>=c},max:function(a,
c){return a<=c},range:function(a,c){return a>=c[0]&&a<=c[1]},minlength:function(a,c){return(d.isArr(a)?a.length:f.trim(""+a).length)>=c},maxlength:function(a,c){return(d.isArr(a)?a.length:f.trim(""+a).length)<=c},rangelength:function(a,c){var b=d.isArr(a)?a.length:f.trim(""+a).length;return b>=c[0]&&b<=c[1]},equalTo:function(a,c){return a===c}};return b});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(f,d,b){d={_init:function(){!a&&f.ie()&&(g=document.getElementById("LocalStorageUserDataDiv"),g||(g=document.createElement("DIV"),g.style.display="none",g.id="LocalStorageUserDataDiv",g.addBehavior("#default#userData"),document.body.appendChild(g),g.load(e)))},getItem:function(e){e=a?c.getItem(e):g.getAttribute(e);return e=b.parseJson(e)},setItem:function(d,f){f=b.stringify(f);try{a?c.setItem(d,f):(g.setAttribute(d,f),g.save(e))}catch(k){return $D.error(k),
!1}return!0},removeItem:function(b){a?c.removeItem(b):(g.removeAttribute(b),g.save(e))},clear:function(){a?c.clear():g.unload()}};var a=window.localStorage&&window.localStorage.getItem,c=window.localStorage,g,e=document.domain;d._init();return d});(function(f){Hui=H=$H=f.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};f=window.$;f.fn.remove=$H.intercept(f.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
$Define("CM.AbstractEvents",function(){var f=$H.createClass();$H.extend(f.prototype,$H.Events);$H.extend(f.prototype,{initialize:function(){this._eventCache={};this._listenTo=[]},_parseListenToEvents:function(d,b,a,c){var g=this,e=$H.toArray(arguments,3);return g._parseEvents(a,function(a){a.unshift(b);g[d].apply(g,a.concat(e))})},listenTo:function(d,b,a,c,g){if(!this._parseListenToEvents("listenTo",d,b,a,c,g)){"number"==typeof c&&(g=c,c=null);c=c||this;var e=this._delegateHandler(a,c);this._listenTo.push({target:d,
name:b,delegation:e,handler:a});d.on(b,e,c,g)}},unlistenTo:function(d,b,a){if(!this._parseListenToEvents("unlistenTo",d,b,a)){var c=this._listenTo,g="all"==d;$H.each(c,function(e,f){if(g||f.name==b&&f.handler==a&&f.target==d)f.target.off(f.name,f.delegation),c.splice(e,1)})}}});return f});
$Define("CM.DataStore",function(){var f=$H.createClass();$H.extend(f.prototype,{get:function(b,a){var c;if(c=d[b])return a?$H.where(c,a):c},push:function(b,a){"string"!=typeof b&&(a=b,b=null);var c=a.constructor.$ns;(d[c]||(d[c]=[])).push(a);b&&(d[b]||(d[b]=a))}});var d={};$S=$H.getSingleton(f);return f});
$Define("CM.AbstractDao","B.LocalStorage",function(f){var d=$H.createClass();$H.extend(d.prototype,{_ajaxMethodMap:{create:"POST",update:"POST",patch:"PATCH","delete":"DELETE",read:"GET"},_localMethodMap:{create:"setItem",update:"setItem",patch:"setItem","delete":"removeItem",read:"getItem"},ajax:function(b){b=this.parseParam(b);var a=$H.intercept(b.error,this.error);b.error=$H.intercept(a,b.beforeErr);a=$H.intercept(b.success,this.success);b.success=$H.intercept(a,b.beforeSucc);b.beforeSend=$H.intercept($H.bind(this.beforeSend,
this),b.beforeSend);b.complete=$H.intercept($H.bind(this.complete,this),b.complete);return $.ajax(b)},parseParam:$H.noop,beforeSend:function(){this.showLoading(!0)},complete:function(){this.showLoading(!1)},error:$H.noop,success:$H.noop,showLoading:$H.noop,get:function(){},set:function(){},remove:function(){},sync:function(b,a,c){c=c||{};var g=c.storeType||"remote",e={type:"POST",dataType:"json"};c.url||(e.url=a.getUrl());if(null==c.data&&a&&("create"===b||"update"===b||"patch"===b))e.data=c.attrs||
a.toJSON(c);if("remote"==g)e.url+="/"+b+".do",$H.extend(e,c),this.ajax(e);else f[this._localMethodMap[b]](e);a.trigger("request",a,c)}});return d});
$Define("CM.Model",["CM.AbstractDao","CM.AbstractEvents","CM.DataStore"],function(f,d){return d.derive({idAttribute:"id",_pending:!1,_validate:function(b,a){if(!a.validate||!this.validate)return!0;b=$H.extend({},this._attributes,b);var c=this.validationError=this.validate(b,a)||null;if(!c)return!0;this.trigger("invalid",this,c,$H.extend(a,{validationError:c}));return!1},_initDepFields:function(){var b=this.fields,a,c,g;for(g in b)if((a=b[g])&&(c=a.depends))for(a=0;a<c.length;a++)this.on("change:"+
c[a],$H.bind(this.set,this,g,null,null))},_parseFields:function(b){var a;if(!(a=this.fields))return b;var c,g,e,d={},f;for(f in b){g=b[f];if(c=a[f]){e=c.type;if(c=c.parse)g=c.apply(this,[g,b]);$H.isStr(e)&&("Date"==e?g=$H.parseDate(g):0<e.indexOf(".")&&(e=$H.ns(e)));$H.isClass(e)&&!(g instanceof e)&&(g=new e(g),g.on("all",$H.bind(this._onAttrEvent,this,f)))}d[f]=g}return d},_onAttrEvent:function(b,a){if(!("invalid"==a||"sync"==a)){var c=this.get(b);0!=a.indexOf("change:")&&(this.trigger("change:"+
b,this,c),this.trigger("change",this))}},initialize:function(b,a){this.callSuper();this.uuid=$H.uuid();this.dao=this.dao||$H.getSingleton(f);this._initDepFields();var c=b||{};a||(a={});this.cid=$H.Util.uuid();this._attributes={};a.collection&&(this.collection=a.collection);a.parse&&(c=this.parse(c,a)||{});c=$H.extendIf(c,this.getDefaults());this.set(c,a);this._changed={};$S.push(this)},getDefaults:function(){var b={},a;if(a=this.fields)for(var c in a){var d=a[c];b[c]=d&&$H.isObj(d)?d.def:d}return b},
toJSON:function(){return $H.clone(this._attributes)},sync:function(b,a,c){return this.dao.sync(b,a,c)},get:function(b){return this._attributes[b]},escape:function(b){return $H.String.escapeHTML(this.get(b))},has:function(b){b=this.get(b);return null!==b&&void 0!==b},set:function(b,a,c){var d;"object"===typeof b?(d=b,c=a):(d={})[b]=a;c||(c={});d=this._parseFields(d);if(!this._validate(d,c))return!1;var e=c.unset;b=c.silent;var f=[],j=this._changing;this._changing=!0;j||(this._previousAttributes=$H.Object.clone(this._attributes),
this._changed={});var k=this._attributes,l=this._previousAttributes;this.idAttribute in d&&(this.id=d[this.idAttribute]);for(var m in d)a=d[m],$H.equals(k[m],a)||f.push(m),$H.equals(l[m],a)?delete this._changed[m]:this._changed[m]=a,e?delete k[m]:k[m]=a;if(!b){f.length&&(this._pending=c);a=0;for(d=f.length;a<d;a++)this.trigger("change:"+f[a],this,k[f[a]],c)}if(j)return this;if(!b)for(;this._pending;)c=this._pending,this._pending=!1,this.trigger("change",this,c);this._changing=this._pending=!1;return this},
unset:function(b,a){a=a||{};a.unset=!0;return this.set(b,void 0,a)},clear:function(b){var a={},c;for(c in this._attributes)a[c]=void 0;b=b||{};b.unset=!0;return this.set(a,b)},each:function(b){$H.each(this._attributes,b)},hasChanged:function(b){var a=this._changed;return null==b?!$H.isEmpty(a):$H.contains(a,b)},changedAttrbutes:function(b){if(!b)return this.hasChanged()?$H.clone(this._changed):!1;var a,c=!1,d=this._changing?this._previousAttributes:this._attributes,e;for(e in b)if(!$H.equals(d[e],
a=b[e]))(c||(c={}))[e]=a;return c},previous:function(b){return null==b||!this._previousAttributes?null:this._previousAttributes[b]},fetch:function(b){var a=this;b=b?$H.clone(b):{};void 0===b.parse&&(b.parse=!0);var c=b.success,d=b.beforeSet;b.success=function(e){if(!(d&&!1==d(a,e,b))){if(!a.set(a.parse(e,b),b))return!1;c&&c(a,e,b);a.trigger("sync",a,e,b)}};a.sync("read",a,b)},save:function(b,a,c){var d=this,e;null==b||"object"===typeof b?(e=b,c=a):(e={})[b]=a;$H.isFunc(c)&&(c={success:c});c=$H.extend({validate:!0},
c);if(e&&c.now){if(!d.set(e,c))return!1}else if(!d._validate(e,c))return!1;void 0===c.parse&&(c.parse=!0);var f=c.success;c.success=function(a){var b=d.parse(a,c);c.now||(b=$H.extend(e||{},b));if($H.isObj(b)&&!d.set(b,c))return!1;f&&f(d,a,c);d.trigger("sync",d,a,c)};b=d.isNew()?"create":c.update?"update":"patch";if("patch"===b){a=d.changedAttrbutes(e);if(!a){f&&f(d,c);return}c.attrs=a}else a=$H.extend({},d._attributes),c.attrs=$H.extend(a,e);d.sync(b,d,c)},destroy:function(b){var a=this;b=b?$H.clone(b):
{};var c=b.success,d=function(){a.trigger("destroy",a,a.collection,b);a.off("all")};b.success=function(e){(!b.now||a.isNew())&&d();c&&c(a,e,b);a.isNew()||a.trigger("sync",a,e,b)};if(a.isNew())return b.success(),!1;a.sync("delete",a,b);b.now&&d()},getUrl:function(){var b=$H.result(this,"url")||$H.result(this.collection,"url");b||$D.error(Error("\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2aurl\u5c5e\u6027\u6216\u8005\u51fd\u6570"));return this.isNew()?b:b.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},
parse:function(b){return b.code&&b.data?b.data:b},clone:function(){return new this.constructor(this._attributes)},isNew:function(){return void 0===this.id},isValid:function(b){return this._validate({},$H.extend(b||{},{validate:!0}))}})});
$Define("CM.Collection",["CM.AbstractDao","CM.AbstractEvents","CM.Model","CM.DataStore"],function(f,d,b){var a=d.derive({model:b,_reset:function(){this.length=0;this._models=[];this._byId={}},_prepareModel:function(a,e){if(a instanceof b)return a;e=e?$H.clone(e):{};e.collection=this;var c;if(e.id&&(c=(c=$S.get(this.model.$ns,{id:e.id}))&&c[0]))return c.set(a,e),c;c=new this.model(a,e);if(!c.validationError)return c;this.trigger("invalid",this,c.validationError,e);return!1},_addReference:function(a){this._byId[a.cid]=
a;null!=a.id&&(this._byId[a.id]=a);a.collection||(a.collection=this);a.on("all",this._onModelEvent,this)},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,e,c,b){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(e,b),e&&a==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))},initialize:function(a,e){this.callSuper();
this.dao=this.dao||$H.getSingleton(f);e||(e={});e.model&&(this.model=e.model);e.url&&(this.url=e.url);void 0!==e.comparator&&(this.comparator=e.comparator);this._reset();a&&this.reset(a,$H.extend({silent:!0},e))},toJSON:function(a){return $H.map(this._models,function(e){return e.toJSON(a)})},sync:function(a,e,c){return this.dao.sync(a,e,c)},add:function(a,e){e=$H.extend({add:!0,remove:!1,merge:!1},e);return this.set(a,e)},remove:function(a,e){var c=!$H.isArr(a);a=c?[a]:$H.clone(a);e||(e={});var b,
d,f,m;b=0;for(d=a.length;b<d;b++)if(m=a[b]=this.get(a[b]))delete this._byId[m.id],delete this._byId[m.cid],f=this.indexOf(m),this._models.splice(f,1),this.length--,e.silent||(e.index=f,m.trigger("remove",m,this,e)),this._removeReference(m,e);return c?a[0]:a},set:function(a,e){if(a){e=$H.extend({add:!0,remove:!0,merge:!0},e);e.parse&&(a=this.parse(a,e));var c=!$H.isArr(a),d=c?a?[a]:[]:$H.clone(a),f,l,m,p,q,x,u,r=e.at,F=this.model,C=this.comparator&&null==r&&!1!==e.sort,G="string"==typeof this.comparator?
this.comparator:null,y=[],s=[],v={},t=e.add,z=e.merge,n=e.remove,w=!C&&t&&n?[]:!1;f=0;for(l=d.length;f<l;f++){q=d[f]||{};m=q instanceof b?p=q:q[F.prototype.idAttribute||"id"];if(x=this.get(m))n&&(v[x.cid]=!0),z&&(q=q===p?p.attributes:q,e.parse&&(q=x.parse(q,e)),x.set(q,e),C&&(!u&&x.hasChanged(G))&&(u=!0)),d[f]=x;else if(t){e.id=m;p=d[f]=this._prepareModel(q,e);if(!p)continue;y.push(p);this._addReference(p,e)}p=x||p;w&&(p.isNew()||!v[p.id])&&w.push(p);v[p.id]=!0}if(n){f=0;for(l=this.length;f<l;++f)v[(p=
this._models[f]).cid]||s.push(p);s.length&&this.remove(s,e)}if(y.length||w&&w.length)if(C&&(u=!0),this.length+=y.length,null!=r){f=0;for(l=y.length;f<l;f++)this._models.splice(r+f,0,y[f])}else{w&&(this._models.length=0);m=w||y;f=0;for(l=m.length;f<l;f++)this._models.push(m[f])}u&&this.sort({silent:!0});if(!e.silent){f=0;for(l=y.length;f<l;f++)(p=y[f]).trigger("add",p,this,e);(u||w&&w.length)&&this.trigger("sort",this,e)}return c?d[0]:d}},each:function(a){$H.each(this._models,a)},reset:function(a,
e){e||(e={});for(var c=0,b=this._models.length;c<b;c++)this._removeReference(this._models[c],e);e.previousModels=this._models;this._reset();a&&(a=this.add(a,$H.extend({silent:!0},e)));e.silent||this.trigger("reset",this,e);return a},push:function(a,e){return this.add(a,$H.extend({at:this.length},e))},pop:function(a){var e=this.at(this.length-1);this.remove(e,a);return e},unshift:function(a,e){return this.add(a,$H.extend({at:0},e))},shift:function(a){var e=this.at(0);this.remove(e,a);return e},slice:function(){return Array.prototype.slice.apply(this._models,
arguments)},get:function(a){return null==a?void 0:this._byId[a]||this._byId[a.id]||this._byId[a.cid]},size:function(){return this.length},at:function(a){return this._models[a]},where:function(a,e){return $H.isEmpty(a)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var c in a)if(a[c]!==e.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){this.comparator||$D.error(Error("\u6ca1\u6709\u6bd4\u8f83\u5668"));a||(a={});"string"==typeof this.comparator||1===this.comparator.length?
this._models=this.sortBy(this.comparator,this):this._models.sort($H.Function.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return $H.invoke(this._models,"get",a)},getUrl:function(){return this.url},fetch:function(a){var e=this;a=a?$H.clone(a):{};void 0===a.parse&&(a.parse=!0);var c=a.success,b=a.beforeSet;a.success=function(d){b&&!1==b(e,d,a)||(e[a.reset?"reset":a.add?"add":"set"](d,a),c&&c(e,d,a),e.trigger("sync",e,d,a))};return e.sync("read",e,
a)},create:function(a,e){var c=this;e=e?$H.clone(e):{};if(!(a=c._prepareModel(a,e)))return!1;e.now&&c.add(a,e);var b=e.success;e.success=function(a,d){e.now||c.add(a,e);b&&b(a,d,e)};a.save(null,e);return a},parse:function(a){return a.data},clone:function(){return new this.constructor(this._models)}}),c=$H.Array;$H.each("map some every find filter invoke indexOf".split(" "),function(b,e){a.prototype[e]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(this._models);return c[e].apply(c,
a)}});$H.each(["sortBy","groupBy","countBy"],function(b){a.prototype[b]=function(a,d){var f=$H.isFunc(a)?a:function(c){return c.get(a)};return c[b](this._models,f,d)}});return a});
$Define("CM.AbstractManager",function(){var f=$H.createClass();$H.extend(f.prototype,{initialize:function(){this._types={};this._all={}},type:"manager",registerType:function(d,b){this._types[d]=b;b.prototype.xtype=d},getClass:function(d){return $H.isClass(d)?d:this._types[d]||$H.ns(d)},register:function(d,b){var a=d.cid=b.cid||$H.uuid(),a=d._id=this.generateId(a);this._all[a]=d},unregister:function(d){var b=this._all,a=d.getId();b[a]==d&&delete b[a]},eachInEl:function(d,b){var a=this;d.find(".js-"+
a.type).each(function(c,d){d=$(d);var e=d.attr("id");(e=a.get(e))&&b(e)})},generateId:function(d,b){var a=$H.expando+"_"+this.type+"_"+(d||$H.uuid());if(!0!=b&&this._all[a])$D.error("id\u91cd\u590d:"+a);else return a},get:function(d){var b=this._all;return b[d]||b[this.generateId(d,!0)]}});return f});
$Define("CM.ViewManager","CM.AbstractManager",function(f){var d=$H.createClass();$H.inherit(d,f,{type:"view",initialize:function(){var b=this;b.callSuper();$H.on("afterRender",function(a,c){b.afterRender(c)});$H.on("removeEl",function(a,c){b.destroy(c)})},afterRender:function(b){this.eachInEl(b,function(a){a.afterRender()})},destroy:function(b){this.eachInEl(b,function(a){a.destroy(!0)})}});$V=$H.getSingleton(d);return d});
$Define("CM.AbstractView",["CM.ViewManager","CM.AbstractEvents"],function(f,d){return d.derive({xtype:"View",renderBy:"append",autoRender:!0,listeners:[],_parseListenEvents:function(b,a){var c=this;return c._parseEvents(a.name,function(d){var e=$H.extend({},a);e.name=d[0];2==d.length&&(e.handler=d[1]);c[b].call(c,e)})},initialize:function(b){this.callSuper();this._listeners=[];this.listeners=$H.clone(this.listeners);this.manager=this.constructor.manager||$H.getSingleton(f);this.manager.register(this,
b);this.doConfig(b);this.init(b);this.parseItems();!1!=this.autoRender&&this.render();this.inited=!0},init:$H.noop,doConfig:function(b){b=(this.initParam=b)||{};$H.extend(this,b);var a;this.renderTo=(a=b.renderTo)?$(a):$(document.body)},getId:function(){return this._id},getCid:function(){return this.cid},getEl:function(){return this._container},getHtml:function(){return this.html},render:function(){var b=this.getHtml();this.renderTo[this.renderBy](b);this._container=$("#"+this.getId());this.initListeners()},
findEl:function(b){return this.getEl().find(b)},parseItems:$H.noop,callChild:$H.noop,listen:function(b){if(!this._parseListenEvents("listen",b)){var a=b.name,c=b.context,d=b.times,e=b.target,f=b.custom||e||$H.contains(this._customEvents,a),j=b.handler;$H.isFunc(e)&&(e=e.call(this));if(f)b=$H.removeUndefined([e,a,j,c,d]),this[e?"listenTo":"on"].apply(this,b);else if(this.listened){var e=this._listeners,d=b.el,f=b.method||"bind",k=b.selector,l=b.data,c=b.delegation=this._delegateHandler(j,c);$H.isFunc(d)&&
(d=d.call(this));d=d?"string"==typeof d?this.findEl(d):d:this.getEl();if(k)if(l)d[f](k,a,l,c);else d[f](k,a,c);else if(l)d[f](a,l,c);else d[f](a,c);e.push(b)}else this.listeners.push(b)}},unlisten:function(b){if(!this._parseListenEvents("unlisten",b)){var a=b.name,c=b.handler;if(b.custom)this.off(a,c);else{var d=b.el,e="delegate"==b.method?"undelegate":"unbind";b=b.selector;for(var f,d=d?"string"==typeof d?this.findEl(d):d:this.getEl(),j=this._listeners.length-1;0<=j;j--){var k=this._listeners[j];
if(k.handler==c){f=k.delegation;this._listeners.splice(j,1);break}}if(b)d[e](b,a,f);else d[e](a,f)}}},initListeners:function(){if(this.listened)return!1;this.listened=!0;for(var b=this.listeners,a=b.length-1;0<=a;a--)this.listen(b[a]);this.callChild()},clearListeners:function(){for(var b=this._listeners,a=b.length-1;0<=a;a--)this.unlisten(b[a]);this.off("all");this.unlistenTo("all");this.callChild()},destroy:function(){if(!this.destroyed)return this.clearListeners(),this.unlistenTo("all"),this.getEl().remove(),
this.destroyed=!0,this.manager.unregister(this),delete this._container,delete this.renderTo,delete this.html,!0}})});
$Define("CM.ModelView",["B.Template","CM.AbstractView","CM.Model","CM.Collection"],function(f,d,b,a){function c(a,e){return e.get?e.get(a):e[a]}function g(a,e){return!a?a:0==a.indexOf("#")?a.substring(1):c(a,e)}function e(a,e,c,b,d,f,h){var j;e="#"+e;var k=b.indexOf("?"),l=b.indexOf(":");if(0==b.indexOf("this."))return a[b.substring(5)];if(0<k||0<l){f=b.substring(0,0<k?k:l);var m=0>k?"":b.substring(k+1,0<l?l:b.length),p=0>l?"":b.substring(l+1,b.length);j=g(f,h);d&&0!=f.indexOf("#")&&a.listenTo(h,
"change:"+f,function(a,b,d){a=$(e);c?"class"==c?d?(p&&a.removeClass(p),m&&a.addClass(m)):(m&&a.removeClass(m),p&&a.addClass(p)):a.attr(c,d?m:p):d?a.prop(m,!0):a.prop(m,!1)});return j?m:p}j=g(b,h);0!=b.indexOf("#")&&(d&&a.listenTo(h,"change:"+b,function(a,b,d){a=$(e);"class"==c?(a.removeClass(j),a.addClass(d),j=d):a.attr(c,d||"")}),"value"==c&&f&&a.listen({name:"input propertychange",el:e,handler:function(a){h.set(b,a.target.value)}}));return j}d=d.derive({bindType:"both",initialize:function(){this._bindModelNums=
{};this._bindElNums={};this.callSuper()},doConfig:function(){this.callSuper();var a=this.modelClass||b;this.model||(this.model=new a(this.data));this.xmodel=this.model},preTmpl:function(){var a=this.tmpl;$H.isArr(a)&&(a=a.join(""));var e=l.test(a),c="#js-"+this.manager.type+" #js-"+this.xtype;if(e){if(e=a.match(m)[1])q.test(a)||(e=e.replace(/([^\s]+)/g,"#$1")),c+=" "+e;a=a.replace(m,"")}c=' id=this._id class="'+c+'"';this.tmpl=a=p.test(a)?a.replace(x,"$1"+c):a.replace(k,"$1 {{bindAttr"+c+"}}")},getTmplFn:function(){$H.isFunc(this.tmpl)||
(this.preTmpl(),this.tmpl=this.constructor.prototype.tmpl=$H.tmpl({tmpl:this.tmpl,ns:"ModelView"}));return this.tmpl},getHtml:function(){return this.html?this.html:this.html=this.getTmplFn()(this.xmodel,this)},ifBind:function(e,c,d){if(!d&&"el"==this.bindType||d&&"model"==this.bindType)return!1;d=d?this._bindElNums:this._bindModelNums;c=!d[e]&&(c instanceof b||c instanceof a);d[e]=1;return c},updateMetaMorph:function(a,e,c){if("append"==c)$("#metamorph-"+a+"-end").before(e);else{var b=$("#metamorph-"+
a+"-start");if(0!=b.length){a="metamorph-"+a+"-end";for(var d=b[0].nextSibling,f;d&&d.id!=a;)f=$(d),d=d.nextSibling,f.remove();e&&b.after(e);"remove"==c&&(b.remove(),$(d).remove())}}},wrapMetaMorph:function(a,e){return'<script id="metamorph-'+a+'-start" type="text/x-placeholder">\x3c/script>'+(e||"")+'<script id="metamorph-'+a+'-end" type="text/x-placeholder">\x3c/script>'},updateXmodel:function(a){this.xmodel.set(a)},getXmodel:function(){return this.xmodel}});f.registerHelper("ModelView",{"if":function(a,
e){var c=e.context,b=e.data,d=e.exp;$H.isFunc(a)&&(a=a.call(b));var f;if(a&&!e.inverse||!a&&e.inverse)f=e.fn(b);var g=e.num,h=c.getCid()+"-"+g;c.ifBind(g,b)&&c.listenTo(b,"change:"+d,function(a,b,f){var g;if(f&&!e.inverse||!f&&e.inverse)a={},a[d]=f,g=e.fn(a);c.updateMetaMorph(h,g)});return c.wrapMetaMorph(h,f)},unless:function(a,e){e.inverse=!0;return e.helpers["if"].call(this,a,e)},each:function(e,c){var b=c.context,d=c.fn,f=h?"":[],g=c.num,j=b.getCid()+"-"+g;if(e){var k;if(e instanceof a)e.each(function(a,
e){k=b.wrapMetaMorph(j+"-"+e.uuid,d(e));h?f+=k:f.push(k)}),b.ifBind(g,e)&&(b.listenTo(e,"add",function(a,e,c,f){a=b.wrapMetaMorph(j+"-"+e.uuid,d(e));(f=f.at)?(c=c.at(f-1),$("#metamorph-"+(j+"-"+c.uuid)+"-end").after(a)):$("#metamorph-"+j+"-end").before(a)}),b.listenTo(e,"remove",function(a,e){b.updateMetaMorph(j+"-"+e.uuid,"","remove")}));else if(void 0!==e.length)for(var l=0,g=e.length;l<g;l++)k=b.wrapMetaMorph(j+"-"+l,d(e[l])),h?f+=k:f.push(k);else for(l in e)k=b.wrapMetaMorph(j+"-"+l,d(e[l])),
h?f+=k:f.push(k);return b.wrapMetaMorph(j,h?f:f.join(""))}},getValue:c,parseValue:function(a,e){var c=e.context,b=e.data,d=e.exp,g=f.isEscape,h=e.helpers,j=e.num,k=c.getCid()+"-"+j;c.ifBind(j,b)&&c.listenTo(b,"change:"+d,function(a,e,b){g&&(b=h.escape(b));c.updateMetaMorph(k,b)});g&&(a=h.escape(a));return c.wrapMetaMorph(k,a)},bindAttr:function(a,c){for(var b=c.context,d=c.data,f=c.num,h="bindAttr-"+(b.getCid()+"-"+f),k=[],l=[],m=b.ifBind(f,d),p=b.ifBind(f,d,!0);f=j.exec(a);)"id"==f[2]?h=0==f[3].indexOf("this.")?
b[f[3].substring(5)]:g(f[3],d):l.push(f);k.push('id="'+h+'"');for(var n,q,x,B,D=0,I=l.length;D<I;D++){f=l[D];q=f[2];n=f[3];n=n.split(" ");x=[];for(var E=0;E<n.length;E++)((B=e(b,h,q,n[E],m,p,d))||0===B)&&x.push(B);n=x.join(" ");q?n=(f[1]||"")+n+f[4]:n&&(n=n+'="'+n+'"');n&&k.push(n)}return" "+k.join(" ")+" "}});var h=f.getIfPlusJoin(),j=/((\w+)=['"]?)?([#\w][\s\w\.\?:#-]*)(['"]?)(?!\w*=)/g,k=/[^<]*(<[a-zA-Z]+)/,l=/^[^>]+class=/,m=/class=['"]?([#\w][\s\w\.\?:#-]*)(['"]?)(?!\w*=)/,p=/^[^>]+{{bindAttr/,
q=/^[^>]+{{bindAttr((?!}}).)class=/,x=/({{bindAttr)/;return d});
$Define("CM.View",["CM.ViewManager","CM.ModelView","CM.Model","B.Template"],function(f,d,b,a){var c=/^(<[a-zA-Z]+)/,g=d.derive({xtype:"View",xConfig:{},tmpl:"<div>{{placeItem}}</div>",_customEvents:"beforeRender render afterRender beforeShow show afterShow beforeHide hide afterHide beforeUpdate update afterUpdate beforeDestroy destroy afterDestroy add remove".split(" "),_defaultEvents:"mousedown mouseup mouseover mousemove mouseenter mouseleave dragstart drag dragenter dragleave dragover drop dragend touchstart touchmove touchend touchcancel keydown keyup keypress click dblclick focus focusin focusout contextmenu change submit".split(" "),_applyArray:function(a,
c){var b=this,d=arguments,f=d.callee.caller,g=f.$owner.prototype;0==d.length?(d=f.arguments,d=$H.toArray(d),a=f.$name,c=d.shift()):d=$H.toArray(d,2);return $H.isArr(c)?($H.each(c,function(c,f){g[a].apply(b,[f].concat(d))}),!0):!1},initialize:function(){this.items=[];this.children=[];this.callSuper()},doConfig:function(a){var c=this;c.initParam=a;"string"==typeof a&&(a={text:a});var d=a||{};$H.extend(c,d,{notCover:function(a,e){var b=$H.contains(c._customEvents,a);if($H.contains(c._defaultEvents,a))return c.listeners.push({name:a,
handler:d[a]}),!0;if(b)return c.on(a,d[a]),!0;if("defItem"==a)return c[a]=$H.extend(c[a],e),!0;if("listener"==a)return c.listeners=c.listeners.concat($H.isArr(e)?e:[e]),!0;if("items"==a)return c.add(e),!0;if("extCls"==a&&c[a])return c[a]+=" "+e,!0;if("xtype"==a)return"View"==c[a]&&(c[a]="string"==typeof e?e:e.$ns),!0}});if(a=d.renderTo){if($H.isFunc(a))a=a.call(c);else if($H.isStr(a)&&0==a.indexOf(">")){var f=c.parent;a=f.inited&&f.findEl(a.substring(1))}else a=$(a);c.renderTo=a}else c.renderTo=$(document.body);
a=c.xConfig;c.modelClass||(f=a?b.derive({fields:a}):b,c.constructor.prototype.modelClass=f);var g={};$H.each(a,function(a){var e=c[a];void 0!==e&&(g[a]=e)});c.xmodel=new c.modelClass(g)},getHtml:function(){this.getId();var a;a="visibility"==this.displayMode?"visibility:hidden;":"display:none;";var b=this.callSuper(),b=b.replace(c,'$1 style="'+a+'"');this.extCls&&(b=b.replace(/(class=['"])/,"$1"+this.extCls+" "));return this.html=b},findHtml:function(a){a=this.find(a);for(var c=[],b=0;b<a.length;b++)c.push(a[b].getHtml());
return c.join("")},initStyle:function(){var a=this.getEl(),c=this.style||{};void 0!==this.width&&(c.width=this.width);void 0!==this.height&&(c.height=this.height);a.css(c)},beforeRender:function(){return this.trigger("beforeRender")},render:function(){if(!1==this.beforeRender())return!1;var a=this.getHtml();this.renderTo[this.renderBy](a);this.afterRender()},afterRender:function(){if(this.rendered)return!1;this.trigger("render");this.callChild();this._container=$("#"+this.getId());this.rendered=!0;
this.initStyle();!0!=this.notListen&&this.initListeners();this.disabled&&this.disable();this.trigger("afterRender");this.hidden||this.show()},beforeShow:function(){return this.trigger("beforeShow")},show:function(a,c){var b=this;if(!1==b.beforeShow()||b.showed||c&&b.hidden)return!1;if(!a&&b.delayShow)setTimeout(function(){g.prototype.show.call(b,!0)},0);else{b.trigger("show");b.showed=!0;var d=b.getEl();"visibility"==b.displayMode?d.css({visibility:"visible"}):d.show();b.callChild([null,!0]);b.afterShow()}},
afterShow:function(){var a=this;setTimeout(function(){a.trigger("afterShow")},0)},beforeHide:function(){return this.trigger("beforeHide")},hide:function(){if(!1==this.beforeHide()||!this.showed)return!1;this.showed=!1;var a=this.getEl();"visibility"==this.displayMode?a.css({visibility:"hidden"}):a.hide();this.trigger("hide");this.afterHide()},afterHide:function(){this.trigger("afterHide")},enable:function(){this.resume();this.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")},
disable:function(){this.suspend();this.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled","disabled")},getContent:function(a,c){c?!c instanceof g&&(c=this.find(c)[0]):c=this;return!1==a?c.children:c.getEl().html()},setContent:function(a,c){if(c)return!c instanceof g&&(c=this.find(c)[0]),c.setContent(a);var b=this.getEl();b.contents().remove();if("string"==typeof a)b.html(a);else return this.add(a)},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=!0;this.callChild()},
resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1;this.callChild()},parentsEl:function(a){return this.getEl().parents(a)},get:function(a){return this.xmodel.get(a)},set:function(a){return this.xmodel.get(a)},each:function(a,c){for(var b=this.children,d=b.length,f,g=0;g<d;){f=b[g];f=c?a.apply(f,c):a(g,f);if(!1===f)break;d==b.length?g++:d=b.length}},match:function(a,c){if("*"==a)return!0;var b=c||this,d,f,g;a=a.replace(/^#([^\s,\[]+)/,"[cid=$1]");a=a.replace(/^\.([^\s,\[]+)/,"[cClass=$1]");
a=a.replace(/^([^\[]+)/,"[xtype=$1]");for(var p=/\[([^=|\!]+)(=|\!=)([^=]+)\]/g;d=p.exec(a);){f=d[1];g=d[2];d=d[3];if("false"==d||"true"==d)d=eval(d);if("="===g?b[f]!=d:b[f]==d)return!1}return!0},find:function(a,c){var b=this;c=c||[];if(a)if($H.isNum(a))c.push(b.children[a]);else if($H.isStr(a)){if(0<a.indexOf(","))return $H.each(a.split(","),function(a,d){c=c.concat(b.find(d))}),c;var d=0==a.indexOf(">"),f=a.replace(/^>?\s?/,""),g=f.search(/\s|>/),p;0<g&&(p=f.substring(g),f=f.substring(0,g));b.each(function(b,
g){g.match(f)&&(p?g.find(p,c):c.push(g));d||g.find(a,c)})}else{if($H.isFunc(a)){var q=$H.isClass(a);b.each(function(b,d){(q&&d instanceof a||!q&&a(d))&&c.push(d);d.find(a,c)})}}else c=c.concat(b.children);return c},parents:function(a){for(var c=this;c.parent;)if(c=c.parent,a&&this.match(a,c))return c;return a||c===this?null:c},index:function(){var a=this,c=a.parent;if(c){var b;c.each(function(c,d){if(d==a)return b=c,!1});return b}return null},callChild:function(a,c){0!=this.children.length&&(a&&"string"!=
typeof a&&(c=a,a=null),a=a||arguments.callee.caller.$name,this.each(function(b,d){c?d[a].apply(d,c):d[a].call(d)}))},add:function(a,c){if(!this._applyArray()){var b=void 0===c;if(this.startParseItems){if(a instanceof g)a.parent=this;else{this.defItem&&$H.extend(a,this.defItem,{notCover:!0});this.parseItem(a);var d=this.manager.getClass(a.xtype);if(d){var f=a.renderTo;!this.inited&&($H.isStr(f)&&0==f.indexOf(">"))&&(f=null);f||(this.inited?a.renderTo=this.getEl():a.autoRender=!1);a.parent=this;a=new d(a)}else $D.error("xtype:"+
a.xtype+"\u672a\u627e\u5230")}d=this.children;b?d.push(a):d.splice(c,0,a);this.trigger("add",a);return a}d=this.items;b?d.push(a):d.splice(c,0,a)}},remove:function(a){if(!this._applyArray()){var c=this.children,b=!1,d;if($H.isNum(a))d=a,a=c[d];else if($H.isStr(a)||$H.isFunc(a)){a=this.find(a);for(var f=0,m=a.length;f<m;f++){if(!1==this.remove(a[f]))return!1;b=!0}}else if(a instanceof g)if(a.parent==this){f=0;for(m=c.length;f<m;f++)if(c[f]==a){d=f;break}}else return a.parent.remove(a);void 0!==d&&
!1!=a.destroy(!0)&&(c.splice(d,1),b=!0);this.trigger("remove",a);return b}},parseItem:function(){},parseItems:function(){this.startParseItems=!0;var a=this.items;if(a)for(var a=$H.isArr(a)?a:[a],c=0,b=a.length;c<b;c++)this.add(a[c])},beforeUpdate:function(){return this.trigger("beforeUpdate")},update:function(a,c){if(!a||!1==this.beforeUpdate())return!1;var b=this.xConfig,d=!0;$H.each(a,function(a){if("undefined"==typeof b[a])return d=!1});var f;if(d)this.xmodel.set(a),f=this;else{f=this.parent;var g=
$("<span></span>").insertBefore(this.getEl());c||(void 0===a.autoRender&&(a.autoRender=!0),a=$H.extend(a,this.initParam,{notCover:!0}));a=$H.extend(a,{xtype:this.xtype,renderBy:"replaceWith",renderTo:g},{notCover:["xtype"]});if(!a.cid||a.cid==this.cid)a._id=this._id;if(f){var p=this.index();if(!1==f.remove(this))return g.remove(),!1;f=f.add(a,p)}else{if(!1==this.destroy())return g.remove(),!1;f=new this.constructor(a)}}this.trigger("update",f);this.afterUpdate(f);return f},replace:function(a){return this.update(a,
!0)},afterUpdate:function(a){this.trigger("afterUpdate",a)},beforeDestroy:function(){return this.trigger("beforeDestroy")},destroy:function(a){if(!1==this.beforeDestroy())return!1;if(!this.destroyed)return this.callChild(),this.trigger("destroy"),this.clearListeners(),this.getEl().remove(),this.destroyed=!0,!a&&this.parent&&this.parent.remove(this),this.manager.unregister(this),delete this.initParam,delete this._container,delete this.renderTo,delete this._listeners,delete this.html,delete this.xmodel,
delete this.children,this.afterDestroy(),!0},afterDestroy:function(){this.trigger("afterDestroy")}},{extend:function(a){var c=this.prototype;$H.extend(c,a,{notCover:function(b){if("_customEvents"==b||"listeners"==b)return c[b]=(a[b]||[]).concat(c[b]||[]),!0;if("xtype"==b||"constructor"==b)return!0;if("xConfig"==b)return c[b]=$H.extendIf(a[b],c[b]),!0}})},html:function(a){return(new this($H.extend({autoRender:!1},a))).getHtml()}});a.registerHelper("ModelView",{placeItem:function(a,c){var b=c.context,
d=c.num,d=b.getCid()+"-"+d,f=b.findHtml(a);return b.wrapMetaMorph(d,f)}});c=/[^<]*(<[a-zA-Z]+)/;return g});$Define("C.ComponentManager",["CM.AbstractManager","CM.ViewManager"],function(f,d){var b=f.derive({type:"component",initialize:function(){var a=$H.getSingleton(d);this._types=a._types;this._all=a._all}});$CM=new b;return b});
$Define("C.AbstractComponent",["CM.ViewManager","CM.View"],function(f,d){$C=$H.ns("C",{});var b=$H.createClass();$H.inherit(b,d,{xtype:"AbstractComponent",xConfig:{extCls:"",tType:"",theme:"",cls:"",radius:null,shadow:!1,shadowInset:!1,shadowSurround:!1,shadowOverlay:!1,isMini:!1,isActive:!1,isFocus:!1,isInline:!1,activeCls:"hui-active",cmpCls:{depends:["cls"],parse:function(){return"hui-"+this.get("cls")}},tTypeCls:{depends:["tType"],parse:function(){var a=this.get("tType");return a?"hui-"+this.get("cls")+
"-"+a:""}},themeCls:{depends:["theme"],parse:function(){return this.get("theme")?"hui-"+this.get("cls")+"-"+this.get("theme"):""}},activeClass:{depends:["isActive","activeCls"],parse:function(){return this.get("isActive")?this.get("activeCls"):""}},radiusCls:{depends:["radius"],parse:function(){var a=this.get("radius");return a?"hui-radius-"+a:""}}},hasConfig:function(a,c){if(!c)return!1;if($H.isArr(c))for(var b=0,d=c.length;b<d;b++){if(this.match(a,c[b]))return!0}else if(this.match(a,c))return!0;
return!1},doConfig:function(){this.callSuper();this.icon&&this.add({xtype:"Icon",name:this.icon});this.isMini&&(this.defItem=$H.extend({isMini:!0},this.defItem))},preTmpl:function(){this.callSuper();this.tmpl=this.tmpl.replace(/(class=['"])/,"$1#js-component cmpCls tTypeCls themeCls radiusCls isMini?hui-mini shadow?hui-shadow shadowSurround?hui-shadow-surround shadowOverlay?hui-shadow-overlay shadowInset?hui-shadow-inset activeClass isFocus?hui-focus isInline?hui-inline ")},active:function(){this.update({isActive:!0})},
unactive:function(){this.update({isActive:!1})},txt:function(a){return void 0!==a?this.set("text",a):this.get("text")},valid:function(){var a=this.validator;if(a){var c=this.val();a.error||(a.error=function(a){new $C.Tips({text:a,theme:"error"})});return a=$H.Validator.valid(c,a)}for(var c=this.children,b=0,d=c.length;b<d;b++)if(a=c[b].valid(),!a)return a;return!0}},{define:function(a,c){var d=$H.createClass();$H.inherit(d,c||b,null,null,{notCover:function(a){return"define"==a}});$H.getSingleton(f).registerType(a,
d);return $C[a]=d}});return b});$Define("C.Icon","C.AbstractComponent",function(f){f=f.define("Icon");f.extend({xConfig:{cls:"icon",hasBg:!0,isAlt:!1,name:"",iconName:{depends:["name"],parse:function(){return"hui-icon-"+this.get("name")}}},tmpl:'<span {{bindAttr class="isAlt?hui-alt-icon iconName hasBg?hui-icon-bg"}}></span>',doConfig:function(d){$H.isStr(d)&&(d={name:d});this.callSuper([d])}});return f});
$Define("C.Button","C.AbstractComponent",function(f){f=f.define("Button");f.extend({xConfig:{cls:"btn",text:"",theme:"gray",iconPos:"",activeCls:"hui-btn-active",isBack:!1,radius:"little",shadow:!0,isInline:!0,iconPosCls:{depends:["iconPos"],parse:function(){var d=this.get("iconPos");return d?"hui-btn-icon-"+d:""}}},cls:"btn",defItem:{xtype:"Icon"},tmpl:'<a href="javascript:;" hidefocus="true" {{bindAttr class="text:hui-btn-icon-notxt isBack?hui-btn-back iconPosCls"}}><span class="hui-btn-txt">{{text}}</span>{{placeItem}}</a>'});
return f});
$Define("C.Panel","C.AbstractComponent",function(f){f=f.define("Panel");f.extend({xConfig:{cls:"panel",content:"",isLoading:!1,loadingTxt:"\u6b63\u5728\u52a0\u8f7d\u4e2d..."},tmpl:'<div>{{#if isLoading}}<div class="hui-panel-loading"><div class="hui-mask"></div><div class="hui-loading-container"><div class="hui-tips hui-tips-big hui-tips-black hui-radius-little"><span class="hui-icon hui-icon-loading"></span><span class="hui-tips-txt">{{loadingTxt}}</span></div></div></div>{{/if}}{{content}}{{placeItem}}</div>'});return f});
$Define("C.Popup","C.AbstractComponent",function(f){f=f.define("Popup");var d=0,b;f.extend({delayShow:!0,clickHide:!0,showPos:"center",destroyWhenHide:!0,shadowOverlay:!0,tmpl:'<div><%=this.findHtml(">*")%></div>',doConfig:function(){this.callSuper();this.clickHide&&this.listeners.push({name:"click",el:$(document),handler:function(){this.hide()}});$H.android()&&(this.listeners.push({name:"show",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.show")&&$("input,textarea,select").attr("disabled",
"disabled")}}),this.listeners.push({name:"hide",custom:!0,handler:function(){!0!=$H.Events.trigger("component.popup.hide")&&setTimeout(function(){$("input,textarea,select").removeAttr("disabled")},500)}}))},afterShow:function(){var a=this,c=a.getEl();c.css("z-index",1E3*d+1E3);if(!a.width&&a.parent){var b=a.width=a.parent.getEl().outerWidth();c.css("width",b)}c=a.showPos;if("string"==typeof c)a[c]();else"function"==typeof c&&c.call(a);a.noMask||a.mask();a.timeout&&setTimeout(function(){a.destroyed||
a.hide()},a.timeout)},hide:function(){!1!=this.callSuper()&&(this.noMask||this.unmask(),this.destroyWhenHide&&this.destroy())},top:function(){this.getEl().css({left:"80px",top:"8px",position:"fixed"})},center:function(){var a=this.getEl(),c=this.width||a.outerWidth(),b=this.height||a.outerHeight(),d=document,c=((d.documentElement.offsetWidth||d.body.offsetWidth)-c)/2,b=((d.documentElement.clientHeight||d.body.clientHeight)-b)/2+(d.documentElement.scrollTop||d.body.scrollTop),b=10>b?window.screen.height/
2-200:b;a.css({left:c+"px",top:b-(this.offsetTop||0)+"px"})},followEl:function(a){a=(a||this.parent.getEl()).position();this.getEl().css(a)},mask:function(){b||(b=$('<div class="hui-mask" style="display:none;"></div>').appendTo(document.body));b.css("z-index",1E3*d+998);0==d&&b.show();d++},unmask:function(){d--;0==d?b.hide():b.css("z-index",1E3*(d-1)+998)}});return f});
$Define("C.ControlGroup","C.AbstractComponent",function(f){f=f.define("ControlGroup");f.extend({xConfig:{cls:"ctrlgp",direction:"v",directionCls:{depends:["direction"],parse:function(){return"hui-ctrlgp-"+this.get("direction")}}},multi:!1,defItem:{xtype:"Button",radius:null,shadow:!1,isInline:!1},tmpl:'<div {{bindAttr class="directionCls"}}>{{placeItem}}</div>',listeners:[{name:"click",selector:".js-item",method:"delegate",handler:function(d){var b=$(d.currentTarget),b=this.find(">[_id="+b.attr("id")+
"]");0<b.length&&(b=b[0].index(),this.onItemClick(d,b))}}],parseItem:function(d){d.extCls=(d.extCls||"")+"js-item"},select:function(d){if(!this.notSelect&&(d="number"==typeof d?this.children[d]:"string"==typeof d?this.find(d)[0]:d))if(!this.multi&&!d.multi){var b=this.getSelected();b&&this.selectItem(b,!1);this.selectItem(d)}else this.selectItem(d,!d.get("selected"))},getSelected:function(d){var b=[];this.each(function(a,c){c.get("selected")&&b.push(d?a:c)});return 0<b.length?this.multi?b:b[0]:null},
selectItem:function(d,b){(b=!1!=b)?d.select?d.select():d.active():d.select?d.select(b):d.unactive()},val:function(d){if(d){var b=d.split(",");this.each(function(a,c){c.select($H.contains(b,c.value))})}else return b=[],this.each(function(a,c){c.get("selected")&&b.push(c.value)}),b.join(",")},onItemClick:function(d,b){this.select(b);this.itemClick&&this.itemClick(this.children[b],b)}});return f});
$Define("C.Radio","C.AbstractComponent",function(f){f=f.define("Radio");f.extend({xConfig:{cls:"radio",name:"",text:"",value:"",selected:!1},tmpl:'<div {{bindAttr class="#hui-btn #hui-btn-gray selected?hui-radio-on"}}><span class="hui-icon hui-icon-radio"></span><input type="radio" {{bindAttr selected?checked name="name" value="value"}}/><span class="hui-radio-txt">{{text}}</span></div>',select:function(d){this.update({selected:!1!=d})},val:function(d){if(d)this.set("value",d);else return this.get("value")}});
return f});
$Define("C.Checkbox","C.AbstractComponent",function(f){f=f.define("Checkbox");f.extend({text:"",value:"",selected:!1,multi:!0,cls:"chkbox",tmpl:'<div class="hui-btn hui-btn-gray<%if(this.selected){%> hui-chkbox-on<%}%>"><span class="hui-icon hui-icon-chkbox"></span><input type="checkbox"<%if(this.selected){%> checked=true<%}%><%if(this.name){%> name="<%=this.name%>"<%}%><%if(this.value){%> value="<%=this.value%>"<%}%>/><span class="hui-chkbox-txt"><%=this.text%></span></div>',select:function(d){this.selected=d=
!1!=d;var b=this.findEl("input"),a=this.getEl();d?(b.attr("checked",!0),a.addClass("hui-chkbox-on")):(b.removeAttr("checked"),a.removeClass("hui-chkbox-on"))},val:function(d){if(d)this.value=d,this.findEl("input").val(d);else return this.value}});return f});
$Define("C.Select","C.AbstractComponent",function(f){f=f.define("Select");f.extend({text:"\u8bf7\u9009\u62e9...",value:"",radius:"little",optionClick:function(){},defItem:{xtype:"Menu",hidden:!0,markType:"dot",renderTo:"body"},_customEvents:["change"],tmpl:'<div class="hui-btn hui-btn-gray hui-btn-icon-right"><span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span><input value="<%=this.value%>" name="<%=this.name%>"/><span class="hui-btn-txt js-select-txt"><%=this.text%></span></div>',
listeners:[{name:"click",handler:function(){this.showOptions()}}],doConfig:function(d){var b=this;b.callSuper();for(var a=d.options,c=!1,f=0,e=a.length;f<e;f++){var h=a[f];if(h.value==d.value){b.text=h.text;c=h.selected=!0;break}}c||delete b.value;b.add({itemClick:function(a){b.val(a.value)},width:b.width,items:a})},showOptions:function(){this.children[0].show()},val:function(d){if(d){if(this.value!=d){var b=this.children[0],a=b.find(">[value="+d+"]");0<a.length&&(this.trigger("change"),a=a[0],this.value=
d,this.findEl("input").attr("value",d),this.txt(a.text),b.select(a))}}else return this.value}});return f});
$Define("C.Input","C.AbstractComponent",function(f){f=f.define("Input");f.extend({radius:"little",iconPos:"left",btnPos:"right",tmpl:'<div class="<%if(this.hasIcon){%> hui-input-icon-<%=this.iconPos%><%}%><%if(this.hasBtn){%> hui-input-btn-<%=this.btnPos%><%}%>"><%=this.findHtml(">*")%><%if(this.type=="textarea"){%><textarea class="js-input"<%}else{%><input type="text" class="js-input hui-input-txt"<%}%>  name="<%=this.name%>"<%if(this.placeholder){%> placeholder="<%=this.placeholder%>"<%}%><%if(this.type=="textarea"){%>><%=this.value%></textarea><%}else{%> value="<%=this.value%>"/><%}%> </div>',listeners:[{name:"focus",
el:".js-input",handler:function(){this.getEl().addClass("hui-focus")}},{name:"blur",el:".js-input",handler:function(){this.getEl().removeClass("hui-focus")}}],doConfig:function(d){var b=this;"search"==d.type&&(b.icon="search");b.callSuper();"textarea"==b.type&&b.listeners.push({name:"input propertychange",el:".js-input",handler:function(){var a=b.findEl(".js-input"),c=a[0].scrollHeight;50<=c&&a.css("height",c)}});b.withClear&&b.add({xtype:"Button",radius:"big",icon:"delete",click:function(){this.parent.findEl("input").val("").focus()}})},
parseItem:function(d){"Icon"==d.xtype?this.hasIcon=!0:"Button"==d.xtype&&(this.hasBtn=!0)},val:function(d){var b=this.findEl("input,textarea");if(d)b.val(d);else return b.val()},focus:function(){this.findEl("input").focus()}});return f});$Define("C.Label","C.AbstractComponent",function(f){f=f.define("Label");f.extend({tmpl:'<label class="<%if(this.color){%> hui-label-<%=this.color%><%}%><%if(this.textAlign){%> c-txt-<%=this.textAlign%><%}%>" for="<%=this.forName%>"><%=this.text%></label>'});return f});
$Define("C.RowItem","C.AbstractComponent",function(f){f=f.define("RowItem");f.extend({cls:"rowitem",tmpl:'<div class="<%if(this.text){%> hui-rowitem-txt<%}%><%if(this.underline){%> hui-rowitem-underline<%}%>"><%=this.text%><%=this.findHtml(">*")%><%if(this.hasArrow){%><a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="\u8be6\u60c5"><span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span></a><%}%></div>',doConfig:function(d){this.callSuper();this.text||(this.text=
"&nbsp;");this.text&&void 0===this.underline&&(this.underline=!0);d.click&&void 0===this.hasArrow&&(this.hasArrow=!0)}});return f});$Define("C.Set","C.AbstractComponent",function(f){f=f.define("Set");f.extend({tmpl:'<div><h1 class="hui-set-title"><%=this.title%></h1><div class="hui-set-content"><%=this.findHtml(">*")%></div></div>'});return f});
$Define("C.Field","C.AbstractComponent",function(f){f=f.define("Field");f.extend({defItem:{xtype:"RowItem",xrole:"content"},tmpl:'<div class="<%if(this.noPadding){%> hui-field-nopadding<%}%>"><div class="hui-field-left"><%=this.findHtml(">[xrole=title]")%></div><div class="hui-field-right"><%=this.findHtml(">[xrole=content]")%></div></div>',doConfig:function(d){this.callSuper();var b=this.title;$H.isSimple(b)&&(b={text:b});b=$H.extend({xtype:"Label",xrole:"title"},b);this.add(b);b=this.content;void 0===
b&&!d.items&&(b="");$H.isSimple(b)&&(b={text:b,underline:!0});b&&(this.noPadding=!0,this.add(b))}});return f});$Define("C.Form","C.AbstractComponent",function(f){f=f.define("Form");f.extend({tmpl:'<div><form action=""><div class="hui-form-tips c-txt-error"></div><%=this.findHtml(">*")%></form></div>'});return f});
$Define("C.TabItem",["C.AbstractComponent","C.Panel"],function(f){f=f.define("TabItem");f.extend({defItem:{xtype:"Button",xrole:"title",radius:null,isInline:!1,iconPos:"top",shadow:!1},extCls:"js-item",tmpl:'<div><%=this.findHtml(">[xrole=title]")%></div>',initialize:function(){this.callSuper();this.titleCmp=this.find(">[xrole=title]")[0];this.contentCmp=this.find(">[xrole=content]")[0]},doConfig:function(d){this.callSuper();var b=d.title;"string"==typeof b&&(b={text:b});"object"==typeof b&&this.add(b);
d=d.content;"string"==typeof d&&(d={xtype:"Panel",content:d});"object"==typeof d&&($H.extend(d,{xrole:"content",hidden:!this.selected,extCls:"js-content"}),this.add(d));this.activeType&&(this.defItem.activeCls="hui-btn-active-"+this.activeType)},parseItem:function(d){this.selected&&"title"==d.xrole&&(d.isActive=!0)},select:function(d){var b=this.titleCmp,a=this.contentCmp;!1==d?(b.unactive(),a&&a.hide()):(b.active(),a&&a.show())},getContent:function(d,b){b||(b=this.contentCmp);return this.callSuper([d,
b])},setContent:function(d,b){b||(b=this.contentCmp);return this.callSuper([d,b])}});return f});
$Define("C.Tab",["C.AbstractComponent","C.TabItem","C.ControlGroup"],function(f,d,b){f=f.define("Tab",b);f.extend({cls:"tab",defItem:{xtype:"TabItem"},listeners:[{name:"afterRender add remove",custom:!0,handler:function(){this.layout()}}],tmpl:'<div><ul class="js-tab-btns c-clear"><%var aBtns=this.find(">TabItem");for(var i=0,len=aBtns.length;i<len;i++){%><li class="hui-tab-item"><%=aBtns[i].getHtml()%></li><%}%></ul><%=this.findHtml(">TabItem>[xrole=content]")%></div>',doConfig:function(){this.callSuper();
this.activeType&&(this.defItem.activeType=this.activeType)},layout:function(){var a=this.children.length,c=Math.floor(100/a);this.findEl(".js-tab-btns>li").each(function(b,d){d.style.width=b<a-1?c+"%":100-c*(a-1)+"%"})},setTabContent:function(a,c){c=c||this.getSelected(!0);this.findEl(".js-tab-content").index(c).html(a)}});return f});
$Define("C.Toolbar","C.AbstractComponent",function(f){f=f.define("Toolbar");f.extend({cls:"tbar",defItem:{xtype:"Button",theme:"black"},tmpl:'<div class="<%if(this.type=="header"){%> hui-header<%}else if(this.type=="footer"){%> hui-footer<%}%>"><%=this.findHtml(">*")%><%if(this.title){%><h1 class="hui-tbar-title js-tbar-txt"><%=this.title%></h1><%}%></div>',parseItem:function(d){"Button"==d.xtype&&(d.shadowSurround=!0,"left"==d.pos?d.extCls=(d.extCls||"")+" hui-tbar-btn-left":"right"==d.pos&&(d.extCls=
(d.extCls||"")+" hui-tbar-btn-right"))}});return f});
$Define("C.Tips",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(f,d){var b=f.define("Tips",d);b.extend({cls:"tips",tType:"big",theme:"black",timeout:1E3,radius:"normal",tmpl:'<div class="<%if(!this.text){%> hui-tips-notxt<%}%>"><%=this.findHtml(">*")%><%if(this.text){%><span class="hui-tips-txt"><%=this.text%></span><%}%></div>',doConfig:function(a){"loading"==a.type?$H.extend(this,{text:"\u6b63\u5728\u52a0\u8f7d\u4e2d...",timeout:null,noMask:!0,icon:"loading"}):"miniLoading"==a.type?
$H.extend(this,{showPos:"top",clickHide:!1,destroyWhenHide:!1,timeout:null,delayShow:!1,shadowOverlay:null,theme:null,noMask:!0,tType:"mini",items:{xtype:"Icon",name:"loading-mini",hasBg:!1}}):"topTips"==a.type&&$H.extend(this,{showPos:"top",noMask:!0,tType:"mini"});this.callSuper()}});return b});
$Define("C.Dialog",["C.AbstractComponent","C.Popup"],function(f,d){var b=f.define("Dialog",d);$H.extend(b,{alert:function(a){return new b({contentMsg:a,noClose:!0,noCancel:!0})},confirm:function(a,c){return new b({contentMsg:a,noClose:!0,okCall:function(){return c&&c(!0)},cancelCall:function(){return c&&c(!1)}})},prompt:function(a,c,d){d||(d=c,c="");return new b({contentMsg:a,noClose:!0,items:{xtype:"Input",xrole:"dialog-content",value:c},okCall:function(){var a=this.find("Input")[0].val();return d&&
d(a)}})}});b.extend({okTxt:"\u786e\u5b9a",cancelTxt:"\u53d6\u6d88",clickHide:!1,radius:"little",tmpl:'<div><%=this.findHtml(">[xrole=dialog-header]")%><div class="hui-dialog-body"><%if(this.content){%><%=this.content%><%}else{%><div class="hui-body-content"><h1 class="hui-content-title"><%=this.contentTitle%></h1><div class="hui-content-msg"><%=this.contentMsg%></div><%=this.findHtml(">[xrole=dialog-content]")%></div><%}%><%if(!this.noAction){%><div class="hui-body-action"><%=this.findHtml(">[xrole=dialog-action]")%></div><%}%></div></div>',
doConfig:function(a){var c=this;c.callSuper();a=a.items;c.title&&!c.hasConfig("[xrole=dialog-header]",a)&&c.add({xtype:"Toolbar",title:c.title,theme:"gray",xrole:"dialog-header",extCls:"hui-dialog-header",items:!c.noClose&&{xtype:"Button",radius:"big",icon:"delete",isMini:!1,theme:"gray",pos:"left",click:function(){c.hide()}}});!c.noAction&&!c.hasConfig("[xrole=dialog-action]",a)&&(a=[],c.noCancel||a.push({title:{isActive:1==c.activeBtn,text:c.cancelTxt,click:function(){!1!=(c.cancelCall&&c.cancelCall())&&
c.hide()}}}),c.noOk||a.push({title:{text:c.okTxt,isActive:2==c.activeBtn,click:function(){!1!=(c.okCall&&c.okCall())&&c.hide()}}}),c.add({xtype:"Tab",xrole:"dialog-action",theme:"border-top",notSelect:!0,items:a}))}});return b});
$Define("C.Menu",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(f,d,b){f=f.define("Menu",d);f.extend(b.prototype);f.extend({notDestroy:!0,cls:"menu",tmpl:'<div class="<%if(this.markType=="dot"){%> hui-menu-mark<%}%>"><ul><%for(var i=0,len=this.children.length;i<len;i++){%><li class="hui-menu-item<%if(this.children[i].selected){%> hui-item-mark<%}%>"><%=this.children[i].getHtml()%><%if(this.markType=="dot"){%><span class="hui-icon-mark"></span><%}%></li><%}%></ul></div>',selectItem:function(a,
c){c=!1!=c;"dot"==this.markType?(a.selected=c,a.getEl().parent()[!1==c?"removeClass":"addClass"]("hui-item-mark")):"active"==this.markType?b.prototype.selectItem.call(this,a,c):a.selected=c}});return f});
$Define("C.Hcard","C.AbstractComponent",function(f){f=f.define("Hcard");f.extend({tmpl:'<div class="hui-hcard<%if(this.image){%> hui-hcard-hasimg"><div class="hui-hcard-img"><img src="<%=this.image%>"></div><%}else{%>"><%}%><div class="hui-hcard-content"><div class="hui-content-title"><%=this.title%></div><%var aDesc=this.desc;aDesc=$H.isArr(aDesc)?aDesc:[aDesc];for(var i=0;i<aDesc.length;i++){%><div class="hui-content-desc"><%var icon;if(icon=aDesc[i].icon){%><span class="hui-icon hui-mini hui-alt-icon hui-icon-<%=icon%> hui-light"></span><%}%><%=aDesc[i].text%></div><%}%></div><%=this.findHtml(">*")%><%if(this.hasArrow){%><a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="\u8be6\u60c5"><span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span></a><%}%></div>',doConfig:function(d){this.callSuper();
d.click&&void 0===this.hasArrow&&(this.hasArrow=!0)}});return f});
$Define("C.Vcard","C.AbstractComponent",function(f){f=f.define("Vcard");f.extend({tmpl:'<div class="hui-vcard"><div class="hui-vcard-title hui-title-hasimg c-clear"><div class="hui-title-img"><img alt="" src="<%=this.image%>"></div><div class="hui-title-txt"><%=this.title%></div><div class="hui-title-extra"><%=this.extraTitle%></div></div><%=this.findHtml(">[xrole!=action]")%><div class="hui-vcard-action"><%=this.findHtml(">[xrole=action]")%></div></div>',doConfig:function(d){this.callSuper();if(d=
d.action)d=$H.extend({xtype:"Button",radius:null,isInline:!1,xrole:"action"},d),this.add(d)}});return f});
$Define("C.ModelList","C.AbstractComponent",function(f){f=f.define("ModelList");f.extend({emptyTips:"\u6682\u65e0\u7ed3\u679c",pdText:"\u4e0b\u62c9\u53ef\u5237\u65b0",pdComment:"\u4e0a\u6b21\u5237\u65b0\u65f6\u95f4\uff1a",tmpl:'<div class="hui-list"><div class="hui-list-inner"><div<%if(this.children.length>0){%> style="display:none"<%}%> class="hui-list-empty js-empty"><%=this.emptyTips%></div><%if(this.hasPullRefresh){%><div class="hui-list-pulldown hui-pd-pull c-h-middle-container"><div class="c-h-middle"><span class="hui-icon hui-alt-icon hui-icon-arrow-d hui-light"></span><span class="hui-icon hui-alt-icon hui-icon-loading-mini"></span><div class="hui-pd-txt"><%if(this.pdText){%><div class="js-txt"><%=this.pdText%></div><%}%><%if(this.pdComment){%><div class="js-comment hui-pd-comment"><span class="js-pdComment"><%=this.pdComment%></span><span class="js-pdTime"><%=this.pdTime%></span></div><%}%></div></div></div><%}%><div class="js-item-container"><%=this.findHtml(">*")%></div><%if(this.hasPullRefresh){%><div class="hui-list-more"><a href="javascript:;" hidefocus="true" class="hui-btn hui-btn-gray hui-shadow hui-inline hui-radius-normal"><span class="hui-btn-txt">\u67e5\u770b\u66f4\u591a</span></a></div><%}%></div></div>',init:function(){var d=
this;d.itemXtype&&((d.defItem||(d.defItem={})).xtype=d.itemXtype);var b=d.model;b.each(function(a,c){d.addListItem(c)});d.listenTo(b,{add:function(a,c){d.addListItem(c)},remove:function(a,c){d.removeListItem(c)},reset:function(){d.removeListItem("emptyAll")}});d.hasPullRefresh=d.hasPullRefresh&&window.iScroll;d.hasPullRefresh&&(d.listen({name:"afterRender",handler:function(){var a=this,c=a.getEl(),b=c.find(".hui-list-pulldown"),d=b.find(".js-txt");a.scroller=new window.iScroll(c[0],{useTransition:!0,
topOffset:50,onRefresh:function(){b.hasClass("hui-pd-refresh")&&(b.removeClass("hui-pd-refresh hui-pd-release"),d.html("\u4e0b\u62c9\u53ef\u5237\u65b0"))},onScrollMove:function(){5<this.y&&!b.hasClass("hui-pd-release")?(b.addClass("hui-pd-release"),d.html("\u677e\u5f00\u53ef\u5237\u65b0"),this.minScrollY=0):5>this.y&&b.hasClass("hui-pd-release")&&(b.removeClass("hui-pd-release"),d.html("\u4e0b\u62c9\u53ef\u5237\u65b0"),this.minScrollY=-50)},onScrollEnd:function(){b.hasClass("hui-pd-release")&&(b.addClass("hui-pd-refresh"),
d.html("\u6b63\u5728\u5237\u65b0"),a.refresh())}})}}),d.listenTo(d.model,"sync",function(){d.findEl(".js-pdTime").html($H.formatDate($H.now(),"HH:mm"));setTimeout(function(){d.refreshScroller()},0)}),d.listen({name:"afterShow",handler:function(){d.refreshScroller()}}),d.listen({name:"click",method:"delegate",selector:".hui-list-more",handler:function(){d.getMore()}}))},addListItem:function(d){this.inited&&this.findEl(".js-empty").hide();this.add({model:d,renderTo:">.js-item-container"})},removeListItem:function(d){"emptyAll"==
d?this.remove(this.children):this.remove(function(b){return b.model&&b.model.id==d.id});0==this.children.length&&this.findEl(".js-empty").show()},refreshScroller:function(){this.scroller&&this.getEl()[0].clientHeight&&this.scroller.refresh()},destroy:function(){this.scroller&&(this.scroller.destroy(),this.scroller=null);this.callSuper()}});return f});
$Define("M.AbstractModule","CM.View",function(f){var d=$H.createClass();$H.inherit(d,f,{useCache:$H.noop,cache:$H.noop,init:$H.noop,reset:$H.noop,exit:function(){return!0},cleanCache:function(){this.clearCache=!0}});return d});$Define("M.AbstractNavigator","handy.base.Object",function(f){var d=$H.createClass();f.extend(d.prototype,{navigate:function(){}});return d});
$Define("M.History","handy.base.HashChange",function(f){var d=$H.createClass(),b=0;$H.extend(d.prototype,{initialize:function(a,c){"function"==typeof a&&(c=a,a=null);this.error=c||$H.noop;this.key=a||"handy";this.states=[];f.listen($H.Function.bind(this.stateChange,this))},stateChange:function(){var a=this.getHashParam(),c=a.hKey,b=this.currentKey,d=this.states,f=d[b];if(c==b)return!1;(d=d[c])?a=d.onStateChange(d.param,!0):($D.warn("hisory state not found"),a=this.error("stateNotFound",a));!0!=a?
(a={hKey:b,param:f.param},this.saveHash(a)):this.currentKey=c},saveState:function(a){var c=this.currentKey=this.key+ ++b;this.states.push(c);this.states[c]=a;this.saveHash({hKey:c,param:a.param})},saveHash:function(a){$H.setHash("#"+$H.Json.stringify(a))},getHashParam:function(){try{var a=$H.getHash().replace("#","");return $H.parseJson(a)}catch(c){$H.Debug.warn("History.getCurrentState:parse hash error:"+c.message)}},getCurrentState:function(){try{var a=this.getHashParam();return this.states[a.hKey]}catch(c){$H.Debug.warn("History.getCurrentState:parse hash error:"+
c.message)}},getPreState:function(){try{for(var a=this.getHashParam().hKey,c=this.states,b=c.length,d=0;d++;d<b)if(c[d]==a)return 0<d?c[c[--d]]:null}catch(f){$H.Debug.error("History.getPreState error:"+f.message,f)}},back:function(){var a=this.getPreState();if(a)a.onStateChange(a.param)}});return d});
$Define("M.ModuleManager",["M.History","CM.AbstractManager"],function(f,d){var b=$H.createClass();$H.inherit(b,d,{type:"module",_createMod:function(a){var c=this,b=a.modName;c.modules[b]={waiting:!0};$Require(c.defModPackage+b,function(d){var f={renderTo:c.container,name:b,xtype:b,extCls:"js-module m-module m-"+b.replace(/\./g,"-"),hidden:!0};$H.extend(f,a);d=new d(f);c.modules[b]=d;$H.trigger("afterRender",d.getEl());c.requestMod==b&&c._showMod(d)})},_showMod:function(a){var c=this.modules[this.currentMod];
if(!this.navigator||!this.navigator.navigate(a,c,this))c&&c.hide(),a.show();c&&(c.isActive=!1);a.isActive=!0;this.currentMod=a.name},_destroy:function(a){a.destroy();delete this.modules[a.name]},initialize:function(a){var c=this;c.callSuper();a&&(c.conf=a,$H.extend(c,a),c.container=a.container?$(a.container):$(document.body));c.defModPackage+=".";c.history=new f(function(a,b){c.go(b.param)});c.modules={}},go:function(a,b){"string"==typeof a&&(a={modName:a});var d=a.modName,e=this.currentMod,f=this.modules,
j=f[e];if(e==d)j.waiting||j.reset();else{if(j&&!j.waiting)if(j._forceExit)j._forceExit=!1;else if(!1==j.exit())return!1;this.requestMod=d;(d=f[d])?!0!=d.notCache&&!0!=d.clearCache&&!1!=d.useCache(a)?(!1==d.clearCache,this._showMod(d),d.cache(a)):d.waiting||(this._destroy(d),this._createMod(a)):this._createMod(a);!0!=b&&this.history.saveState({onStateChange:$H.Function.bind(this.go,this),param:a});return!0}},update:function(a,b){var d=a.update(b);d&&(this.modules[a.name]=d,$H.trigger("afterRender",
d.getEl()));return d},clearCache:function(a){a.notCache=!0},back:function(a){a&&(this.modules[this.currentMod]._forceExit=!0);history.back()}});return b});
