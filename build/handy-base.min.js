/* Handy v1.0.0-dev | 2014-04-11 | zhengyinhui100@gmail.com */
(function(){var e=window.handy,c=window.$,b=window.handy=window.$=function(){};b.version="1.0.0";b.isDebug="undefined"==typeof gEnv?!1:"dev"==gEnv;b.expando="handy"+(b.version+Math.random()).replace(/\D/g,"");b.add=function(a,d,f){f||(f=d,d=null);b.base||(b.base={});var c=[];if(d)if("string"==typeof d)c.push(b.base.Object.ns(d));else for(var j=0;j<d.length;j++)c.push(b.base.Object.ns(d[j]));c.push(b);d=f.apply(window,c);b.base[a]=b[a]=d;if(0<="Browser,Class,Array,Cookie,Date,Events,Function,Json,Object,String,Template,Util".indexOf(a))for(var h in d)b.isDebug&&
("undefined"!=typeof b[h]&&"console"in window&&!Function[h])&&(console.log(b[h]),console.log(a+"\u547d\u540d\u51b2\u7a81:"+h)),b[h]=d[h]};b.noConflict=function(a){window.$===b&&(window.$=c);a&&window.handy===b&&(window.handy=e);return b};b.noop=function(){}})();
handy.add("Json",function(){function e(a){g.lastIndex=0;g.test(a)&&(a=a.replace(g,function(a){var d=j[a];return"string"===typeof d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));return'"'+a+'"'}function c(b,g){var h,k,j,p,n=d,r,q=g[b];q&&("object"===typeof q&&"function"===typeof q.toJSON)&&(q=q.toJSON(b));"function"===typeof a&&(q=a.call(g,b,q));switch(typeof q){case "string":return e(q);case "number":return isFinite(q)?String(q):"null";case "boolean":case "null":return String(q);case "object":if(!q)return"null";
d+=f;r=[];if("[object Array]"===Object.prototype.toString.apply(q)){p=q.length;for(h=0;h<p;h+=1)r[h]=c(h,q)||"null";j=0===r.length?"[]":d?"[\n"+d+r.join(",\n"+d)+"\n"+n+"]":"["+r.join(",")+"]";d=n;return j}if(a&&"object"===typeof a){p=a.length;for(h=0;h<p;h+=1)"string"===typeof a[h]&&(k=a[h],(j=c(k,q))&&r.push(e(k)+(d?": ":":")+j))}else for(k in q)Object.prototype.hasOwnProperty.call(q,k)&&(j=c(k,q))&&r.push(e(k)+(d?": ":":")+j);j=0===r.length?"{}":d?"{\n"+d+r.join(",\n"+d)+"\n"+n+"}":"{"+r.join(",")+
"}";d=n;return j}}var b="JSON"in window,a,d,f,g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,n=/(?:^|:|,)(?:\s*\[)+/g;
return{stringify:function(h,g,k,j){if(b&&!j)return JSON.stringify.apply(null,arguments);var e;f=d="";if("number"===typeof k)for(e=0;e<k;e+=1)f+=" ";else"string"===typeof k&&(f=k);if((a=g)&&"function"!==typeof g&&("object"!==typeof g||"number"!==typeof g.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return c("",{"":h})},parseJson:function(a,d,f){function c(a,b){var f,g,h=a[b];if(h&&"object"===typeof h)for(f in h)Object.prototype.hasOwnProperty.call(h,
f)&&(g=c(h,f),void 0!==g?h[f]=g:delete h[f]);return d.call(a,b,h)}if(b&&!f)return JSON.parse.apply(null,arguments);var g;a=String(a);h.lastIndex=0;h.test(a)&&(a=a.replace(h,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(k.test(a.replace(p,"@").replace(r,"]").replace(n,"")))return g=eval("("+a+")"),"function"===typeof d?c({"":g},""):g;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var e;e=(e=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(e[0])?function(b,a,d){var f=[];if(b.length){a=a||0;for(d=d||b.length;a<d;a++)f.push(b[a])}return f}:function(b,a,d){return Array.prototype.slice.call(b,a||0,d||b.length)};var c={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},ns:function(b,a){var d=null,f,g,j,h;b=c.alias(b);g=b.split(".");d=g[0];d=(j=2==arguments.length)?eval("(function(){if (typeof "+d+' == "undefined"){'+
d+" = {};}return "+d+";})()"):eval("(function(){if (typeof "+d+' != "undefined")return '+d+";})()");f=1;for(h=g.length;f<h;++f){if(f==h-1&&j)d[g[f]]=a;else if(j||d&&d[g[f]])d[g[f]]=d[g[f]]||{};else return;d=d[g[f]]}return d},alias:function(b,a){var d=c._alias;if(a)d[b]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+b+":"+d[b]):d[b]=a;else{if(b){var f=b,g=b.length-1;do{if(d[f])return d[f]+b.substring(g);g=f.lastIndexOf(".")}while(0<g&&(f=f.substring(0,g)));return b}return d}},extend:function(b,a,
d){if(!a||c.isStr(a)||c.isNum(a))return b;var f=d?d.notCover:!1,g=d?d.cover:null;d=d?d.IsClone:!1;b=b||{};var j=b.constructor,h=j.$isClass,k,e;for(e in a)if(k=a[e],(!g||c.contains(g,e))&&a.hasOwnProperty(e)){var r=b.hasOwnProperty(e),n=!0===f?r:!1;c.isArr(f)?n=c.contains(f,e)&&r:c.isFunc(f)&&(n=f(e,k));n||(k=d?c.clone(k):k,h&&c.isFunc(k)&&(k.$name=e,k.$owner=j),b[e]=k)}return b},mix:function(b,a,d){b.superProto||(b.superProto={});for(var f in a)b.superProto[f]=c.isFunc(a[f])?b.superProto[f]?function(d,
b){return function(){b.apply(this,arguments);a[d].apply(this,arguments)}}(f,b.superProto[f]):a[f]:a[f],b[f]||(b[f]=a[f]);d&&c.extend(b,d);a.toString!=a.constructor.prototype.toString&&(b.superProto.toString=function(){a.toString.apply(b,arguments)});return b},isNum:function(b){return"number"==typeof b},isStr:function(b){return"string"==typeof b},isBool:function(b){return"boolean"==typeof b},isSimple:function(b){return c.isStr(b)||c.isNum(b)||c.isBool(b)},isUndef:function(b){return"undefined"==typeof b},
isFunc:function(b){return"[object Function]"===Object.prototype.toString.call(b)},isArr:function(b){return"[object Array]"===Object.prototype.toString.call(b)},isObj:function(b){return"object"==typeof b&&!c.isArr(b)},isClass:function(b){return c.isFunc(b)&&!0===b.$isClass},equals:function(b,a){if(typeof b==typeof a){if("object"!=typeof b)return b===a;if(b===a)return!0;if(c.isArr(b)&&c.isArr(a)){if(b.length!=a.length)return!1;for(var d=0,f=b.length;d<f;d++)if(!c.equals(b[d],a[d]))return!1;return!0}if(!c.isArr(b)&&
!c.isArr(a)){if(c.count(b)!=c.count(a))return!1;for(d in b)if(void 0==a[d]||!c.equals(b[d],a[d]))return!1;return!0}}return!1},clone:function(b){if(null==b||"object"!=typeof b)return b;var a=b.constructor;if(a!=Object&&a!=window.Array)return b;if(a==window.Date||a==window.RegExp||a==window.Function||a==window.String||a==window.Number||a==window.Boolean)return new a(b);try{var d=new a,f;for(f in b)d[f]=c.clone(b[f]);return d}catch(g){return b}},isEmpty:function(b){if(c.isArr(b))return 0==b.length;for(var a in b)return!1;
return!0},each:function(b,a,d){if(b){var f,g=0,j=b.length,h=void 0===j||c.isFunc(b);if(d)if(h)for(f in b){if(!1===a.apply(b[f],d))break}else for(;g<j&&!1!==a.apply(b[g],d);)f=b.length,j==f?g++:j=f;else if(h)for(f in b){if(!1===a.call(b[f],f,b[f]))break}else for(;g<j&&!1!==a.call(b[g],g,b[g]);)f=b.length,j==f?g++:j=f;return b}},contains:function(b,a){if(!b)return!1;var d=!1;c.each(b,function(b,g){if(c.equals(g,a))return d=!0,!1});return d},largeThan:function(b,a){if("object"==typeof b&&"object"==typeof a){var d=
!0;c.each(a,function(f){if(!c.equals(a[f],b[f]))return d=!1});return d}},count:function(b){if(c.isArr(b))return b.length;var a=0,d;for(d in b)a++;return a},removeUndefined:function(b,a){var d=c.isArr(b);if(a){if(d){var f=[];c.each(b,function(a,d){void 0!==d&&f.push(d)});return f}return c.extend({},b,{isClone:!0,notCover:function(a,d){return void 0===d}})}c.each(b,function(a,f){void 0===f&&(d?b.splice(a,1):delete b[a])});return b},toArray:e,fromArray:function(b){for(var a={},d=0,f=b.length;d<f;d++){var c=
b[d];a[c.name]=c.value}return a},generateMethod:function(b,a,d){a=c.isArr(a)?a:a.split(",");for(var f=0;f<a.length;f++){var g=a[f];b[g]=d(g)}}};return c});
handy.add("Browser","handy.base.Object",function(e){var c={},b={};e.generateMethod(b,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(a){return function(d){var b=c[a];return!d&&"string"===typeof b&&/^[\d\.]+$/.test(b)?parseInt(b):b}});e=window.navigator.userAgent;var a;(a=e.match(/MSIE ([\d.]+)/))?c.ie=a[1]:(a=e.match(/Firefox\/([\d.]+)/))?c.firefox=a[1]:(a=e.match(/Chrome\/([\d.]+)/))?
c.chrome=a[1]:(a=e.match(/Opera.([\d.]+)/))?c.opera=a[1]:(a=e.match(/Version\/([\d.]+).*Safari/))?c.safari=a[1]:0;/windows|win32/i.test(e)?c.windows=!0:/linux/i.test(e)?c.linux=!0:/macintosh/i.test(e)?c.mac=!0:0;/trident/i.test(e)?c.trident=!0:/webkit/i.test(e)?c.webkit=!0:/gecko/i.test(e)?c.gecko=!0:/presto/i.test(e)?c.presto=!0:0;/MetaSr/i.test(e)?c.sogou=!0:/Maxthon/i.test(e)?c.maxthon=!0:/TencentTraveler/i.test(e)?c.tt=!0:/TheWorld/i.test(e)?c.theWorld=!0:/360[S|E]E/i.test(e)?c.is360=!0:0;var d;
if((d=e.match(/AppleWebKit\/([\d.]*)/))&&d[1])if(/ Mobile\//.test(e)&&e.match(/iPad|iPod|iPhone/)){c.mobile="ios";if((d=e.match(/OS ([^\s]*)/))&&d[1])c.ios=d[1].replace("_",".");if((d=e.match(/iPad|iPod|iPhone/))&&d[0])c[d[0].toLowerCase()]=c.ios}else if(/ Android/i.test(e)){if(/Mobile/.test(e)&&(c.mobile="android"),(d=e.match(/Android ([^\s]*);/))&&d[1])c.android=d[1]}else if(d=e.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))c.mobile=d[0].toLowerCase();var f;try{if(c.ie){var g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
g&&(f=g.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(g=navigator.plugins["Shockwave Flash"])){var j=g.description.split(" ");a=0;for(var h=j.length;a<h;a++)if(0<parseInt(j[a])){f=j[a];break}}}catch(k){}c.flash=f?f:null;return b});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(e,c,b){var a={level:b.isDebug?0:5,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!c.mobile(),out:function(d,f,c){c=c||"log";if(f||a.showInPage){var e=b.expando+"debugDiv",h=top.document,k=h.getElementById(e);k?k.style.display="block":(k=h.createElement("DIV"),k.id=e,k.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+h.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u5168\u5c4f</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',k.style.position="fixed",k.style.width=h.body.offsetWidth-20+"px",k.style.left=0,k.style.top=0,k.style.right=0,k.style.height="150px",k.style.backgroundColor="#aaa",k.style.fontSize="12px",k.style.padding="10px",k.style.zIndex=9999999999,k.style.opacity=0.8,k.style.filter="alpha(opacity=80)",h.body.appendChild(k));e=k.getElementsByTagName("DIV")[0];h=b.Json.stringify(d,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0).replace(/\n/g,"<br/>");e.innerHTML+=
c+" : "+h+"<br/>";e.scrollTop=e.scrollHeight}e=arguments.callee.caller;e.$owner||(e=e.caller);try{if(e.$owner)console[c]("["+e.$owner.$ns+"->"+e.$name+"]");console[c](d)}catch(p){}},log:function(d,b){a.level>a.LOG_LEVEL||a.out(d,!!b,"log")},info:function(d,b){this.level>a.INFO_LEVEL||a.out(d,!!b,"info")},warn:function(d,b){a.level>a.WARN_LEVEL||a.out(d,!!b,"warn")},error:function(d,b){if(!(a.level>a.ERROR_LEVEL)&&(a.out(d,!!b,"error"),d instanceof Error))throw d;},time:function(d,b,c){a.level>a.INFO_LEVEL||
(d?("boolean"==typeof b&&(c=b,b=""),a.out((b||"")+((new Date).getTime()-(a.lastTime||0)),!!c)):a.lastTime=(new Date).getTime())},debug:function(d){if(!(a.level>a.DEBUG_LEVEL)&&!1!==d)debugger}};return a});
handy.add("Function",function(e){return{bind:function(c,b,a){var d=Array.prototype.slice.call(arguments,2);return function(){Array.prototype.push.apply(d,arguments);return c.apply(b,d)}},intercept:function(c,b,a,d){return e.Object.isFunc(c)&&e.Object.isFunc(b)?function(){var f=a||this,g={},e=arguments;g.scope=d;g.target=f;g.method=c;return!1!=b.apply(g,e)?c.apply(f,e):!1}:c}}});
handy.add("Class",["B.Object","B.Debug"],function(e,c){var b={createClass:function(a){var d=function(){var a,b,c=arguments;if(this.constructor==d)a=this;else return a=c.callee,b=function(){},b.prototype=a.prototype,b=new b,a.apply(b,c),b;if(b=a.initialize){for(var h in a)"object"==typeof a[h]&&(a[h]=e.clone(a[h]));return b.apply(a,c)}};d.$isClass=!0;d.derive=function(a,d,c){var h=b.createClass();b.inherit(h,this,a,d,c);return h};d.prototype.callSuper=function(a,d){a&&(!a.$isClass&&void 0!=a.length)&&
(d=a,a=null);var b=arguments.callee.caller,c=b.$owner.superProto;d=d||b.arguments;a=a?a.prototype:c||this.constructor.superProto;b=b.$name;if(a&&(b=a[b],e.isFunc(b)))return b.apply(this,d)};a&&this.ns(a,d);return d},inherit:function(a,d,b,g,j){var h=function(){};h.prototype=d.prototype;e.extend(a,d,j);a.prototype=new h;a.prototype.constructor=a;a.superClass=d;a.superProto=d.prototype;if(d._onInherit)try{d._onInherit(a)}catch(k){c.error(k)}g&&e.extend(a,g);b&&e.extend(a.prototype,b)},getSingleton:function(a){return(a=
"string"==typeof a?e.ns(a):a)&&(a.$singleton||(a.$singleton=new a))}};return b});
handy.add("Loader",["B.Debug","B.Object","B.Function"],function(e,c,b,a){function d(a){var d={},b=[];"string"==typeof a&&(a=[a]);for(var f=0,h=a.length;f<h;f++){var e;e=a[f];e=/\.(css|js)$/.test(e)?x[e]&&"loaded"==x[e].status:m.urlMap&&m.urlMap[e]?m.urlMap[e].chkExist():c.ns(e);if(e)b.push(e);else return d.notExist=a[f],d}d.exist=b;return d}function f(a,d){function b(){b.isCalled||(b.isCalled=!0,clearTimeout(k),d())}if("SCRIPT"===a.nodeName){var c=a,f=b;c.onload=c.onerror=c.onreadystatechange=function(){/loaded|complete|undefined/.test(c.readyState)&&
(c.onload=c.onerror=c.onreadystatechange=null,r.removeChild(c),c=null,setTimeout(f,0))}}else{var h=b;window.hasOwnProperty("attachEvent")?a.attachEvent("onload",h):setTimeout(function(){g(a,h)},0)}var k=setTimeout(function(){e.error("Time is out:"+a.src);b()},m.timeout)}function g(a,d){if(!d.isCalled){var b;if(n)a.sheet&&(b=!0);else if(a.sheet)try{a.sheet.cssRules&&(b=!0)}catch(c){if("SecurityError"===c.name||"NS_ERROR_DOM_SECURITY_ERR"===c.name)b=!0}setTimeout(function(){b?d():g(a,d)},1)}}function j(a){m.showLoading(!1);
w--;x[a].status="loaded";m.traceLog&&e.info(k+"Response: "+a);h()}function h(){for(var a=s.length-1;0<=a;a--){var b=s[a],c=d(b.deps);if(c.notExist)0==a&&0==w&&$D.error(p+c.notExist);else{s.splice(a,1);b.callback.apply(null,c.exist);h();break}}}var k="[Handy Loader] ",p=k+"not found: ",r=document.head||document.getElementsByTagName("head")[0]||document.documentElement,n=navigator.userAgent.indexOf("AppleWebKit"),s=[],w=0,x={},m={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(d,
b,f){d=a.Object.alias(d);2==arguments.length&&(f=b,b=[]);m.require(b,function(){var a;if("function"==typeof f)try{a=f.apply(null,arguments),m.traceLog&&e.info(k+"define: "+d)}catch(b){b.message=k+d+":factory define error:"+b.message;e.error(b);return}else a=f;if(a){c.ns(d,a);var h=typeof a;if("object"==h||"function"==h)a.$ns=d}else $D.error(k+"factory no return: "+d)})},require:function(c,h){for(var g="string"==typeof c?[c]:c,n=[],q=[],t=!0,u=0,y=g.length;u<y;u++){var l=g[u],l=a.Object.alias(l),v=
d(l);v.notExist?(n.push(l),t&&(t=!1,s.push({deps:g,callback:h})),m.traceLog&&e.info(p+l)):q.push(v.exist[0])}if(0==n.length)return h&&h.apply(null,q),0==q.length?q[0]:q;t=!1;g=0;for(q=n.length;g<q;g++)if(u=n[g],!x[u]){t=u;l=m.urlMap&&m.urlMap[t]&&m.urlMap[t].url;if(!l){y="";l=m.rootPath;if("string"==typeof l)y=l;else if("object"==typeof l)for(v in v=void 0,l)0==t.indexOf(v)&&(y=l[v],t=t.replace(v,""));else y="";l=/.css$/.test(t)?0==t.indexOf("/")?t:"/css/"+t:/.js$/.test(t)?t:t.replace(/\./g,"/")+
".js";0!=l.indexOf("/")&&(l="/"+l);l=y+l}t=!0;x[u]={id:u,status:"loading"};y=b.bind(j,null,u);if(/.css$/.test(l))a:{u=l;l=r.getElementsByTagName("link");for(v=0;v<l.length;v++){var z=l[v].href;!m.skinNode&&0<=z.indexOf(m.skinName)&&(m.skinNode=l[v]);if(0<=z.indexOf(u)||0<=u.indexOf(z))break a}l=document.createElement("link");l.rel="stylesheet";l.href=u;f(l,y);r.insertBefore(l,m.skinNode);m.traceLog&&e.info(k+"request:"+u)}else u=l,l=document.createElement("script"),l.async="async",l.src=u,l.type=
"text/javascript",f(l,y),r.appendChild(l),m.traceLog&&e.info(k+"request:"+u);w++}t&&m.showLoading(!0)}};return m});
handy.add("Events",function(e){return{_eventCache:{},_execEvtCache:[],_parseEvents:function(c,b){var a=/\s+/;if("object"==typeof c){for(var d in c)b([d,c[d]]);return!0}if("string"==typeof c&&a.test(c)){a=c.split(a);d=0;for(var f=a.length;d<f;d++)b([a[d]]);return!0}return!1},_parseCustomEvents:function(c,b,a){var d=this,f=e.toArray(arguments,2);return d._parseEvents(b,function(a){d[c].apply(d,a.concat(f))})},_delegateHandler:function(c,b){var a=this;return function(){if(!0!=a.isSuspend)return c.apply(b||
a,arguments)}},_pushEvent:function(c){this._execEvtCache.push(c)},_execEvents:function(){var c=this,b;e.each(c._execEvtCache,function(a,d){var f=d.delegation;"number"==typeof d.times&&(1<d.times?d.times--:c.off(d.name,d.handler));b=f.apply(c,d.args)});c._execEvtCache=[];return b},on:function(c,b,a,d){if(!this._parseCustomEvents("on",c,b,a,d)){"number"==typeof a&&(d=a,a=null);var f=this._eventCache,e=f[c];e||(e=f[c]=[]);c=this._delegateHandler(b,a);e.push({times:d,handler:b,context:a,delegation:c})}},
once:function(c,b,a){var d=e.toArray(arguments);this.on.apply(this,d.push(1))},off:function(c,b){if("all"==c)return this._eventCache={},!0;if(!this._parseCustomEvents("off",c,b)){var a=this._eventCache,d=c.indexOf(".");if(!b&&0>=d){for(var f in a)(f.split(".")[0]==c||0==d&&0<=f.indexOf(c))&&delete a[f];return!0}d=a[c];if(!d)return!1;if(b){a=0;for(f=d.length;a<f;a++)if(d[a].handler==b)return d.splice(a,1),!0}else return delete a[c],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=
!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(c,b){function a(a){if(a)for(var b=0,f=a.length;b<f;b++){var h=a[b];h.args=g;h.name=c;d._pushEvent(h)}}var d=this,f=e.toArray(arguments);f.unshift("trigger");if(!d._parseCustomEvents.apply(d,f)){var f=d._eventCache,g=e.toArray(arguments),j;if(0<c.indexOf("."))j=f[c],a(j);else for(var h in f)if(j=c.indexOf("."),h.split(".")[0]==c||0==j&&0<=h.indexOf(c))j=f[h],a(j);a(f.all);return d._execEvents()}}}});
handy.add("Date",function(){var e=window.Date,c={getWeek:function(a,d){var b=a.getDay();d&&(b=(b+(d%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[b]},isWeeken:function(a){return 0==a.getDay()||6==a.getDay()},getDaysInMonth:function(a){a=new e(a.getFullYear(),a.getMonth()+1,0);return a.getDate()},getDaysInYear:function(a){var d=new e(a.getFullYear(),0,0);a=new e(a.getFullYear()+1,0,0);return Math.floor((a.getTime()-d.getTime())/864E5)},getDayIndexOfYear:function(a){var d=new e("1/1/"+
a.getFullYear());return Math.ceil((a.getTime()-d.getTime())/864E5)},formatDate:function(a,d){d=d||"yyyy-MM-dd HH:mm:ss";a=a||new e;var b=a.getHours(),g=Math.floor((a.getMonth()+3)/3),b={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":0==b%12?12:b%12,"H+":b,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":c.getWeek(a),"q+":g,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][g-1],"S+":a.getMilliseconds()},j;for(j in b)RegExp("("+j+")").test(d)&&(g=RegExp.$1.length,d=d.replace(RegExp.$1,1==g?b[j]:
("00"+b[j]).slice(-g)));return d},parseDate:function(a,b){var c=typeof a,g=new e;if("number"==c)return g.setTime(a),g;if("string"!=c)return a;var c=(b||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),j=a.match(/\d+/g);if(j){for(var h=0;h<j.length;h++){var k=c[h],p=parseInt(j[h]);switch(k){case "yyyy":g.setFullYear(p);break;case "MM":g.setMonth(p-1);break;case "dd":g.setDate(p);break;case "HH":g.setHours(p);break;case "mm":g.setMinutes(p);break;case "ss":g.setSeconds(p);break;case "SS":g.setMilliseconds(p)}}return g}},
now:function(a){var d=new e;if(a)"number"!=typeof a&&(a=c.parseDate(a).getTime()),b=a-d.getTime();else return d.setTime(d.getTime()+b),d},howLong:function(a,b){var f=c.now().getTime()-a.getTime();if(b){var e;if(60>(f/=6E4))e="\u5206\u949f",f=f||1;else if(24>(f/=60))e="\u5c0f\u65f6";else if(30>(f/=24))e="\u5929";else return"30\u5929\u524d";f=(Math.floor(f)||1)+e+"\u524d"}return f}},b=0;return c});
handy.add("String",function(){var e={stripTags:function(c){return c.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(c){var b=document.createElement("div");c=document.createTextNode(c);b.appendChild(c);return b.innerHTML},unescapeHTML:function(c){var b=document.createElement("div");b.innerHTML=e.stripTags(c);return b.childNodes[0].nodeValue},decodeHTML:function(c){c=c.replace(/&lt;/gi,"<");c=c.replace(/&gt;/gi,">");c=c.replace(/&quot;/gi,'"');c=c.replace(/&apos;/gi,"'");c=c.replace(/<\/?br>/gi,"\n");
c=c.replace(/&amp;/gi,"&");return c=c.replace(/&nbsp;/gi," ")},encodeHTML:function(c){c=c.replace(/&/gi,"&amp;");c=c.replace(/</gi,"&lt;");c=c.replace(/>/gi,"&gt;");c=c.replace(/\"/gi,"&quot;");c=c.replace(/\'/gi,"&apos;");c=c.replace(/\n/gi,"</br>");return c=c.replace(/ /gi,"&nbsp;")},trim:function(c){return c=c.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(c,b){b||(b=/[,%\'\"\/\\;|\<\>\^]/);return-1<c.search(b)},len:function(c){return c.replace(/[^\x00-\xff]/g,"**").length},left:function(c,
b,a){if(e.len(c)>b){!0===a?a=2:0<a||(a=0);var d=0,f=0;for(b-=a;f<b;)255<c.charCodeAt(d)?f+=2:f++,d++;c=c.substring(0,d);for(d=0;d<a;d++)c+="."}return c},isNumStr:function(c){return 0==c.search(/^\d+$/g)},hasChn:function(c){return/[\u4E00-\u9FA5]+/.test(c)},isChn:function(c){return/^[\u4E00-\u9FA5]+$/.test(c)},addParam:function(c,b){b&&(c+=(-1<c.indexOf("?")?"&":"?")+b);return c}};return e});
handy.add("Cookie",function(){return{getCookie:function(e,c){var b=e+"=",a="",d=document.cookie;if(0<d.length){var f=d.indexOf(b);-1!=f&&(f+=b.length,b=d.indexOf(";",f),-1==b&&(b=d.length),a=d.substring(f,b),c||(a=unescape(a)))}return a},setCookie:function(e,c,b){var a=[];void 0!=e&&void 0!=c&&a.push(e+"="+escape(c));b&&(void 0!=b.path&&a.push("path="+b.path),void 0!=b.domain&&a.push("domain="+b.domain),void 0!=b.expires&&a.push("expires="+b.expires),b.secure&&a.push("secure"));document.cookie=a.join(";")},
delCookie:function(e){var c=new Date;c.setTime(c.getTime()-1);document.cookie=e+"=;expires="+c.toGMTString()}}});
handy.add("Util","B.Object",function(e,c){var b=0;return{isWindow:function(a){return null!=a&&a==a.window},getUuid:function(){return b++},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(a){var b=top.location.hash;0<=b.indexOf("#")&&(a=b.replace(/#[^\?]*/,a));top.location.hash=a},distance:function(a,b,f){function e(a){a.get?a=[a.get("latitude"),a.get("longitude")]:c.isObj(a)&&(a=[a.latitude,a.longitude]);return a}var j;a=e(a);j=a[0];a=a[1];b=e(b);j=j*Math.PI/180;var h=
b[0]*Math.PI/180;b=a*Math.PI/180-b[1]*Math.PI/180;b=2*Math.asin(Math.sqrt(Math.pow(Math.sin((j-h)/2),2)+Math.cos(j)*Math.cos(h)*Math.pow(Math.sin(b/2),2)));b=Math.round(63781370*b);b=(b/1E3).toFixed(2);if(f){if(isNaN(b))return"\u672a\u77e5";b+="km"}return b},result:function(a,b){var c=a[b];return e.isFunc(c)?c():c}}});
handy.add("Array","B.Object",function(e,c){function b(a){return a}function a(a){return function(b){return b[a]}}function d(d){return null==d?b:c.isFunc(d)?d:a(d)}function f(a){return function(b){if(b===a)return!0;for(var d in a)if(a[d]!==b[d])return!1;return!0}}function g(a){return function(b,c,f){var g={};c=d(c);e.each(b,function(d,e){var j=c.call(f,e,d,b);a(g,j,e)});return g}}var j={map:function(a,b,d){var c=[];if(null==a)return c;var f=Array.prototype.map;if(f&&a.map===f)return a.map(b,d);e.each(a,
function(a,f){c.push(b.call(d,f,a))});return c},pluck:function(b,d){return this.map(b,a(d))},some:function(a,b,d){var f=!1;if(null==a||!b)return f;var e=Array.prototype.some;if(e&&a.some===e)return a.some(b,d);c.each(a,function(a,c,e){if(f||(f=b.call(d,c,a,e)))return!1});return!!f},every:function(a,b,d){var f=!0;if(null==a||!b)return f;var e=Array.prototype.every;if(e&&a.every===e)return a.every(b,d);c.each(a,function(a,c,e){if(!(f=b.call(d,c,a,e)))return!1});return!!f},indexOf:function(a,b,d){if(null==
a)return-1;var c=0,f=a.length;if(d)if("number"==typeof d)c=0>d?Math.max(0,f+d):d;else return c=j.sortedIndex(a,b),a[c]===b?c:-1;var e=Array.prototype.indexOf;if(e&&a.indexOf===e)return a.indexOf(b,d);for(;c<f;c++)if(a[c]===b)return c;return-1},find:function(a,b,d){var c;this.some(a,function(a,f,e){if(b.call(d,a,f,e))return c=a,!0});return c},filter:function(a,b,d){var f=[];if(null==a)return f;var e=Array.prototype.filter;if(e&&a.filter===e)return a.filter(b,d);c.each(a,function(a,c,e){b.call(d,c,
a,e)&&f.push(c)});return f},where:function(a,b){return this.filter(a,f(b))},findWhere:function(a,b){return this.find(a,f(b))},invoke:function(a,b){var d=Array.prototype.slice.call(arguments,2),c=e.isFunc(b);return this.map(a,function(a){return(c?b:a[b]).apply(a,d)})},sortedIndex:function(a,b,c,f){c=d(c);b=c.call(f,b);for(var e=0,g=a.length;e<g;){var j=e+g>>>1;c.call(f,a[j])<b?e=j+1:g=j}return e},sortBy:function(a,b,c){b=d(b);return this.pluck(this.map(a,function(a,d,f){return{value:a,index:d,criteria:b.call(c,
a,d,f)}}).sort(function(a,b){var d=a.criteria,c=b.criteria;if(d!==c){if(d>c||void 0===d)return 1;if(d<c||void 0===c)return-1}return a.index-b.index}),"value")},groupBy:g(function(a,b,d){a[b]?a[b].push(d):a[b]=[d]}),countBy:g(function(a,b){a[b]?a[b]++:a[b]=1})};return j});
handy.add("Template","B.String",function(e,c){function b(a){return j?"$r+="+a+";\n":"$r.push("+a+");\n"}function a(a){a=a.replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n");return b('"'+a+'"')}var d={openTag:"<%",closeTag:"%>",isEscape:!0,registerHelper:function(a,b){h[a]||(k+=a+"=oHelpers."+a+",");h[a]=b},tmpl:function(e,r){var n,s,w;if("string"==typeof e)n=e;else if(void 0!=e.length)n=e.join("");else if(n=e.tmpl,w=e.id)if(f[w])s=f[w];else if(!n){var x=document.getElementById(w);
x&&(n=(x.value||x.innerHTML).replace(/\s/g,""))}if(!s){if(!n){c.Debug.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}var m=k+"$r="+(j?'""':"[]")+";\n";c.Object.each(n.split(d.openTag),function(c,f){var e=f.split(d.closeTag);if(1==e.length)m+=a(e[0]);else{var h=m,j=e[0],j=j.replace(/this/g,"$data");0==j.indexOf("=")&&(j="("+j.replace(g,"")+")",j=b(j+'==undefined?"":'+j));m=h+(j+"\n");e[1]&&(m+=a(e[1]))}});m+="return "+(j?"$r;":'$r.join("");');n=new Function("$data",m);n.$helpers=h;s=n;w&&(f[w]=s)}return r?
s(r):s}},f={},g=/^=/,j="".trim,h={escape:e.escapeHTML,trim:e.trim},k="var oHelpers=arguments.callee.$helpers,escape=oHelpers.escape,trim=oHelpers.trim,";return d});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(e,c,b){function a(a){if(a==p)return!1;var b=k.contentWindow.document;b.open();b.write("<!doctype html><html><body>"+a+"</body></html>");b.close();p=a;e.log("set:"+k.contentWindow.document.body.innerText)}function d(){var b=c.getHash(),d=k.contentWindow.document.body.innerText;b!=p?(a(b),f(b)):d!=p&&(e.log("update:"+k.contentWindow.document.body.innerText),c.setHash(d))}function f(a){var b=s.listeners,d;for(d in b)b[d](a)}var g,
j=0,h=document,k,p,r=h.documentMode,n="onhashchange"in window&&(void 0===r||7<r),s={delay:50,listen:function(e,p){if(!g&&!g)if(g=!0,s.listeners={},n)$(window).on("hashchange",function(){f(c.getHash())});else k=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(h.body)[0],$(k).one("load",function(){a(c.getHash());setInterval(d,s.delay)});if(p in s.listeners)$D.error(Error("Duplicate name"));else return p=p||b.expando+ ++j,s.listeners[p]=e,p},unListen:function(a){for(var b in s.listeners)(!a||
a==b)&&delete s.listeners[b]}};return s});handy.add("Support","B.Browser",function(e){var c={mediaQuery:function(){var a;if(e.mobile())a="hui-mobile";else{a="hui-pc";var b=e.ie();b&&(a+=" ie"+b)}document.documentElement.className+=" "+a}};c.mediaQuery();if(6==e.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(b){}return c});
handy.add("Validator",["B.String","B.Object"],function(e,c){var b={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(a,d){var c=d.rules,e;for(e in c){var j=c[e],h=("function"==typeof j?j:b[e])(a,j);if(!h)return c=d.error||b.error,e=d.messages&&
d.messages[e]||b.messages[e],e=e.replace(/\{([^\}]+)\}/g,function(a,b){return j[b]||0==b&&j||d[b]||j||""}),c&&c(e),h}return!0},required:function(a){return 0<e.trim(""+a).length},email:function(a){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a){return!/Invalid|NaN/.test((new Date(a)).toString())},dateISO:function(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a){return/^\d+$/.test(a)},creditcard:function(a){if(/[^0-9 \-]+/.test(a))return!1;var b=0,c=0,e=!1;a=a.replace(/\D/g,"");for(var j=a.length-1;0<=j;j--){c=a.charAt(j);c=parseInt(c,10);if(e&&9<(c*=2))c-=9;b+=c;e=!e}return 0===b%10},min:function(a,b){return a>=b},max:function(a,
b){return a<=b},range:function(a,b){return a>=b[0]&&a<=b[1]},minlength:function(a,b){return(c.isArr(a)?a.length:e.trim(""+a).length)>=b},maxlength:function(a,b){return(c.isArr(a)?a.length:e.trim(""+a).length)<=b},rangelength:function(a,b){var f=c.isArr(a)?a.length:e.trim(""+a).length;return f>=b[0]&&f<=b[1]},equalTo:function(a,b){return a===b}};return b});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(e,c,b){c={_init:function(){!a&&e.ie()&&(f=document.getElementById("LocalStorageUserDataDiv"),f||(f=document.createElement("DIV"),f.style.display="none",f.id="LocalStorageUserDataDiv",f.addBehavior("#default#userData"),document.body.appendChild(f),f.load(g)))},getItem:function(c){c=a?d.getItem(c):f.getAttribute(c);return c=b.parseJson(c)},setItem:function(c,e){e=b.stringify(e);try{a?d.setItem(c,e):(f.setAttribute(c,e),f.save(g))}catch(k){return $D.error(k),
!1}return!0},removeItem:function(b){a?d.removeItem(b):(f.removeAttribute(b),f.save(g))},clear:function(){a?d.clear():f.unload()}};var a=window.localStorage&&window.localStorage.getItem,d=window.localStorage,f,g=document.domain;c._init();return c});(function(e){Hui=H=$H=e.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};e=window.$;e.fn.remove=$H.intercept(e.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
