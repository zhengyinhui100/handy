/* Handy v1.0.0-dev | 2014-03-30 | zhengyinhui100@gmail.com */
(function(){var f=window.handy,b=window.$,a=window.handy=window.$=function(){};a.version="1.0.0";a.isDebug="undefined"==typeof gEnv?!1:"dev"==gEnv;a.expando="handy"+(a.version+Math.random()).replace(/\D/g,"");a.add=function(c,d,b){b||(b=d,d=null);a.base||(a.base={});var g=[];if(d)if("string"==typeof d)g.push(a.base.Object.namespace(d));else for(var h=0;h<d.length;h++)g.push(a.base.Object.namespace(d[h]));g.push(a);d=b.apply(window,g);a.base[c]=a[c]=d;if(0<="Browser,Class,Array,Cookie,Events,Function,Json,Object,String,Template,Util".indexOf(c))for(var f in d)a.isDebug&&
("undefined"!=typeof a[f]&&"console"in window&&!Function[f])&&(console.log(a[f]),console.log(c+"\u547d\u540d\u51b2\u7a81:"+f)),a[f]=d[f]};a.noConflict=function(c){window.$===a&&(window.$=b);c&&window.handy===a&&(window.handy=f);return a};a.noop=function(){}})();
handy.add("Json",function(){function f(c){g.lastIndex=0;g.test(c)&&(c=c.replace(g,function(c){var a=h[c];return"string"===typeof a?a:"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)}));return'"'+c+'"'}function b(a,g){var h,k,j,m,n=d,x,q=g[a];q&&("object"===typeof q&&"function"===typeof q.toJSON)&&(q=q.toJSON(a));"function"===typeof c&&(q=c.call(g,a,q));switch(typeof q){case "string":return f(q);case "number":return isFinite(q)?String(q):"null";case "boolean":case "null":return String(q);case "object":if(!q)return"null";
d+=e;x=[];if("[object Array]"===Object.prototype.toString.apply(q)){m=q.length;for(h=0;h<m;h+=1)x[h]=b(h,q)||"null";j=0===x.length?"[]":d?"[\n"+d+x.join(",\n"+d)+"\n"+n+"]":"["+x.join(",")+"]";d=n;return j}if(c&&"object"===typeof c){m=c.length;for(h=0;h<m;h+=1)"string"===typeof c[h]&&(k=c[h],(j=b(k,q))&&x.push(f(k)+(d?": ":":")+j))}else for(k in q)Object.prototype.hasOwnProperty.call(q,k)&&(j=b(k,q))&&x.push(f(k)+(d?": ":":")+j);j=0===x.length?"{}":d?"{\n"+d+x.join(",\n"+d)+"\n"+n+"}":"{"+x.join(",")+
"}";d=n;return j}}var a="JSON"in window,c,d,e,g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j=/^[\],:{}\s]*$/,m=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,n=/(?:^|:|,)(?:\s*\[)+/g;
return{stringify:function(g,h,f,k){if(a&&!k)return JSON.stringify.apply(null,arguments);var j;e=d="";if("number"===typeof f)for(j=0;j<f;j+=1)e+=" ";else"string"===typeof f&&(e=f);if((c=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return b("",{"":g})},parseJson:function(c,d,b){function e(c,a){var b,g,h=c[a];if(h&&"object"===typeof h)for(b in h)Object.prototype.hasOwnProperty.call(h,
b)&&(g=e(h,b),void 0!==g?h[b]=g:delete h[b]);return d.call(c,a,h)}if(a&&!b)return JSON.parse.apply(null,arguments);var g;c=String(c);k.lastIndex=0;k.test(c)&&(c=c.replace(k,function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)}));if(j.test(c.replace(m,"@").replace(r,"]").replace(n,"")))return g=eval("("+c+")"),"function"===typeof d?e({"":g},""):g;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var f;f=(f=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(f[0])?function(a,c,d){var b=[];if(a.length){c=c||0;for(d=d||a.length;c<d;c++)b.push(a[c])}return b}:function(a,c,d){return Array.prototype.slice.call(a,c||0,d||a.length)};var b={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},namespace:function(a,c){var d=null,e,g,h,f;a=b.alias(a);g=a.split(".");d=g[0];d=(h=2==arguments.length)?eval("(function(){if (typeof "+d+' == "undefined"){'+
d+" = {};}return "+d+";})()"):eval("(function(){if (typeof "+d+' != "undefined")return '+d+";})()");e=1;for(f=g.length;e<f;++e){if(e==f-1&&h)d[g[e]]=c;else if(h||d&&d[g[e]])d[g[e]]=d[g[e]]||{};else return;d=d[g[e]]}return d},alias:function(a,c){var d=b._alias;if(c)d[a]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+a+":"+d[a]):d[a]=c;else{if(a){var e=a,g=a.length-1;do{if(d[e])return d[e]+a.substring(g);g=e.lastIndexOf(".")}while(0<g&&(e=e.substring(0,g)));return a}return d}},extend:function(a,c,
d){if(!c||b.isString(c)||b.isNumber(c))return a;var e=d?d.notCover:!1,g=d?d.cover:null;d=d?d.IsClone:!1;a=a||{};var h=a.constructor,f=h.$isClass,j,m;for(m in c)if(j=c[m],(!g||b.contains(g,m))&&c.hasOwnProperty(m)){var r=a.hasOwnProperty(m),n=!0===e?r:!1;b.isArray(e)?n=b.contains(e,m)&&r:b.isFunction(e)&&(n=e(m,j));n||(j=d?b.clone(j):j,f&&b.isFunction(j)&&(j.$name=m,j.$owner=h),a[m]=j)}return a},mix:function(a,c,d){a.superProto||(a.superProto={});for(var e in c)a.superProto[e]=b.isFunction(c[e])?a.superProto[e]?
function(a,d){return function(){d.apply(this,arguments);c[a].apply(this,arguments)}}(e,a.superProto[e]):c[e]:c[e],a[e]||(a[e]=c[e]);d&&b.extend(a,d);c.toString!=c.constructor.prototype.toString&&(a.superProto.toString=function(){c.toString.apply(a,arguments)});return a},isFunction:function(a){return"[object Function]"===window.Object.prototype.toString.call(a)},isArray:function(a){return"[object Array]"===window.Object.prototype.toString.call(a)},isObject:function(a){return"object"==typeof a&&!b.isArray(a)},
isNumber:function(a){return"number"==typeof a},isString:function(a){return"string"==typeof a},isUndefined:function(a){return"undefined"==typeof a},isClass:function(a){return b.isFunction(a)&&!0===a.$isClass},equals:function(a,c){if(typeof a==typeof c){if("object"!=typeof a)return a===c;if(a===c)return!0;if(b.isArray(a)&&b.isArray(c)){if(a.length!=c.length)return!1;for(var d=0,e=a.length;d<e;d++)if(!b.equals(a[d],c[d]))return!1;return!0}if(!b.isArray(a)&&!b.isArray(c)){if(b.count(a)!=b.count(c))return!1;
for(d in a)if(void 0==c[d]||!b.equals(a[d],c[d]))return!1;return!0}}return!1},clone:function(a){if(null==a||"object"!=typeof a)return a;var c=a.constructor;if(c!=window.Object&&c!=window.Array)return a;if(c==window.Date||c==window.RegExp||c==window.Function||c==window.String||c==window.Number||c==window.Boolean)return new c(a);try{var d=new c,e;for(e in a)d[e]=b.clone(a[e]);return d}catch(g){return a}},isEmpty:function(a){if(b.isArray(a))return 0==a.length;for(var c in a)return!1;return!0},each:function(a,
c,d){var e,g=0,h=a.length,f=void 0===h||b.isFunction(a);if(d)if(f)for(e in a){if(!1===c.apply(a[e],d))break}else for(;g<h&&!1!==c.apply(a[g],d);)e=a.length,h==e?g++:h=e;else if(f)for(e in a){if(!1===c.call(a[e],e,a[e]))break}else for(;g<h&&!1!==c.call(a[g],g,a[g]);)e=a.length,h==e?g++:h=e;return a},contains:function(a,c){var d=!1;b.each(a,function(a,g){if(b.equals(g,c))return d=!0,!1});return d},largeThan:function(a,c){if("object"==typeof a&&"object"==typeof c){var d=!0;b.each(c,function(e){if(!b.equals(c[e],
a[e]))return d=!1});return d}},count:function(a){if(b.isArray(a))return a.length;var c=0,d;for(d in a)c++;return c},removeUndefined:function(a,c){var d=b.isArray(a);if(c){if(d){var e=[];b.each(a,function(c,a){void 0!==a&&e.push(a)});return e}return b.extend({},a,{isClone:!0,notCover:function(c,a){return void 0===a}})}b.each(a,function(c,b){void 0===b&&(d?a.splice(c,1):delete a[c])});return a},toArray:f,fromArray:function(a){for(var c={},d=0,b=a.length;d<b;d++){var g=a[d];c[g.name]=g.value}return c},
generateMethod:function(a,c,d){c=b.isArray(c)?c:c.split(",");for(var e=0;e<c.length;e++){var g=c[e];a[g]=d(g)}}};return b});
handy.add("Browser","handy.base.Object",function(f){var b={},a={};f.generateMethod(a,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(c){return function(a){var d=b[c];return!a&&"string"===typeof d&&/^[\d\.]+$/.test(d)?parseInt(d):d}});f=window.navigator.userAgent;var c;(c=f.match(/MSIE ([\d.]+)/))?b.ie=c[1]:(c=f.match(/Firefox\/([\d.]+)/))?b.firefox=c[1]:(c=f.match(/Chrome\/([\d.]+)/))?
b.chrome=c[1]:(c=f.match(/Opera.([\d.]+)/))?b.opera=c[1]:(c=f.match(/Version\/([\d.]+).*Safari/))?b.safari=c[1]:0;/windows|win32/i.test(f)?b.windows=!0:/linux/i.test(f)?b.linux=!0:/macintosh/i.test(f)?b.mac=!0:0;/trident/i.test(f)?b.trident=!0:/webkit/i.test(f)?b.webkit=!0:/gecko/i.test(f)?b.gecko=!0:/presto/i.test(f)?b.presto=!0:0;/MetaSr/i.test(f)?b.sogou=!0:/Maxthon/i.test(f)?b.maxthon=!0:/TencentTraveler/i.test(f)?b.tt=!0:/TheWorld/i.test(f)?b.theWorld=!0:/360[S|E]E/i.test(f)?b.is360=!0:0;var d;
if((d=f.match(/AppleWebKit\/([\d.]*)/))&&d[1])if(/ Mobile\//.test(f)&&f.match(/iPad|iPod|iPhone/)){b.mobile="ios";if((d=f.match(/OS ([^\s]*)/))&&d[1])b.ios=d[1].replace("_",".");if((d=f.match(/iPad|iPod|iPhone/))&&d[0])b[d[0].toLowerCase()]=b.ios}else if(/ Android/i.test(f)){if(/Mobile/.test(f)&&(b.mobile="android"),(d=f.match(/Android ([^\s]*);/))&&d[1])b.android=d[1]}else if(d=f.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))b.mobile=d[0].toLowerCase();var e;try{if(b.ie){var g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
g&&(e=g.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(g=navigator.plugins["Shockwave Flash"])){var h=g.description.split(" ");c=0;for(var k=h.length;c<k;c++)if(0<parseInt(h[c])){e=h[c];break}}}catch(j){}b.flash=e?e:null;return a});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(f,b,a){var c={level:a.isDebug?0:5,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!b.mobile(),out:function(d,b,g){g=g||"log";if(b||c.showInPage){b=a.expando+"debugDiv";var h=top.document,f=h.getElementById(b);f?f.style.display="block":(f=h.createElement("DIV"),f.id=b,f.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+h.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u5168\u5c4f</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',f.style.position="fixed",f.style.width=h.body.offsetWidth-20+"px",f.style.left=0,f.style.top=0,f.style.right=0,f.style.height="150px",f.style.backgroundColor="#aaa",f.style.fontSize="12px",f.style.padding="10px",f.style.zIndex=9999999999,f.style.opacity=0.8,f.style.filter="alpha(opacity=80)",h.body.appendChild(f));b=f.getElementsByTagName("DIV")[0];h=a.Json.stringify(d,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0).replace(/\n/g,"<br/>");b.innerHTML+=
g+" : "+h+"<br/>";b.scrollTop=b.scrollHeight}try{console[g](d)}catch(j){}},log:function(a,b){c.level>c.LOG_LEVEL||c.out(a,!!b,"log")},info:function(a,b){this.level>c.INFO_LEVEL||c.out(a,!!b,"info")},warn:function(a,b){c.level>c.WARN_LEVEL||c.out(a,!!b,"warn")},error:function(a,b){if(!(c.level>c.ERROR_LEVEL)&&(c.out(a,!!b,"error"),a instanceof Error))throw a;},time:function(a,b,g){c.level>c.INFO_LEVEL||(a?("boolean"==typeof b&&(g=b,b=""),c.out((b||"")+((new Date).getTime()-(c.lastTime||0)),!!g)):c.lastTime=
(new Date).getTime())},debug:function(a){if(!(c.level>c.DEBUG_LEVEL)&&!1!==a)debugger}};return c});handy.add("Function",function(f){return{bind:function(b,a,c){var d=Array.prototype.slice.call(arguments,2);return function(){Array.prototype.push.apply(d,arguments);return b.apply(a,d)}},intercept:function(b,a,c,d){return f.Object.isFunction(b)&&f.Object.isFunction(a)?function(){var e=c||this,g={},h=arguments;g.scope=d;g.target=e;g.method=b;return!1!=a.apply(g,h)?b.apply(e,h):!1}:b}}});
handy.add("Class",["B.Object","B.Debug"],function(f,b){var a={createClass:function(c){var b=function(){var a,c;a=this.constructor==b?this:arguments.callee;if(c=a.initialize){for(var h in a)"object"==typeof a[h]&&(a[h]=f.clone(a[h]));return c.apply(a,arguments)}};b.$isClass=!0;b.derive=function(c,b,d){var f=a.createClass();a.inherit(f,this,c,b,d);return f};b.prototype.callSuper=function(a,c){a&&(!a.$isClass&&void 0!=a.length)&&(c=a,a=null);var b=arguments.callee.caller,d=b.$owner.superProto;c=c||b.arguments;
a=a?a.prototype:d||this.constructor.superProto;b=b.$name;if(a&&(b=a[b],f.isFunction(b)))return b.apply(this,c)};c&&this.namespace(c,b);return b},inherit:function(a,d,e,g,h){var k=function(){};k.prototype=d.prototype;f.extend(a,d,h);a.prototype=new k;a.prototype.constructor=a;a.superClass=d;a.superProto=d.prototype;if(d._onInherit)try{d._onInherit(a)}catch(j){b.error(j)}g&&f.extend(a,g);e&&f.extend(a.prototype,e)},getSingleton:function(a){return(a="string"==typeof a?f.namespace(a):a)&&(a.$singleton||
(a.$singleton=new a))}};return a});
handy.add("Loader",["B.Debug","B.Object","B.Function"],function(f,b,a,c){function d(a){var c={},d=[];"string"==typeof a&&(a=[a]);for(var g=0,e=a.length;g<e;g++){var h;h=a[g];h=/\.(css|js)$/.test(h)?y[h]&&"loaded"==y[h].status:p.urlMap&&p.urlMap[h]?p.urlMap[h].chkExist():b.namespace(h);if(h)d.push(h);else return c.notExist=a[g],c}c.exist=d;return c}function e(a,c){function b(){b.isCalled||(b.isCalled=!0,clearTimeout(j),c())}if("SCRIPT"===a.nodeName){var d=a,e=b;d.onload=d.onerror=d.onreadystatechange=
function(){/loaded|complete|undefined/.test(d.readyState)&&(d.onload=d.onerror=d.onreadystatechange=null,r.removeChild(d),d=null,setTimeout(e,0))}}else{var h=b;window.hasOwnProperty("attachEvent")?a.attachEvent("onload",h):setTimeout(function(){g(a,h)},0)}var j=setTimeout(function(){f.error("Time is out:"+a.src);b()},p.timeout)}function g(a,c){if(!c.isCalled){var b;if(n)a.sheet&&(b=!0);else if(a.sheet)try{a.sheet.cssRules&&(b=!0)}catch(d){if("SecurityError"===d.name||"NS_ERROR_DOM_SECURITY_ERR"===
d.name)b=!0}setTimeout(function(){b?c():g(a,c)},1)}}function h(a){p.showLoading(!1);w--;y[a].status="loaded";p.traceLog&&f.info(j+"Response: "+a);k()}function k(){for(var a=s.length-1;0<=a;a--){var c=s[a],b=d(c.deps);if(b.notExist)0==a&&0==w&&$D.error(m+b.notExist);else{s.splice(a,1);c.callback.apply(null,b.exist);k();break}}}var j="Loader ",m=j+"not found: ",r=document.head||document.getElementsByTagName("head")[0]||document.documentElement,n=navigator.userAgent.indexOf("AppleWebKit"),s=[],w=0,y=
{},p={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(a,d,g){a=c.Object.alias(a);2==arguments.length&&(g=d,d=[]);p.require(d,function(){var c;if("function"==typeof g)try{c=g.apply(null,arguments),p.traceLog&&f.info(j+"define: "+a)}catch(d){d.message=j+a+":factory define error:"+d.message;f.error(d);return}else c=g;if(c){b.namespace(a,c);var e=typeof c;if("object"==e||"function"==e)c.$ns=a}else $D.error(j+"factory no return: "+a)})},require:function(b,g){for(var k=
"string"==typeof b?[b]:b,n=[],q=[],t=!0,u=0,z=k.length;u<z;u++){var l=k[u],l=c.Object.alias(l),v=d(l);v.notExist?(n.push(l),t&&(t=!1,s.push({deps:k,callback:g})),p.traceLog&&f.info(m+l)):q.push(v.exist[0])}if(0==n.length)return g&&g.apply(null,q),0==q.length?q[0]:q;t=!1;k=0;for(q=n.length;k<q;k++)if(u=n[k],!y[u]){t=u;l=p.urlMap&&p.urlMap[t]&&p.urlMap[t].url;if(!l){z="";l=p.rootPath;if("string"==typeof l)z=l;else if("object"==typeof l)for(v in v=void 0,l)0==t.indexOf(v)&&(z=l[v],t=t.replace(v,""));
else z="";l=/.css$/.test(t)?0==t.indexOf("/")?t:"/css/"+t:/.js$/.test(t)?t:t.replace(/\./g,"/")+".js";0!=l.indexOf("/")&&(l="/"+l);l=z+l}t=!0;y[u]={id:u,status:"loading"};z=a.bind(h,null,u);if(/.css$/.test(l))a:{u=l;l=r.getElementsByTagName("link");for(v=0;v<l.length;v++){var A=l[v].href;!p.skinNode&&0<=A.indexOf(p.skinName)&&(p.skinNode=l[v]);if(0<=A.indexOf(u)||0<=u.indexOf(A))break a}l=document.createElement("link");l.rel="stylesheet";l.href=u;e(l,z);r.insertBefore(l,p.skinNode);p.traceLog&&f.info(j+
"request:"+u)}else u=l,l=document.createElement("script"),l.async="async",l.src=u,l.type="text/javascript",e(l,z),r.appendChild(l),p.traceLog&&f.info(j+"request:"+u);w++}t&&p.showLoading(!0)}};return p});
handy.add("Events",function(f){return{_eventCache:{},_execEvtCache:[],_parseEvents:function(b,a){var c=/\s+/;if("object"==typeof b){for(var d in b)a([d,b[d]]);return!0}if("string"==typeof b&&c.test(b)){c=b.split(c);d=0;for(var e=c.length;d<e;d++)a([c[d]]);return!0}return!1},_parseCustomEvents:function(b,a,c){var d=this,e=f.toArray(arguments,2);return d._parseEvents(a,function(a){d[b].apply(d,a.concat(e))})},_delegateHandler:function(b,a){var c=this;return function(){if(!0!=c.isSuspend)return b.apply(a||
c,arguments)}},_pushEvent:function(b){this._execEvtCache.push(b)},_execEvents:function(){var b=this,a;f.each(b._execEvtCache,function(c,d){var e=d.delegation;"number"==typeof d.times&&(1<d.times?d.times--:b.off(d.name,d.handler));a=e.apply(b,d.args)});b._execEvtCache=[];return a},on:function(b,a,c,d){if(!this._parseCustomEvents("on",b,a,c,d)){"number"==typeof c&&(d=c,c=null);var e=this._eventCache,g=e[b];g||(g=e[b]=[]);b=this._delegateHandler(a,c);g.push({times:d,handler:a,context:c,delegation:b})}},
once:function(b,a,c){var d=f.toArray(arguments);this.on.apply(this,d.push(1))},off:function(b,a){if("all"==b)return this._eventCache={},!0;if(!this._parseCustomEvents("off",b,a)){var c=this._eventCache,d=b.indexOf(".");if(!a&&0>=d){for(var e in c)(e.split(".")[0]==b||0==d&&0<=e.indexOf(b))&&delete c[e];return!0}d=c[b];if(!d)return!1;if(a){c=0;for(e=d.length;c<e;c++)if(d[c].handler==a)return d.splice(c,1),!0}else return delete c[b],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=
!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(b,a){function c(a){if(a)for(var c=0,e=a.length;c<e;c++){var h=a[c];h.args=g;h.name=b;d._pushEvent(h)}}var d=this,e=f.toArray(arguments);e.unshift("trigger");if(!d._parseCustomEvents.apply(d,e)){var e=d._eventCache,g=f.toArray(arguments),h;if(0<b.indexOf("."))h=e[b],c(h);else for(var k in e)if(h=b.indexOf("."),k.split(".")[0]==b||0==h&&0<=k.indexOf(b))h=e[k],c(h);c(e.all);return d._execEvents()}}}});
handy.add("Date",function(){var f=window.Date,b={getWeek:function(a,c){var b=a.getDay();c&&(b=(b+(c%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[b]},isWeeken:function(a){return 0==a.getDay()||6==a.getDay()},getDaysInMonth:function(a){a=new f(a.getFullYear(),a.getMonth()+1,0);return a.getDate()},getDaysInYear:function(a){var c=new f(a.getFullYear(),0,0);a=new f(a.getFullYear()+1,0,0);return Math.floor((a.getTime()-c.getTime())/864E5)},getDayIndexOfYear:function(a){var c=new f("1/1/"+
a.getFullYear());return Math.ceil((a.getTime()-c.getTime())/864E5)},format:function(a,c){c=c||"yyyy-MM-dd HH:mm:ss";a=a||new f;var d=a.getHours(),e=Math.floor((a.getMonth()+3)/3),d={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":0==d%12?12:d%12,"H+":d,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":b.getWeek(a),"q+":e,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][e-1],"S+":a.getMilliseconds()},g;for(g in d)RegExp("("+g+")").test(c)&&(e=RegExp.$1.length,c=c.replace(RegExp.$1,1==e?d[g]:("00"+
d[g]).slice(-e)));return c},parse:function(a,c){for(var b=(c||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),e=a.match(/\d+/g),g=new f,h=0;h<e.length;h++){var k=b[h],j=parseInt(e[h]);switch(k){case "yyyy":g.setFullYear(j);break;case "MM":g.setMonth(j-1);break;case "dd":g.setDate(j);break;case "HH":g.setHours(j);break;case "mm":g.setMinutes(j);break;case "ss":g.setSeconds(j);break;case "SS":g.setMilliseconds(j)}}return g},parseObject:function(a){return new f(a.year+1900,a.month,a.date,a.hours,a.minutes,
a.seconds)}};return b});
handy.add("String",function(){var f={stripTags:function(b){return b.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(b){var a=document.createElement("div");b=document.createTextNode(b);a.appendChild(b);return a.innerHTML},unescapeHTML:function(b){var a=document.createElement("div");a.innerHTML=f.stripTags(b);return a.childNodes[0].nodeValue},decodeHTML:function(b){b=b.replace(/&lt;/gi,"<");b=b.replace(/&gt;/gi,">");b=b.replace(/&quot;/gi,'"');b=b.replace(/&apos;/gi,"'");b=b.replace(/<\/?br>/gi,"\n");
b=b.replace(/&amp;/gi,"&");return b=b.replace(/&nbsp;/gi," ")},encodeHTML:function(b){b=b.replace(/&/gi,"&amp;");b=b.replace(/</gi,"&lt;");b=b.replace(/>/gi,"&gt;");b=b.replace(/\"/gi,"&quot;");b=b.replace(/\'/gi,"&apos;");b=b.replace(/\n/gi,"</br>");return b=b.replace(/ /gi,"&nbsp;")},trim:function(b){return b=b.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(b,a){a||(a=/[,%\'\"\/\\;|\<\>\^]/);return-1<b.search(a)},len:function(b){return b.replace(/[^\x00-\xff]/g,"**").length},left:function(b,
a,c){if(f.len(b)>a){!0===c?c=2:0<c||(c=0);var d=0,e=0;for(a-=c;e<a;)255<b.charCodeAt(d)?e+=2:e++,d++;b=b.substring(0,d);for(d=0;d<c;d++)b+="."}return b},isNumberStr:function(b){return 0==b.search(/^\d+$/g)},hasChn:function(b){return/[\u4E00-\u9FA5]+/.test(b)},isChn:function(b){return/^[\u4E00-\u9FA5]+$/.test(b)},addParam:function(b,a){a&&(b+=(-1<b.indexOf("?")?"&":"?")+a);return b}};return f});
handy.add("Cookie",function(){return{getCookie:function(f,b){var a=f+"=",c="",d=document.cookie;if(0<d.length){var e=d.indexOf(a);-1!=e&&(e+=a.length,a=d.indexOf(";",e),-1==a&&(a=d.length),c=d.substring(e,a),b||(c=unescape(c)))}return c},setCookie:function(f,b,a){var c=[];void 0!=f&&void 0!=b&&c.push(f+"="+escape(b));a&&(void 0!=a.path&&c.push("path="+a.path),void 0!=a.domain&&c.push("domain="+a.domain),void 0!=a.expires&&c.push("expires="+a.expires),a.secure&&c.push("secure"));document.cookie=c.join(";")},
delCookie:function(f){var b=new Date;b.setTime(b.getTime()-1);document.cookie=f+"=;expires="+b.toGMTString()}}});
handy.add("Util","B.Object",function(f){var b=0;return{isWindow:function(a){return null!=a&&a==a.window},getUuid:function(){return b++},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(a){var c=top.location.hash;0<=c.indexOf("#")&&(a=c.replace(/#[^\?]*/,a));top.location.hash=a},distance:function(a,c,b){var e,g;f.isArray(a)?(e=a[0],a=a[1]):(e=a.latitude,a=a.longitude);f.isArray(c)?(g=c[0],c=c[1]):(g=c.latitude,c=c.longitude);e=e*Math.PI/180;g=g*Math.PI/180;a=a*Math.PI/
180-c*Math.PI/180;a=2*Math.asin(Math.sqrt(Math.pow(Math.sin((e-g)/2),2)+Math.cos(e)*Math.cos(g)*Math.pow(Math.sin(a/2),2)));a=Math.round(63781370*a);if(b){if(isNaN(a))return"\u672a\u77e5";a=1E3<a?(a/1E3).toFixed(1)+"km":a+"m"}return a},result:function(a,c){var b=a[c];return f.isFunction(b)?b():b}}});
handy.add("Array","B.Object",function(f,b){function a(a){return a}function c(a){return function(c){return c[a]}}function d(a){return function(c){if(c===a)return!0;for(var b in a)if(a[b]!==c[b])return!1;return!0}}var e={map:function(a,c,b){var d=[];if(null==a)return d;var e=Array.prototype.map;if(e&&a.map===e)return a.map(c,b);f.each(a,function(a,e){d.push(c.call(b,e,a))});return d},pluck:function(a,b){return this.map(a,c(b))},some:function(a,c,d){var e=!1;if(null==a||!c)return e;var f=Array.prototype.some;
if(f&&a.some===f)return a.some(c,d);b.each(a,function(a,b,g){if(e||(e=c.call(d,b,a,g)))return!1});return!!e},every:function(a,c,d){var e=!0;if(null==a||!c)return e;var f=Array.prototype.every;if(f&&a.every===f)return a.every(c,d);b.each(a,function(a,b,g){if(!(e=c.call(d,b,a,g)))return!1});return!!e},indexOf:function(a,c,b){if(null==a)return-1;var d=0,f=a.length;if(b)if("number"==typeof b)d=0>b?Math.max(0,f+b):b;else return d=e.sortedIndex(a,c),a[d]===c?d:-1;var r=Array.prototype.indexOf;if(r&&a.indexOf===
r)return a.indexOf(c,b);for(;d<f;d++)if(a[d]===c)return d;return-1},find:function(a,c,b){var d;this.some(a,function(a,e,f){if(c.call(b,a,e,f))return d=a,!0});return d},filter:function(a,c,d){var e=[];if(null==a)return e;var f=Array.prototype.filter;if(f&&a.filter===f)return a.filter(c,d);b.each(a,function(a,b,f){c.call(d,b,a,f)&&e.push(b)});return e},where:function(a,c){return this.filter(a,d(c))},findWhere:function(a,c){return this.find(a,d(c))},invoke:function(a,c){var b=Array.prototype.slice.call(arguments,
2),d=f.isFunction(c);return this.map(a,function(a){return(d?c:a[c]).apply(a,b)})},sortedIndex:function(d,e,f,j){f=null==f?a:b.isFunction(f)?f:c(f);e=f.call(j,e);for(var m=0,r=d.length;m<r;){var n=m+r>>>1;f.call(j,d[n])<e?m=n+1:r=n}return m},sortBy:function(d,e,f){e=null==e?a:b.isFunction(e)?e:c(e);return this.pluck(this.map(d,function(a,c,b){return{value:a,index:c,criteria:e.call(f,a,c,b)}}).sort(function(a,c){var b=a.criteria,d=c.criteria;if(b!==d){if(b>d||void 0===b)return 1;if(b<d||void 0===d)return-1}return a.index-
c.index}),"value")}};return e});
handy.add("Template","B.String",function(f,b){function a(a){return h?"$r+="+a+";\n":"$r.push("+a+");\n"}function c(c){c=c.replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n");return a('"'+c+'"')}var d={openTag:"<%",closeTag:"%>",isEscape:!0,registerHelper:function(a,c){k[a]||(j+=a+"=oHelpers."+a+",");k[a]=c},tmpl:function(f,r){var n,s,w;if("string"==typeof f)n=f;else if(n=f.tmpl,w=f.id)if(e[w])s=e[w];else if(!n){var y=document.getElementById(w);y&&(n=(y.value||y.innerHTML).replace(/\s/g,
""))}if(!s){if(!n){b.Debug.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}var p=j+"$r="+(h?'""':"[]")+";\n";b.Object.each(n.split(d.openTag),function(b,e){var f=e.split(d.closeTag);if(1==f.length)p+=c(f[0]);else{var h=p,j=f[0],j=j.replace(/this/g,"$data");0==j.indexOf("=")&&(j=a(j.replace(g,"")+'||""'));p=h+(j+"\n");f[1]&&(p+=c(f[1]))}});p+="return "+(h?"$r;":'$r.join("");');n=new Function("$data",p);n.$helpers=k;s=n;w&&(e[w]=s)}return r?s(r):s}},e={},g=/^=/,h="".trim,k={escape:f.escapeHTML,trim:f.trim},
j="var oHelpers=arguments.callee.$helpers,escape=oHelpers.escape,trim=oHelpers.trim,";return d});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(f,b,a){function c(a){if(a==m)return!1;var c=j.contentWindow.document;c.open();c.write("<!doctype html><html><body>"+a+"</body></html>");c.close();m=a;f.log("set:"+j.contentWindow.document.body.innerText)}function d(){var a=b.getHash(),d=j.contentWindow.document.body.innerText;a!=m?(c(a),e(a)):d!=m&&(f.log("update:"+j.contentWindow.document.body.innerText),b.setHash(d))}function e(a){var c=s.listeners,b;for(b in c)c[b](a)}var g,
h=0,k=document,j,m,r=k.documentMode,n="onhashchange"in window&&(void 0===r||7<r),s={delay:50,listen:function(f,m){if(!g&&!g)if(g=!0,s.listeners={},n)$(window).on("hashchange",function(){e(b.getHash())});else j=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(k.body)[0],$(j).one("load",function(){c(b.getHash());setInterval(d,s.delay)});if(m in s.listeners)$D.error(Error("Duplicate name"));else return m=m||a.expando+ ++h,s.listeners[m]=f,m},unListen:function(a){for(var c in s.listeners)(!a||
a==c)&&delete s.listeners[c]}};return s});handy.add("Support","B.Browser",function(f){var b={mediaQuery:function(){var a;if(f.mobile())a="hui-mobile";else{a="hui-pc";var b=f.ie();b&&(a+=" ie"+b)}document.documentElement.className+=" "+a}};b.mediaQuery();if(6==f.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}return b});
handy.add("Validator",["B.String","B.Object"],function(f,b){var a={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(c,b){var e=b.rules,f;for(f in e){var h=e[f],k=("function"==typeof h?h:a[f])(c,h);if(!k)return e=b.error||a.error,f=b.messages&&
b.messages[f]||a.messages[f],f=f.replace(/\{([^\}]+)\}/g,function(a,c){return h[c]||0==c&&h||b[c]||h||""}),e&&e(f),k}return!0},required:function(a){return 0<f.trim(""+a).length},email:function(a){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a){return!/Invalid|NaN/.test((new Date(a)).toString())},dateISO:function(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a){return/^\d+$/.test(a)},creditcard:function(a){if(/[^0-9 \-]+/.test(a))return!1;var b=0,e=0,f=!1;a=a.replace(/\D/g,"");for(var h=a.length-1;0<=h;h--){e=a.charAt(h);e=parseInt(e,10);if(f&&9<(e*=2))e-=9;b+=e;f=!f}return 0===b%10},min:function(a,b){return a>=b},max:function(a,
b){return a<=b},range:function(a,b){return a>=b[0]&&a<=b[1]},minlength:function(a,d){return(b.isArray(a)?a.length:f.trim(""+a).length)>=d},maxlength:function(a,d){return(b.isArray(a)?a.length:f.trim(""+a).length)<=d},rangelength:function(a,d){var e=b.isArray(a)?a.length:f.trim(""+a).length;return e>=d[0]&&e<=d[1]},equalTo:function(a,b){return a===b}};return a});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(f,b,a){b={_init:function(){!c&&f.ie()&&(e=document.getElementById("LocalStorageUserDataDiv"),e||(e=document.createElement("DIV"),e.style.display="none",e.id="LocalStorageUserDataDiv",e.addBehavior("#default#userData"),document.body.appendChild(e),e.load(g)))},getItem:function(b){b=c?d.getItem(b):e.getAttribute(b);return b=a.parseJson(b)},setItem:function(b,f){f=a.stringify(f);try{c?d.setItem(b,f):(e.setAttribute(b,f),e.save(g))}catch(j){return $D.error(j),
!1}return!0},removeItem:function(a){c?d.removeItem(a):(e.removeAttribute(a),e.save(g))},clear:function(){c?d.clear():e.unload()}};var c=window.localStorage&&window.localStorage.getItem,d=window.localStorage,e,g=document.domain;b._init();return b});(function(f){Hui=H=$H=f.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};f=window.$;f.fn.remove=$H.intercept(f.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
