/* Handy v1.0.0-dev | 2014-03-29 | zhengyinhui100@gmail.com */
(function(){var f=window.handy,d=window.$,a=window.handy=window.$=function(){};a.version="1.0.0";a.isDebug="undefined"==typeof gEnv?!1:"dev"==gEnv;a.expando="handy"+(a.version+Math.random()).replace(/\D/g,"");a.add=function(b,c,e){e||(e=c,c=null);a.base||(a.base={});var d=[];if(c)if("string"==typeof c)d.push(a.base.Object.namespace(c));else for(var h=0;h<c.length;h++)d.push(a.base.Object.namespace(c[h]));d.push(a);c=e.apply(window,d);a.base[b]=a[b]=c;if(0<="Browser,Class,Collection,Cookie,Events,Function,Json,Object,String,Template,Util".indexOf(b))for(var f in c)a.isDebug&&
("undefined"!=typeof a[f]&&"console"in window&&!Function[f])&&(console.log(a[f]),console.log(b+"\u547d\u540d\u51b2\u7a81:"+f)),a[f]=c[f]};a.noConflict=function(b){window.$===a&&(window.$=d);b&&window.handy===a&&(window.handy=f);return a};a.noop=function(){}})();
handy.add("Json",function(){function f(a){g.lastIndex=0;g.test(a)&&(a=a.replace(g,function(a){var b=h[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));return'"'+a+'"'}function d(a,g){var h,k,j,n,A=c,x,p=g[a];p&&("object"===typeof p&&"function"===typeof p.toJSON)&&(p=p.toJSON(a));"function"===typeof b&&(p=b.call(g,a,p));switch(typeof p){case "string":return f(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);case "object":if(!p)return"null";
c+=e;x=[];if("[object Array]"===Object.prototype.toString.apply(p)){n=p.length;for(h=0;h<n;h+=1)x[h]=d(h,p)||"null";j=0===x.length?"[]":c?"[\n"+c+x.join(",\n"+c)+"\n"+A+"]":"["+x.join(",")+"]";c=A;return j}if(b&&"object"===typeof b){n=b.length;for(h=0;h<n;h+=1)"string"===typeof b[h]&&(k=b[h],(j=d(k,p))&&x.push(f(k)+(c?": ":":")+j))}else for(k in p)Object.prototype.hasOwnProperty.call(p,k)&&(j=d(k,p))&&x.push(f(k)+(c?": ":":")+j);j=0===x.length?"{}":c?"{\n"+c+x.join(",\n"+c)+"\n"+A+"}":"{"+x.join(",")+
"}";c=A;return j}}var a="JSON"in window,b,c,e,g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g;
return{stringify:function(g,h,f,k){if(a&&!k)return JSON.stringify.apply(null,arguments);var j;e=c="";if("number"===typeof f)for(j=0;j<f;j+=1)e+=" ";else"string"===typeof f&&(e=f);if((b=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))$D.error(Error("Json.stringify:\u66ff\u6362\u53c2\u6570\u53ea\u80fd\u662f\u51fd\u6570\u6216\u8005\u6570\u7ec4"));else return d("",{"":g})},parseJson:function(b,c,e){function d(a,b){var e,g,h=a[b];if(h&&"object"===typeof h)for(e in h)Object.prototype.hasOwnProperty.call(h,
e)&&(g=d(h,e),void 0!==g?h[e]=g:delete h[e]);return c.call(a,b,h)}if(a&&!e)return JSON.parse.apply(null,arguments);var g;b=String(b);k.lastIndex=0;k.test(b)&&(b=b.replace(k,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(j.test(b.replace(n,"@").replace(u,"]").replace(q,"")))return g=eval("("+b+")"),"function"===typeof c?d({"":g},""):g;$D.error(new SyntaxError("JSON.parse"))}}});
handy.add("Object",function(){var f;f=(f=window.navigator.userAgent.match(/MSIE ([\d.]+)/))&&9>parseInt(f[0])?function(a,b,c){var e=[];if(a.length){b=b||0;for(c=c||a.length;b<c;b++)e.push(a[b])}return e}:function(a,b,c){return Array.prototype.slice.call(a,b||0,c||a.length)};var d={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},namespace:function(a,b){var c=null,e,g,h,f;a=d.alias(a);g=a.split(".");c=g[0];c=(h=2==arguments.length)?eval("(function(){if (typeof "+c+' == "undefined"){'+
c+" = {};}return "+c+";})()"):eval("(function(){if (typeof "+c+' != "undefined")return '+c+";})()");e=1;for(f=g.length;e<f;++e){if(e==f-1&&h)c[g[e]]=b;else if(h||c&&c[g[e]])c[g[e]]=c[g[e]]||{};else return;c=c[g[e]]}return c},alias:function(a,b){var c=d._alias;if(b)c[a]?$D.error("\u522b\u540d\u5df2\u88ab\u4f7f\u7528"+a+":"+c[a]):c[a]=b;else{if(a){var e=a,g=a.length-1;do{if(c[e])return c[e]+a.substring(g);g=e.lastIndexOf(".")}while(0<g&&(e=e.substring(0,g)));return a}return c}},extend:function(a,b,
c){var e=c?c.notCover:!1,g=c?c.cover:null;c=c?c.IsClone:!1;a=a||{};var h=a.constructor,f=h.$isClass,j,n;for(n in b)if(j=b[n],(!g||d.contains(g,n))&&b.hasOwnProperty(n)){var u=a.hasOwnProperty(n),q=!0===e?u:!1;d.isArray(e)?q=d.contains(e,n)&&u:d.isFunction(e)&&(q=e(n,j));q||(j=c?d.clone(j):j,f&&d.isFunction(j)&&(j.$name=n,j.$owner=h),a[n]=j)}return a},mix:function(a,b,c){a.superProto||(a.superProto={});for(var e in b)a.superProto[e]=d.isFunction(b[e])?a.superProto[e]?function(a,e){return function(){e.apply(this,
arguments);b[a].apply(this,arguments)}}(e,a.superProto[e]):b[e]:b[e],a[e]||(a[e]=b[e]);c&&d.extend(a,c);b.toString!=b.constructor.prototype.toString&&(a.superProto.toString=function(){b.toString.apply(a,arguments)});return a},isFunction:function(a){return"[object Function]"===window.Object.prototype.toString.call(a)},isArray:function(a){return"[object Array]"===window.Object.prototype.toString.call(a)},isObject:function(a){return"object"==typeof a&&!d.isArray(a)},isNumber:function(a){return"number"==
typeof a},isString:function(a){return"string"==typeof a},isUndefined:function(a){return"undefined"==typeof a},isClass:function(a){return d.isFunction(a)&&!0===a.$isClass},equals:function(a,b){if(typeof a==typeof b){if("object"!=typeof a)return a===b;if(a===b)return!0;if(d.isArray(a)&&d.isArray(b)){if(a.length!=b.length)return!1;for(var c=0,e=a.length;c<e;c++)if(!d.equals(a[c],b[c]))return!1;return!0}if(!d.isArray(a)&&!d.isArray(b)){if(d.count(a)!=d.count(b))return!1;for(c in a)if(void 0==b[c]||!d.equals(a[c],
b[c]))return!1;return!0}}return!1},clone:function(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor;if(b!=window.Object&&b!=window.Array)return a;if(b==window.Date||b==window.RegExp||b==window.Function||b==window.String||b==window.Number||b==window.Boolean)return new b(a);try{var c=new b,e;for(e in a)c[e]=d.clone(a[e]);return c}catch(g){return a}},isEmpty:function(a){if(d.isArray(a))return 0==a.length;for(var b in a)return!1;return!0},each:function(a,b,c){var e,g=0,h=a.length,f=void 0===
h||d.isFunction(a);if(c)if(f)for(e in a){if(!1===b.apply(a[e],c))break}else for(;g<h&&!1!==b.apply(a[g],c);)e=a.length,h==e?g++:h=e;else if(f)for(e in a){if(!1===b.call(a[e],e,a[e]))break}else for(;g<h&&!1!==b.call(a[g],g,a[g]);)e=a.length,h==e?g++:h=e;return a},contains:function(a,b){var c=!1;d.each(a,function(a,g){if(d.equals(g,b))return c=!0,!1});return c},largeThan:function(a,b){if("object"==typeof a&&"object"==typeof b){var c=!0;d.each(b,function(e){if(!d.equals(b[e],a[e]))return c=!1});return c}},
count:function(a){if(d.isArray(a))return a.length;var b=0,c;for(c in a)b++;return b},removeUndefined:function(a,b){var c=d.isArray(a);if(b){if(c){var e=[];d.each(a,function(a,b){void 0!==b&&e.push(b)});return e}return d.extend({},a,{isClone:!0,notCover:function(a,b){return void 0===b}})}d.each(a,function(b,e){void 0===e&&(c?a.splice(b,1):delete a[b])});return a},toArray:f,fromArray:function(a){for(var b={},c=0,e=a.length;c<e;c++){var d=a[c];b[d.name]=d.value}return b},getSingleton:function(a){a="string"==
typeof a?d.namespace(a):a;return a._singleton||(a._singleton=new a)},generateMethod:function(a,b,c){b=d.isArray(b)?b:b.split(",");for(var e=0;e<b.length;e++){var g=b[e];a[g]=c(g)}}};return d});
handy.add("Browser","handy.base.Object",function(f){var d={},a={};f.generateMethod(a,"ie firefox chrome safari opera windows linux mac trident webkit gecko presto sogou maxthon tt theWorld is360 mobile android ios iPhone iPod iPad flash".split(" "),function(a){return function(b){var e=d[a];return!b&&"string"===typeof e&&/^[\d\.]+$/.test(e)?parseInt(e):e}});f=window.navigator.userAgent;var b;(b=f.match(/MSIE ([\d.]+)/))?d.ie=b[1]:(b=f.match(/Firefox\/([\d.]+)/))?d.firefox=b[1]:(b=f.match(/Chrome\/([\d.]+)/))?
d.chrome=b[1]:(b=f.match(/Opera.([\d.]+)/))?d.opera=b[1]:(b=f.match(/Version\/([\d.]+).*Safari/))?d.safari=b[1]:0;/windows|win32/i.test(f)?d.windows=!0:/linux/i.test(f)?d.linux=!0:/macintosh/i.test(f)?d.mac=!0:0;/trident/i.test(f)?d.trident=!0:/webkit/i.test(f)?d.webkit=!0:/gecko/i.test(f)?d.gecko=!0:/presto/i.test(f)?d.presto=!0:0;/MetaSr/i.test(f)?d.sogou=!0:/Maxthon/i.test(f)?d.maxthon=!0:/TencentTraveler/i.test(f)?d.tt=!0:/TheWorld/i.test(f)?d.theWorld=!0:/360[S|E]E/i.test(f)?d.is360=!0:0;var c;
if((c=f.match(/AppleWebKit\/([\d.]*)/))&&c[1])if(/ Mobile\//.test(f)&&f.match(/iPad|iPod|iPhone/)){d.mobile="ios";if((c=f.match(/OS ([^\s]*)/))&&c[1])d.ios=c[1].replace("_",".");if((c=f.match(/iPad|iPod|iPhone/))&&c[0])d[c[0].toLowerCase()]=d.ios}else if(/ Android/i.test(f)){if(/Mobile/.test(f)&&(d.mobile="android"),(c=f.match(/Android ([^\s]*);/))&&c[1])d.android=c[1]}else if(c=f.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))d.mobile=c[0].toLowerCase();var e;try{if(d.ie){var g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
g&&(e=g.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&0<navigator.plugins.length&&(g=navigator.plugins["Shockwave Flash"])){var h=g.description.split(" ");b=0;for(var k=h.length;b<k;b++)if(0<parseInt(h[b])){e=h[b];break}}}catch(j){}d.flash=e?e:null;return a});
handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(f,d,a){var b={level:a.isDebug?0:5,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window)||!!d.mobile(),out:function(c,e,d){d=d||"log";if(e||b.showInPage){e=a.expando+"debugDiv";var h=top.document,f=h.getElementById(e);f?f.style.display="block":(f=h.createElement("DIV"),f.id=e,f.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="this.parentNode.getElementsByTagName(\'DIV\')[0].innerHTML=\'\';">\u6e05\u7a7a</a>',
"<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='\u5168\u5c4f'){this.parentNode.style.height='"+h.body.offsetHeight+"px';this.innerHTML='\u6536\u8d77'}else{this.parentNode.style.height='100px';this.innerHTML='\u5168\u5c4f';}\">\u5168\u5c4f</a>",'<a href="javascript:void(0)" onclick="var oDv=this.parentNode.getElementsByTagName(\'div\')[0];if(this.innerHTML==\'\u5e95\u90e8\'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML=\'\u9876\u90e8\';}else{oDv.scrollTop=0;this.innerHTML=\'\u5e95\u90e8\';}">\u9876\u90e8</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="location.reload();">\u5237\u65b0</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="history.back();">\u540e\u9000</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+
'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',f.style.position="fixed",f.style.width=h.body.offsetWidth-20+"px",f.style.left=0,f.style.top=0,f.style.right=0,f.style.height="150px",f.style.backgroundColor="#aaa",f.style.fontSize="12px",f.style.padding="10px",f.style.zIndex=9999999999,f.style.opacity=0.8,f.style.filter="alpha(opacity=80)",h.body.appendChild(f));e=f.getElementsByTagName("DIV")[0];h=a.Json.stringify(c,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0).replace(/\n/g,"<br/>");e.innerHTML+=
d+" : "+h+"<br/>";e.scrollTop=e.scrollHeight}try{console[d](c)}catch(j){}},log:function(a,e){b.level>b.LOG_LEVEL||b.out(a,!!e,"log")},info:function(a,e){this.level>b.INFO_LEVEL||b.out(a,!!e,"info")},warn:function(a,e){b.level>b.WARN_LEVEL||b.out(a,!!e,"warn")},error:function(a,e){if(!(b.level>b.ERROR_LEVEL)&&(b.out(a,!!e,"error"),a instanceof Error))throw a;},time:function(a,e,d){b.level>b.INFO_LEVEL||(a?("boolean"==typeof e&&(d=e,e=""),b.out((e||"")+((new Date).getTime()-(b.lastTime||0)),!!d)):b.lastTime=
(new Date).getTime())},debug:function(a){if(!(b.level>b.DEBUG_LEVEL)&&!1!==a)debugger}};return b});handy.add("Function",function(f){return{bind:function(d,a,b){var c=Array.prototype.slice.call(arguments,2);return function(){Array.prototype.push.apply(c,arguments);return d.apply(a,c)}},intercept:function(d,a,b,c){return f.Object.isFunction(d)&&f.Object.isFunction(a)?function(){var e=b||this,g={},f=arguments;g.scope=c;g.target=e;g.method=d;return!1!=a.apply(g,f)?d.apply(e,f):!1}:d}}});
handy.add("Class",["B.Object","B.Debug"],function(f,d){var a={createClass:function(b){var c=function(){var a,b;a=this.constructor==c?this:arguments.callee;if(b=a.initialize){for(var d in a)"object"==typeof a[d]&&(a[d]=f.clone(a[d]));return b.apply(a,arguments)}};c.$isClass=!0;c.derive=function(b,c,d){var f=a.createClass();a.inherit(f,this,b,c,d);return f};c.prototype.callSuper=function(a,b){a&&(!a.$isClass&&void 0!=a.length)&&(b=a,a=null);var c=arguments.callee.caller,d=c.$owner.superProto;b=b||c.arguments;
a=a?a.prototype:d||this.constructor.superProto;c=c.$name;if(a&&(c=a[c],f.isFunction(c)))return c.apply(this,b)};b&&this.namespace(b,c);return c},inherit:function(a,c,e,g,h){var k=function(){};k.prototype=c.prototype;f.extend(a,c,h);a.prototype=new k;a.prototype.constructor=a;a.superClass=c;a.superProto=c.prototype;if(c._onInherit)try{c._onInherit(a)}catch(j){d.error(j)}g&&f.extend(a,g);e&&f.extend(a.prototype,e)}};return a});
handy.add("Loader",["B.Debug","B.Object","B.Function"],function(f,d,a,b){function c(a){var b={},c=[];"string"==typeof a&&(a=[a]);for(var e=0,f=a.length;e<f;e++){var g;g=a[e];g=/\.(css|js)$/.test(g)?y[g]&&"loaded"==y[g].status:m.urlMap&&m.urlMap[g]?m.urlMap[g].chkExist():d.namespace(g);if(g)c.push(g);else return b.notExist=a[e],b}b.exist=c;return b}function e(a,b){function c(){c.isCalled||(c.isCalled=!0,clearTimeout(j),b())}if("SCRIPT"===a.nodeName){var e=a,d=c;e.onload=e.onerror=e.onreadystatechange=
function(){/loaded|complete|undefined/.test(e.readyState)&&(e.onload=e.onerror=e.onreadystatechange=null,u.removeChild(e),e=null,setTimeout(d,0))}}else{var h=c;window.hasOwnProperty("attachEvent")?a.attachEvent("onload",h):setTimeout(function(){g(a,h)},0)}var j=setTimeout(function(){f.error("Time is out:"+a.src);c()},m.timeout)}function g(a,b){if(!b.isCalled){var c;if(q)a.sheet&&(c=!0);else if(a.sheet)try{a.sheet.cssRules&&(c=!0)}catch(e){if("SecurityError"===e.name||"NS_ERROR_DOM_SECURITY_ERR"===
e.name)c=!0}setTimeout(function(){c?b():g(a,b)},1)}}function h(a){m.showLoading(!1);w--;y[a].status="loaded";m.traceLog&&f.info(j+"Response: "+a);k()}function k(){for(var a=r.length-1;0<=a;a--){var b=r[a],e=c(b.deps);if(e.notExist)0==a&&0==w&&$D.error(n+e.notExist);else{r.splice(a,1);b.callback.apply(null,e.exist);k();break}}}var j="Loader ",n=j+"not found: ",u=document.head||document.getElementsByTagName("head")[0]||document.documentElement,q=navigator.userAgent.indexOf("AppleWebKit"),r=[],w=0,y=
{},m={traceLog:!1,timeout:15E3,skinName:"skin",showLoading:function(){},define:function(a,c,e){a=b.Object.alias(a);2==arguments.length&&(e=c,c=[]);m.require(c,function(){var b;if("function"==typeof e)try{b=e.apply(null,arguments),m.traceLog&&f.info(j+"define: "+a)}catch(c){c.message=j+a+":factory define error:"+c.message;f.error(c);return}else b=e;if(b){d.namespace(a,b);var g=typeof b;if("object"==g||"function"==g)b.$ns=a}else $D.error(j+"factory no return: "+a)})},require:function(d,g){for(var k=
"string"==typeof d?[d]:d,q=[],p=[],s=!0,t=0,z=k.length;t<z;t++){var l=k[t],l=b.Object.alias(l),v=c(l);v.notExist?(q.push(l),s&&(s=!1,r.push({deps:k,callback:g})),m.traceLog&&f.info(n+l)):p.push(v.exist[0])}if(0==q.length)return g&&g.apply(null,p),0==p.length?p[0]:p;s=!1;k=0;for(p=q.length;k<p;k++)if(t=q[k],!y[t]){s=t;l=m.urlMap&&m.urlMap[s]&&m.urlMap[s].url;if(!l){z="";l=m.rootPath;if("string"==typeof l)z=l;else if("object"==typeof l)for(v in v=void 0,l)0==s.indexOf(v)&&(z=l[v],s=s.replace(v,""));
else z="";l=/.css$/.test(s)?0==s.indexOf("/")?s:"/css/"+s:/.js$/.test(s)?s:s.replace(/\./g,"/")+".js";0!=l.indexOf("/")&&(l="/"+l);l=z+l}s=!0;y[t]={id:t,status:"loading"};z=a.bind(h,null,t);if(/.css$/.test(l))a:{t=l;l=u.getElementsByTagName("link");for(v=0;v<l.length;v++){var B=l[v].href;!m.skinNode&&0<=B.indexOf(m.skinName)&&(m.skinNode=l[v]);if(0<=B.indexOf(t)||0<=t.indexOf(B))break a}l=document.createElement("link");l.rel="stylesheet";l.href=t;e(l,z);u.insertBefore(l,m.skinNode);m.traceLog&&f.info(j+
"request:"+t)}else t=l,l=document.createElement("script"),l.async="async",l.src=t,l.type="text/javascript",e(l,z),u.appendChild(l),m.traceLog&&f.info(j+"request:"+t);w++}s&&m.showLoading(!0)}};return m});
handy.add("Events",function(f){return{_eventCache:{},_execEvtCache:[],_parseEvents:function(d,a){var b=/\s+/;if("object"==typeof d){for(var c in d)a([c,d[c]]);return!0}if("string"==typeof d&&b.test(d)){b=d.split(b);c=0;for(var e=b.length;c<e;c++)a([b[c]]);return!0}return!1},_parseCustomEvents:function(d,a,b){var c=this,e=f.toArray(arguments,2);return c._parseEvents(a,function(a){c[d].apply(c,a.concat(e))})},_delegateHandler:function(d,a){var b=this;return function(){if(!0!=b.isSuspend)return d.apply(a||
b,arguments)}},_pushEvent:function(d){this._execEvtCache.push(d)},_execEvents:function(){var d=this,a;f.each(d._execEvtCache,function(b,c){var e=c.delegation;"number"==typeof c.times&&(1<c.times?c.times--:d.off(c.name,c.handler));a=e.apply(d,c.args)});d._execEvtCache=[];return a},on:function(d,a,b,c){if(!this._parseCustomEvents("on",d,a,b,c)){"number"==typeof b&&(c=b,b=null);var e=this._eventCache,g=e[d];g||(g=e[d]=[]);d=this._delegateHandler(a,b);g.push({times:c,handler:a,context:b,delegation:d})}},
once:function(d,a,b){var c=f.toArray(arguments);this.on.apply(this,c.push(1))},off:function(d,a){if("all"==d)return this._eventCache={},!0;if(!this._parseCustomEvents("off",d,a)){var b=this._eventCache,c=d.indexOf(".");if(!a&&0>=c){for(var e in b)(e.split(".")[0]==d||0==c&&0<=e.indexOf(d))&&delete b[e];return!0}c=b[d];if(!c)return!1;if(a){b=0;for(e=c.length;b<e;b++)if(c[b].handler==a)return c.splice(b,1),!0}else return delete b[d],!0;return!1}},suspend:function(){if(this.isSuspend)return!1;this.isSuspend=
!0},resume:function(){if(!this.isSuspend)return!1;this.isSuspend=!1},trigger:function(d,a){function b(a){if(a)for(var b=0,e=a.length;b<e;b++){var f=a[b];f.args=g;f.name=d;c._pushEvent(f)}}var c=this,e=f.toArray(arguments);e.unshift("trigger");if(!c._parseCustomEvents.apply(c,e)){var e=c._eventCache,g=f.toArray(arguments),h;if(0<d.indexOf("."))h=e[d],b(h);else for(var k in e)if(h=d.indexOf("."),k.split(".")[0]==d||0==h&&0<=k.indexOf(d))h=e[k],b(h);b(e.all);return c._execEvents()}}}});
handy.add("Date",function(){var f=window.Date,d={getWeek:function(a,b){var c=a.getDay();b&&(c=(c+(b%7+7))%7);return"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[c]},isWeeken:function(a){return 0==a.getDay()||6==a.getDay()},getDaysInMonth:function(a){a=new f(a.getFullYear(),a.getMonth()+1,0);return a.getDate()},getDaysInYear:function(a){var b=new f(a.getFullYear(),0,0);a=new f(a.getFullYear()+1,0,0);return Math.floor((a.getTime()-b.getTime())/864E5)},getDayIndexOfYear:function(a){var b=new f("1/1/"+
a.getFullYear());return Math.ceil((a.getTime()-b.getTime())/864E5)},format:function(a,b){b=b||"yyyy-MM-dd HH:mm:ss";a=a||new f;var c=a.getHours(),e=Math.floor((a.getMonth()+3)/3),c={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":0==c%12?12:c%12,"H+":c,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":d.getWeek(a),"q+":e,"Q+":["\u4e00","\u4e8c","\u4e09","\u56db"][e-1],"S+":a.getMilliseconds()},g;for(g in c)RegExp("("+g+")").test(b)&&(e=RegExp.$1.length,b=b.replace(RegExp.$1,1==e?c[g]:("00"+
c[g]).slice(-e)));return b},parse:function(a,b){for(var c=(b||"yyyy-MM-dd HH:mm:ss").match(/[a-zA-Z]+/g),e=a.match(/\d+/g),d=new f,h=0;h<e.length;h++){var k=c[h],j=parseInt(e[h]);switch(k){case "yyyy":d.setFullYear(j);break;case "MM":d.setMonth(j-1);break;case "dd":d.setDate(j);break;case "HH":d.setHours(j);break;case "mm":d.setMinutes(j);break;case "ss":d.setSeconds(j);break;case "SS":d.setMilliseconds(j)}}return d},parseObject:function(a){return new f(a.year+1900,a.month,a.date,a.hours,a.minutes,
a.seconds)}};return d});
handy.add("String",function(){var f={stripTags:function(d){return d.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(d){var a=document.createElement("div");d=document.createTextNode(d);a.appendChild(d);return a.innerHTML},unescapeHTML:function(d){var a=document.createElement("div");a.innerHTML=f.stripTags(d);return a.childNodes[0].nodeValue},decodeHTML:function(d){d=d.replace(/&lt;/gi,"<");d=d.replace(/&gt;/gi,">");d=d.replace(/&quot;/gi,'"');d=d.replace(/&apos;/gi,"'");d=d.replace(/<\/?br>/gi,"\n");
d=d.replace(/&amp;/gi,"&");return d=d.replace(/&nbsp;/gi," ")},encodeHTML:function(d){d=d.replace(/&/gi,"&amp;");d=d.replace(/</gi,"&lt;");d=d.replace(/>/gi,"&gt;");d=d.replace(/\"/gi,"&quot;");d=d.replace(/\'/gi,"&apos;");d=d.replace(/\n/gi,"</br>");return d=d.replace(/ /gi,"&nbsp;")},trim:function(d){return d=d.replace(/(^(\s|\u3000)+)|((\s|\u3000)+$)/g,"")},check:function(d,a){a||(a=/[,%\'\"\/\\;|\<\>\^]/);return-1<d.search(a)},len:function(d){return d.replace(/[^\x00-\xff]/g,"**").length},left:function(d,
a,b){if(f.len(d)>a){!0===b?b=2:0<b||(b=0);var c=0,e=0;for(a-=b;e<a;)255<d.charCodeAt(c)?e+=2:e++,c++;d=d.substring(0,c);for(c=0;c<b;c++)d+="."}return d},isNumberStr:function(d){return 0==d.search(/^\d+$/g)},hasChn:function(d){return/[\u4E00-\u9FA5]+/.test(d)},isChn:function(d){return/^[\u4E00-\u9FA5]+$/.test(d)},addParam:function(d,a){a&&(d+=(-1<d.indexOf("?")?"&":"?")+a);return d}};return f});
handy.add("Cookie",function(){return{getCookie:function(f,d){var a=f+"=",b="",c=document.cookie;if(0<c.length){var e=c.indexOf(a);-1!=e&&(e+=a.length,a=c.indexOf(";",e),-1==a&&(a=c.length),b=c.substring(e,a),d||(b=unescape(b)))}return b},setCookie:function(f,d,a){var b=[];void 0!=f&&void 0!=d&&b.push(f+"="+escape(d));a&&(void 0!=a.path&&b.push("path="+a.path),void 0!=a.domain&&b.push("domain="+a.domain),void 0!=a.expires&&b.push("expires="+a.expires),a.secure&&b.push("secure"));document.cookie=b.join(";")},
delCookie:function(f){var d=new Date;d.setTime(d.getTime()-1);document.cookie=f+"=;expires="+d.toGMTString()}}});
handy.add("Util","B.Object",function(f){var d=0;return{isWindow:function(a){return null!=a&&a==a.window},getUuid:function(){return d++},getHash:function(){return top.location.hash.replace(/\?.*/,"")},setHash:function(a){var b=top.location.hash;0<=b.indexOf("#")&&(a=b.replace(/#[^\?]*/,a));top.location.hash=a},distance:function(a,b,c){var e,d;f.isArray(a)?(e=a[0],a=a[1],d=b[0],b=b[1]):(e=a.latitude,a=a.longtitude,d=b.latitude,b=b.longtitude);e=e*Math.PI/180;d=d*Math.PI/180;a=a*Math.PI/180-b*Math.PI/
180;a=2*Math.asin(Math.sqrt(Math.pow(Math.sin((e-d)/2),2)+Math.cos(e)*Math.cos(d)*Math.pow(Math.sin(a/2),2)));a=Math.round(63781370*a);c&&(a=1E3<a?(a/1E3).toFixed(1)+"km":a+"m");return a},result:function(a,b){var c=a[b];return f.isFunction(c)?c():c}}});
handy.add("Collection","B.Object",function(f,d){function a(a){return a}function b(a){return function(b){return b[a]}}function c(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}}return{map:function(a,b,c){var d=[];if(null==a)return d;var j=Array.prototype.map;if(j&&a.map===j)return a.map(b,c);f.each(a,function(a,e){d.push(b.call(c,e,a))});return d},pluck:function(a,c){return this.map(a,b(c))},some:function(a,b,c){var f=!1;if(null==a||!b)return f;var j=Array.prototype.some;
if(j&&a.some===j)return a.some(b,c);d.each(a,function(a,d,e){if(f||(f=b.call(c,d,a,e)))return!1});return!!f},every:function(a,b,c){var f=!0;if(null==a||!b)return f;var j=Array.prototype.every;if(j&&a.every===j)return a.every(b,c);d.each(a,function(a,d,e){if(!(f=b.call(c,d,a,e)))return!1});return!!f},find:function(a,b,c){var d;this.some(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0});return d},filter:function(a,b,c){var f=[];if(null==a)return f;var j=Array.prototype.filter;if(j&&a.filter===j)return a.filter(b,
c);d.each(a,function(a,d,e){b.call(c,d,a,e)&&f.push(d)});return f},where:function(a,b){return this.filter(a,c(b))},findWhere:function(a,b){return this.find(a,c(b))},invoke:function(a,b){var c=Array.prototype.slice.call(arguments,2),d=f.isFunction(b);return this.map(a,function(a){return(d?b:a[b]).apply(a,c)})},sortBy:function(c,f,h){var k=f;f=null==k?a:d.isFunction(k)?k:b(k);return this.pluck(this.map(c,function(a,b,c){return{value:a,index:b,criteria:f.call(h,a,b,c)}}).sort(function(a,b){var c=a.criteria,
d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-b.index}),"value")}}});
handy.add("Template","B.String",function(f,d){function a(a){return h?"$r+="+a+";\n":"$r.push("+a+");\n"}function b(b){b=b.replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n");return a('"'+b+'"')}var c={openTag:"<%",closeTag:"%>",isEscape:!0,registerHelper:function(a,b){k[a]||(j+=a+"=oHelpers."+a+",");k[a]=b},tmpl:function(f,u){var q,r,w;if("string"==typeof f)q=f;else if(q=f.tmpl,w=f.id)if(e[w])r=e[w];else if(!q){var y=document.getElementById(w);y&&(q=(y.value||y.innerHTML).replace(/\s/g,
""))}if(!r){if(!q){d.Debug.error("\u6a21\u677f\u672a\u5b9a\u4e49");return}var m=j+"$r="+(h?'""':"[]")+";\n";d.Object.each(q.split(c.openTag),function(d,e){var f=e.split(c.closeTag);if(1==f.length)m+=b(f[0]);else{var h=m,j=f[0],j=j.replace(/this/g,"$data");0==j.indexOf("=")&&(j=a(j.replace(g,"")+'||""'));m=h+(j+"\n");f[1]&&(m+=b(f[1]))}});m+="return "+(h?"$r;":'$r.join("");');q=new Function("$data",m);q.$helpers=k;r=q;w&&(e[w]=r)}return u?r(u):r}},e={},g=/^=/,h="".trim,k={escape:f.escapeHTML,trim:f.trim},
j="var oHelpers=arguments.callee.$helpers,escape=oHelpers.escape,trim=oHelpers.trim,";return c});
handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(f,d,a){function b(a){if(a==n)return!1;var b=j.contentWindow.document;b.open();b.write("<!doctype html><html><body>"+a+"</body></html>");b.close();n=a;f.log("set:"+j.contentWindow.document.body.innerText)}function c(){var a=d.getHash(),c=j.contentWindow.document.body.innerText;a!=n?(b(a),e(a)):c!=n&&(f.log("update:"+j.contentWindow.document.body.innerText),d.setHash(c))}function e(a){var b=r.listeners,c;for(c in b)b[c](a)}var g,
h=0,k=document,j,n,u=k.documentMode,q="onhashchange"in window&&(void 0===u||7<u),r={delay:50,listen:function(f,n){if(!g&&!g)if(g=!0,r.listeners={},q)$(window).on("hashchange",function(){e(d.getHash())});else j=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(k.body)[0],$(j).one("load",function(){b(d.getHash());setInterval(c,r.delay)});if(n in r.listeners)$D.error(Error("Duplicate name"));else return n=n||a.expando+ ++h,r.listeners[n]=f,n},unListen:function(a){for(var b in r.listeners)(!a||
a==b)&&delete r.listeners[b]}};return r});handy.add("Support","B.Browser",function(f){var d={mediaQuery:function(){var a;if(f.mobile())a="hui-mobile";else{a="hui-pc";var c=f.ie();c&&(a+=" ie"+c)}document.documentElement.className+=" "+a}};d.mediaQuery();if(6==f.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}return d});
handy.add("Validator",["B.String","B.Object"],function(f,d){var a={messages:{required:"{name}\u4e0d\u80fd\u4e3a\u7a7a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u94fe\u63a5\u5730\u5740",date:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",number:"{name}\u987b\u662f\u6570\u5b57",digits:"{name}\u987b\u662f\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4fe1\u7528\u5361\u53f7\u7801",
equalTo:"\u8bf7\u8f93\u5165\u76f8\u540c\u7684{name}",min:"{name}\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"{name}\u4e0d\u80fd\u5927\u4e8e{0}",range:"{name}\u8981\u5728{0}\u5230{1}\u4e4b\u95f4",maxlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7{0}",minlength:"{name}\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e{0}",rangelength:"{name}\u957f\u5ea6\u8981\u5728{0}\u5230{1}\u4e4b\u95f4"},valid:function(b,c){var d=c.rules,f;for(f in d){var h=d[f],k=("function"==typeof h?h:a[f])(b,h);if(!k)return d=c.error||a.error,f=c.messages&&
c.messages[f]||a.messages[f],f=f.replace(/\{([^\}]+)\}/g,function(a,b){return h[b]||0==b&&h||c[b]||h||""}),d&&d(f),k}return!0},required:function(a){return 0<f.trim(""+a).length},email:function(a){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a){return!/Invalid|NaN/.test((new Date(a)).toString())},dateISO:function(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a){return/^\d+$/.test(a)},creditcard:function(a){if(/[^0-9 \-]+/.test(a))return!1;var c=0,d=0,f=!1;a=a.replace(/\D/g,"");for(var h=a.length-1;0<=h;h--){d=a.charAt(h);d=parseInt(d,10);if(f&&9<(d*=2))d-=9;c+=d;f=!f}return 0===c%10},min:function(a,c){return a>=c},max:function(a,
c){return a<=c},range:function(a,c){return a>=c[0]&&a<=c[1]},minlength:function(a,c){return(d.isArray(a)?a.length:f.trim(""+a).length)>=c},maxlength:function(a,c){return(d.isArray(a)?a.length:f.trim(""+a).length)<=c},rangelength:function(a,c){var e=d.isArray(a)?a.length:f.trim(""+a).length;return e>=c[0]&&e<=c[1]},equalTo:function(a,c){return a===c}};return a});
handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(f,d,a){d={_init:function(){!b&&f.ie()&&(e=document.getElementById("LocalStorageUserDataDiv"),e||(e=document.createElement("DIV"),e.style.display="none",e.id="LocalStorageUserDataDiv",e.addBehavior("#default#userData"),document.body.appendChild(e),e.load(g)))},getItem:function(d){d=b?c.getItem(d):e.getAttribute(d);return d=a.parseJson(d)},setItem:function(d,f){f=a.stringify(f);try{b?c.setItem(d,f):(e.setAttribute(d,f),e.save(g))}catch(j){return $D.error(j),
!1}return!0},removeItem:function(a){b?c.removeItem(a):(e.removeAttribute(a),e.save(g))},clear:function(){b?c.clear():e.unload()}};var b=window.localStorage&&window.localStorage.getItem,c=window.localStorage,e,g=document.domain;d._init();return d});(function(f){Hui=H=$H=f.noConflict();$D=$H.Debug;$HD=$H.Date;$Define=$H.Loader.define;$Require=$H.Loader.require;$G={config:{}};f=window.$;f.fn.remove=$H.intercept(f.fn.remove,function(){$H.trigger("removeEl",this.target)})})(handy);
