/* handy v1.0 | 2014-06-26 | zhengyinhui100@gmail.com */
!function(){function a(a,b,c){c||(c=b,b=null),e.base||(e.base={});var d=[];if(b)if("string"==typeof b)d.push(e.base.Object.ns(b));else for(var f=0;f<b.length;f++)d.push(e.base.Object.ns(b[f]));d.push(e);var g=c.apply(window,d);if(e.base[a]=e[a]=g,"Browser,Class,Array,Geo,Cookie,Date,Events,Function,Json,Object,String,Template,Util".indexOf(a)>=0)for(var h in g)e.isDebug&&"undefined"!=typeof e[h]&&"console"in window&&!Function[h]&&(console.log(e[h]),console.log(a+"命名冲突:"+h)),e[h]=g[h]}function b(a){return window.$===e&&(window.$=d),a&&window.handy===e&&(window.handy=c),e}var c=window.handy,d=window.$,e=window.handy=window.$=function(){};e.version="1.0.0",e.isDebug="undefined"==typeof gEnv?!1:"dev"==gEnv,e.expando=("handy-"+e.version).replace(/\./g,"_"),e.add=a,e.noConflict=b,e.noop=function(){}}(),handy.add("Json",function($H){function _fQuote(a){return _rEscapable.lastIndex=0,_rEscapable.test(a)&&(a=a.replace(_rEscapable,function(a){var b=_oMeta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),'"'+a+'"'}function _fToString(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof _replacer&&(i=_replacer.call(b,a,i)),typeof i){case"undefined":return"undefined";case"string":return _fQuote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=_indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=_fToString(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(_replacer&&"object"==typeof _replacer)for(f=_replacer.length,c=0;f>c;c+=1)"string"==typeof _replacer[c]&&(d=_replacer[c],e=_fToString(d,i),e&&g.push(_fQuote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=_fToString(d,i),e&&g.push(_fQuote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}function fStringify(a,b,c,d){if(_bNativeJson&&!d)return JSON.stringify.apply(null,arguments);var e;if(gap="",_indent="","number"==typeof c)for(e=0;c>e;e+=1)_indent+=" ";else"string"==typeof c&&(_indent=c);return _replacer=b,!b||"function"==typeof b||"object"==typeof b&&"number"==typeof b.length?_fToString("",{"":a}):void $D.error(new Error("Json.stringify:替换参数只能是函数或者数组"))}function fParseJson(sText,fReviver,bNotNative){function _fReviver(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=_fReviver(e,c),void 0!==d?e[c]=d:delete e[c]);return fReviver.call(a,b,e)}if(_bNativeJson&&!bNotNative)return JSON.parse.apply(null,arguments);var j;return sText=String(sText),_rCx.lastIndex=0,_rCx.test(sText)&&(sText=sText.replace(_rCx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),_rValidchars.test(sText.replace(_rValidescape,"@").replace(_rValidtokens,"]").replace(_rValidbraces,""))?(j=eval("("+sText+")"),"function"==typeof fReviver?_fReviver({"":j},""):j):void $D.error(new SyntaxError("JSON.parse"))}var Json={stringify:fStringify,parseJson:fParseJson},_bNativeJson="JSON"in window,_replacer,gap,_indent,_rEscapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_oMeta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},_rCx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_rValidchars=/^[\],:{}\s]*$/,_rValidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,_rValidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,_rValidbraces=/(?:^|:|,)(?:\s*\[)+/g;return Json}),handy.add("Object",function($H){function fNamespace(sPath,obj){var oObject=null,j,aPath,root,bIsCreate,len;for(sPath=Object.alias(sPath),aPath=sPath.split("."),root=aPath[0],bIsCreate=2==arguments.length,oObject=eval(bIsCreate?"(function(){if (typeof "+root+' == "undefined"){'+root+" = {};}return "+root+";})()":"(function(){if (typeof "+root+' != "undefined")return '+root+";})()"),j=1,len=aPath.length;len>j;++j){if(j==len-1&&bIsCreate)oObject[aPath[j]]=obj;else{if(!(bIsCreate||oObject&&oObject[aPath[j]]))return;oObject[aPath[j]]=oObject[aPath[j]]||{}}oObject=oObject[aPath[j]]}return oObject}function fAlias(a,b){var c=Object._alias;if(!b){if(a){var d=a,e=a.length-1;do{if(c[d])return c[d]+a.substring(e);e=d.lastIndexOf(".")}while(e>0&&(d=d.substring(0,e)));return a}return c}c[a]?$D.error("别名已被使用"+a+":"+c[a]):c[a]=b}function fExtend(a,b,c){if(!b||Object.isStr(b)||Object.isNum(b))return a;var d=c?c.notCover:!1,e=c?c.cover:null,f=c?c.IsClone:!1;a=a||{};var g,h=a.constructor,i=h.$isClass;for(var j in b)if(g=b[j],(!e||Object.contains(e,j))&&b.hasOwnProperty(j)){var k=a.hasOwnProperty(j),l=d===!0?k:!1;if(Object.isArr(d)?l=Object.contains(d,j)&&k:Object.isFunc(d)&&(l=d(j,g)),!l){var g=f?Object.clone(g):g;i&&Object.isFunc(g)&&!g.$name&&(g.$name=j,g.$owner=h),a[j]=g}}return a}function fExtendIf(a,b){return Object.extend(a,b,{notCover:!0})}function fMix(a,b,c,d){a.superProto||(a.superProto={});for(var e in b){if(Object.isFunc(b[e]))if(a.superProto[e]){var f=a.superProto[e];a.superProto[e]=function(a,c){return function(){c.apply(this,arguments),b[a].apply(this,arguments)}}(e,f)}else a.superProto[e]=b[e];else a.superProto[e]=b[e];a[e]||(a[e]=b[e])}return c&&Object.extend(a,c),b.toString!=b.constructor.prototype.toString&&(a.superProto.toString=function(){b.toString.apply(a,arguments)}),d&&a.prototype&&b.prototype,a}function fIsNum(a){return"number"==typeof a}function fIsStr(a){return"string"==typeof a}function fIsBool(a){return"boolean"==typeof a}function fIsSimple(a){return Object.isStr(a)||Object.isNum(a)||Object.isBool(a)}function fIsUndef(a){return"undefined"==typeof a}function fIsFunc(a){return"[object Function]"===wObject.prototype.toString.call(a)}function fIsArr(a){return"[object Array]"===wObject.prototype.toString.call(a)}function fIsObj(a){return"object"==typeof a&&!Object.isArr(a)}function fIsClass(a){return Object.isFunc(a)&&a.$isClass===!0}function fIsInstance(a){return a&&a.constructor&&a.constructor.$isClass===!0}function fEquals(a,b){if(typeof a==typeof b){if("object"!=typeof a)return a===b;if(a===b)return!0;if(Object.isArr(a)&&Object.isArr(b)){if(a.length!=b.length)return!1;for(var c=0,d=a.length;d>c;c++)if(!Object.equals(a[c],b[c]))return!1;return!0}if(Object.isArr(a)||Object.isArr(b))return!1;if(Object.count(a)!=Object.count(b))return!1;for(var e in a){if(void 0===b[e])return!1;if(!Object.equals(a[e],b[e]))return!1}return!0}return!1}function fClone(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor;if(b!=wObject&&b!=window.Array)return a;if(b==window.Date||b==window.RegExp||b==window.Function||b==window.String||b==window.Number||b==window.Boolean)return new b(a);try{var c=new b;for(var d in a)c[d]=Object.clone(a[d]);return c}catch(e){return a}}function fIsEmpty(a){if(Object.isArr(a))return 0==a.length;for(var b in a)return!1;return!0}function fEach(a,b,c){if(a){var d,e,f=0,g=a.length,h=void 0===g||Object.isFunc(a);if(c)if(h){for(d in a)if(b.apply(a[d],c)===!1)break}else for(;g>f&&b.apply(a[f],c)!==!1;)e=a.length,g==e?f++:g=e;else if(h){for(d in a)if(b.call(a[d],d,a[d])===!1)break}else for(;g>f&&b.call(a[f],f,a[f])!==!1;)e=a.length,g==e?f++:g=e;return a}}function fContains(a,b){if(!a)return!1;var c=!1;return Object.each(a,function(a,d){return Object.equals(d,b)?(c=!0,!1):void 0}),c}function fLargeThan(a,b){if("object"==typeof a&&"object"==typeof b){var c=!0;return Object.each(b,function(d){return Object.equals(b[d],a[d])?void 0:c=!1}),c}}function fCount(a){if(Object.isArr(a))return a.length;var b=0;for(var c in a)b++;return b}function fRemoveUndefined(a,b){var c=Object.isArr(a);if(b){if(c){var d=[];return Object.each(a,function(a,b){void 0!==b&&d.push(b)}),d}return Object.extend({},a,{isClone:!0,notCover:function(a,b){return void 0===b}})}return Object.each(a,function(b,d){void 0===d&&(c?a.splice(b,1):delete a[b])}),a}function fToArray(){var a=window.navigator.userAgent.match(/MSIE ([\d.]+)/);return a&&parseInt(a[0])<9?function(a,b,c){var d=[];if(a.length)for(var e=b||0,f=c||a.length;f>e;e++)d.push(a[e]);return d}:function(a,b,c){return Array.prototype.slice.call(a,b||0,c||a.length)}}function fFromArray(a){for(var b={},c=0,d=a.length;d>c;c++){var e=a[c];b[e.name]=e.value}return b}function fGenerateMethod(a,b,c){for(var d=Object.isArr(b)?b:b.split(","),e=0;e<d.length;e++){var f=d[e];a[f]=c(f)}}var Object={_alias:{B:"handy.base",C:"handy.component",M:"handy.module",CM:"handy.common"},ns:fNamespace,alias:fAlias,extend:fExtend,extendIf:fExtendIf,mix:fMix,isNum:fIsNum,isStr:fIsStr,isBool:fIsBool,isSimple:fIsSimple,isUndef:fIsUndef,isFunc:fIsFunc,isArr:fIsArr,isObj:fIsObj,isClass:fIsClass,isInstance:fIsInstance,equals:fEquals,clone:fClone,isEmpty:fIsEmpty,each:fEach,contains:fContains,largeThan:fLargeThan,count:fCount,removeUndefined:fRemoveUndefined,toArray:fToArray(),fromArray:fFromArray,generateMethod:fGenerateMethod},wObject=window.Object;return Object}),handy.add("Browser","handy.base.Object",function(a){function b(){var a=window.navigator.userAgent;c(a),d(a),e(a),f(a),g(a),h()}function c(a){var b,c=a;(b=c.match(/MSIE ([\d.]+)/))?i.ie=b[1]:(b=c.match(/Firefox\/([\d.]+)/))?i.firefox=b[1]:(b=c.match(/Chrome\/([\d.]+)/))?i.chrome=b[1]:(b=c.match(/Opera.([\d.]+)/))?i.opera=b[1]:(b=c.match(/Version\/([\d.]+).*Safari/))?i.safari=b[1]:0}function d(a){/windows|win32/i.test(a)?i.windows=!0:/linux/i.test(a)?i.linux=!0:/macintosh/i.test(a)?i.mac=!0:0}function e(a){var b=a;/trident/i.test(b)?i.trident=!0:/webkit/i.test(b)?i.webkit=!0:/gecko/i.test(b)?i.gecko=!0:/presto/i.test(b)?i.presto=!0:0}function f(a){var b=a;/MetaSr/i.test(b)?i.sogou=!0:/Maxthon/i.test(b)?i.maxthon=!0:/TencentTraveler/i.test(b)?i.tt=!0:/TheWorld/i.test(b)?i.theWorld=!0:/360[S|E]E/i.test(b)?i.is360=!0:0}function g(a){var b,c=a;(b=c.match(/AppleWebKit\/([\d.]*)/))&&b[1]&&(/ Mobile\//.test(c)&&c.match(/iPad|iPod|iPhone/)?(i.mobile="ios",b=c.match(/OS ([^\s]*)/),b&&b[1]&&(i.ios=b[1].replace("_",".")),b=c.match(/iPad|iPod|iPhone/),b&&b[0]&&(i[b[0].toLowerCase()]=i.ios)):/ Android/i.test(c)?(/Mobile/.test(c)&&(i.mobile="android"),b=c.match(/Android ([^\s]*);/),b&&b[1]&&(i.android=b[1])):(b=c.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))&&(i.mobile=b[0].toLowerCase()))}function h(){var a;try{if(i.ie){var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b&&(a=b.getVariable("$version").split(" ")[1])}else if(navigator.plugins&&navigator.plugins.length>0){var b=navigator.plugins["Shockwave Flash"];if(b)for(var c=b.description.split(" "),d=0,e=c.length;e>d;d++)if(parseInt(c[d])>0){a=c[d];break}}}catch(f){}i.flash=a?a:null}var i={},j={};return a.generateMethod(j,["ie","firefox","chrome","safari","opera","windows","linux","mac","trident","webkit","gecko","presto","sogou","maxthon","tt","theWorld","is360","mobile","android","ios","iPhone","iPod","iPad","flash"],function(a){return function(b){var c=i[a];return!b&&"string"==typeof c&&/^[\d\.]+$/.test(c)?parseInt(c):c}}),b(),j}),handy.add("Debug",["handy.base.Json","handy.base.Browser"],function(a,b,c){function d(a,b,d){if(d=d||"log",b||k.showInPage){var e=c.expando+"debugDiv",f=top.document,g=f.getElementById(e);g?g.style.display="block":(g=f.createElement("DIV"),g.id=e,g.innerHTML=['<a href="javascript:void(0)" onclick="this.parentNode.style.display=\'none\'">关闭</a>',"<a href=\"javascript:void(0)\" onclick=\"this.parentNode.getElementsByTagName('DIV')[0].innerHTML='';\">清空</a>","<a href=\"javascript:void(0)\" onclick=\"if(this.innerHTML=='全屏'){this.parentNode.style.height='"+f.body.offsetHeight+"px';this.innerHTML='收起'}else{this.parentNode.style.height='100px';this.innerHTML='全屏';}\">收起</a>","<a href=\"javascript:void(0)\" onclick=\"var oDv=this.parentNode.getElementsByTagName('div')[0];if(this.innerHTML=='底部'){oDv.scrollTop=oDv.scrollHeight;this.innerHTML='顶部';}else{oDv.scrollTop=0;this.innerHTML='底部';}\">顶部</a>",'<a href="javascript:void(0)" onclick="location.reload();">刷新</a>','<a href="javascript:void(0)" onclick="history.back();">后退</a>'].join("&nbsp;&nbsp;&nbsp;&nbsp;")+'<div style="padding-top:5px;height:90%;overflow:auto;"></div>',g.style.position="fixed",g.style.width="100%",g.style.left=0,g.style.top=0,g.style.right=0,g.style.height="100%",g.style.backgroundColor="#aaa",g.style.fontSize="12px",g.style.padding="10px",g.style.zIndex=9999999999,g.style.opacity=.95,g.style.filter="alpha(opacity=95)",f.body.appendChild(g));var h=g.getElementsByTagName("DIV")[0];a=a instanceof Error?a.message:a;var i="string"==typeof a?a:c.Json.stringify(a,null,"&nbsp;&nbsp;&nbsp;&nbsp;",!0);i=i.replace(/\n|\\n/g,"<br/>");var j;j="log"==d?"":' style="color:'+("error"==d?"red":"info"==d?"green":"yellow"),h.innerHTML+="<div"+j+'">'+d+":<br/>"+i+"</div><br/><br/>",h.scrollTop=h.scrollHeight}var l=arguments.callee.caller;l.$owner||(l=l.caller);try{l.$owner&&console[d]("["+l.$owner.$ns+"->"+l.$name+"]"),console[d](a)}catch(m){}}function e(a,b){k.level>k.LOG_LEVEL||k.out(a,!!b,"log")}function f(a,b){this.level>k.INFO_LEVEL||k.out(a,!!b,"info")}function g(a,b){k.level>k.WARN_LEVEL||k.out(a,!!b,"warn")}function h(a,b){if(!(k.level>k.ERROR_LEVEL)&&(k.out(a,!!b,"error"),a instanceof Error))throw a}function i(a,b,c){k.level>k.INFO_LEVEL||(a?("boolean"==typeof b&&(c=b,b=""),k.out((b||"")+((new Date).getTime()-(k.lastTime||0)),!!c)):k.lastTime=(new Date).getTime())}function j(a){k.level>k.DEBUG_LEVEL}var k={level:c.isDebug?0:5,LOG_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,showInPage:!("console"in window&&!b.mobile()),out:d,log:e,info:f,warn:g,error:h,time:i,debug:j};return k}),handy.add("Function",function(a){function b(a,b){var c=Array.prototype.slice.call(arguments,2);return function(){var d=c.slice();return Array.prototype.push.apply(d,arguments),a.apply(b,d)}}function c(b,c,d,e){return a.Object.isFunc(b)&&a.Object.isFunc(c)?function(){var a=d||this,f={},g=arguments;return f.scope=e,f.target=a,f.method=b,0!=c.apply(f,g)?b.apply(a,g):!1}:b||c}var d={bind:b,intercept:c};return d}),handy.add("Class",["B.Object","B.Debug"],function(a,b){function c(b){var c=function(){var a,b,d=arguments;if(this.constructor!=c){a=d.callee;var e=function(){};e.prototype=a.prototype;var f=new e;return a.apply(f,d),f}return a=this,b=a.initialize,b?b.apply(a,d):void 0};return c.$isClass=!0,c.derive=function(a,b,c){var d=f.createClass();return f.inherit(d,this,a,b,c),d},c.prototype.callSuper=function(b,c){var d=this;b&&!b.$isClass&&void 0!==b.length&&(c=b,b=null);var e=arguments.callee.caller,f=e.$owner.superProto;c=c||e.arguments,b=b?b.prototype:f||d.constructor.superProto;var g=e.$name;if(b){var h=b[g];if(a.isFunc(h))return h.apply(d,c)}},b&&this.ns(b,c),c}function d(c,d,e,f,g){var h=function(){};if(h.prototype=d.prototype,a.extend(c,d,g),c.prototype=new h,c.prototype.constructor=c,c.superClass=d,c.superProto=d.prototype,d._onInherit)try{d._onInherit(c)}catch(i){b.error(i)}f&&a.extend(c,f),e&&a.extend(c.prototype,e)}function e(b){var c;return c="string"==typeof b?a.ns(b):b,c&&(c.$singleton||(c.$singleton=new c))}var f={createClass:c,inherit:d,getSingleton:e};return f}),handy.add("Loader",["B.Debug","B.Object","B.Function"],function(a,b,c){function d(a){function c(a){return/\.(css|js)$/.test(a)?x[a]&&"loaded"==x[a].status:y.urlMap&&y.urlMap[a]?y.urlMap[a].chkExist():b.ns(a)}var d={},e=[],f=[];"string"==typeof a&&(a=[a]);for(var g=0,h=a.length;h>g;g++){var i=a[g];i=b.alias(i);var j=c(i);j?e.push(j):f.push(i)}return d.exist=e,d.notExist=f,d}function e(a){var b=y.urlMap&&y.urlMap[a]&&y.urlMap[a].url;if(!b){var c="",d=y.rootPath;if("string"==typeof d)c=d;else if("object"==typeof d)for(var e in d)0==a.indexOf(e)&&(c=d[e],a=a.replace(e,""));else c="";b=/.css$/.test(a)?0==a.indexOf("/")?a:"/css/"+a:/.js$/.test(a)?a:a.replace(/\./g,"/")+".js",b=c.replace(/\/$/,"")+"/"+b.replace(/^\//,"")}return b}function f(a,b){var c=document.createElement("script");c.async="async",c.src=a,c.type="text/javascript",h(c,b),s.appendChild(c)}function g(a,b){for(var c=s.getElementsByTagName("link"),d=0;d<c.length;d++){var e=c[d].href;if(!y.skinNode&&e.indexOf(y.skinName)>=0&&(y.skinNode=c[d]),e.indexOf(a)>=0||a.indexOf(e)>=0)return}var f=document.createElement("link");f.rel="stylesheet",f.href=a,h(f,b),y.skinNode?s.insertBefore(f,y.skinNode):s.appendChild(f)}function h(b,c){function d(){d.isCalled||(d.isCalled=!0,clearTimeout(e),c())}"SCRIPT"===b.nodeName?i(b,d):j(b,d);var e=setTimeout(function(){a.error("Time is out:"+b.src),d()},y.timeout)}function i(b,c){var d=function(){/loaded|complete|undefined/.test(b.readyState)&&(b.onload=b.onerror=b.onreadystatechange=null,s.removeChild(b),b=null,setTimeout(c,0))};b.onload=b.onreadystatechange=d,b.onerror=function(){a.error(q+"load script error:\n"+b.src),d()}}function j(a,b){window.hasOwnProperty("attachEvent")?a.attachEvent("onload",b):setTimeout(function(){k(a,b)},0)}function k(a,b){if(!b.isCalled){var c;if(u)a.sheet&&(c=!0);else if(a.sheet)try{a.sheet.cssRules&&(c=!0)}catch(d){("SecurityError"===d.name||"NS_ERROR_DOM_SECURITY_ERR"===d.name)&&(c=!0)}setTimeout(function(){c?b():k(a,b)},1)}}function l(b){for(var d=!1,h=0,i=b.length;i>h;h++){var j=b[h];if(!x[j]){var k=e(j);d=!0,x[j]={id:j,status:"loading"};var l=c.bind(m,null,j);y.traceLog&&a.log(q+"request:\n"+k),/.css$/.test(k)?g(k,l):f(k,l),w++}}d&&y.showLoading(!0)}function m(b){y.showLoading(!1),w--,x[b].status="loaded",y.traceLog&&a.log(q+"Response:\n"+b),n()}function n(){for(var c=v.length-1;c>=0;c--){var e=v[c],f=d(e.deps);if(0===f.notExist.length){v.splice(c,1),e.callback.apply(null,f.exist),n();break}if(0==c&&0==w){for(var c=v.length-1;c>=0;c--){for(var e=v[c],f=d(e.deps),g=f.notExist,h=!1,i=v.length-1;i>=0;i--)if(b.contains(g,v[i].id)){h=!0;break}h||a.error(r+e.id),a.warn(e.id),a.warn("----notExist : "+f.notExist)}a.error(r+f.notExist)}}}function o(c,d,e){c=b.alias(c);var f=arguments.length;if(2==f&&(e=d,d=[]),b.isFunc(e))for(var g,h=e.toString(),i=/\$Require\s*\(\s*['"]([^'"]+)['"]\s*\)/g;g=i.exec(h);)d.push(g[1]);y.require(d,function(){var d;if("function"==typeof e)try{y.traceLog&&a.log(q+"define:\n"+c),d=e.apply(null,arguments)}catch(f){return f.message=q+c+":\nfactory define error:\n"+f.message,void a.error(f)}else d=e;if(d){b.ns(c,d);var g=typeof d;("object"==g||"function"==g)&&(d.$ns=c)}else a.warn(q+"factory no return:\n"+c)},c)}function p(c,e,f){for(var g="string"==typeof c?[c]:c,h=[],i=[],j=!0,k=0,m=g.length;m>k;k++){var n=g[k];n=b.alias(n);var o=d(n);o.notExist.length>0?(h.push(n),j&&(j=!1,v.push({id:f,deps:g,callback:e})),y.traceLog&&a.log(r+n)):i.push(o.exist[0])}return 0==h.length?(e&&e.apply(null,i),1==i.length?i[0]:i):void l(h)}var q="[Handy Loader] ",r=q+"not found: ",s=document.head||document.getElementsByTagName("head")[0]||document.documentElement,t=navigator.userAgent,u=t.indexOf("AppleWebKit"),v=[],w=0,x={},y={traceLog:!1,timeout:15e3,skinName:"skin",showLoading:function(){},define:o,require:p};return y}),handy.add("Events",function(a){function b(a,b){var c=/\s+/;if("object"==typeof a){for(var d in a)b([d,a[d]]);return!0}if("string"==typeof a&&c.test(a)){for(var e=a.split(c),f=0,g=e.length;g>f;f++)b([e[f]]);return!0}return!1}function c(b,c){var d=this,e=a.toArray(arguments,2);return d._parseEvents(c,function(a){d[b].apply(d,a.concat(e))})}function d(a,b){var c=this;return function(d){return 1!=c.isSuspend||d.indexOf(":")>0?a.apply(b||c,arguments):void 0}}function e(a){var b=this;b._execEvtCache.push(a)}function f(){var b,c=this,d=c._execEvtCache;return a.each(d,function(a,e){d.splice(a,1);var f=e.delegation;"number"==typeof e.times&&(e.times>1?e.times--:c.off(e.name,e.handler)),b=f.apply(c,e.args)}),b}function g(a,b,c,d){var e=this;if(!e._parseCustomEvents("on",a,b,c,d)){"number"==typeof c&&(d=c,c=null);var f=e._eventCache,g=f[a];g||(g=f[a]=[]);var h=e._delegateHandler(b,c);g.push({times:d,handler:b,context:c,delegation:h})}}function h(){var b=this,c=a.toArray(arguments);c.push(1),b.on.apply(b,c)}function i(a,b){var c=this;if("all"==a)return c._eventCache={},!0;if(!c._parseCustomEvents("off",a,b)){var d=c._eventCache,e=a.indexOf(".");if(!b&&0>=e){for(var f in d)(f.split(".")[0]==a||0==e&&f.indexOf(a)>=0)&&delete d[f];return!0}var g=d[a];if(!g)return!1;if(!b)return delete d[a],!0;for(var h=0,i=g.length;i>h;h++)if(g[h].handler==b)return g.splice(h,1),!0;return!1}}function j(b){function c(a){if(a)for(var c=0,e=a.length;e>c;c++){var f=a[c];f.args=h,f.name=b,d._pushEvent(f)}}var d=this,e=a.toArray(arguments);if(e.unshift("trigger"),!d._parseCustomEvents.apply(d,e)){var f,g=d._eventCache,h=a.toArray(arguments);if(b.indexOf(".")>0)f=g[b],c(f);else for(var i in g){var j=b.indexOf(".");(i.split(".")[0]==b||0==j&&i.indexOf(b)>=0)&&(f=g[i],c(f))}return c(g.all),d._execEvents()}}function k(){var a=this;return a.isSuspend?!1:void(a.isSuspend=!0)}function l(){var a=this;return a.isSuspend?void(a.isSuspend=!1):!1}var m={_eventCache:{},_execEvtCache:[],_parseEvents:b,_parseCustomEvents:c,_delegateHandler:d,_pushEvent:e,_execEvents:f,on:g,once:h,off:i,suspend:k,resume:l,trigger:j};return m}),handy.add("Date",function(){function a(a,b){var c=["日","一","二","三","四","五","六"],d=a.getDay();return b&&(d+=b%7+7,d%=7),c[d]}function b(a){return 0==a.getDay()||6==a.getDay()}function c(a){return a=new j(a.getFullYear(),a.getMonth()+1,0),a.getDate()}function d(a){var b=new j(a.getFullYear(),0,0),c=new j(a.getFullYear()+1,0,0);return Math.floor((c.getTime()-b.getTime())/864e5)}function e(a){var b=new j("1/1/"+a.getFullYear());return Math.ceil((a.getTime()-b.getTime())/864e5)}function f(a,b){if("string"==typeof a&&(a=k.parseDate(a)),"object"!=typeof a)return a;var b=b||"yyyy-MM-dd HH:mm:ss",c=a.getHours(),d=Math.floor((a.getMonth()+3)/3),e={"y+":a.getFullYear(),"M+":a.getMonth()+1,"d+":a.getDate(),"h+":c%12==0?12:c%12,"H+":c,"m+":a.getMinutes(),"s+":a.getSeconds(),"w+":k.getWeek(a),"q+":d,"Q+":["一","二","三","四"][d-1],"S+":a.getMilliseconds()};for(var f in e)if(new RegExp("("+f+")").test(b)){var g=RegExp.$1.length;b=b.replace(RegExp.$1,1==g?e[f]:("00"+e[f]).slice(-g))}return b}function g(a,b){var c=typeof a,d=new j;if("number"==c)return d.setTime(a),d;if("string"!=c)return a;var b=b||"yyyy-MM-dd HH:mm:ss",e=b.match(/[a-zA-Z]+/g),f=a.match(/\d+/g);if(f){d.setDate(1);for(var g=0;g<f.length;g++){var h=e[g],i=parseInt(f[g]);switch(h){case"yyyy":d.setFullYear(i);break;case"MM":d.setMonth(i-1);break;case"dd":var l=k.getDaysInMonth(d);i>l&&(i=l),d.setDate(i);break;case"HH":d.setHours(i);break;case"mm":d.setMinutes(i);break;case"ss":d.setSeconds(i);break;case"SS":d.setMilliseconds(i)}}return d}}function h(a){var b=new j;return a&&a!==!0?("number"!=typeof a&&(a=k.parseDate(a).getTime()),void(l=a-b.getTime())):(b.setTime(b.getTime()+l),a&&(b=k.formatDate(b)),b)}function i(a,b){if(a){a=k.parseDate(a);var c=k.now(),d=c.getTime()-a.getTime();if(0!=b){var e;if((d/=6e4)<60)e="分钟",d=d||1;else if((d/=60)<24)e="小时";else{if(!((d/=24)<30))return"30天前";e="天"}d=d>0?d:1,d=(Math.floor(d)||1)+e+"前"}return d}}var j=window.Date,k={getWeek:a,isWeeken:b,getDaysInMonth:c,getDaysInYear:d,getDayIndexOfYear:e,formatDate:f,parseDate:g,now:h,howLong:i},l=0;return k}),handy.add("String",function(){function a(a){return a.replace(/<\/?[^>]+>/gi,"")}function b(a){if(!a)return a;var b=document.createElement("div"),c=document.createTextNode(a);return b.appendChild(c),b.innerHTML}function c(a){var b=document.createElement("div");return b.innerHTML=n.stripTags(a),b.childNodes[0].nodeValue}function d(a){return a=a.replace(/&lt;/gi,"<"),a=a.replace(/&gt;/gi,">"),a=a.replace(/&quot;/gi,'"'),a=a.replace(/&apos;/gi,"'"),a=a.replace(/<\/?br>/gi,"\n"),a=a.replace(/&amp;/gi,"&"),a=a.replace(/&nbsp;/gi," ")}function e(a){return a=a.replace(/&/gi,"&amp;"),a=a.replace(/</gi,"&lt;"),a=a.replace(/>/gi,"&gt;"),a=a.replace(/\"/gi,"&quot;"),a=a.replace(/\'/gi,"&apos;"),a=a.replace(/\n/gi,"</br>"),a=a.replace(/ /gi,"&nbsp;")}function f(a){return a=a.replace(/(^(\s|　)+)|((\s|　)+$)/g,"")}function g(a,b){return b||(b=/[,%\'\"\/\\;|\<\>\^]/),a.search(b)>-1}function h(a){return a.replace(/[^\x00-\xff]/g,"**").length}function i(a,b,c){if(n.len(a)>b){c===!0?c=2:c>0||(c=0);var d=0,e=0;for(b-=c;b>e;)a.charCodeAt(d)>255?e+=2:e++,d++;a=a.substring(0,d);for(var d=0;c>d;d++)a+="."}return a}function j(a){return 0==a.search(/^\d+$/g)}function k(a){return/[\u4E00-\u9FA5]+/.test(a)}function l(a){return/^[\u4E00-\u9FA5]+$/.test(a)}function m(a,b){return b&&(a+=(a.indexOf("?")>-1?"&":"?")+b),a}var n={stripTags:a,escapeHTML:b,unescapeHTML:c,decodeHTML:d,encodeHTML:e,trim:f,check:g,len:h,left:i,isNumStr:j,hasChn:k,isChn:l,addParam:m};return n}),handy.add("Cookie",function(){function a(a,b){var c=a+"=",d="",e=document.cookie;if(e.length>0){var f=e.indexOf(c);if(-1!=f){f+=c.length;var g=e.indexOf(";",f);-1==g&&(g=e.length),d=e.substring(f,g),b||(d=unescape(d))}}return d}function b(a,b,c){var d=[];void 0!==a&&void 0!==b&&d.push(a+"="+escape(b)),c&&(void 0!==c.path&&d.push("path="+c.path),void 0!==c.domain&&d.push("domain="+c.domain),void 0!==c.expires&&d.push("expires="+c.expires),c.secure&&d.push("secure")),document.cookie=d.join(";")}function c(a){var b=new Date;b.setTime(b.getTime()-1),document.cookie=a+"=;expires="+b.toGMTString()}var d={getCookie:a,setCookie:b,delCookie:c};return d}),handy.add("Util","B.Object",function(a){function b(a){return null!=a&&a==a.window}function c(){return++i}function d(){var a=top.location.hash;return a.replace(/\?.*/,"")}function e(a){var b=top.location.hash;b.indexOf("#")>=0&&(a=b.replace(/#[^\?]*/,a)),top.location.hash=a}function f(a){for(var b=0,c=0;a;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{top:c,left:b}}function g(b,c){var d=b[c];return a.isFunc(d)?d():d}var h={isWindow:b,uuid:c,getHash:d,setHash:e,position:f,result:g},i=0;return h}),handy.add("Array","B.Object",function(a,b){function c(a){return a}function d(a){return function(b){return b[a]}}function e(a){return null==a?c:b.isFunc(a)?a:d(a)}function f(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}}function g(b){return function(c,d,f){var g={};return d=e(d),a.each(c,function(a,e){var h=d.call(f,e,a,c);b(g,h,e)}),g}}function h(b,c,d){var e=[];if(null==b)return e;var f=Array.prototype.map;return f&&b.map===f?b.map(c,d):(a.each(b,function(a,b){e.push(c.call(d,b,a))}),e)}function i(a,b){return this.map(a,d(b))}function j(a,c,d){var e=!1;if(null==a||!c)return e;var f=Array.prototype.some;return f&&a.some===f?a.some(c,d):(b.each(a,function(a,b,f){return e||(e=c.call(d,b,a,f))?!1:void 0}),!!e)}function k(a,c,d){var e=!0;if(null==a||!c)return e;var f=Array.prototype.every;return f&&a.every===f?a.every(c,d):(b.each(a,function(a,b,f){return(e=c.call(d,b,a,f))?void 0:!1}),!!e)}function l(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=v.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}var f=Array.prototype.indexOf;if(f&&a.indexOf===f)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1}function m(a,b,c){var d;return this.some(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d}function n(a,c,d){var e=[];if(null==a)return e;var f=Array.prototype.filter;return f&&a.filter===f?a.filter(c,d):(b.each(a,function(a,b,f){c.call(d,b,a,f)&&e.push(b)}),e)}function o(a,b){return this.filter(a,f(b))}function p(a,b){return this.find(a,f(b))}function q(b,c){var d=Array.prototype.slice.call(arguments,2),e=a.isFunc(c);return this.map(b,function(a){return(e?c:a[c]).apply(a,d)})}function r(a,b,c,d,f){c=e(c);for(var g=c.call(d,b),h=0,i=a.length;i>h;){var j=h+i>>>1,k=c.call(d,a[j]);(f?k>g:g>k)?h=j+1:i=j}return h}function s(a,b,c,d){var f=this;return b=e(b),f.pluck(f.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,e=b.criteria;if(c!==e){if(c>e||void 0===c)return d?-1:1;if(e>c||void 0===e)return d?1:-1}return a.index-b.index}),"value")}function t(){return g(function(a,b,c){a[b]?a[b].push(c):a[b]=[c]})}function u(){return g(function(a,b){a[b]?a[b]++:a[b]=1})}var v={map:h,pluck:i,some:j,every:k,indexOf:l,find:m,filter:n,where:o,findWhere:p,invoke:q,sortedIndex:r,sortBy:s,groupBy:t(),countBy:u()};return v}),handy.add("Geo",function(a){function b(b,c,d){function e(a){return a*Math.PI/180}function f(b){return b.get?b=[b.get("latitude"),b.get("longitude")]:a.isObj(b)&&(b=[b.latitude,b.longitude]),b}var g,h,i,j,k=6371;b=f(b),g=b[0],h=b[1],c=f(c),i=c[0],j=c[1];var l=e(g),m=e(i),n=k*Math.acos(Math.cos(m)*Math.cos(l)*Math.cos(e(h)-e(j))+Math.sin(m)*Math.sin(l));if(n=n.toFixed(2),0!=d){if(isNaN(n)){if(g!=i||h!=j||!a.isNum(g)||!a.isNum(h))return"未知";n=0}n+="km"}return n}var c={distance:b};return c}),handy.add("Template",["B.Object","B.String","B.Debug","B.Function"],function(a,b,c){function d(a){var b=typeof a;return"string"!==b&&("number"===b?a+="":a=""),a}function e(a){return b.encodeHTML(d(a))}function f(b,c){var d=c.data;return a.isFunc(b)&&(b=b.call(d)),b&&!c.inverse||!b&&c.inverse?c.fn(d):void 0}function g(a,b){return b.inverse=!0,b.helpers["if"].call(this,a,b)}function h(a,b){var c=b.fn,d="";if(a){if(void 0!==a.length)for(var e=0,f=a.length;f>e;e++)d+=c(a[e]);else for(var e in a)d+=c(a[e]);return d}}function i(a,b){var c=b.fn,d=[];if(a){if(void 0!==a.length)for(var e=0,f=a.length;f>e;e++)d.push(c(a[e]));else for(var e in a)d.push(c(a[e]));return d.join("")}}function j(a){return v?"$r+="+a+";":"$r.push("+a+");"}function k(a){return a=a.replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n"),j('"'+a+'"')}function l(a,c){var c=c||{},d=a.exp.replace(/"/g,"'");d=b.trim(d).replace(/\s{2,}/g," ");var e,f=c.helpers,g=f&&f.getValue,h=f&&f.parseValue,i=a.blockName,k=a.children,l=a.num,m="\nif($tmp||$tmp===0){"+j("$tmp")+"}",o=(a.inverse?"inverse:true,":"")+"num:"+l+',context:$me,exp:"'+d+'",helpers:$helpers,data:$data}',p=g?'$helpers.getValue.call($me,"'+d+'",$data,{'+o+")":"($data&&$data."+d+")";if(i){var q="$program"+l;if(e='$tmp = $helpers["'+i+'"].call($me,'+p+", {fn:"+q+","+o+");"+m,k){var r=n(k,c),u=x[0]+"\n"+r.join("\n")+"\n"+x[1];s.splice(2,0,"\nfunction "+q+"($data){\n"+u+"\n}\n")}}else{var v;(v=d.match(/([^\s]+)\s([^\n]+)/))?(d=v[1],e="if (helper = $helpers."+d+') {\n$tmp = helper.call($me,"'+v[2]+'",{'+o+'); \n}else{$tmp="";}'):(e="if (helper = $helpers."+d+') {\n$tmp = helper.call($me,"",{'+o+"); \n}else{\nhelper = "+p+"; $tmp = typeof helper === functionType ? helper.call($me,{"+o+") : helper;\n"+(h?"\n$tmp=$helpers.parseValue.call($me,$tmp,{"+o+");":"")+"}",t.isEscape?"\n$tmp=escape($tmp);":""),e+=m}return e}function m(a,b){function d(a,b,c){for(var d,e=new RegExp(h+"[#/]"+a+"((?!"+i+").)*"+i,"ig"),f=0;d=e.exec(c);)if(d[0]==b){if(0==f)return d.index;f--}else f++;return-1}if(a){var e,f,g=b||{},h=t.openTag,i=t.closeTag;if(g.children?f=g.children:g.children=f=[],(e=a.indexOf(h))>=0){var j=a.substring(0,e);if(j&&f.push({html:j}),a=a.substring(e+h.length),0==a.indexOf("#")){a=a.substring(1);var k=a.match(/^[a-z]+/);if(!k)return void c.error("找不到辅助函数:"+a);var l=k[0];e=a.indexOf(i);var n=a.substring(l.length+1,e);a=a.substring(e+i.length);var o={num:++w,blockName:l,exp:n};f.push(o);var p=h+"/"+l+i;e=d(l,p,a);var q;if(-1==e)return void c.error("未找到块结束位置:"+p);if(q=a.substring(0,e),a=a.substring(e+p.length),m(q,o),"if"==l)for(var r=o.children,s=0,u=r.length;u>s;s++){var v=r[s];"else"==v.exp&&(v.exp=o.exp,v.blockName="if",v.num=++w,v.inverse=!0,v.children=r.slice(s+1),f.push(v),o.children=r.slice(0,s))}}else e=a.indexOf(i),f.push({num:++w,exp:a.substring(0,e)}),a=a.substring(e+i.length);m(a,g)}else a&&f.push({html:a});return g}}function n(a,b){var c=[];if(a)for(var d=0,e=a.length;e>d;d++){var f=a[d];f.html?c.push(k(f.html)):f.exp&&c.push(l(f,b))}return c}function o(b,d){var e=t.openTag,f=t.closeTag;b=b.replace(new RegExp(e+"!((?!"+f+").)*"+f,"ig"),""),t.isTrim&&(b=b.replace(/^[\s\n]+/,"").replace(/[\s\n]+$/,"").replace(new RegExp("("+f+"|\\>)(\\s|\\n)+(?=("+e+"|<))","ig"),"$1").replace(new RegExp(f+"[\\s\\n]+([^\\n]+)[\\s\\n]+(?=("+e+"|<))","ig"),f+"$1")),s=[x[0]],s.push('var escape=$helpers.escape,functionType="function",$me=this;');
var g,h=d&&d.ns;h?(g=a.extend({},y["default"]),g=a.extend(g,y[h])):g=y["default"],d.helpers=g;var i=m(b);w=0;var j=n(i.children,d);s=s.concat(j),s.push(x[1]);var k=s.join("\n");try{var l=["$T","$helpers","$data",k],o=window.Function.apply(null,l);return function(a,b){return o.call(b||a,t,g,a)}}catch(p){c.log(k),c.error(p)}}function p(){return v}function q(b,c,d){a.isObj(c)?(y[b]||(y[b]={}),a.extend(y[b],c)):y[b][c]=d}function r(a,b,d){var e,f,g;if("string"==typeof a)e=a;else if(void 0!==a.length)e=a.join("");else if(e=a.tmpl,g=a.id)if(u[g])f=u[g];else if(!e){var h=document.getElementById(g);h&&(e=(h.value||h.innerHTML).replace(/\s/g,""))}if(!f){if(!e)return void c.error("模板未定义");f=o(e,a),g&&(u[g]=f)}if(!b)return f;try{return f(b,d)}catch(i){c.log(f.toString()),c.error(i)}}var s,t={openTag:"{{",closeTag:"}}",isTrim:!0,isEscape:!1,getIfPlusJoin:p,registerHelper:q,tmpl:r},u={},v="".trim,w=0,x=["var $r="+(v?'""':"[]")+",$tmp,helper;","return "+(v?"$r;":'$r.join("");')],y={"default":{"if":f,unless:g,each:v?h:i,escape:e,trim:b.trim}};return t}),handy.add("HashChange",["handy.base.Debug","handy.base.Util"],function(a,b,c){function d(){j||(j=!0,q.listeners={},p?$(window).on("hashchange",function(){g(b.getHash())}):(k=$('<iframe id="fff" tabindex="-1" style="display:none" width=0 height=0 title="empty" />').appendTo(n.body)[0],$(k).one("load",function(){e(b.getHash()),setInterval(f,q.delay)})))}function e(b){if(b==l)return!1;var c=k.contentWindow,d=c.document;d.open(),d.write("<!doctype html><html><body>"+b+"</body></html>"),d.close(),l=b,a.log("set:"+k.contentWindow.document.body.innerText)}function f(){var c=b.getHash(),d=k.contentWindow.document.body.innerText;c!=l?(e(c),g(c)):d!=l&&(a.log("update:"+k.contentWindow.document.body.innerText),b.setHash(d))}function g(a){var b=q.listeners;for(var c in b)b[c](a)}function h(a,b){return j||d(),b in q.listeners?void $D.error(new Error("Duplicate name")):(b=b||c.expando+ ++m,q.listeners[b]=a,b)}function i(a){for(var b in q.listeners)a&&a!=b||delete q.listeners[b]}var j,k,l,m=0,n=document,o=n.documentMode,p="onhashchange"in window&&(void 0===o||o>7),q={delay:50,listen:h,unListen:i};return q}),handy.add("Support","B.Browser",function(a){function b(){var b;if(a.mobile())b="hui-mobile";else{b="hui-pc";var c=a.ie();c&&(b+=" ie"+c)}document.documentElement.className+=" "+b}var c={mediaQuery:b};if(c.mediaQuery(),6==a.ie())try{document.execCommand("BackgroundImageCache",!1,!0)}catch(d){}return c}),handy.add("Validator",["B.String","B.Object"],function(a,b){function c(a,b){var c=b.rules;for(var d in c){var e=c[d],f="function"==typeof e?e:s[d],g=f(a,e);if(!g){var h=b.error||s.error,i=b.messages&&b.messages[d]||s.messages[d];return i=i.replace(/\{([^\}]+)\}/g,function(a,c){return e[c]||0==c&&e||b[c]||e||""}),h&&h(i),g}}return!0}function d(b){return a.trim(""+b).length>0}function e(a){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)}function f(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)}function g(a){return!/Invalid|NaN/.test(new Date(a).toString())}function h(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)}function i(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)}function j(a){return/^\d+$/.test(a)}function k(a){if(/[^0-9 \-]+/.test(a))return!1;var b=0,c=0,d=!1;a=a.replace(/\D/g,"");for(var e=a.length-1;e>=0;e--){var f=a.charAt(e);c=parseInt(f,10),d&&(c*=2)>9&&(c-=9),b+=c,d=!d}return b%10===0}function l(a,b){return a>=b}function m(a,b){return b>=a}function n(a,b){return a>=b[0]&&a<=b[1]}function o(c,d){var e=b.isArr(c)?c.length:a.trim(""+c).length;return e>=d}function p(c,d){var e=b.isArr(c)?c.length:a.trim(""+c).length;return d>=e}function q(c,d){var e=b.isArr(c)?c.length:a.trim(""+c).length;return e>=d[0]&&e<=d[1]}function r(a,b){return a===b}var s={messages:{required:"{name}不能为空",email:"请输入正确的邮件地址",url:"请输入正确的链接地址",date:"请输入正确的日期",dateISO:"请输入正确格式的日期",number:"{name}须是数字",digits:"{name}须是整数",creditcard:"请输入正确的信用卡号码",equalTo:"请输入相同的{name}",min:"{name}不能小于{0}",max:"{name}不能大于{0}",range:"{name}要在{0}到{1}之间",maxlength:"{name}长度不能超过{0}",minlength:"{name}长度不能少于{0}",rangelength:"{name}长度要在{0}到{1}之间"},valid:c,required:d,email:e,url:f,date:g,dateISO:h,number:i,digits:j,creditcard:k,min:l,max:m,range:n,minlength:o,maxlength:p,rangelength:q,equalTo:r};return s}),handy.add("LocalStorage",["B.Browser","B.Events","B.Json"],function(a,b,c){function d(){if(!k&&a.ie()){var b="LocalStorageUserDataDiv";i=document.getElementById(b),i||(i=document.createElement("DIV"),i.style.display="none",i.id=b,i.addBehavior("#default#userData"),document.body.appendChild(i),i.load(m))}}function e(a){var b;return b=k?l.getItem(a):i.getAttribute(a),b=c.parseJson(b)}function f(a,b){b=c.stringify(b);try{k?l.setItem(a,b):(i.setAttribute(a,b),i.save(m))}catch(d){return $D.error(d),!1}return!0}function g(a){k?l.removeItem(a):(i.removeAttribute(a),i.save(m))}function h(){k?l.clear():i.unload()}var i,j={_init:d,getItem:e,setItem:f,removeItem:g,clear:h},k=window.localStorage&&window.localStorage.getItem,l=window.localStorage,m=document.domain;return j._init(),j}),function(a){$H=a.noConflict(),H=$H,Hui=$H,$D=$H.Debug,$HD=$H.Date,$Define=$H.Loader.define,$Require=$H.Loader.require,$G={config:{}};var b=window.$;b.fn.remove=$H.intercept(b.fn.remove,function(){var a=this.target;$H.trigger("removeEl",a)})}(handy),$Define("CM.AbstractEvents",function(){function a(){var a=this;a._eventCache={},a._listenTo=[]}function b(a,b,c){var d=this,e=$H.toArray(arguments,3);return d._parseEvents(c,function(c){c.unshift(b),d[a].apply(d,c.concat(e))})}function c(a,b,c,d,e){var f=this;if(!f._parseListenToEvents("listenTo",a,b,c,d,e)){"number"==typeof d&&(e=d,d=null),d=d||f;var g=f._delegateHandler(c,d);f._listenTo.push({target:a,name:b,delegation:g,handler:c}),a.on(b,g,d,e)}}function d(a,b,c){var d=this;if(!d._parseListenToEvents("unlistenTo",a,b,c)){var e=d._listenTo,f="all"==a;$H.each(e,function(d,g){(f||g.name==b&&g.handler==c&&g.target==a)&&(g.target.off(g.name,g.delegation),e.splice(d,1))})}}var e=$H.createClass();return $H.extend(e.prototype,$H.Events),$H.extend(e.prototype,{initialize:a,_parseListenToEvents:b,listenTo:c,unlistenTo:d}),e}),$Define("CM.DataStore",function(){function a(a,b){var c;if(a=$H.isClass(a)?a.$ns:$H.isInstance(a)?a.constructor.$ns:$H.alias(a),c=e[a]){if(b){if($H.isObj(b)){var d=[];return $H.each(c,function(a,c){$H.largeThan(c,b)&&d.push(c)}),d}return c[b]}return c}}function b(){}function c(a,b){"string"!=typeof a&&(b=a,a=null);var c=b.constructor.$ns,d=e[c]||(e[c]={});d[b.id]=b,a&&(e[a]||(e[a]=b))}var d=$H.createClass();$H.extend(d.prototype,{get:a,find:b,push:c});var e={};return $S=$H.getSingleton(d),d}),$Define("CM.AbstractDao","B.LocalStorage",function(a){function b(a){var b=this;a=b.parseParam(a);var c=$H.intercept(a.error,b.error);a.error=$H.intercept(c,a.beforeErr);var d=$H.intercept(a.success,b.success);return a.success=$H.intercept(d,a.beforeSucc),a.beforeSend=$H.intercept($H.bind(b.beforeSend,b),a.beforeSend),a.complete=$H.intercept($H.bind(b.complete,b),a.complete),$.ajax(a)}function c(){this.showLoading(!0)}function d(){this.showLoading(!1)}function e(){}function f(){}function g(){}function h(b,c,d){var e=this;d=d||{};var f=d.storeType||"remote",g={type:"POST",dataType:"json"};d.url||(g.url=c.getUrl()),null!=d.data||!c||"create"!==b&&"update"!==b&&"patch"!==b||(g.data=d.attrs||c.toJSON(d)),"remote"==f?(g.url+="/"+b+".do",$H.extend(g,d),e.ajax(g)):a[e._localMethodMap[b]](g),c.trigger("request",c,d)}var i=$H.createClass();return $H.extend(i.prototype,{_ajaxMethodMap:{create:"POST",update:"POST",patch:"PATCH","delete":"DELETE",read:"GET"},_localMethodMap:{create:"setItem",update:"setItem",patch:"setItem","delete":"removeItem",read:"getItem"},ajax:b,parseParam:$H.noop,beforeSend:c,complete:d,error:$H.noop,success:$H.noop,showLoading:$H.noop,get:e,set:f,remove:g,sync:h}),i}),$Define("CM.Model",["CM.AbstractDao","CM.AbstractEvents","CM.DataStore"],function(a,b){function c(a,b,c){if(a){var d,e,f=this,g=f.prototype.idAttribute,h=!1;if((e=a[g])&&(d=$S.get(f,e)),d)h=d.set(a).changed;else{var i,d=new f(a,b);(i=$S.get(d,d.id))?(h=i.set(a).changed,d=i):(h=!0,$S.push(d))}return c&&(c.changed=h),d}}function d(a,b){var c=this;if(!b.validate||!c.validate)return!0;a=$H.extend({},c._attributes,a);var d=c.validationError=c.validate(a,b)||null;return d?(c.trigger("invalid",c,d,$H.extend(b,{validationError:d})),!1):!0}function e(a,b){var c,d,e,f=this,g=f.fields,h={};for(var i in g){var c=g[i];if(c&&(d=c.depends))for(var j=0;j<d.length;j++)if(a.hasOwnProperty(d[j])){h[i]=void 0,e=!0;break}}e&&f.set(h,null,{silent:b})}function f(a){var b,c=this;if(!(b=c.fields))return a;var d,e,f,g,h,i={};for(var j in a){if(f=a[j],(d=b[j])&&(g=d.type,h=d.options,(e=d.parse)&&(f=e.apply(c,[f,a])),$H.isStr(g)&&("Date"==g?f=$H.parseDate(f):g.indexOf(".")>0&&(g=$H.ns(g))),$H.isClass(g)&&!(f instanceof g)))if(g.get){var k={};f=g.get(f,h,k),f&&(f._changedTmp=k.changed)}else{var l=c.get(j);if(l){var m=l.set(f);f=l,f._changedTmp=m.changed}else f=new g(f,h),f._changedTmp=!0}i[j]=f}return i}function g(a,b,c,d){if("invalid"!=b&&"sync"!=b&&"request"!=b&&0!=b.indexOf("change:")&&("add"!=b||$H.isInstance(d))){var e=this,f=e.get(a),g=$H.toArray(arguments,1);e.trigger.apply(e,["change:"+a,e,f].concat(g)),e.trigger.apply(e,["change",e].concat(g)),e._attrEvts[a]=1;var h={};h[a]=f,e._doDepends(h)}}function h(b,c){var d=this;d.callSuper(),d.uuid=$H.uuid(),d.dao=d.dao||$H.getSingleton(a);var e=b||{};c||(c={}),d.cid=$H.Util.uuid(),d._attributes={},d._attrEvts={},c.collection&&(d.collection=c.collection),c.parse&&(e=d.parse(e,c)||{}),e=$H.extendIf(e,d.getDefaults()),d.init&&d.init(),d.set(e,c),d._changed={}}function i(){var a,b=this,c={};if(a=b.fields)for(var d in a){var e=a[d];c[d]=e&&$H.isObj(e)?e.def:e}return c}function j(){return $H.clone(this._attributes)}function k(a,b,c){var d=this;return d.lastSyncTime=$H.now(),d.dao.sync(a,b,c)}function l(a){return this._attributes[a]}function m(a){return $H.String.escapeHTML(this.get(a))}function n(a){var b=this.get(a);return null!==b&&void 0!==b}function o(a,b,c){var d,e=this,f={result:e};if("object"==typeof a?(d=a,c=b):(d={})[a]=b,c||(c={}),d instanceof D&&(d=d._attributes),d=e._parseFields(d),!e._validate(d,c))return f.invalid=!0,f;var g=c.unset,h=c.silent,i={},j=e._changing;e._changing=!0,j||(e._previousAttributes=$H.Object.clone(e._attributes),e._changed={});var k=e._attributes,l=e._previousAttributes;e.idAttribute in d&&(e.id=d[e.idAttribute]);for(var m in d){b=d[m];var n=k[m],o=n&&$H.isInstance(n),p=b&&$H.isInstance(b);o||p?(g?(delete k[m],n&&e.unlistenTo(n,"all")):(k[m]=b,n&&n.id==b.id||(b._changedTmp=!0,n&&e.unlistenTo(n,"all"),e.listenTo(b,"all",$H.bind(e._onAttrEvent,e,m)))),(g||b._changedTmp)&&(i[m]=b),delete b._changedTmp):($H.equals(k[m],b)||(i[m]=b),$H.equals(l[m],b)?delete e._changed[m]:e._changed[m]=b,g?delete k[m]:k[m]=b)}var q=!$H.isEmpty(i);if(!h){q&&(e._pending=c);for(var r in i)e._attrEvts[r]||e.trigger("change:"+r,e,k[r],c)}if(!h)for(;e._pending;)c=e._pending,e._pending=!1,e.trigger("change",e,c);return e._pending=!1,e._changing=!1,q&&e._doDepends(i,h),f.changed=q,e._attrEvts={},f}function p(a,b){return b=b||{},b.unset=!0,this.set(a,void 0,b)}function q(a){var b=this,c={};for(var d in b._attributes)c[d]=void 0;return a=a||{},a.unset=!0,b.set(c,a)}function r(a){var b=this._attributes;$H.each(b,a)}function s(a){var b=this._changed;return null==a?!$H.isEmpty(b):$H.contains(b,a)}function t(a){var b=this;if(!a)return b.hasChanged()?$H.clone(b._changed):!1;var c,d=!1,e=b._changing?b._previousAttributes:b._attributes;for(var f in a)$H.equals(e[f],c=a[f])||((d||(d={}))[f]=c);return d}function u(a){var b=this;return null!=a&&b._previousAttributes?b._previousAttributes[a]:null}function v(a){var b=this;b.set("fetching",!0),a=a?$H.clone(a):{},void 0===a.parse&&(a.parse=!0);var c=a.success,d=a.beforeSet;a.success=function(e){b.set("fetching",!1);var f=b.parse(e,a);if(!d||0!=d(b,f,a)){var g=b.set(f,a);if(g.invalid)return!1;c&&c(b,f,a),b.trigger("sync",b,f,a)}},b.sync("read",b,a)}function w(a,b,c){var d,e,f=this;if(null==a||"object"==typeof a?(d=a,c=b):(d={})[a]=b,$H.isFunc(c)&&(c={success:c}),c=$H.extend({validate:!0},c),d&&c.now){if(f.set(d,c).invalid)return!1}else if(!f._validate(d,c))return!1;void 0===c.parse&&(c.parse=!0);var g=c.success;c.success=function(a){var b=f.parse(a,c);return c.now||(b=$H.extend(d||{},b)),$H.isObj(b)&&f.set(b,c).invalid?!1:(g&&g(f,a,c),void f.trigger("sync",f,a,c))},e=f.isNew()?"create":c.update?"update":"patch";var h;if("patch"===e){var i=f.changedAttrbutes(d);if(!i)return void(g&&g(f,c));h=i}else{var j=$H.extend({},f._attributes);h=$H.extend(j,d)}for(var k in h)$H.isInstance(h[k])&&delete h[k];c.attrs=h,f.sync(e,f,c)}function x(a){var b=this;a=a?$H.clone(a):{};var c=a.success,d=function(){b.trigger("destroy",b,b.collection,a),b.off("all")};return a.success=function(e){(!a.now||b.isNew())&&d(),c&&c(b,e,a),b.isNew()||b.trigger("sync",b,e,a)},b.isNew()?(a.success(),!1):(b.sync("delete",b,a),void(a.now&&d()))}function y(){var a=this,b=$H.result(a,"url")||$H.result(a.collection,"url");return b||$D.error(new Error("必须设置一个url属性或者函数")),a.isNew()?b:b.replace(/([^\/])$/,"$1/")+encodeURIComponent(a.id)}function z(a){return a.code?a.data:a}function A(){var a=this;return new a.constructor(a._attributes)}function B(){var a=this;return void 0===a.id}function C(a){return this._validate({},$H.extend(a||{},{validate:!0}))}var D=b.derive({idAttribute:"id",$isModel:!0,_pending:!1,_validate:d,_doDepends:e,_parseFields:f,_onAttrEvent:g,initialize:h,getDefaults:i,toJSON:j,sync:k,get:l,escape:m,has:n,set:o,unset:p,clear:q,each:r,hasChanged:s,changedAttrbutes:t,previous:u,fetch:v,save:w,destroy:x,getUrl:y,parse:z,clone:A,isNew:B,isValid:C},{get:c});return D}),$Define("CM.Collection",["CM.AbstractDao","CM.AbstractEvents","CM.Model","CM.DataStore"],function(a,b,c){function d(a){return $H.isFunc(a)?a:function(b){return b.get(a)}}function e(){var a=this;a.length=0,a._models=[],a._byId={}}function f(a,b){var d=this;if(a instanceof c)return a;b=b?$H.clone(b):{},b.collection=d;var e=d.model.get(a,b);return e.validationError?(d.trigger("invalid",d,e.validationError,b),!1):e}function g(a){var b=this;b._byId[a.cid]=a,null!=a.id&&(b._byId[a.id]=a),a.collection||(a.collection=b),a.on("all",b._onModelEvent,b)}function h(a){var b=this;b===a.collection&&delete a.collection,a.off("all",b._onModelEvent,b)}function i(a,b,c,d){var e=this;("add"!==a&&"remove"!==a||c===e)&&("destroy"===a&&e.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete e._byId[b.previous(b.idAttribute)],null!=b.id&&(e._byId[b.id]=b)),e.trigger.apply(e,arguments))}function j(b,c){var d=this;d.callSuper(),d.dao=d.dao||$H.getSingleton(a),c||(c={}),c.model&&(d.model=c.model),c.url&&(d.url=c.url),void 0!==c.comparator&&(d.comparator=c.comparator),void 0!==c.desc&&(d.desc=c.desc),d._reset(),b&&d.reset(b,$H.extend({silent:!0},c));var e=d.comparator;$H.isStr(e)&&d.on("change:"+e,function(a,b){d.sortItem(b)})}function k(a){var b=this;return $H.map(b._models,function(b){return b.toJSON(a)})}function l(a,b,c){var d=this;return d.lastSyncTime=$H.now(),d.dao.sync(a,b,c)}function m(a,b){return b=$H.extend({add:!0,remove:!1,merge:!1},b),this.set(a,b).result}function n(a,b){var c=this,d=!$H.isArr(a);a=d?[a]:$H.clone(a),b||(b={});var e,f,g,h;for(e=0,f=a.length;f>e;e++)h=a[e]=c.get(a[e]),h&&(delete c._byId[h.id],delete c._byId[h.cid],g=c.indexOf(h),c._models.splice(g,1),c.length--,b.silent||(b.index=g,h.trigger("remove",h,c,b)),c._removeReference(h,b));return d?a[0]:a}function o(a,b){var d=this;if(!a)return{result:d};b=$H.extend({add:!0,remove:!1,merge:!0},b),a instanceof K&&(a=a._models),b.parse&&(a=d.parse(a,b));var e,f,g,h,i,j,k=!$H.isArr(a),l=k?a?[a]:[]:$H.clone(a),m=d._models,n=b.at,o=d.model,p=d.comparator&&null==n&&b.sort!==!1,q=b.add,r=b.merge,s=b.remove,t=!1;for(e=0,f=l.length;f>e;e++)if(i=l[e]||{},g=i instanceof c?h=i:i[o.prototype.idAttribute||"id"],j=d.get(g)){if(s&&(d.remove(j,b),t=!0),r){i=i===h?h.attributes:i,b.parse&&(i=j.parse(i,b));var u=j.set(i,b).changed;t=t||u}l[e]=j}else if(q){if(b.id=g,h=l[e]=d._prepareModel(i,b),!h)continue;d._addReference(h,b),p&&(n=d.sortedIndex(h)),null!=n?m.splice(n,0,h):m.push(h),d.length+=1,b.silent||h.trigger("add",h,d,b,n),t=!0}return{changed:t,result:d}}function p(a){$H.each(this._models,a)}function q(a){for(var b=this._models,c=b.length-1;c>=0;c--)a(c,b[c])}function r(a,b){var c=this;b||(b={});for(var d=0,e=c._models.length;e>d;d++)c._removeReference(c._models[d],b);return b.previousModels=c._models,c._reset(),a&&(a=c.add(a,$H.extend({silent:!0},b)).result),b.silent||c.trigger("reset",c,b),a}function s(a,b){var c=this;return c.add(a,$H.extend({at:c.length},b)).result}function t(a){var b=this,c=b.at(b.length-1);return b.remove(c,a),c}function u(a,b){return this.add(a,$H.extend({at:0},b)).result}function v(a){var b=this,c=b.at(0);return b.remove(c,a),c}function w(){return Array.prototype.slice.apply(this._models,arguments)}function x(a){var b=this;return null==a?void 0:b._byId[a]||b._byId[a.id]||b._byId[a.cid]}function y(){return this.length}function z(a){return this._models[a]}function A(a,b){var c=this;return $H.isEmpty(a)?b?void 0:[]:c[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})}function B(a){return this.where(a,!0)}function C(a){var b=this;return b.comparator||$D.error(new Error("没有比较器")),a||(a={}),"string"==typeof b.comparator||1===b.comparator.length?b._models=b.sortBy(b.comparator,b,a.desc):b._models.sort($H.Function.bind(b.comparator,b)),a.silent||b.trigger("sort",b,a),b}function D(a,b){var c=this;void 0===b&&(b=c.sortedIndex(a));var d=c.indexOf(a),e=c._models;e.splice(d,1),e.splice(b,0,a),c.trigger("sortItem",a,b,d,c)}function E(a){return $H.invoke(this._models,"get",a)}function F(){return this.url}function G(a){var b=this;b.fetching=!0,a=a?$H.clone(a):{};var c=a.success,d=a.beforeSet;return a.success=function(e){b.fetching=!1;var f=b.parse(e,a);if(!d||0!=d(b,f,a)){var g=a.reset?"reset":a.add?"add":"set";b[g](f,a),c&&c(b,f,a),b.trigger("sync",b,f,a)}},b.sync("read",b,a)}function H(a,b){var c=this;if(b=b?$H.clone(b):{},!(a=c._prepareModel(a,b)))return!1;b.now&&c.add(a,b);var d=b.success;return b.success=function(a,e){b.now||c.add(a,b),d&&d(a,e,b)},a.save(null,b),a}function I(a){return a.code?a.data:a}function J(){var a=this;return new a.constructor(a._models)}var K=b.derive({model:c,$isCollection:!0,_getIterator:d,_reset:e,_prepareModel:f,_addReference:g,_removeReference:h,_onModelEvent:i,initialize:j,toJSON:k,sync:l,add:m,remove:n,set:o,each:p,eachDesc:q,reset:r,push:s,pop:t,unshift:u,shift:v,slice:w,get:x,size:y,at:z,where:A,findWhere:B,sort:C,sortItem:D,pluck:E,getUrl:F,fetch:G,create:H,parse:I,clone:J}),L=$H.Array;return $H.each(["map","some","every","find","filter","invoke","indexOf"],function(a,b){K.prototype[b]=function(){var a=Array.prototype.slice.call(arguments);return a.unshift(this._models),L[b].apply(L,a)}}),K.prototype.sortedIndex=function(a,b,c){var d=this._getIterator(this.comparator);return c=this.desc||c,L.sortedIndex(this._models,a,d,b,c)},$H.each(["sortBy","groupBy","countBy"],function(a,b){K.prototype[b]=function(a,c,d){var e=this._getIterator(a);return d=this.desc||d,L[b](this._models,e,c,d)}}),K}),$Define("CM.AbstractManager",function(){function a(){var a=this;a._types={},a._all={}}function b(a,b){var c=this;c._types[a]=b,b.prototype.xtype=a}function c(a){return $H.isClass(a)?a:this._types[a]||$H.ns(a)}function d(a,b){var c=this,d=a.cid=b.cid||$H.uuid(),e=a._id=c.generateId(d,a.xtype);c._all[e]=a,c._all[d]=a}function e(a){var b=this._all,c=a.getId(),d=a.getCid();b[c]==a&&delete b[c],b[d]==a&&delete b[d]}function f(a,b){var c=this,d=a.find(".js-"+c.type);d.each(function(a,d){d=$(d);var e=d.attr("id"),f=c.get(e);f&&b(f)})}function g(a,b){var c=this,d=$H.expando+"-"+c.type+"-"+b+"-"+(a||$H.uuid());return c._all[d]?void $D.error("id重复:"+d):d}function h(a){var b=this,c=b._all;return c[a]}var i=$H.createClass();return $H.extend(i.prototype,{initialize:a,type:"manager",registerType:b,getClass:c,register:d,unregister:e,eachInEl:f,generateId:g,get:h}),i}),$Define("CM.ViewManager","CM.AbstractManager",function(a){function b(){var a=this;a.callSuper(),$H.on("afterRender",function(b,c){a.afterRender(c)}),$H.on("removeEl",function(b,c){a.destroy(c)})}function c(a){this.eachInEl(a,function(a){a.afterRender()})}function d(a){this.eachInEl(a,function(a){a.destroy(!0)})}var e=$H.createClass();return $H.inherit(e,a,{type:"view",initialize:b,afterRender:c,destroy:d}),$V=$H.getSingleton(e),e}),$Define("CM.AbstractView",["CM.ViewManager","CM.AbstractEvents"],function(a,b){function c(a,b){var c=this,d=b.name;return c._parseEvents(d,function(d){var e=$H.extend({},b);e.name=d[0],2==d.length&&(e.handler=d[1]),c[a].call(c,e)})}function d(b){var c=this;b=b||{},c.callSuper(),c._listeners=[],c.listeners=$H.clone(c.listeners),c.manager=c.constructor.manager||$H.getSingleton(a),c.manager.register(c,b),c.doConfig(b),c.init(b),c.parseItems(),0!=c.autoRender&&c.render(),c.inited=!0}function e(a){var b=this;b.initParam=a;var c=a||{};$H.extend(b,c);var d;b.renderTo=$((d=c.renderTo)?d:document.body)}function f(){return this._id}function g(){return this.cid}function h(){return this._container}function i(){return this.html}function j(){var a=this,b=a.getHtml();a.renderTo[a.renderBy](b),a._container=$("#"+a.getId()),a.initListeners()}function k(a){return this.getEl().find(a)}function l(a){var b=this;if(!b._parseListenEvents("listen",a)){var c=a.name,d=a.context,e=a.times,f=a.target,g=a.custom||f||$H.contains(b._customEvents,c),h=a.handler;if($H.isFunc(f)&&(f=f.call(b)),g){var i=$H.removeUndefined([f,c,h,d,e]);b[f?"listenTo":"on"].apply(b,i)}else{if(!b.listened)return void b.listeners.push(a);var j=b._listeners,k=a.el,l=a.method||"bind",m=a.selector,n=a.data,o=a.delegation=b._delegateHandler(h,d);$H.isFunc(k)&&(k=k.call(b)),k=k?"string"==typeof k?b.findEl(k):k:b.getEl(),m?n?k[l](m,c,n,o):k[l](m,c,o):n?k[l](c,n,o):k[l](c,o),j.push(a)}}}function m(a){var b=this;if(!b._parseListenEvents("unlisten",a)){var c=a.name,d=a.handler;if(a.custom)b.off(c,d);else{var e,f=a.el,g="delegate"==a.method?"undelegate":"unbind",h=a.selector;f=f?"string"==typeof f?b.findEl(f):f:b.getEl();for(var i=b._listeners.length-1;i>=0;i--){var j=b._listeners[i];if(j.handler==d){e=j.delegation,b._listeners.splice(i,1);break}}h?f[g](h,c,e):f[g](c,e)}}}function n(){var a=this;if(a.listened)return!1;a.listened=!0;for(var b=a.listeners,c=b.length-1;c>=0;c--)a.listen(b[c]);a.callChild()}function o(){for(var a=this,b=a._listeners,c=b.length-1;c>=0;c--)a.unlisten(b[c]);a.off("all"),a.unlistenTo("all"),a.callChild()}function p(){var a=this;if(!a.destroyed)return a.clearListeners(),a.unlistenTo("all"),a.getEl().remove(),a.destroyed=!0,a.manager.unregister(a),delete a._container,delete a.renderTo,delete a.html,!0}var q=b.derive({xtype:"View",renderBy:"append",autoRender:!0,listeners:[],_parseListenEvents:c,initialize:d,init:$H.noop,doConfig:e,getId:f,getCid:g,getEl:h,getHtml:i,render:j,findEl:k,parseItems:$H.noop,callChild:$H.noop,listen:l,unlisten:m,initListeners:n,clearListeners:o,destroy:p});return q}),$Define("CM.ModelView",["B.Template","CM.AbstractView","CM.Model","CM.Collection"],function(a,b,c,d){function e(a,b){var c=b.context,d=b.data,e=b.exp;$H.isFunc(a)&&(a=a.call(d));var f;(a&&!b.inverse||!a&&b.inverse)&&(f=b.fn(d));var g=b.num,h=c.getCid()+"-"+g;return c.ifBind(g,d)&&c.listenTo(d,"change:"+e,function(a,d,e){var f;(e&&!b.inverse||!e&&b.inverse)&&(f=b.fn(d)),c.updateMetaMorph(h,f)}),c.wrapMetaMorph(h,f)}function f(a,b){return b.inverse=!0,b.helpers["if"].call(this,a,b)}function g(a,b){var c=b.context,e=b.fn,f=C?"":[],g=b.num,h=c.getCid()+"-"+g;if(a){var i;if(a instanceof d)a.each(function(a,b){i=c.wrapMetaMorph(h+"-"+b.uuid,e(b)),C?f+=i:f.push(i)}),c.ifBind(g,a)&&(c.listenTo(a,"add",function(a,b,d,f){var g=c.wrapMetaMorph(h+"-"+b.uuid,e(b)),i=f.at;if(i){var j=d.at(i-1),k=h+"-"+j.uuid;$("#metamorph-"+k+"-end").after(g)}else $("#metamorph-"+h+"-end").before(g)}),c.listenTo(a,"remove",function(a,b){var d=h+"-"+b.uuid;c.updateMetaMorph(d,"","remove")}));else if(void 0!==a.length)for(var j=0,k=a.length;k>j;j++)i=c.wrapMetaMorph(h+"-"+j,e(a[j])),C?f+=i:f.push(i);else for(var j in a)i=c.wrapMetaMorph(h+"-"+j,e(a[j])),C?f+=i:f.push(i);return c.wrapMetaMorph(h,C?f:f.join(""))}}function h(a,b){var c=b.get?b.get(a):b[a];return c}function i(b,c){var d=c.context,e=c.data,f=c.exp,g=a.isEscape,h=c.helpers,i=c.num,j=d.getCid()+"-"+i;return d.ifBind(i,e)&&d.listenTo(e,"change:"+f,function(a,b,c){g&&(c=h.escape(c)),d.updateMetaMorph(j,c)}),g&&(b=h.escape(b)),d.wrapMetaMorph(j,b)}function j(a,b){for(var c,d=b.context,e=b.data,f=b.num,g=b.type,h=d.getCid()+"-"+f,i="bindAttr-"+h,j=[],m=[],n=d.ifBind(f,e),o=g&&d.ifBind(f,e,!0);c=D.exec(a);)"id"==c[2]?i=0==c[3].indexOf("this.")?d[c[3].substring(5)]:k(c[3],e):m.push(c);j.push('id="'+i+'"');for(var p,q,r,s,t,u=0,v=m.length;v>u;u++){c=m[u],q=c[2],p=c[3],r=p.split(" "),s=[];for(var w=0;w<r.length;w++)t=l(d,i,q,r[w],n,o,e),(t||0===t)&&s.push(t);var x=s.join(" ");q?(g&&"value"==q&&(b.value=x),x=(c[1]||"")+x+c[4]):x&&(x=x+'="'+x+'"'),x&&j.push(x)}return" "+j.join(" ")+" "}function k(a,b){return a?0==a.indexOf("#")?a.substring(1):h(a,b):a}function l(a,b,c,d,e,f,g){var h,i=a,b="#"+b,j=d.indexOf("?"),l=d.indexOf(":");if(0==d.indexOf("this."))return i[d.substring(5)];if(j>0||l>0){var m=d.substring(0,j>0?j:l),n=0>j?"":d.substring(j+1,l>0?l:d.length),o=0>l?"":d.substring(l+1,d.length);return h=k(m,g),e&&0!=m.indexOf("#")&&i.listenTo(g,"change:"+m,function(a,d,e){var f=$(b);c?"class"==c?e?(o&&f.removeClass(o),n&&f.addClass(n)):(n&&f.removeClass(n),o&&f.addClass(o)):f.attr(c,e?n:o):e?f.prop(n,!0):f.prop(n,!1)}),h?n:o}return h=k(d,g),0!=d.indexOf("#")&&(e&&i.listenTo(g,"change:"+d,function(a,d,e){var f=$(b);"class"==c?(f.removeClass(h),f.addClass(e),h=e):f.attr(c,e||"")}),"value"==c&&f&&i.listen({name:"input propertychange",el:b,handler:function(a){g.set(d,a.target.value)}})),h}function m(a,b){b.type="input";var c=j(a,b);return"<input "+c+"/>"}function n(a,b){b.type="textarea";var c=j(a,b);return"<textarea "+c+">"+b.value+"</textarea>"}function o(){var a=this;a._bindModelNums={},a._bindElNums={},a.callSuper()}function p(){var a=this;a.callSuper();var b=a.modelClass||c;a.model||(a.model=new b(a.data)),a.xmodel=a.model}function q(){var a=this,b=a.tmpl;$H.isArr(b)&&(b=b.join(""));var c=F.test(b),d="#js-"+a.manager.type+" #js-"+a.xtype;if(c){var e=b.match(G)[1];e&&(I.test(b)||(e=e.replace(/([^\s]+)/g,"#$1")),d+=" "+e),b=b.replace(G,"")}var f=' id=this._id class="'+d+'"';b=H.test(b)?b.replace(J,"$1"+f):b.replace(E,"$1 {{bindAttr"+f+"}}"),a.tmpl=b}function r(){var a=this,b=a.tmpl,c=a.constructor;return $H.isFunc(b)||$H.isFunc(b=c.tmpl)||(a.preTmpl(),b=c.tmpl=$H.tmpl({tmpl:a.tmpl,ns:"ModelView"})),a.tmpl=b}function s(){var a=this;if(a.html)return a.html;var b=a.getTmplFn(),c=a.html=b(a.xmodel,a);return c}function t(a,b,e){var f=this;if(!e&&"el"==f.bindType||e&&"model"==f.bindType)return!1;var g=e?f._bindElNums:f._bindModelNums,h=!g[a]&&(b&&(b instanceof c||b instanceof d)||!b);return g[a]=1,h}function u(a,b){return $("#metamorph-"+a+(b?"-end":"-start"))}function v(a,b,c){var d=this;if("append"==c)return void d.getMetaMorph(a,!0).before(b);var e=d.getMetaMorph(a);if(0!=e.length){for(var f,g="metamorph-"+a+"-end",h=e[0].nextSibling;h&&h.id!=g;)f=$(h),h=h.nextSibling,f.remove();void 0!==b&&e.after(b),"remove"==c&&(e.remove(),$(h).remove())}}function w(a,b){var c='<script id="metamorph-',d='" type="text/x-placeholder"></script>';return b=void 0===b?"":b,c+a+"-start"+d+b+c+a+"-end"+d}function x(a){return this.xmodel.get(a)}function y(a,b){this.xmodel.set(a,b)}function z(a){this.xmodel.set(a)}function A(){return this.xmodel}var B=b.derive({bindType:"both",initialize:o,doConfig:p,preTmpl:q,getTmplFn:r,getHtml:s,ifBind:t,getMetaMorph:u,updateMetaMorph:v,wrapMetaMorph:w,get:x,set:y,update:z,getXmodel:A});a.registerHelper("ModelView",{"if":e,unless:f,each:g,getValue:h,parseValue:i,bindAttr:j,input:m,textarea:n});var C=a.getIfPlusJoin(),D=/((\w+)=['"]?)?([#\w][\s\w\.\?:#-]*)(['"]?)(?!\w*=)/g,E=/[^<]*(<[a-zA-Z]+)/,F=/^[^>]+class=/,G=/class=['"]?([#\w][\s\w\.\?:#-]*)(['"]?)(?!\w*=)/,H=/^[^>]+{{bindAttr/,I=/^[^>]+{{bindAttr((?!}}).)class=/,J=/({{bindAttr)/;return B}),$Define("CM.View",["CM.ViewManager","CM.ModelView","CM.Model","B.Template"],function(ViewManager,ModelView,Model,Template){function fPlaceItem(a,b){var c=b.context,d=b.num,e=c.getCid()+"-"+d,f=c.findHtml(a);return c.ifBind(d)&&c.on("add",function(b,d,f){if(d.match(a.replace(/^>\s?/,""))){if(void 0!==f){for(var g=c.getMetaMorph(e),h=0;f>h;h++)g=g.next();g.after(d.getHtml())}else c.updateMetaMorph(e,d.getHtml(),"append");d.afterRender()}}),c.wrapMetaMorph(e,f)}function fExtend(a){var b=this.prototype;$H.extend(b,a,{notCover:function(c){return"_customEvents"==c||"listeners"==c?(b[c]=(a[c]||[]).concat(b[c]||[]),!0):"xtype"==c||"constructor"==c?!0:"xConfig"==c||"fastUpdateMethod"==c?(b[c]=$H.extendIf(a[c],b[c]),!0):void 0}})}function fHtml(a){var b=new this($H.extend({autoRender:!1},a));return b.getHtml()}function _fApplyArray(a,b){var c=this,d=arguments,e=d.callee.caller,f=e.$owner.prototype;return 0==d.length?(d=e.arguments,d=$H.toArray(d),a=e.$name,b=d.shift()):d=$H.toArray(d,2),$H.isArr(b)?($H.each(b,function(b,e){f[a].apply(c,[e].concat(d))}),!0):!1}function fInitialize(){var a=this;a.items=[],a.children=[],a.callSuper()}function fDoConfig(a){var b=this;if(!b.configed){b.configed=!0,b.initParam=a,"string"==typeof a&&(a={text:a});var c=a||{};$H.extend(b,c,{notCover:function(a,d){var e;(e=/^{{(((?!}}).)+)}}$/.exec(d))&&(e=e[1],(b.refModelAttrs||(b.refModelAttrs={}))[a]=e);var f=(b[a],$H.contains(b._customEvents,a)),g=$H.contains(b._defaultEvents,a);return g?(b.listeners.push({name:a,handler:c[a]}),!0):f?(b.on(a,c[a]),!0):"defItem"==a?(b[a]=$H.extend(b[a],d),!0):"listener"==a?(b.listeners=b.listeners.concat($H.isArr(d)?d:[d]),!0):"items"==a?(b.add(d),!0):"extCls"==a&&b[a]?(b[a]+=" "+d,!0):"xtype"==a?("View"==b[a]&&(b[a]="string"==typeof d?d:d.$ns),!0):void 0
}});var d;if(d=c.renderTo){if($H.isFunc(d))d=d.call(b);else if($H.isStr(d)&&0==d.indexOf(">")){var e=b.parent;d=e.inited&&e.findEl(d.substring(1))}else d=$(d);b.renderTo=d}else b.renderTo=$(document.body);var f=b.getRefModel();if(f){var g=b.refModelAttrs;for(var h in g){var i,j=g[h];if(j.indexOf(".")>0){var k=j.split(".");i=f.get(k[0]),i=i&&i.get(k[1])}else i=f.get(j);b[h]=i}}var l=b.xConfig,m=b.modelClass;if(!m&&!(m=b.constructor.modelClass)){var n;n=l?Model.derive({fields:l}):Model,m=b.constructor.modelClass=n}var o={};$H.each(l,function(a){var c=b[a];void 0!==c&&(o[a]=c)}),b.xmodel=new m(o),b.bindRefModel()}}function fGetHtml(){var a,b=this,c=(b.getId(),b.extCls||"");"visibility"==b.displayMode?a="visibility:hidden;":c+=" hui-hidden";var d=b.callSuper();a&&(d=d.replace(_oTagReg,'$1 style="'+a+'"')),c&&(d=d.replace(/(class=['"])/,"$1"+c+" "));var e;return(e=b.wrapHtml)&&(d=e[0]+d+e[1]),b.html=d}function fFindHtml(a){for(var b=this,c=b.find(a),d=[],e=0;e<c.length;e++)d.push(c[e].getHtml());return d.join("")}function fInitStyle(){var a=this,b=this.getEl(),c=a.style||{};void 0!==a.width&&(c.width=a.width),void 0!==a.height&&(c.height=a.height),b.css(c)}function fBeforeRender(){return this.trigger("beforeRender")}function fRender(){var a=this;if(0==a.beforeRender())return!1;var b=a.getHtml();a.renderTo[a.renderBy](b),a.afterRender()}function fAfterRender(){var a=this;return a.rendered?!1:(a.trigger("render"),a.callChild(),a._container=$("#"+a.getId()),a.rendered=!0,a.initStyle(),1!=a.notListen&&a.initListeners(),a.disabled&&a.disable(),a.trigger("afterRender"),void(a.hidden||a.show()))}function fBeforeShow(){return this.trigger("beforeShow")}function fShow(a,b){var c=this;if(0==c.beforeShow()||c.showed||b&&c.hidden)return!1;if(!a&&c.delayShow)return void setTimeout(function(){View.prototype.show.call(c,!0)},0);c.trigger("show"),c.showed=!0,c.hidden=!1;var d=c.getEl();"visibility"==c.displayMode?d.css({visibility:"visible"}):d.removeClass("hui-hidden"),c.callChild([null,!0]),c.afterShow()}function fAfterShow(){var a=this;setTimeout(function(){a.trigger("afterShow")},0)}function fBeforeHide(){return this.trigger("beforeHide")}function fHide(a){var b=this;if(0==b.beforeHide()||!b.showed)return!1;b.showed=!1;var c=b.getEl();"visibility"==b.displayMode?c.css({visibility:"hidden"}):c.addClass("hui-hidden"),1!=a&&(b.hidden=!0),b.trigger("hide"),b.callChild([!0]),b.afterHide()}function fAfterHide(){this.trigger("afterHide")}function fEnable(){var a=this;a.resume(),a.getEl().removeClass("hui-disable").find("input,textarea,select").removeAttr("disabled")}function fDisable(){var a=this;a.suspend(),a.getEl().addClass("hui-disable").find("input,textarea,select").attr("disabled","disabled")}function fGetContent(a,b){var c=this;if(b?!b instanceof View&&(b=c.find(b)[0]):b=c,0==a){var d=b.children;return d}return b.getEl().html()}function fSetContent(a,b){var c=this;return b?(!b instanceof View&&(b=c.find(b)[0]),b.setContent(a)):"string"!=typeof a?(c.set("content",""),c.add(a)):(c.set("content",a),void c.remove())}function fSuspend(){var a=this;return a.isSuspend?!1:(a.isSuspend=!0,void a.callChild())}function fResume(){var a=this;return a.isSuspend?(a.isSuspend=!1,void a.callChild()):!1}function fParentsEl(a){return this.getEl().parents(a)}function fGet(a){var b,c=this,d=c.xConfig,e=c.xmodel;return b=e&&void 0!==d[a]?e.get(a):c[a]}function fSet(a,b){var c=this,d={};d[a]=b,c.fastUpdate(d)||(c[a]=b)}function fGetRefModel(){var a,b=this;if(a=b.refModel||b.model)return a;for(var c=b.parent;c;){if(a=c.refModel||c.model)return b.refModel=a;if(!c.parent)return c.model;c=c.parent}}function fBindRefModel(){function a(a,d){var g;if(d.indexOf(".")>0){var h=d.split(".");d=h[0],g=h[1]}("both"==c||"bindRef"==c)&&b.listenTo(e,"change:"+d,function(c,d,e){g&&(e=e&&e.get(g)),b.set(a,e)}),("both"==c||"bindXmodel"==c)&&b.listenTo(f,"change:"+a,function(a,b,c){if(g){var f=e;f=f.get(d),f&&f.set(g,c)}else e.set(d,c)})}var b=this,c=b.bindRefType,d=b.refModelAttrs;if(c&&d){var e=b.getRefModel(),f=b.xmodel;for(var g in d)a(g,d[g])}}function fEach(a,b){for(var c,d=this.children,e=d.length,f=0;e>f;){var g=d[f];if(c=b?a.apply(g,b):a(f,g),c===!1)break;e==d.length?f++:e=d.length}}function fMatch(sSel,oObj){if("*"==sSel)return!0;oObj=oObj||this;var m,prop,op,value,viewVal;sSel=sSel.replace(/^#([^\s,\[]+)/,"[cid=$1]"),sSel=sSel.replace(/^\.([^\s,\[]+)/,"[cClass=$1]"),sSel=sSel.replace(/^([^\[]+)/,"[xtype=$1]");for(var r=/\[([^=|\!]+)(=|\!=)([^=]*)\]/g;m=r.exec(sSel);)if(prop=m[1],op=m[2],value=m[3],("false"==value||"true"==value)&&(value=eval(value)),viewVal=oObj.get?oObj.get(prop):oObj[prop],"="===op?viewVal!=value:viewVal==value)return!1;return!0}function fFind(a,b){var c=this,b=b||[];if(a){if($H.isNum(a)){var d=c.children[a];b.push(d)}else if($H.isStr(a)){if(a.indexOf(",")>0)return $H.each(a.split(","),function(a,d){b=b.concat(c.find(d))}),b;var e,f,g=0==a.indexOf(">"),e=a.replace(/^>?\s?/,""),h=e.search(/\s/);h>0&&(f=e.substring(h+1),e=e.substring(0,h)),c.each(function(c,d){var h=d.match(e);h&&(f?d.find(f,b):b.push(d)),g||d.find(a,b)})}else if($H.isFunc(a)){var i=$H.isClass(a);c.each(function(c,d){(i&&d instanceof a||!i&&a(d))&&b.push(d),d.find(a,b)})}}else b=b.concat(c.children);return b}function fParents(a){for(var b=this,c=b;c.parent;)if(c=c.parent,a&&b.match(a,c))return c;return a||c===b?null:c}function fIndex(){var a=this,b=a.parent;if(b){var c;return b.each(function(b,d){return d==a?(c=b,!1):void 0}),c}return null}function fCallChild(a,b){var c=this;0!=c.children.length&&(a&&"string"!=typeof a&&(b=a,a=null),a=a||arguments.callee.caller.$name,c.each(function(c,d){b?d[a].apply(d,b):d[a].call(d)}))}function fAdd(a,b){var c=this;if(!c._applyArray()){var d=void 0===b;if(!c.startParseItems){var e=c.items;return void(d?e.push(a):e.splice(b,0,a))}if(a instanceof View)a.parent=c;else{c.defItem&&$H.extend(a,c.defItem,{notCover:!0}),c.parseItem(a);var f=c.manager.getClass(a.xtype);if(f){var g=a.renderTo;!c.inited&&$H.isStr(g)&&0==g.indexOf(">")&&(g=null),g||(a.autoRender=!1),a.parent=c,a=new f(a)}else $D.error("xtype:"+a.xtype+"未找到")}var h=c.children;return d?h.push(a):h.splice(b,0,a),c.trigger("add",a,b),a}}function fRemove(a){var b=this;if(!b._applyArray()){var c,d=b.children,e=!1;if($H.isNum(a))c=a,a=d[c];else if($H.isStr(a)||$H.isFunc(a)){a=b.find(a);for(var f=0,g=a.length;g>f;f++){if(0==b.remove(a[f]))return!1;e=!0}}else if(a instanceof View){if(a.parent!=b)return a.parent.remove(a);for(var f=0,g=d.length;g>f;f++)if(d[f]==a){c=f;break}}return void 0!==c&&0!=a.destroy(!0)&&(d.splice(c,1),e=!0),b.trigger("remove",a),e}}function fParseItems(){var a=this;a.startParseItems=!0;var b=a.items;if(b){b=$H.isArr(b)?b:[b];for(var c=0,d=b.length;d>c;c++)a.add(b[c])}}function fBeforeUpdate(){return this.trigger("beforeUpdate")}function fFastUpdate(a){var b=this,c=b.xmodel;if(!c)return!1;var d=b.xConfig,e=b.fastUpdateMethod,f=!0,g={},h={},i={};return $H.each(a,function(a,b){d.hasOwnProperty(a)?g[a]=b:e[a]?h[a]=b:(i[a]=b,f=!1)}),f?(c.set(a),$H.each(h,function(a,c){e[a].call(b,c)}),!0):!1}function fUpdate(a,b){var c=this;if(!a||0==c.beforeUpdate())return!1;var d;if(c.fastUpdate(a)===!0)d=c;else{var e=c.parent,f=$("<span></span>").insertBefore(c.getEl());if(b||(void 0===a.autoRender&&(a.autoRender=!0),a=$H.extend(a,c.initParam,{notCover:!0})),a=$H.extend(a,{xtype:c.xtype,renderBy:"replaceWith",renderTo:f},{notCover:["xtype"]}),a.cid&&a.cid!=c.cid||(a._id=c._id),e){var g=c.index();if(0==e.remove(c))return f.remove(),!1;d=e.add(a,g)}else{if(0==c.destroy())return f.remove(),!1;d=new c.constructor(a)}}return c.trigger("update",d),c.afterUpdate(d),d}function fReplace(a){return this.update(a,!0)}function fAfterUpdate(a){this.trigger("afterUpdate",a)}function fBeforeDestroy(){return this.trigger("beforeDestroy")}function fDestroy(a){var b=this;if(0==b.beforeDestroy())return!1;if(!b.destroyed)return b.callChild(),b.trigger("destroy"),b.clearListeners(),b.getEl().remove(),b.destroyed=!0,!a&&b.parent&&b.parent.remove(b),b.manager.unregister(b),delete b.initParam,delete b._container,delete b.renderTo,delete b._listeners,delete b.html,delete b.xmodel,delete b.children,b.afterDestroy(),!0}function fAfterDestroy(){this.trigger("afterDestroy")}var _oTagReg=/^(<[a-zA-Z]+)/,_oHasClsReg=/^[^>]+class=/,_oClsReg=/(class=")/,View=ModelView.derive({xtype:"View",xConfig:{},tmpl:"<div>{{placeItem}}</div>",bindRefType:"bindRef",fastUpdateMethod:{renderTo:function(a){this.getEl()[this.renderBy]($(a))},hidden:function(a){a?this.hide():this.show()},disabled:function(a){a?this.disable():this.enable()}},_customEvents:["beforeRender","render","afterRender","beforeShow","show","afterShow","beforeHide","hide","afterHide","beforeUpdate","update","afterUpdate","beforeDestroy","destroy","afterDestroy","add","remove"],_defaultEvents:["mousedown","mouseup","mouseover","mousemove","mouseenter","mouseleave","dragstart","drag","dragenter","dragleave","dragover","drop","dragend","touchstart","touchmove","touchend","touchcancel","keydown","keyup","keypress","click","dblclick","focus","focusin","focusout","contextmenu","change","submit"],_applyArray:_fApplyArray,initialize:fInitialize,doConfig:fDoConfig,getHtml:fGetHtml,findHtml:fFindHtml,initStyle:fInitStyle,beforeRender:fBeforeRender,render:fRender,afterRender:fAfterRender,beforeShow:fBeforeShow,show:fShow,afterShow:fAfterShow,beforeHide:fBeforeHide,hide:fHide,afterHide:fAfterHide,enable:fEnable,disable:fDisable,getContent:fGetContent,setContent:fSetContent,suspend:fSuspend,resume:fResume,parentsEl:fParentsEl,get:fGet,set:fSet,getRefModel:fGetRefModel,bindRefModel:fBindRefModel,each:fEach,match:fMatch,find:fFind,parents:fParents,index:fIndex,callChild:fCallChild,add:fAdd,remove:fRemove,parseItem:function(){},parseItems:fParseItems,beforeUpdate:fBeforeUpdate,fastUpdate:fFastUpdate,update:fUpdate,replace:fReplace,afterUpdate:fAfterUpdate,beforeDestroy:fBeforeDestroy,destroy:fDestroy,afterDestroy:fAfterDestroy},{extend:fExtend,html:fHtml});Template.registerHelper("ModelView",{placeItem:fPlaceItem});var _oTagReg=/[^<]*(<[a-zA-Z]+)/;return View}),$Define("C.ComponentManager",["CM.AbstractManager","CM.ViewManager"],function(a,b){function c(){var a=this,c=$H.getSingleton(b);a._types=c._types,a._all=c._all}var d=a.derive({type:"component",initialize:c});return $CM=new d,d}),$Define("C.AbstractComponent",["CM.ViewManager","CM.View"],function(a,b){function c(b,c){var d=$H.createClass(),e=c||k;return $H.inherit(d,e,null,null,{notCover:function(a){return"define"==a}}),$H.getSingleton(a).registerType(b,d),$C[b]=d,d}function d(a,b){var c=this;if(!b)return!1;if($H.isArr(b)){for(var d=0,e=b.length;e>d;d++)if(c.match(a,b[d]))return!0}else if(c.match(a,b))return!0;return!1}function e(){var a=this;a.callSuper(),a.icon&&a.add({xtype:"Icon",name:a.icon}),a.isMini&&(a.defItem=$H.extend({isMini:!0},a.defItem))}function f(){var a=this;a.callSuper(),a.tmpl=a.tmpl.replace(/(class=['"])/,"$1#js-component cmpCls tTypeCls themeCls radiusCls isMini?hui-mini shadow?hui-shadow shadowSurround?hui-shadow-surround shadowOverlay?hui-shadow-overlay shadowInset?hui-shadow-inset activeClass isFocus?hui-focus isInline?hui-inline ")}function g(){this.update({isActive:!0})}function h(){this.update({isActive:!1})}function i(a){var b=this;return void 0!==a?b.set("text",a):b.get("text")}function j(){var a=this,b=a.validator;if(b){var c=a.val();b.error||(b.error=function(a){new $C.Tips({text:a,theme:"error"})});var d=$H.Validator.valid(c,b);return d}for(var e=a.children,f=0,g=e.length;g>f;f++){var d=e[f].valid();if(!d)return d}return!0}$C=$H.ns("C",{});var k=$H.createClass();return $H.inherit(k,b,{xtype:"AbstractComponent",xConfig:{extCls:"",tType:"",theme:"",cls:"",radius:null,shadow:!1,shadowInset:!1,shadowSurround:!1,shadowOverlay:!1,isMini:!1,isActive:!1,isFocus:!1,isInline:!1,activeCls:"hui-active",cmpCls:{depends:["cls"],parse:function(){return"hui-"+this.get("cls")}},tTypeCls:{depends:["tType"],parse:function(){var a=this.get("tType");return a?"hui-"+this.get("cls")+"-"+a:""}},themeCls:{depends:["theme"],parse:function(){var a=this.get("theme");return a?"hui-"+this.get("cls")+"-"+this.get("theme"):""}},activeClass:{depends:["isActive","activeCls"],parse:function(){return this.get("isActive")?this.get("activeCls"):""}},radiusCls:{depends:["radius"],parse:function(){var a=this.get("radius");return a?"hui-radius-"+a:""}}},hasConfig:d,doConfig:e,preTmpl:f,active:g,unactive:h,txt:i,valid:j},{define:c}),k}),$Define("C.Icon","C.AbstractComponent",function(a){function b(a){var b=this;$H.isStr(a)&&(a={name:a}),b.callSuper([a])}var c=a.define("Icon");return c.extend({xConfig:{cls:"icon",hasBg:!0,isAlt:!1,name:"",iconName:{depends:["name"],parse:function(){return"hui-icon-"+this.get("name")}}},tmpl:'<span {{bindAttr class="isAlt?hui-alt-icon iconName hasBg?hui-icon-bg"}}></span>',doConfig:b}),c}),$Define("C.Button","C.AbstractComponent",function(a){var b=a.define("Button");return b.extend({xConfig:{cls:"btn",text:"",theme:"gray",markType:"",iconPos:"",activeCls:"hui-btn-active",isBack:!1,radius:"little",shadow:!0,isInline:!0,hasText:{depends:["text"],parse:function(){var a=this.get("text");return a||0===a}},iconPosCls:{depends:["iconPos"],parse:function(){var a=this.get("iconPos");return a?"hui-btn-icon-"+a:""}},markCls:{depends:["markType"],parse:function(){var a=this.get("markType");return a?"hui-btn-mark-"+a:""}}},cls:"btn",defItem:{xtype:"Icon"},tmpl:['<a href="javascript:;" hidefocus="true" {{bindAttr class="hasText:hui-btn-icon-notxt isBack?hui-btn-back markCls iconPosCls"}}>','<span class="hui-btn-txt">{{text}}</span>',"{{placeItem}}",'<span class="hui-btn-mark"></span>',"</a>"].join("")}),b}),$Define("C.Desc",["C.AbstractComponent","CM.Model","CM.Collection"],function(a){var b=a.define("Desc");return b.extend({xConfig:{cls:"desc",icon:"",text:"",iconCls:{depends:["icon"],parse:function(){var a=this.get("icon");return a?"hui-icon-"+a:""}}},tmpl:['<div class="hui-content-desc">',"{{#if icon}}",'<span {{bindAttr class="#hui-icon #hui-mini #hui-alt-icon iconCls #hui-light"}}></span>',"{{/if}}","{{text}}","</div>"].join("")}),b}),$Define("C.Panel","C.AbstractComponent",function(a){var b=a.define("Panel");return b.extend({xConfig:{cls:"panel",content:"",isLoading:!1,loadingTxt:"正在加载中..."},tmpl:["<div>","{{#if isLoading}}",'<div class="hui-panel-loading">','<div class="hui-mask"></div>','<div class="hui-loading-container">','<div class="hui-tips hui-tips-big hui-tips-black hui-radius-little">','<span class="hui-icon hui-icon-loading"></span>','<span class="hui-tips-txt">{{loadingTxt}}</span>',"</div>","</div>","</div>","{{/if}}","{{#if content}}","{{content}}","{{else}}","{{placeItem}}","{{/if}}","</div>"].join("")}),b}),$Define("C.Popup","C.AbstractComponent",function(a){function b(){var a=this;a.callSuper(),a.clickHide&&a.listeners.push({name:"click",el:$(document),handler:function(){this.hide()}}),$H.android()&&(a.listeners.push({name:"show",custom:!0,handler:function(){var a=$H.Events.trigger("component.popup.show");1!=a&&$("input,textarea,select").attr("disabled","disabled")}}),a.listeners.push({name:"hide",custom:!0,handler:function(){var a=$H.Events.trigger("component.popup.hide");1!=a&&setTimeout(function(){$("input,textarea,select").removeAttr("disabled")},500)}}))}function c(){var a=this,b=a.getEl();if(b.css("z-index",1e3*l+1e3),!a.width&&a.parent){var c=a.width=a.parent.getEl().outerWidth();b.css("width",c)}var d=a.showPos;"string"==typeof d?a[d]():"function"==typeof d&&d.call(a),a.noMask||a.mask(),a.timeout&&setTimeout(function(){a.destroyed||a.hide()},a.timeout)}function d(){var a=this,b=a.callSuper();0!=b&&(a.noMask||a.unmask(),a.destroyWhenHide&&a.destroy())}function e(){var a=this,b=a.getEl();b.css({left:"80px",top:"8px",position:"fixed"})}function f(){var a=this,b=a.getEl(),c=a.width||b.outerWidth(),d=a.height||b.outerHeight(),e=document,f=((e.documentElement.offsetWidth||e.body.offsetWidth)-c)/2,g=((e.documentElement.clientHeight||e.body.clientHeight)-d)/2+(e.documentElement.scrollTop||e.body.scrollTop);g=10>g?window.screen.height/2-200:g,b.css({left:f+"px",top:g-(a.offsetTop||0)+"px"})}function g(a){var b=this,c=a||b.parent.getEl(),d=$H.position(c[0]);b.getEl().css(d)}function h(){var a=this;j?j.appendTo(a.renderTo):j=$('<div class="hui-mask" style="display:none;"></div>').appendTo(a.renderTo),j.css("z-index",1e3*l+998),0==l&&j.show(),l++}function i(){l--,0==l?j.hide():j.css("z-index",1e3*(l-1)+998)}var j,k=a.define("Popup"),l=0;return k.extend({delayShow:!0,clickHide:!0,showPos:"center",destroyWhenHide:!0,shadowOverlay:!0,tmpl:"<div>{{placeItem}}</div>",doConfig:b,afterShow:c,hide:d,top:e,center:f,followEl:g,mask:h,unmask:i}),k}),$Define("C.ControlGroup","C.AbstractComponent",function(a){function b(){var a=this;a.callSuper(),"h"==a.get("direction")&&a.listen({name:"afterRender add remove",custom:!0,handler:function(){a.layout()}})}function c(a){a.extCls=(a.extCls||"")+"js-item"}function d(){var a=this;if(a.rendered){var b=a.children.length,c=Math.floor(100/b),d=a.findEl("> .js-item"),e="hui-item-first",f="hui-item-last";d.each(function(a,d){var g=$(d);0==a?(g.removeClass(f),g.addClass(e)):a==b-1?(g.removeClass(e),g.addClass(f)):(g.removeClass(e),g.removeClass(f)),d.style.width=b-1>a?c+"%":100-c*(b-1)+"%"})}}function e(a){var b,c=this;if(!c.notSelect&&(b="number"==typeof a?c.children[a]:"string"==typeof a?c.find(a)[0]:a))if(c.multi||b.multi)c.selectItem(b,!b.get("selected"));else{var d=c.getSelected();d&&c.selectItem(d,!1),c.selectItem(b)}}function f(a){var b=this,c=[];return b.each(function(b,d){d.get(d.select?"selected":"isActive")&&c.push(a?b:d)}),c.length>0?b.multi?c:c[0]:null}function g(a,b){b=0!=b,b?a.select?a.select():a.active():a.select?a.select(b):a.unactive()}function h(a){var b=this;if(void 0===a){var c=[];return b.each(function(a,b){b.get("selected")&&c.push(b.value)}),c.join(",")}var c=(""+a).split(",");b.each(function(a,d){$H.contains(c,d.get("value"))?b.selectItem(d,!0):b.selectItem(d,!1)})}function i(a,b){var c=this;if(c.select(b),c.itemClick){var d=c.children[b];c.itemClick(d,b)}}var j=a.define("ControlGroup");return j.extend({xConfig:{cls:"ctrlgp",direction:"v",directionCls:{depends:["direction"],parse:function(){return"hui-ctrlgp-"+this.get("direction")}}},multi:!1,defItem:{xtype:"Button",radius:null,shadow:!1,isInline:!1},tmpl:'<div {{bindAttr class="directionCls"}}>{{placeItem}}</div>',listeners:[{name:"click",selector:".js-item",method:"delegate",handler:function(a){var b=this,c=$(a.currentTarget),d=b.find("> [_id="+c.attr("id")+"]");if(d.length>0){var e=d[0].index();b.onItemClick(a,e)}}}],doConfig:b,parseItem:c,layout:d,select:e,getSelected:f,selectItem:g,val:h,onItemClick:i}),j}),$Define("C.Radio","C.AbstractComponent",function(a){function b(a){this.update({selected:!(0==a)})}function c(a){var b=this;return void 0===a?b.get("value"):void b.set("value",a)}var d=a.define("Radio");return d.extend({xConfig:{cls:"radio",name:"",text:"",value:"",selected:!1},tmpl:['<div {{bindAttr class="#hui-btn #hui-btn-gray selected?hui-radio-on"}}>','<span class="hui-icon hui-icon-radio"></span>','<input type="radio" {{bindAttr selected?checked name="name" value="value"}}/>','<span class="hui-radio-txt">{{text}}</span>',"</div>"].join(""),select:b,val:c}),d}),$Define("C.Checkbox","C.AbstractComponent",function(a){function b(a){this.update({selected:!(0==a)})}function c(a){var b=this;return void 0===a?b.get("value"):void b.set("value",a)}var d=a.define("Checkbox");return d.extend({xConfig:{cls:"chkbox",name:"",text:"",value:"",selected:!1},multi:!0,tmpl:['<div {{bindAttr class="#hui-btn #hui-btn-gray selected?hui-chkbox-on"}}>','<span class="hui-icon hui-icon-chkbox"></span>','<input type="checkbox" {{bindAttr selected?checked name="name" value="value"}}/>','<span class="hui-chkbox-txt">{{text}}</span>',"</div>"].join(""),select:b,val:c}),d}),$Define("C.Select","C.AbstractComponent",function(a){function b(a){var b=this;b.callSuper();var c=$H.clone(a.options);b.defTxt=b.get("text");for(var d=!1,e=0,f=c.length;f>e;e++){var g=c[e],h=g.value;if(void 0!==h&&h==a.value){b.set("text",g.text),g.selected=!0,d=!0;break}}d||delete b.value,b.add({itemClick:function(a){var c=a.get("value");b.val(c)},width:b.optionWidth||b.width,items:c})}function c(){var a=this;a.children[0].show()}function d(a){var b=this;if(void 0===a)return b.get("value");if(b.get("value")!=a){var c=b.children[0],d=c.find("> [value="+a+"]");d.length>0&&(d=d[0],b.set("value",a),b.txt(d.get("text")),c.select(d),b.trigger("change",a,d))}}function e(){var a=this,b=a.children[0];b.selectItem(b.getSelected(),!1),a.set("value",""),a.set("text",a.defTxt)}var f=a.define("Select");return f.extend({xConfig:{cls:"select",name:"",text:"请选择...",value:"",radius:"little",iconPos:"right",iconPosCls:{depends:["iconPos"],parse:function(){var a=this.get("iconPos");return a?"hui-btn-icon-"+a:""}}},optionClick:function(){},defItem:{xtype:"Menu",hidden:!0,markType:"hook",showPos:"followEl",renderTo:"body"},_customEvents:["change"],tmpl:['<div {{bindAttr class="#hui-btn #hui-btn-gray iconPosCls"}}>','<span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span>','<input {{bindAttr value="value" name="name"}}/>','<span class="hui-btn-txt">{{text}}</span>',"</div>"].join(""),listeners:[{name:"click",handler:function(){this.showOptions()}}],doConfig:b,showOptions:c,val:d,clearValue:e}),f}),$Define("C.Input","C.AbstractComponent",function(a){function b(a){var b=this;"search"==a.type&&(b.icon="search"),b.callSuper(),a.isTextarea&&b.listeners.push({name:"input propertychange",el:".js-input",handler:function(){var a=b.getEl();a.height("auto");var c=b.findEl(".js-input"),d=c[0].scrollHeight;d>=50&&c.css("height",d)}}),b.withClear&&b.add({xtype:"Button",radius:"big",icon:"delete",click:function(){this.parent.findEl("input").val("").focus()}}),a.inputHeight&&b.on("afterRender",function(){b.findEl("input,textarea").css("height",a.inputHeight)})}function c(a){var b=this;"Icon"==a.xtype?b.get("iconPos")||b.set("iconPos","left"):"Button"==a.xtype&&(b.get("btnPos")||b.set("btnPos","right"))}function d(a){var b=this.findEl("input,textarea");return void 0===a?b.val():void b.val(a)}function e(){this.findEl("input").focus()}var f=a.define("Input");return f.extend({xConfig:{cls:"input",isTextarea:!1,name:"",value:"",placeholder:"",radius:"little",iconPos:"",btnPos:"",iconPosCls:{depends:["iconPos"],parse:function(){var a=this.get("iconPos");return a?"hui-input-icon-"+a:""}},btnPosCls:{depends:["btnPos"],parse:function(){var a=this.get("btnPos");return a?"hui-input-btn-"+a:""}}},fastUpdateMethod:{inputHeight:function(a){this.findEl("input,textarea").css("height",a)}},type:"",withClear:!1,tmpl:['<div {{bindAttr class="iconPosCls btnPosCls"}}>',"{{placeItem}}","{{#if isTextarea}}",'{{textarea class="#js-input" name="name" placeholder="placeholder" value=value}}',"{{else}}",'{{input type="#text" class="#js-input #hui-input-txt" name="name" placeholder="placeholder" value="value"}}',"{{/if}}","</div>"].join(""),listeners:[{name:"focus",el:".js-input",handler:function(){this.getEl().addClass("hui-focus")}},{name:"blur",el:".js-input",handler:function(){this.getEl().removeClass("hui-focus")}}],doConfig:b,parseItem:c,val:d,focus:e}),f}),$Define("C.Label","C.AbstractComponent",function(a){var b=a.define("Label");return b.extend({xConfig:{cls:"label",text:"",color:"",textAlign:"",forName:"",colorCls:{depends:["color"],parse:function(){var a=this.get("color");return a?"hui-label-"+a:""}},textAlignCls:{depends:["textAlign"],parse:function(){var a=this.get("textAlign");return a?"c-txt-"+a:""}}},tmpl:['<label {{bindAttr class="colorCls textAlignCls" for="forName"}}>',"{{text}}","</label>"].join("")}),b}),$Define("C.RowItem","C.AbstractComponent",function(a){function b(a){var b=this;b.callSuper();var c=b.get("text");c||0===c||b.set("text","&nbsp;"),void 0===b.text||a.hasOwnProperty("underline")||b.set("underline",!0),a.click&&!a.hasOwnProperty("hasArrow")&&b.set("hasArrow",!0)}var c=a.define("RowItem");return c.extend({xConfig:{cls:"rowitem",text:"",underline:!1,hasArrow:!1,newsNum:0,newsNumTxt:{depends:["newsNum"],parse:function(){var a=this.get("newsNum");return a?a>9?"9+":a:0}}},tmpl:['<div {{bindAttr class="underline?hui-rowitem-underline"}}>',"{{placeItem}}",'<div class="hui-rowitem-txt">{{text}}</div>',"{{#if newsNumTxt}}",'<span class="hui-news-tips">{{newsNumTxt}}</span>',"{{else}}","{{#if hasArrow}}",'<a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="详情"><span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span></a>',"{{/if}}","{{/if}}","</div>"].join(""),doConfig:b}),c}),$Define("C.Set","C.AbstractComponent",function(a){var b=a.define("Set");return b.extend({xConfig:{cls:"set",title:""},tmpl:["<div>",'<h1 class="hui-set-title">{{title}}</h1>','<div class="hui-set-content">',"{{placeItem}}","</div>","</div>"].join("")}),b}),$Define("C.Field","C.AbstractComponent",function(a){function b(a){var b=this,c=a.title;$H.isSimple(c)&&(c={text:c}),c=$H.extend({xtype:"Label",xrole:"title"},c),b.add(c);var d=a.content;void 0!==d||a.items||(d=""),$H.isSimple(d)&&(d={text:d,underline:!0}),d&&(b.noPadding=!0,b.add(d));var e=$.extend({},a);delete e.title,delete e.content,b.callSuper([e])}var c=a.define("Field");return c.extend({xConfig:{cls:"field",noPadding:!1},defItem:{xtype:"RowItem",xrole:"content"},tmpl:["<div>",'<div class="hui-field-left">',"{{placeItem > [xrole=title]}}","</div>",'<div {{bindAttr class="#hui-field-right noPadding?hui-field-nopadding"}}>',"{{placeItem > [xrole=content]}}","</div>","</div>"].join(""),doConfig:b}),c}),$Define("C.Form","C.AbstractComponent",function(a){var b=a.define("Form");return b.extend({xConfig:{cls:"form"},tmpl:["<div>",'<form action="">','<div class="hui-form-tips c-txt-error"></div>',"{{placeItem}}","</form>","</div>"].join("")}),b}),$Define("C.TabItem",["C.AbstractComponent","C.Panel"],function(a){function b(){var a=this;a.callSuper(),a.titleCmp=a.find("> [xrole=title]")[0],a.contentCmp=a.find("> [xrole=content]")[0]}function c(a){var b=this;b.callSuper();var c=a.title;"string"==typeof c&&(c={text:c}),"object"==typeof c&&b.add(c);var d=a.content;"string"==typeof d&&(d={xtype:"Panel",content:d}),"object"==typeof d&&($H.extend(d,{xrole:"content",hidden:!b.selected,extCls:"js-content"}),b.add(d))}function d(a){var b=this;b.selected&&"title"==a.xrole&&(a.isActive=!0),a.icon&&void 0===a.iconPos&&(a.iconPos="top"),b.activeType&&(a.activeCls="hui-btn-active-"+b.activeType)}function e(a){var b=this,c=b.titleCmp,d=b.contentCmp;0==a?(c.unactive(),d&&d.hide(),b.set("selected",!1),b.trigger("selectchange",!1)):(c.active(),d&&d.show(),b.set("selected",!0),b.trigger("selectchange",!0))}function f(a,b){var c=this;return b||(b=c.contentCmp),c.callSuper([a,b])}function g(a,b){var c=this;return b||(b=c.contentCmp),c.callSuper([a,b])}var h=a.define("TabItem");return h.extend({xConfig:{cls:"tabitem"},defItem:{xtype:"Button",xrole:"title",radius:null,isInline:!1,shadow:!1},_customEvents:["selectchange"],tmpl:"<div>{{placeItem > [xrole=title]}}</div>",initialize:b,doConfig:c,parseItem:d,select:e,getContent:f,setContent:g}),h}),$Define("C.Tab",["C.AbstractComponent","C.TabItem","C.ControlGroup"],function(a,b,c){function d(a){var b=this;b.activeType&&(a.activeType=b.activeType),b.callSuper()}function e(a,b){var c=this;b=b||c.getSelected(!0),c.findEl(".js-tab-content").index(b).html(a)}var f=a.define("Tab",c);return f.extend({xConfig:{cls:"tab",direction:"h"},defItem:{xtype:"TabItem"},tmpl:["<div>","{{placeItem > TabItem}}",'<div class="c-clear"></div>',"{{placeItem > TabItem > [xrole=content]}}","</div>"].join(""),parseItem:d,setTabContent:e}),f}),$Define("C.Toolbar","C.AbstractComponent",function(a){function b(a){"Button"==a.xtype&&(a.shadowSurround=!0,"left"==a.pos?a.extCls=(a.extCls||"")+" hui-tbar-btn-left":"right"==a.pos&&(a.extCls=(a.extCls||"")+" hui-tbar-btn-right"))}var c=a.define("Toolbar");return c.extend({xConfig:{cls:"tbar",title:"",isHeader:!1,isFooter:!1},defItem:{xtype:"Button",theme:"black"},tmpl:['<div {{bindAttr class="isHeader?hui-header isFooter?hui-footer"}}>',"{{placeItem}}",'{{#if title}}<h1 class="hui-tbar-title js-tbar-txt">{{title}}</h1>{{/if}}',"</div>"].join(""),parseItem:b}),c}),$Define("C.Tips",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(a,b){function c(a){var b=this;"loading"==a.type?$H.extend(b,{text:"正在加载中...",timeout:null,noMask:!0,icon:"loading"}):"miniLoading"==a.type?$H.extend(b,{showPos:"top",clickHide:!1,destroyWhenHide:!1,timeout:null,delayShow:!1,shadowOverlay:null,theme:null,noMask:!0,tType:"mini",items:{xtype:"Icon",name:"loading-mini",hasBg:!1}}):"topTips"==a.type&&$H.extend(b,{showPos:"top",noMask:!0,tType:"mini"}),b.callSuper()}var d=a.define("Tips",b);return d.extend({xConfig:{cls:"tips",text:"",radius:"normal",theme:"black"},timeout:2e3,tmpl:['<div {{bindAttr class="text:hui-tips-notxt"}}>',"{{placeItem}}",'{{#if text}}<span class="hui-tips-txt">{{text}}</span>{{/if}}',"</div>"].join(""),doConfig:c}),d}),$Define("C.Dialog",["C.AbstractComponent","C.Popup"],function(a,b){function c(a){return new g({contentMsg:a,noClose:!0,noCancel:!0})}function d(a,b){return new g({contentMsg:a,noClose:!0,okCall:function(){return b&&b(!0)},cancelCall:function(){return b&&b(!1)}})}function e(a,b,c){return c||(c=b,b=""),new g({contentMsg:a,noClose:!0,items:{xtype:"Input",xrole:"dialog-content",value:b},okCall:function(){var a=this.find("Input")[0].val();return c&&c(a)}})}function f(a){var b=this;b.callSuper();var c=a.items;if(b.title&&!b.hasConfig("[xrole=dialog-header]",c)&&b.add({xtype:"Toolbar",title:b.title,theme:"gray",xrole:"dialog-header",extCls:"hui-dialog-header",items:!b.noClose&&{xtype:"Button",radius:"big",icon:"delete",isMini:!1,theme:"gray",pos:"left",click:function(){b.hide()}}}),!b.noAction&&!b.hasConfig("[xrole=dialog-action]",c)){var d=[];b.noCancel||d.push({title:{isActive:1==b.activeBtn,text:b.cancelTxt,click:function(){0!=(b.cancelCall&&b.cancelCall())&&b.hide()}}}),b.noOk||d.push({title:{text:b.okTxt,isActive:2==b.activeBtn,click:function(){0!=(b.okCall&&b.okCall())&&b.hide()}}}),b.add({xtype:"Tab",xrole:"dialog-action",theme:"border-top",notSelect:!0,items:d})}}var g=a.define("Dialog",b);return $H.extend(g,{alert:c,confirm:d,prompt:e}),g.extend({xConfig:{cls:"dialog",radius:"little",content:"",contentTitle:"",contentMsg:""},okTxt:"确定",cancelTxt:"取消",clickHide:!1,tmpl:["<div>","{{placeItem > [xrole=dialog-header]}}",'<div class="hui-dialog-body">',"{{#if content}}","{{content}}","{{else}}",'<div class="hui-body-content c-clear">','<h1 class="hui-content-title">{{contentTitle}}</h1>','<div class="hui-content-msg">{{contentMsg}}</div>',"{{placeItem > [xrole=dialog-content]}}","</div>","{{/if}}","{{#unless noAction}}",'<div class="hui-body-action">',"{{placeItem > [xrole=dialog-action]}}","</div>","{{/unless}}","</div>","</div>"].join(""),doConfig:f}),g}),$Define("C.Menu",["C.AbstractComponent","C.Popup","C.ControlGroup"],function(a,b,c){function d(){var a=this;a.callSuper(c),a.callSuper()}function e(a){var b=this;c.prototype.parseItem.call(b,a);var d=b.markType;d?"hook"==d&&(a.items={name:"check",isAlt:!0,hasBg:!1},a.iconPos="left",a.activeCls="hui-item-select"):b.notSelect=!0,a.isActive=a.selected}var f=a.define("Menu",b);return f.extend(c.prototype),f.extend({xConfig:{cls:"menu"},markType:null,destroyWhenHide:!1,defItem:{xtype:"Button",radius:null,shadow:!1,theme:null,isInline:!1},tmpl:'<div {{bindAttr class="directionCls"}}>{{placeItem}}</div>',doConfig:d,parseItem:e}),f}),$Define("C.DatePicker",["C.AbstractComponent","C.Dialog"],function(a,b){function c(a){var b,c=a.formator||"default",d=g.instance||(g.instance={});return(b=d[c])?(b.host!=a.host&&(b.host=a.host,b.off("change confirm"),a.change&&b.on("change",a.change),a.confirm&&b.on("confirm",a.confirm),a.date&&b.val(a.date)),b.show()):b=d[c]=new g($H.extend(a,{destroyWhenHide:!1})),b}function d(a,b,c,d,e){for(var f={xtype:"Select",xrole:"dialog-content",name:"dialogSelect",value:a,width:50,cClass:d,optionWidth:100,iconPos:"bottom",extCls:"hui-dp-"+d,options:[],defItem:{showPos:"center"},change:function(){var a=this,b=a.parent,c=b.val(!0);
if("month"==a.cClass){var d=$H.getDaysInMonth(c),e=b.find(".date > Menu")[0],f=e.find();e.val()>d&&e.val(d);for(var g=28;31>g;g++){var h=f[g];h.hidden=d>g?!1:!0}}var i=b.val();b.val(i),b.trigger("change")}},g=b;c>=g;g++)f.options.push({text:"minute"==d&&10>g?"0"+g:g,value:g,hidden:e&&g>e});return f}function e(a){var b=this;a=a||{};var c=a.date;$H.isStr(c)&&(c=$H.parseDate(c));for(var c=c||$H.now(),e=a.formator||(a.formator="yyyy-MM-dd HH:mm"),f=$H.formatDate(c,e),g=[],h=$H.getDaysInMonth(c),i=e.match(/[a-zA-Z]+/g),j=f.match(/\d+/g),k=0;k<i.length;k++){var l=i[k],m=parseInt(j[k]);switch(l){case"yyyy":g.push(d(m,m,m+10,"year"));break;case"MM":g.push(d(m,1,12,"month"));break;case"dd":g.push(d(m,1,31,"date",h));break;case"HH":g.push(d(m,0,23,"hour"));break;case"mm":g.push(d(m,0,59,"minute"))}}$H.extend(a,{contentTitle:f+" 星期"+$H.getWeek(c),items:g,okCall:function(){return b.trigger("confirm")}}),b.callSuper([a])}function f(a){var b=this,c=b.find("Select"),d=b.formator;if(!a||$H.isBool(a)){for(var e="",f=0;f<c.length;f++)1==f||2==f?e+="-":3==f?e+=" ":4==f&&(e+=":"),e+=c[f].val();var g=$H.parseDate(e);return a?g:$H.formatDate(g,d)}var e=a,h=a;$H.isStr(a)?h=$H.parseDate(a,d):e=$H.formatDate(a,d);for(var i=e.match(/\d+/g),f=0;f<c.length;f++)c[f].val(i[f]);b.set("contentTitle",e+" 星期"+$H.getWeek(h))}var g=a.define("DatePicker",b);return g.getInstance=c,g.extend({xConfig:{cls:"dp"},extCls:"hui-dialog",_customEvents:["change","confirm"],doConfig:e,val:f}),g}),$Define("C.DateSelect",["C.AbstractComponent","C.DatePicker"],function(a,b){function c(a){var b=this,c=a.date;c||(c=$H.now(),c.setMinutes(0)),b.date=c;var d=$H.formatDate(c,a.formator||(a.formator="yyyy-MM-dd HH:mm"));b.set("value",d),b.callSuper()}function d(){var a=this;b.getInstance({date:a.get("value"),formator:a.formator,host:a,confirm:function(){return a.set("value",this.val()),a.trigger("change"),a.trigger("confirm")}})}function e(a){var b=this;if(!a||$H.isBool(a)){var c=b.get("value");return a?$H.parseDate(c):c}a=$H.formatDate(a,b.formator),b.get("value")!=a&&(b.set("value",a),b.trigger("change"))}var f=a.define("DateSelect");return f.extend({xConfig:{cls:"dsel",name:"",value:"right",text:{depends:["value"],parse:function(){var a=this.get("value");return a?a+" 星期"+$H.getWeek($H.parseDate(a)):"请选择..."}},radius:"little",iconPos:"right",iconPosCls:{depends:["iconPos"],parse:function(){var a=this.get("iconPos");return a?"hui-btn-icon-"+a:""}}},_customEvents:["change","confirm"],tmpl:['<div {{bindAttr class="#hui-btn #hui-btn-gray iconPosCls"}}>','<span class="hui-icon hui-alt-icon hui-icon-carat-d hui-light"></span>','<input {{bindAttr value="value" name="name"}}/>','<span class="hui-btn-txt">{{text}}</span>',"</div>"].join(""),listeners:[{name:"click",handler:function(){this.showDialog()}}],doConfig:c,showDialog:d,val:e}),f}),$Define("C.Hcard","C.AbstractComponent",function(a){function b(a){var b=this;b.callSuper(),a.click&&void 0===b.hasArrow&&b.set("hasArrow",!0);var c=b.desc;c&&(1==c.length&&b.set("theme","little"),b.add(c)),b.imgClick&&b.listen({name:"click",selector:".js-img",method:"delegate",handler:function(){b.imgClick.call(b)}}),b.contentClick&&b.listen({name:"click",selector:".js-content",method:"delegate",handler:function(){b.contentClick.call(b)}})}var c=a.define("Hcard");return c.extend({xConfig:{cls:"hcard",image:"",title:"",titleDesc:"",hasArrow:!1,newsNum:0,newsNumTxt:{depends:["newsNum"],parse:function(){var a=this.get("newsNum");return a?a>9?"9+":a:0}}},defItem:{xtype:"Desc"},tmpl:['<div {{bindAttr class="image?hui-hcard-hasimg"}}>',"{{#if image}}",'<div class="hui-hcard-img js-img">','<img {{bindAttr src="image"}}>',"</div>","{{/if}}",'<div class="hui-hcard-content js-content">','<div class="hui-content-title">',"{{title}}",'<span class="hui-title-desc">{{titleDesc}}</span>',"</div>","{{placeItem > [xtype=Desc]}}","</div>","{{placeItem > [xtype!=Desc]}}","{{#if newsNumTxt}}",'<span class="hui-news-tips">{{newsNumTxt}}</span>',"{{else}}","{{#if hasArrow}}",'<a href="javascript:;" hidefocus="true" class="hui-click-arrow" title="详情">','<span class="hui-icon hui-alt-icon hui-icon-carat-r hui-light"></span>',"</a>","{{/if}}","{{/if}}","</div>"].join(""),doConfig:b}),c}),$Define("C.Vcard","C.AbstractComponent",function(a){function b(a){var b=this;b.callSuper();var c=a.action;c&&(c=$H.extend({xtype:"Button",radius:null,isInline:!1,xrole:"action"},c),b.add(c))}var c=a.define("Vcard");return c.extend({xConfig:{cls:"vcard",image:"",title:"",extraTitle:""},tmpl:["<div>",'<div {{bindAttr class="#hui-vcard-title image?hui-title-hasimg #c-clear"}}>','<div class="hui-title-img">','<img {{bindAttr src="image"}}>',"</div>",'<div class="hui-title-txt">{{title}}</div>','<div class="hui-title-extra">{{extraTitle}}</div>',"</div>","{{placeItem > [xrole!=action]}}",'<div class="hui-vcard-action">',"{{placeItem > [xrole=action]}}","</div>","</div>"].join(""),doConfig:b}),c}),$Define("C.Conversation","C.AbstractComponent",function(a){function b(){var a=this;a.callSuper(),a.imgClick&&a.listen({name:"click",selector:".js-conver-img",method:"delegate",handler:function(){a.imgClick.call(a)}})}var c=a.define("Conversation");return c.extend({xConfig:{cls:"conversation",theme:"left",time:"",image:"",content:""},tmpl:['<div class="c-clear">','<div class="hui-conver-time">{{time}}</div>','<div class="hui-conver-img js-conver-img">','<img {{bindAttr src="image"}}>',"</div>",'<div class="hui-conver-content">',"{{content}}",'<div class="hui-triangle">','<div class="hui-triangle hui-triangle-inner"></div>',"</div>","</div>","</div>"].join(""),doConfig:b}),c}),$Define("C.ModelList","C.AbstractComponent",function(a){function b(){var a=this;a.callSuper(),a.set("pdTxt",a.pullTxt),a.itemXtype&&((a.defItem||(a.defItem={})).xtype=a.itemXtype);var b=a.model;0==b.size()?a.set("isEmpty",!0):a.loadMore(),a.listenTo(b,{add:function(b,c){a.addListItem(c)},remove:function(b,c){a.removeListItem(c)},sortItem:function(b,c,d){var e=a.find(function(a){return a.model&&a.model.id==c.id});e=e[0];var f=e.getEl(),g=f.parent(),h=g.children("div").eq(d);h.before(f)},reset:function(){a.removeListItem("emptyAll")}});var c=a.hasPullRefresh&&window.iScroll&&!$H.ie();a.set("hasPullRefresh",c),c&&(a.listen({name:"afterRender",handler:function(){var a=this,b=a.getEl(),c=b.find(".hui-list-pulldown"),d=50,e="hui-pd-refresh",f="hui-pd-release";a.scroller=new window.iScroll(b[0],{useTransition:!0,topOffset:d,onRefresh:function(){c.hasClass(e)&&(c.removeClass(e+" "+f),a.set("pdTxt",a.pullTxt))},onScrollMove:function(){this.y>5&&!c.hasClass(f)?(c.addClass(f),a.set("pdTxt",a.flipTxt),this.minScrollY=0):this.y<5&&c.hasClass(f)&&(c.removeClass(f),a.set("pdTxt",a.pullTxt),this.minScrollY=-d)},onScrollEnd:function(){c.hasClass(f)&&(c.addClass(e),a.set("pdTxt",a.releaseTxt),a.pulldownIsRefresh?a.refresh():a.loadMore())}})}}),a.listenTo(a.model,"sync",function(){a.set("pdTime",$H.formatDate($H.now(),"HH:mm")),setTimeout(function(){a.refreshScroller()},0)}),a.listen({name:"afterShow",handler:function(){a.refreshScroller(),"bottom"==a.scrollPos&&a.scrollTo("bottom")}}),a.listen({name:"click",method:"delegate",selector:".hui-list-more",handler:function(){a.pulldownIsRefresh?a.loadMore():a.refresh()}}))}function c(a,b){var c=this;if(c.set("isEmpty",!1),void 0===b){b=c.model.indexOf(a);var d=c.inited?c.children.length:c.items.length;b=b>d?d:b}c.add({model:a},b),c.refreshScroller()}function d(a){var b=this;b.remove("emptyAll"==a?b.children:function(b){return b.model&&b.model.id==a.id}),0==b.children.length&&b.set("isEmpty",!0),b.refreshScroller()}function e(){var a=this;a.scroller&&a.getEl()[0].clientHeight&&a.scroller.refresh()}function f(a,b,c){var d=this,e=d.scroller;if($H.isStr(a)){if("top"==a)e.scrollTo(0,-50);else if("bottom"==a){var f=d.findEl(".hui-list-inner")[0].clientHeight;e.scrollTo(0,-f)}}else e.scrollTo(a,b,c)}function g(){var a=this,b=a.model,c=a.children.length,d=b.size();if(d>c){var e=a.maxNumFromCache,f=c,g=c+e;a.pulldownIsRefresh?b.each(function(b,c){b>=f&&g>b&&a.addListItem(c)}):(g=d-c,f=g-e,b.eachDesc(function(b,c){b>=f&&g>b&&a.addListItem(c,0)})),a.refreshScroller()}else a.getMore()}function h(a){var b=this,c=b.scroller,d=c.minScrollY;if(c.minScrollY=10,a){var e=b.findEl(".hui-list-pulldown");e.addClass("hui-pd-release")}c.scrollTo(0,0,200),setTimeout(function(){c.minScrollY=d},250)}function i(){var a=this;a.scroller&&(a.scroller.destroy(),a.scroller=null),a.callSuper()}var j=a.define("ModelList");return j.extend({xConfig:{cls:"mlist",isEmpty:!1,emptyTips:"暂无",pdTxt:"",pdComment:"上次刷新时间：",pdTime:"",hasMoreBtn:!0,moreBtnTxt:"查看更多",showBtnIfEmpty:!1,hasPullRefresh:!1,showMoreBtn:{depends:["isEmpty","showBtnIfEmpty"],parse:function(){return this.get("showBtnIfEmpty")||!this.get("isEmpty")}}},pullTxt:"下拉可刷新",flipTxt:"松开可刷新",releaseTxt:"正在刷新",maxNumFromCache:20,scrollPos:"top",pulldownIsRefresh:!0,tmpl:['<div class="hui-list">','<div class="hui-list-inner">',"{{#if hasPullRefresh}}",'<div class="hui-list-pulldown hui-pd-pull c-h-middle-container">','<div class="c-h-middle">','<span class="hui-icon hui-alt-icon hui-icon-arrow-d hui-light"></span>','<span class="hui-icon hui-alt-icon hui-icon-loading-mini"></span>','<div class="hui-pd-txt">','{{#if pdTxt}}<div class="js-txt">{{pdTxt}}</div>{{/if}}',"{{#if pdComment}}",'<div class="js-comment hui-pd-comment">','<span class="js-pdComment">{{pdComment}}</span>','<span class="js-pdTime">{{pdTime}}</span>',"</div>","{{/if}}","</div>","</div>","</div>","{{/if}}","{{#if isEmpty}}",'<div class="hui-list-empty js-empty">{{emptyTips}}</div>',"{{/if}}",'<div class="js-item-container">{{placeItem}}</div>',"{{#if hasMoreBtn}}",'<div {{bindAttr class="#hui-list-more showMoreBtn:hui-hidden"}}>','<a href="javascript:;" hidefocus="true" class="hui-btn hui-btn-gray hui-shadow hui-inline hui-radius-little">','<span class="hui-btn-txt">{{moreBtnTxt}}</span>',"</a>","</div>","{{/if}}","</div>","</div>"].join(""),doConfig:b,addListItem:c,removeListItem:d,refreshScroller:e,scrollTo:f,loadMore:g,showLoading:h,destroy:i}),j}),$Define("M.AbstractModule","CM.View",function(a){function b(){this.clearCache=!0}var c=$H.createClass();return $H.inherit(c,a,{useCache:$H.noop,cache:$H.noop,init:$H.noop,reset:$H.noop,exit:function(){return!0},cleanCache:b}),c}),$Define("M.AbstractNavigator","handy.base.Object",function(a){var b=$H.createClass();return a.extend(b.prototype,{navigate:function(){}}),b}),$Define("M.History","handy.base.HashChange",function(a){function b(b,c){var d=this;"function"==typeof b&&(c=b,b=null),d.error=c||$H.noop,d.key=b||"handy",d.states=[],a.listen($H.Function.bind(d.stateChange,d))}function c(){var a=this,b=a.getHashParam(),c=b.hKey,d=a.currentKey,e=a.states,f=e[d];if(c==d)return!1;var g,h=e[c];h?g=h.onStateChange(h.param,!0):($D.warn("hisory state not found"),g=a.error("stateNotFound",b)),1!=g?(b={hKey:d,param:f.param},a.saveHash(b)):a.currentKey=c}function d(a){var b=this,c=b.currentKey=b.key+ ++k;b.states.push(c),b.states[c]=a;var d=a.param;b.saveHash({hKey:c,modName:d&&d.modName})}function e(a){$H.setHash("#"+$H.Json.stringify(a))}function f(){try{var a=$H.getHash().replace("#",""),b=$H.parseJson(a);return b}catch(c){$H.Debug.warn("History.getCurrentState:parse hash error:"+c.message)}}function g(){var a=this;try{var b=a.getHashParam();return a.states[b.hKey]}catch(c){$H.Debug.warn("History.getCurrentState:parse hash error:"+c.message)}}function h(){var a=this;try{for(var b=a.getHashParam(),c=b.hKey,d=a.states,e=d.length,f=0;f++;e>f)if(d[f]==c)return f>0?d[d[--f]]:null}catch(g){$H.Debug.error("History.getPreState error:"+g.message,g)}}function i(){var a=this,b=a.getPreState();b&&b.onStateChange(b.param)}var j=$H.createClass(),k=0;return $H.extend(j.prototype,{initialize:b,stateChange:c,saveState:d,saveHash:e,getHashParam:f,getCurrentState:g,getPreState:h,back:i}),j}),$Define("M.ModuleManager",["M.History","CM.AbstractManager"],function(a,b){function c(a){var b=this,c=a.modName;b.modules[c]={waiting:!0},$Require(b.defModPackage+c,function(d){var e={renderTo:b.container,name:c,xtype:c,extCls:"js-module m-module m-"+c.replace(/\./g,"-"),hidden:!0};$H.extend(e,a);var f=new d(e);b.modules[c]=f,$H.trigger("afterRender",f.getEl()),b.requestMod==c&&b._showMod(f)})}function d(a){var b=this,c=b.modules[b.currentMod];b.navigator&&b.navigator.navigate(a,c,b)||(c&&c.hide(),a.show()),c&&(c.isActive=!1),a.isActive=!0,b.currentMod=a.name}function e(a){var b=this;a.destroy(),delete b.modules[a.name]}function f(b){var c=this;c.callSuper(),b&&(c.conf=b,$H.extend(c,b),c.container=$(b.container?b.container:document.body)),c.defModPackage=c.defModPackage+".",c.history=new a(function(a,b){c.go(b.param)}),c.modules={}}function g(a,b){var c=this;"string"==typeof a&&(a={modName:a});var d=a.modName,e=c.currentMod,f=c.modules,g=f[e];if(e==d)return void(g.waiting||g.reset());if(g&&!g.waiting)if(g._forceExit)g._forceExit=!1;else if(0==g.exit())return!1;c.requestMod=d;var h=f[d];return h?1!=h.notCache&&1!=h.clearCache&&0!=h.useCache(a)?(0==h.clearCache,c._showMod(h),h.cache(a)):h.waiting||(c._destroy(h),c._createMod(a)):c._createMod(a),1!=b&&c.history.saveState({onStateChange:$H.Function.bind(c.go,c),param:a}),!0}function h(a,b){var c=a.update(b);return c&&(this.modules[a.name]=c,$H.trigger("afterRender",c.getEl())),c}function i(a){a.notCache=!0}function j(a){var b=this;a&&(b.modules[b.currentMod]._forceExit=!0),history.back()}var k=$H.createClass();return $H.inherit(k,b,{type:"module",_createMod:c,_showMod:d,_destroy:e,initialize:f,go:g,update:h,clearCache:i,back:j}),k});